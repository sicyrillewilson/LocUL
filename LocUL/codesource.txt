=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\androidTest\java\tg\univlome\epl\ExampleInstrumentedTest.kt 
=============================================== 
package tg.univlome.epl

import androidx.test.ext.junit.runners.AndroidJUnit4
import androidx.test.platform.app.InstrumentationRegistry
import org.junit.Assert.assertEquals
import org.junit.Test
import org.junit.runner.RunWith

/**
 * Instrumented test, which will execute on an Android device.
 *
 * See [testing documentation](http://d.android.com/tools/testing).
 */
@RunWith(AndroidJUnit4::class)
class ExampleInstrumentedTest {
    @Test
    fun useAppContext() {
        // Context of the app under test.
        val appContext = InstrumentationRegistry.getInstrumentation().targetContext
        assertEquals("tg.univlome.epl", appContext.packageName)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\FragmentUtils.kt 
=============================================== 
package tg.univlome.epl

import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager

/**
 * Objet FragmentUtils : Fournit une fonction utilitaire simplifiée
 * pour effectuer une transition vers un nouveau fragment.
 *
 * Description :
 * Cette classe utilitaire encapsule la logique standard de remplacement
 * de fragment dans l'application. Elle permet de :
 *  - Remplacer dynamiquement un fragment existant
 *  - Ajouter l'opération à la pile de retour (`BackStack`)
 *
 * Elle est principalement utilisée pour centraliser le code lié
 * aux transactions de fragments, assurant une meilleure maintenabilité.
 *
 * Composants principaux :
 *  - FragmentManager : gestionnaire de fragments fourni par AndroidX
 *  - Fragment : nouveau fragment à afficher
 *
 * @see androidx.fragment.app.Fragment
 * @see androidx.fragment.app.FragmentManager
 */
object FragmentUtils {

    /**
     * Remplace le fragment courant par un nouveau, et ajoute l’opération à la pile de retour.
     *
     * @param fragmentManager Instance de `FragmentManager` utilisée pour exécuter la transaction.
     * @param newFragment Nouveau fragment à afficher dans le conteneur `R.id.container`.
     */
    fun ouvrirFragment(fragmentManager: FragmentManager, newFragment: Fragment) {
        val transaction = fragmentManager.beginTransaction()
        transaction.replace(R.id.container, newFragment)
        transaction.addToBackStack(null)
        transaction.commit()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\MainActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl

import android.Manifest
import android.animation.Animator
import android.animation.AnimatorListenerAdapter
import android.animation.ValueAnimator
import android.app.Activity
import android.app.Dialog
import android.content.pm.PackageManager
import android.graphics.Color
import android.graphics.Rect
import android.os.Bundle
import android.os.Handler
import android.os.Looper
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.DecelerateInterpolator
import android.widget.ArrayAdapter
import android.widget.Button
import android.widget.Spinner
import android.widget.Toast
import androidx.activity.result.contract.ActivityResultContracts
import androidx.appcompat.app.ActionBarDrawerToggle
import androidx.appcompat.app.AppCompatActivity
import androidx.appcompat.app.AppCompatDelegate
import androidx.appcompat.widget.Toolbar
import androidx.core.content.ContextCompat
import androidx.core.os.LocaleListCompat
import androidx.core.view.GravityCompat
import androidx.drawerlayout.widget.DrawerLayout
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.google.android.material.navigation.NavigationView
import tg.univlome.epl.databinding.ActivityMainBinding
import tg.univlome.epl.models.NavItem
import tg.univlome.epl.ui.LogoFragment
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.ui.batiment.BatimentFragment
import tg.univlome.epl.ui.home.HomeFragment
import tg.univlome.epl.ui.infrastructure.InfraFragment
import tg.univlome.epl.ui.maps.MapsFragment
import java.util.Locale

/**
 * Activité principale de l'application : `MainActivity`
 *
 * Description :
 * Cette activité est le point d’entrée visuel de l’application. Elle centralise :
 * - L’interface de navigation latérale (`DrawerLayout`)
 * - L’affichage des fragments (accueil, bâtiments, salles, carte)
 * - La gestion de la langue, du thème et des permissions de localisation
 * - L’intégration des fragments `LogoFragment` et `SearchBarFragment` pour la barre de recherche dynamique
 *
 * Composants principaux :
 * - `DrawerLayout`, `NavigationView`, `Toolbar` : composants d'interface
 * - `NavItem` : modèle utilisé pour représenter les éléments de navigation
 * - `HomeFragment`, `BatimentFragment`, `InfraFragment`, `MapsFragment` : fragments principaux
 * - `SearchBarFragment`, `LogoFragment` : fragments d’en-tête dynamiques
 *
 * Bibliothèques utilisées :
 * - OSMDroid (via MapsFragment)
 * - Firebase (optionnel, indirect)
 * - AndroidX : AppCompat, RecyclerView, Fragment, Lifecycle
 *
 * Fonctionnalités intégrées :
 * - Gestion du thème (clair, sombre, système)
 * - Gestion multilingue (français/anglais)
 * - Permissions runtime pour la localisation
 * - Comportement personnalisé du bouton retour (double clic pour quitter)
 *
 * @see NavItem
 * @see HomeFragment
 * @see LogoFragment
 * @see SearchBarFragment
 */
class MainActivity : AppCompatActivity(), SearchBarFragment.SearchListener,
    LogoFragment.LogoListener {

    // Liaison de la vue
    lateinit var ui: ActivityMainBinding

    // Navigation
    private var selectedItem: NavItem? = null
    private lateinit var drawerLayout: DrawerLayout
    private lateinit var navigationView: NavigationView
    private lateinit var toolbar: Toolbar

    // Fragments de recherche et logo
    private lateinit var searchBarFragment: SearchBarFragment
    private lateinit var logoFragment: LogoFragment
    private var currentLanguageCode: String? = null

    private var doubleBackToExitPressedOnce = false // Variable pour gérer le double appui
    private var currentFragment: Fragment? = null // Pour suivre quel fragment est affiché
    private var navItems = listOf<NavItem>()

    // Demande de permission de localisation
    private val locationPermissionRequest =
        registerForActivityResult(ActivityResultContracts.RequestPermission()) { isGranted: Boolean ->
            if (isGranted) {
                // Permission accordée, on recharge les données si HomeFragment est actif
                (currentFragment as? HomeFragment)?.rechargerDonnees()
            } else {
                Toast.makeText(this, "Permission localisation refusée", Toast.LENGTH_SHORT).show()
            }
        }

    /**
     * Méthode appelée lors de la création de l'activité.
     * Initialise la navigation, le thème, la langue, les fragments et les permissions.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        val sharedPreferences = getSharedPreferences("AppSettings", MODE_PRIVATE)

        // Vérifie si l'activité a déjà été redémarrée
        val hasRestarted = sharedPreferences.getBoolean("theme_applied_once", false)

        // Appliquer langue
        currentLanguageCode =
            sharedPreferences.getString("language_code", Locale.getDefault().language)
        if (currentLanguageCode != null) {
            setLocale(this, currentLanguageCode!!)
        }

        // Appliquer le thème
        val savedTheme = sharedPreferences.getInt("theme_mode", AppCompatDelegate.MODE_NIGHT_NO)
        AppCompatDelegate.setDefaultNightMode(savedTheme)

        if (!hasRestarted) {
            // Marque comme redémarré
            sharedPreferences.edit().putBoolean("theme_applied_once", true).apply()

            // Redémarre l'activité pour appliquer le thème proprement
            finish()
            startActivity(intent)
            return // Stoppe ici le flux du premier démarrage
        }

        super.onCreate(savedInstanceState)
        ui = ActivityMainBinding.inflate(layoutInflater)
        setContentView(ui.root)

        /*// Charger les paramètres sauvegardés
        val sharedPreferences = getSharedPreferences("AppSettings", MODE_PRIVATE)

        // Appliquer la langue
        currentLanguageCode =
            sharedPreferences.getString("language_code", Locale.getDefault().language)
        if (currentLanguageCode != null) {
            setLocale(this, currentLanguageCode!!)
        }

        // Appliquer le thème
        val savedTheme = sharedPreferences.getInt("theme_mode", AppCompatDelegate.MODE_NIGHT_NO)
        AppCompatDelegate.setDefaultNightMode(savedTheme)*/

        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        drawerLayout = findViewById(R.id.drawer_layout)
        navigationView = findViewById<NavigationView>(R.id.nav_view)
        toolbar = findViewById(R.id.toolbarHome)

        // Configurer la toolbar
        setSupportActionBar(toolbar)
        setTitle("")

        // Configurer le toggle pour le drawer
        val toggle = ActionBarDrawerToggle(
            this, drawerLayout, toolbar,
            R.string.navigation_drawer_open,
            R.string.navigation_drawer_close
        )
        drawerLayout.addDrawerListener(toggle)
        toggle.syncState()

        toolbar.setNavigationIcon(R.drawable.hamburger_menu)

        val menuView = navigationView.getChildAt(0) as RecyclerView
        menuView.addItemDecoration(object : RecyclerView.ItemDecoration() {
            override fun getItemOffsets(
                outRect: Rect, view: View, parent: RecyclerView, state: RecyclerView.State
            ) {
                val position = parent.getChildAdapterPosition(view)
                if (position > 0) {
                    outRect.top = 10
                }
            }
        })

        // Gérer les événements de clic sur les items du menu
        navigationView.setNavigationItemSelectedListener { item ->
            // Gérer les clics sur les options du menu
            when (item.itemId) {
                R.id.settings -> {
                    showSettingsDialog(this, true)
                }

                R.id.share -> {

                }

                R.id.contact -> {

                }

                R.id.about -> {

                }
            }

            drawerLayout.closeDrawer(GravityCompat.START)
            true
        }

        searchBarFragment = SearchBarFragment()
        logoFragment = LogoFragment()

        // Ajouter la barre de recherche à l'activité, mais la cacher au début
        if (savedInstanceState == null) {
            supportFragmentManager.beginTransaction()
                .add(R.id.search_bar_container, searchBarFragment)
                .hide(searchBarFragment)
                .add(R.id.search_bar_container, logoFragment)
                .show(logoFragment)
                .commit()
        }

        // Ensuite tu fais registerFragmentLifecycleCallbacks + verification immédiate
        supportFragmentManager.registerFragmentLifecycleCallbacks(object :
            FragmentManager.FragmentLifecycleCallbacks() {
            override fun onFragmentResumed(fm: FragmentManager, fragment: Fragment) {
                super.onFragmentResumed(fm, fragment)

                when (fragment) {
                    is SearchBarFragment.SearchListener -> {
                        showSearchBarFragment(fragment)
                        showLogo(null)
                    }

                    is LogoFragment.LogoListener -> {
                        showLogo(fragment)
                        showSearchBarFragment(null)
                    }
                }
            }
        }, true)

        chargerItems()

        if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION)
            != PackageManager.PERMISSION_GRANTED
        ) {
            locationPermissionRequest.launch(Manifest.permission.ACCESS_FINE_LOCATION)
        } else {
            // Si déjà accordée, on recharge immédiatement les données du HomeFragment
            (currentFragment as? HomeFragment)?.rechargerDonnees()
        }
    }

    /**
     * Initialise les éléments de navigation (`NavItem`) et configure le comportement de sélection.
     * Chaque item déclenche le chargement de son fragment associé.
     */
    private fun chargerItems() {
        navItems = listOf(
            NavItem(
                findViewById(R.id.container_home),
                findViewById(R.id.nav_home),
                findViewById(R.id.text_home),
                findViewById(R.id.icon_home),
                HomeFragment()
            ),
            NavItem(
                findViewById(R.id.container_batiment),
                findViewById(R.id.nav_batiment),
                findViewById(R.id.text_batiment),
                findViewById(R.id.icon_batiment),
                BatimentFragment()
            ),
            NavItem(
                findViewById(R.id.container_salle),
                findViewById(R.id.nav_salle),
                findViewById(R.id.text_salle),
                findViewById(R.id.icon_salle),
                InfraFragment()
            ),
            NavItem(
                findViewById(R.id.container_maps),
                findViewById(R.id.nav_maps),
                findViewById(R.id.text_maps),
                findViewById(R.id.icon_maps),
                MapsFragment()
            )
        )

        for (item in navItems) {
            item.minLayout.setBackgroundColor(Color.TRANSPARENT)
            item.textView.visibility = View.GONE
            item.icon.setColorFilter(
                ContextCompat.getColor(
                    this,
                    R.color.gray
                )
            )
        }

        val defaultItem = navItems[0]
        selectedItem = defaultItem
        defaultItem.layout.setBackgroundResource(R.drawable.nav_item_bg)
        defaultItem.textView.visibility = View.VISIBLE
        defaultItem.textView.setTextColor(ContextCompat.getColor(this, R.color.mainColor))
        defaultItem.icon.setColorFilter(ContextCompat.getColor(this, R.color.mainColor))

        animateItemSelection(defaultItem)

        // Charge le fragment par défaut
        loadFragment(defaultItem.fragment)

        if (defaultItem.fragment is HomeFragment) {
            showLogo(defaultItem.fragment as LogoFragment.LogoListener)
            showSearchBarFragment(null)
        } else if (defaultItem.fragment is SearchBarFragment.SearchListener) {
            showSearchBarFragment(defaultItem.fragment as SearchBarFragment.SearchListener)
            showLogo(null)
        }

        for (item in navItems) {
            item.layout.setOnClickListener {
                if (selectedItem == item) {
                    return@setOnClickListener // Ne rien faire si l'item est déjà sélectionné
                }

                setItem(item, navItems)

            }
        }
    }

    /**
     * Applique les effets visuels et la logique de sélection d’un élément du menu.
     *
     * @param item Élément sélectionné dans le menu.
     * @param navItems Liste complète des items pour réinitialisation.
     */
    fun setItem(item: NavItem, navItems: List<NavItem>) {
        // Réinitialiser tous les items
        for (otherItem in navItems) {
            otherItem.layout.setBackgroundColor(Color.TRANSPARENT)
            otherItem.textView.visibility = View.GONE
            otherItem.icon.setColorFilter(
                ContextCompat.getColor(
                    this,
                    R.color.gray
                )
            ) // Couleur inactive
            if (otherItem.textView.text == this.getString(R.string.infrastructures)) {
                item.textView.minWidth = 0
            }
        }

        // Animer l'élément sélectionné
        _animateItemSelection(item)

        // Mettre à jour l'item sélectionné
        selectedItem = item

        // Charger le fragment correspondant
        loadFragment(item.fragment)
    }

    /**
     * Effectue également une animation d'arrière-plan pour l'item sélectionné.
     */
    private fun animateItemSelection(item: NavItem) {
        item.layout.setBackgroundResource(R.drawable.nav_item_bg)

        // Animation d'apparition progressive du texte
        item.textView.alpha = 0f
        item.textView.visibility = View.VISIBLE
        item.textView.setTextColor(ContextCompat.getColor(this, R.color.black))
        item.textView.animate()
            .alpha(1f)
            .setDuration(350)
            .start()

        item.icon.setColorFilter(ContextCompat.getColor(this, R.color.black))
    }

    /**
     * Effectue une animation d'arrière-plan pour l'item sélectionné.
     */
    private fun _animateItemSelection(item: NavItem) {
        // Appliquer le style de fond
        item.layout.setBackgroundResource(R.drawable.nav_item_bg)

        // Colorier l'icône
        item.icon.setColorFilter(ContextCompat.getColor(this, R.color.black))

        // Préparer le texte pour l'animation
        item.textView.alpha = 0f
        item.textView.visibility = View.VISIBLE
        item.textView.setTextColor(ContextCompat.getColor(this, R.color.black))

        // Mesurer la largeur que devrait avoir le layout en mode wrap_content
        val widthSpec = View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED)
        val heightSpec = View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED)

        // Garder la largeur actuelle (avant expansion)
        val startWidth = item.layout.width

        // Mesurer la largeur cible avec le texte visible
        item.layout.measure(widthSpec, heightSpec)
        val targetWidth = item.layout.measuredWidth

        // Animation d'expansion horizontale
        val layoutParams = item.layout.layoutParams
        val animator = ValueAnimator.ofInt(startWidth, targetWidth)
        animator.duration = 500
        animator.interpolator = DecelerateInterpolator()

        animator.addUpdateListener { animation ->
            val value = animation.animatedValue as Int
            layoutParams.width = value
            item.layout.layoutParams = layoutParams
        }

        animator.addListener(object : AnimatorListenerAdapter() {
            override fun onAnimationEnd(animation: Animator) {
                // Quand l'animation est terminée, définir en wrap_content
                layoutParams.width = ViewGroup.LayoutParams.WRAP_CONTENT
                item.layout.layoutParams = layoutParams
            }
        })

        // Démarrer l'animation d'expansion
        animator.start()

        // Animation d'apparition progressive du texte
        item.textView.animate()
            .alpha(1f)
            .setDuration(350)
            .start()
    }

    /**
     * Affiche la barre de recherche (`SearchBarFragment`) si un listener est fourni.
     *
     * @param listener Listener implémenté par le fragment actuel ou `null` pour masquer la barre.
     */
    fun showSearchBarFragment(listener: SearchBarFragment.SearchListener?) {
        if (listener != null) {
            // Afficher la barre de recherche et définir le listener du fragment actif
            searchBarFragment.setSearchListener(listener)
            supportFragmentManager.beginTransaction()
                .show(searchBarFragment)
                .commit()
        } else {
            // Cacher la barre de recherche
            supportFragmentManager.beginTransaction()
                .hide(searchBarFragment)
                .commit()
        }
    }

    /**
     * Affiche ou masque le logo (`LogoFragment`) en fonction du fragment actif.
     */
    fun showLogo(listener: LogoFragment.LogoListener?) {
        if (listener != null) {
            logoFragment.setLogoListener(listener)
            supportFragmentManager.beginTransaction()
                .show(logoFragment)
                .commit()
        } else {
            supportFragmentManager.beginTransaction()
                .hide(logoFragment)
                .commit()
        }
    }

    /**
     * Charge dynamiquement un fragment dans le conteneur principal.
     *
     * @param fragment Fragment à afficher.
     */
    fun loadFragment(fragment: Fragment) {
        supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .commit()
        currentFragment = fragment
    }

    /**
     * Charge le fragment MapsFragment dans le conteneur principal.
     *
     * @param fragment Fragment à afficher.
     */
    fun loadMapsFragment() {
        for (item in navItems) {
            if (item.fragment is MapsFragment) {
                setItem(item, navItems)
                break
            }
        }
    }

    /**
     * Affiche une boîte de dialogue de paramètres permettant à l'utilisateur
     * de choisir la langue et le thème de l'application.
     *
     * @param activity Activité appelante.
     * @param show Si `true`, la boîte de dialogue est immédiatement affichée.
     */
    fun showSettingsDialog(activity: Activity, show: Boolean) {
        val dialog = Dialog(activity)
        val view = LayoutInflater.from(activity).inflate(R.layout.settings, null)
        dialog.setContentView(view)

        val languageSpinner = view.findViewById<Spinner>(R.id.languageSpinner)
        val themeSpinner = view.findViewById<Spinner>(R.id.themeSpinner)
        val applyButton = view.findViewById<Button>(R.id.appliquer)

        val languageOptions =
            listOf(activity.getString(R.string.francais), activity.getString(R.string.anglais))
        val themeOptions = listOf(
            activity.getString(R.string.clair),
            activity.getString(R.string.sombre),
            activity.getString(R.string.systeme)
        )

        val languageAdapter = ArrayAdapter(activity, R.layout.spinner_item, languageOptions)
        languageAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)
        languageSpinner.adapter = languageAdapter

        val themeAdapter = ArrayAdapter(activity, R.layout.spinner_item, themeOptions)
        themeAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)
        themeSpinner.adapter = themeAdapter

        // Charger les préférences sauvegardées
        val sharedPreferences =
            activity.getSharedPreferences("AppSettings", MODE_PRIVATE)
        val savedLanguageCode = sharedPreferences.getString(
            "language_code",
            Locale.getDefault().language
        ) // Langue par défaut du système
        val savedTheme = sharedPreferences.getInt(
            "theme_mode",
            AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM
        ) // Thème par défaut : Système

        // Appliquer les préférences sauvegardées
        setLocale(activity, savedLanguageCode!!)
        //AppCompatDelegate.setDefaultNightMode(savedTheme)

        // Définir les sélections des spinners
        val savedLanguagePosition = when (savedLanguageCode) {
            "fr" -> 0
            "en" -> 1
            else -> 0 // Français par défaut
        }
        languageSpinner.setSelection(savedLanguagePosition)

        val savedThemePosition = when (savedTheme) {
            AppCompatDelegate.MODE_NIGHT_NO -> 0
            AppCompatDelegate.MODE_NIGHT_YES -> 1
            AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM -> 2 // Système
            else -> 0 // Clair par défaut
        }
        themeSpinner.setSelection(savedThemePosition)

        // Appliquer les choix au clic sur "Appliquer"
        applyButton.setOnClickListener {
            val selectedLanguagePosition = languageSpinner.selectedItemPosition
            val selectedThemePosition = themeSpinner.selectedItemPosition

            // Appliquer la langue
            val selectedLanguageCode = when (selectedLanguagePosition) {
                0 -> "fr" // Français
                1 -> "en" // Anglais
                else -> "fr"
            }
            val appLocale = LocaleListCompat.forLanguageTags(selectedLanguageCode)
            AppCompatDelegate.setApplicationLocales(appLocale)

            // Appliquer le thème
            val selectedThemeMode = when (selectedThemePosition) {
                0 -> AppCompatDelegate.MODE_NIGHT_NO // Clair
                1 -> AppCompatDelegate.MODE_NIGHT_YES // Sombre
                2 -> AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM // Système
                else -> AppCompatDelegate.MODE_NIGHT_NO
            }
            AppCompatDelegate.setDefaultNightMode(selectedThemeMode)

            // Sauvegarder les préférences
            val editor = sharedPreferences.edit()
            editor.putString("language_code", selectedLanguageCode)
            editor.putInt("theme_mode", selectedThemeMode)
            editor.apply()

            dialog.dismiss()
            val fragmentManager = (activity as AppCompatActivity).supportFragmentManager
            fragmentManager.fragments.forEach {
                fragmentManager.beginTransaction().remove(it).commitAllowingStateLoss()
            }

            //activity.recreate() // Recréer l'activité pour appliquer les changements
            activity.finish()
            activity.startActivity(activity.intent)
        }

        // Personnaliser l'apparence du Dialog
        dialog.window?.setBackgroundDrawableResource(R.drawable.rounded_frame)
        dialog.window?.setLayout(
            (activity.resources.displayMetrics.widthPixels * 0.8).toInt(), // 65% de la largeur de l'écran
            (activity.resources.displayMetrics.heightPixels * 0.28).toInt(),
        )
        if (show) {
            dialog.show()
        }
    }

    /**
     * Applique la langue spécifiée à l'application en mettant à jour la configuration du contexte.
     *
     * @param activity Activité cible.
     * @param languageCode Code de langue (ex: "fr", "en").
     */
    fun setLocale(activity: Activity, languageCode: String) {
        val locale = Locale(languageCode)
        Locale.setDefault(locale)

        val config = activity.resources.configuration
        config.setLocale(locale)
        config.setLayoutDirection(locale)

        activity.resources.updateConfiguration(config, activity.resources.displayMetrics)
    }

    /**
     * Gère le comportement du bouton retour, avec une vérification de double appui
     * pour quitter l'application depuis le `HomeFragment`.
     */
    @Deprecated("Deprecated in Java")
    override fun onBackPressed() {
        if (drawerLayout.isDrawerOpen(GravityCompat.START)) {
            // Si le drawer est ouvert, fermez-le
            drawerLayout.closeDrawer(GravityCompat.START)
        } else {
            if (currentFragment is HomeFragment) {
                // Si on est sur HomeFragment, gérer le double appui pour quitter l'application
                if (doubleBackToExitPressedOnce) {
                    super.onBackPressed() // Quitter l'application
                    return
                }

                this.doubleBackToExitPressedOnce = true
                // Afficher un message à l'utilisateur
                Toast.makeText(this, "Appuyez à nouveau pour quitter", Toast.LENGTH_SHORT)
                    .show()

                // Remettre la variable à false après un délai
                Handler(Looper.getMainLooper()).postDelayed({
                    doubleBackToExitPressedOnce = false
                }, 2000) // Le délai pour un deuxième appui est de 2 secondes
            } else {
                chargerItems()
            }
        }
    }

    override fun onResume() {
        super.onResume()
    }

    override fun onPause() {
        super.onPause()
    }

    override fun onSearch(query: String) {}
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\MyApp.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl

import android.app.Application
import android.preference.PreferenceManager
import com.google.firebase.firestore.FirebaseFirestore
import com.google.firebase.firestore.FirebaseFirestoreSettings
import org.osmdroid.config.Configuration

/**
 * Classe MyApp : Point d’entrée principal de l’application.
 *
 * Description :
 * Cette classe étend `Application` et est utilisée pour effectuer des configurations
 * globales dès le lancement de l’application Android.
 *
 * Deux initialisations majeures sont effectuées :
 *  - **OSMDroid** : Chargement des préférences partagées pour la configuration de la carte
 *  - **Firebase Firestore** : Activation de la persistance hors-ligne des données
 *
 * Elle est référencée dans le fichier `AndroidManifest.xml` via l’attribut `android:name`.
 *
 * Composants principaux :
 *  - `Configuration.getInstance().load(...)` pour OSMDroid
 *  - `FirebaseFirestoreSettings.setPersistenceEnabled(true)` pour Firestore
 *
 * Bibliothèques utilisées :
 *  - OSMDroid : bibliothèque de cartographie open source
 *  - Firebase Firestore : base de données NoSQL temps réel
 *
 * @see android.app.Application
 * @see org.osmdroid.config.Configuration
 * @see com.google.firebase.firestore.FirebaseFirestore
 */
class MyApp : Application() {

    /**
     * Initialise les composants globaux de l’application.
     * Appelé automatiquement au lancement de l’application.
     */
    override fun onCreate() {
        super.onCreate()

        // osmdroid
        Configuration.getInstance().load(this, PreferenceManager.getDefaultSharedPreferences(this))

        // Firestore offline
        val settings = FirebaseFirestoreSettings.Builder()
            .setPersistenceEnabled(true)
            .build()
        FirebaseFirestore.getInstance().firestoreSettings = settings
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\BatimentAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.FragmentUtils
import tg.univlome.epl.R
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.ui.batiment.BatimentActivity

/**
 * Adapter BatimentAdapter : Adaptateur pour l'affichage des bâtiments dans un RecyclerView
 *
 * Description :
 * Cet adaptateur permet d'afficher une liste réduite de bâtiments (jusqu’à 3 éléments) suivie d’un bouton
 * "Voir tout" qui redirige vers un fragment listant l'ensemble des bâtiments disponibles.
 * Il gère le rendu des informations clés d’un bâtiment (nom, situation, distance, image) ainsi que
 * la navigation vers l'activité de détails `BatimentActivity`.
 *
 * Composants principaux :
 * - `BatimentViewHolder` : Gère l’affichage d’un élément de type bâtiment.
 * - `ButtonViewHolder` : Gère l’affichage du bouton "Voir tout".
 * - `updateList()` : Met à jour dynamiquement la liste de bâtiments affichés.
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement et la mise en cache d’images à distance
 * - `AndroidX RecyclerView` pour la gestion optimisée des listes scrollables
 * - `Intent` pour le passage aux détails (`BatimentActivity`)
 * - `FragmentUtils` pour la navigation entre fragments
 *
 * @param batiments Liste initiale de bâtiments à afficher
 * @param fragmentManager Gestionnaire de fragments pour les transitions
 * @param newFragment Fragment à charger lors du clic sur "Voir tout"
 *
 * @see BatimentActivity
 * @see tg.univlome.epl.utils.BatimentUtils
 */
class BatimentAdapter(
    private var batiments: List<Batiment>,
    private val fragmentManager: FragmentManager,
    private val newFragment: Fragment,
) : RecyclerView.Adapter<RecyclerView.ViewHolder>() {

    private var min: Int = 3

    companion object {
        private const val VIEW_TYPE_BATIMENT = 0
        private const val VIEW_TYPE_BUTTON = 1
    }

    /**
     * Définit le type de vue à afficher selon la position (bâtiment ou bouton).
     */
    override fun getItemViewType(position: Int): Int {
        return if (position < minOf(batiments.size, min)) VIEW_TYPE_BATIMENT else VIEW_TYPE_BUTTON
    }

    /**
     * Crée et retourne le bon type de ViewHolder selon le type défini.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder {
        return if (viewType == VIEW_TYPE_BATIMENT) {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_batiment, parent, false)
            BatimentViewHolder(view)
        } else {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_voir_tout, parent, false)
            ButtonViewHolder(view)
        }
    }

    /**
     * Lie les données d’un bâtiment ou configure le bouton "Voir tout".
     */
    override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) {
        if (holder is BatimentViewHolder && position < minOf(batiments.size, min)) {
            val batiment = batiments[position]
            holder.nom.text = batiment.nom
            holder.situation.text = batiment.situation
            holder.distance.text = batiment.distance
            if (!batiment.image.isNullOrEmpty()) {
                Glide.with(holder.itemView.context)
                    .asBitmap()
                    .load(batiment.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable = android.graphics.drawable.BitmapDrawable(
                                holder.itemView.resources,
                                resource
                            )
                            holder.img.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                holder.img.setImageResource(batiment.icon)
            }

            holder.itemView.setOnClickListener {
                val intent = Intent(holder.itemView.context, BatimentActivity::class.java).apply {
                    putExtra("batiment", batiment)
                }
                holder.itemView.context.startActivity(intent)
            }
        } else if (holder is ButtonViewHolder) {
            holder.btnVoirTout.setOnClickListener {
                FragmentUtils.ouvrirFragment(fragmentManager, newFragment)
            }
        }
    }

    /**
     * Retourne le nombre total d’éléments à afficher (3 max + 1 bouton).
     */
    override fun getItemCount(): Int {
        return minOf(batiments.size, min) + 1 // 3 batiments max + 1 bouton "voir tout"
    }

    /**
     * Met à jour dynamiquement la liste de bâtiments affichée.
     * @param newList Nouvelle liste de bâtiments à afficher
     */
    fun updateList(newList: List<Batiment>) {
        batiments = newList
        notifyDataSetChanged()
    }

    /**
     * ViewHolder pour l’affichage d’un bâtiment (image, nom, situation, distance).
     */
    class BatimentViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img = view.findViewById<ImageView>(R.id.imgBatiment)
        val nom = view.findViewById<TextView>(R.id.txtNomBatiment)
        val situation = view.findViewById<TextView>(R.id.situationBat)
        val distance = view.findViewById<TextView>(R.id.txtDistanceBatiment)
    }

    /**
     * ViewHolder pour le bouton "Voir tout" (utilise une icône).
     */
    class ButtonViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val btnVoirTout = view.findViewById<ImageView>(R.id.imgVoirTout)
    }

}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\BatimentFragmentAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.ui.batiment.BatimentActivity

/**
 * Adapter BatimentFragmentAdapter : Adaptateur d'affichage des bâtiments (vue étendue)
 *
 * Description :
 * Cet adaptateur est utilisé pour afficher l’ensemble des bâtiments dans les fragments
 * "Voir tout", sans limitation du nombre d’éléments. Chaque élément représente un bâtiment avec
 * son image, son nom, sa situation et sa distance. Un clic sur un bâtiment ouvre
 * l'activité de détail `BatimentActivity`.
 *
 * Composants principaux :
 * - `ViewHolder` : Gère l’affichage des informations d’un bâtiment.
 * - `updateList()` : Met à jour dynamiquement la liste des bâtiments affichés.
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement d'images à partir d’URL
 * - `AndroidX RecyclerView` pour l’affichage efficace d’une liste scrollable
 * - `Intent` pour la navigation vers l’activité de détail `BatimentActivity`
 *
 * @param batiments Liste des bâtiments à afficher dans le RecyclerView
 *
 * @see BatimentActivity
 * @see tg.univlome.epl.utils.BatimentUtils
 */
class BatimentFragmentAdapter(private var batiments: List<Batiment>) :
    RecyclerView.Adapter<BatimentFragmentAdapter.ViewHolder>() {

    /**
     * ViewHolder représentant un bâtiment avec :
     * - Une image (ou icône par défaut)
     * - Son nom
     * - Sa situation géographique (ex: "Campus Nord")
     * - La distance calculée depuis la position de l'utilisateur
     */
    class ViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img = view.findViewById<ImageView>(R.id.imgBatiment)
        val nom = view.findViewById<TextView>(R.id.txtNomBatiment)
        val situation = view.findViewById<TextView>(R.id.situationBat)
        val distance = view.findViewById<TextView>(R.id.txtDistanceBatiment)
    }

    /**
     * Crée un ViewHolder pour l’affichage d’un bâtiment.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ViewHolder {
        val view =
            LayoutInflater.from(parent.context).inflate(R.layout.item_all_batiment, parent, false)
        return ViewHolder(view)
    }

    /**
     * Lie les données du bâtiment à la vue correspondante.
     */
    override fun onBindViewHolder(holder: ViewHolder, position: Int) {
        val batiment = batiments[position]
        holder.nom.text = batiment.nom
        holder.situation.text = batiment.situation
        holder.distance.text = batiment.distance
        if (!batiment.image.isNullOrEmpty()) {
            Glide.with(holder.itemView.context)
                .asBitmap()
                .load(batiment.image)
                .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                    ) {
                        val drawable = android.graphics.drawable.BitmapDrawable(
                            holder.itemView.resources,
                            resource
                        )
                        holder.img.setImageDrawable(drawable)
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        } else {
            holder.img.setImageResource(batiment.icon)
        }

        holder.itemView.setOnClickListener {
            val intent = Intent(holder.itemView.context, BatimentActivity::class.java).apply {
                putExtra("batiment", batiment)
            }
            holder.itemView.context.startActivity(intent)
        }
    }

    /**
     * Retourne le nombre total de bâtiments à afficher.
     */
    override fun getItemCount(): Int = batiments.size

    /**
     * Met à jour la liste affichée avec de nouvelles données.
     *
     * @param newList Nouvelle liste de bâtiments
     */
    fun updateList(newList: List<Batiment>) {
        batiments = newList
        notifyDataSetChanged()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\ImageAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.view.ViewGroup
import android.widget.ImageView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R

/**
 * Adapter ImageAdapter : Affichage en carrousel d'une galerie d'images
 *
 * Description :
 * Cet adaptateur est utilisé dans un `ViewPager2` pour afficher une galerie d'images (URL) sous forme
 * de carrousel dans les activités de visualisation (`BatimentActivity`, `SalleActivity`, etc.).
 * Chaque image est affichée en plein écran avec ajustement automatique.
 *
 * Composants :
 * - `ImageViewHolder` : ViewHolder contenant une seule `ImageView` plein écran.
 * - `Glide` : Chargement des images depuis une URL avec gestion de placeholder et fallback.
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement et la mise en cache des images
 * - `RecyclerView + ViewPager2` pour le carrousel d’images
 *
 * @param images Liste d'URL des images à afficher
 *
 * @see tg.univlome.epl.ui.batiment.BatimentActivity
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 * @see tg.univlome.epl.ui.home.SalleActivity
 */
class ImageAdapter(private val images: List<String>) :
    RecyclerView.Adapter<ImageAdapter.ImageViewHolder>() {

    /**
     * ViewHolder contenant une ImageView plein écran.
     */
    class ImageViewHolder(val imageView: ImageView) : RecyclerView.ViewHolder(imageView)

    /**
     * Crée dynamiquement un ImageView en plein écran pour le carrousel.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ImageViewHolder {
        val imageView = ImageView(parent.context).apply {
            layoutParams = ViewGroup.LayoutParams(
                ViewGroup.LayoutParams.MATCH_PARENT,
                ViewGroup.LayoutParams.MATCH_PARENT
            )
            scaleType = ImageView.ScaleType.FIT_XY
        }
        return ImageViewHolder(imageView)
    }

    /**
     * Lie une URL d’image au `ImageView` avec chargement asynchrone.
     *
     * @param holder ViewHolder de l'image
     * @param position Position dans la liste d’images
     */
    override fun onBindViewHolder(holder: ImageViewHolder, position: Int) {
        val imageUrl = images[position]
        Glide.with(holder.imageView.context)
            .load(imageUrl)
            .placeholder(R.drawable.img) // image de chargement par défaut
            .error(R.drawable.img)       // image si erreur de chargement
            .into(holder.imageView)
    }

    /**
     * Retourne le nombre total d'images à afficher.
     */
    override fun getItemCount(): Int = images.size
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\InfraAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.FragmentUtils
import tg.univlome.epl.R
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.ui.infrastructure.InfraActivity

/**
 * Adapter InfraAdapter : Affichage résumé des infrastructures avec option "Voir tout"
 *
 * Description :
 * Cet adaptateur affiche une liste horizontale des infrastructures (bâtiments secondaires)
 * avec un maximum de 3 éléments, suivi d’un bouton "Voir tout". Il est utilisé dans
 * la page d’accueil (`HomeFragment`) pour un affichage synthétique, avec ouverture
 * d’une activité détaillée (`InfraActivity`) ou d’un fragment complet à la demande.
 *
 * Composants :
 * - `InfraViewHolder` : Affiche une infrastructure (image, nom, situation, distance)
 * - `ButtonViewHolder` : Affiche un bouton "Voir tout" pour ouvrir un fragment complet
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement optimisé des images distantes
 * - `FragmentManager` pour la navigation entre fragments
 *
 * @param infras Liste des infrastructures à afficher
 * @param fragmentManager FragmentManager utilisé pour ouvrir le fragment complet
 * @param newFragment Fragment à ouvrir via le bouton "Voir tout"
 *
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 * @see tg.univlome.epl.ui.home.HomeFragment
 */
class InfraAdapter(
    private var infras: List<Infrastructure>,
    private val fragmentManager: FragmentManager,
    private val newFragment: Fragment,
) : RecyclerView.Adapter<RecyclerView.ViewHolder>() {

    private var min: Int = 3

    companion object {
        private const val VIEW_TYPE_INFRA = 0
        private const val VIEW_TYPE_BUTTON = 1
    }

    /**
     * Détermine le type de vue : élément d’infrastructure ou bouton "Voir tout"
     */
    override fun getItemViewType(position: Int): Int {
        return if (position < minOf(infras.size, min)) VIEW_TYPE_INFRA else VIEW_TYPE_BUTTON
    }

    /**
     * Crée le ViewHolder adapté au type de vue : item ou bouton
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder {
        return if (viewType == VIEW_TYPE_INFRA) {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_infra, parent, false)
            InfraViewHolder(view)
        } else {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_voir_tout, parent, false)
            ButtonViewHolder(view)
        }
    }

    /**
     * Lie les données d'une infrastructure à la vue, ou configure le bouton "Voir tout"
     */
    override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) {
        if (holder is InfraViewHolder && position < minOf(infras.size, min)) {
            val infra = infras[position]
            holder.nom.text = infra.nom
            holder.situation.text = infra.situation
            holder.distance.text = infra.distance
            if (!infra.image.isNullOrEmpty()) {
                Glide.with(holder.itemView.context)
                    .asBitmap()
                    .load(infra.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable = android.graphics.drawable.BitmapDrawable(
                                holder.itemView.resources,
                                resource
                            )
                            holder.img.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                holder.img.setImageResource(infra.icon)
            }

            holder.itemView.setOnClickListener {
                val intent = Intent(holder.itemView.context, InfraActivity::class.java).apply {
                    putExtra("infrastructure", infra)
                }
                holder.itemView.context.startActivity(intent)
            }
        } else if (holder is ButtonViewHolder) {
            holder.btnVoirTout.setOnClickListener {
                FragmentUtils.ouvrirFragment(fragmentManager, newFragment)
            }
        }
    }

    /**
     * Retourne le nombre total d’éléments à afficher (max 3 infrastructures + bouton)
     */
    override fun getItemCount(): Int {
        return minOf(infras.size, min) + 1 // +1 pour le bouton "Voir Tout"
    }

    /**
     * Met à jour la liste des infrastructures et notifie l’adaptateur.
     *
     * @param newList Nouvelle liste à afficher
     */
    fun updateList(newList: List<Infrastructure>) {
        infras = newList
        notifyDataSetChanged()
    }

    /**
     * ViewHolder pour une infrastructure avec image, nom, situation, distance.
     */
    class InfraViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img = view.findViewById<ImageView>(R.id.imgInfra)
        val nom = view.findViewById<TextView>(R.id.txtNomInfra)
        val situation = view.findViewById<TextView>(R.id.situationInfra)
        val distance = view.findViewById<TextView>(R.id.txtDistanceInfra)
    }

    /**
     * ViewHolder pour le bouton "Voir tout".
     */
    class ButtonViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val btnVoirTout = view.findViewById<ImageView>(R.id.imgVoirTout)
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\InfraFragmentAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.ui.infrastructure.InfraActivity

/**
 * Adapter InfraFragmentAdapter : Affichage complet des infrastructures
 *
 * Description :
 * Cet adaptateur est utilisé dans les fragments comme `AllInfraFragment`, `NordInfraFragment`,
 * `SudInfraFragment`, ou `ViewAllInfraFragment` pour afficher toutes les infrastructures
 * disponibles dans un `RecyclerView`, avec une carte miniature, nom, distance et situation.
 *
 * Contrairement à `InfraAdapter`, il ne limite pas le nombre d’éléments ni n’inclut
 * de bouton "Voir tout". Chaque item est cliquable pour ouvrir `InfraActivity`.
 *
 * Composants :
 * - `InfraViewHolder` : Vue de chaque infrastructure avec image, nom, situation, distance
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement efficace des images distantes
 *
 * @param infras Liste complète des infrastructures à afficher
 *
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 * @see tg.univlome.epl.ui.infrastructure.AllInfraFragment
 * @see tg.univlome.epl.ui.infrastructure.ViewAllInfraFragment
 */
class InfraFragmentAdapter(private var infras: List<Infrastructure>) :
    RecyclerView.Adapter<InfraFragmentAdapter.InfraViewHolder>() {

    /**
     * ViewHolder représentant une infrastructure dans la liste.
     * Contient une image, le nom, la situation et la distance.
     */
    class InfraViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img: ImageView = view.findViewById(R.id.imgInfra)
        val nom: TextView = view.findViewById(R.id.txtNomInfra)
        val situation = view.findViewById<TextView>(R.id.situationInfra)
        val distance: TextView = view.findViewById(R.id.txtDistanceInfra)
    }

    /**
     * Crée un ViewHolder pour une infrastructure.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): InfraViewHolder {
        val view =
            LayoutInflater.from(parent.context).inflate(R.layout.item_all_infra, parent, false)
        return InfraViewHolder(view)
    }

    /**
     * Lie les données d'une infrastructure à la vue correspondante.
     */
    override fun onBindViewHolder(holder: InfraViewHolder, position: Int) {
        val infra = infras[position]
        holder.nom.text = infra.nom
        holder.situation.text = infra.situation
        holder.distance.text = infra.distance
        if (!infra.image.isNullOrEmpty()) {
            Glide.with(holder.itemView.context)
                .asBitmap()
                .load(infra.image)
                .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                    ) {
                        val drawable = android.graphics.drawable.BitmapDrawable(
                            holder.itemView.resources,
                            resource
                        )
                        holder.img.setImageDrawable(drawable)
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        } else {
            holder.img.setImageResource(infra.icon)
        }

        holder.itemView.setOnClickListener {
            val intent = Intent(holder.itemView.context, InfraActivity::class.java).apply {
                putExtra("infrastructure", infra)
            }
            holder.itemView.context.startActivity(intent)
        }
    }

    /**
     * Retourne le nombre total d'infrastructures affichées.
     */
    override fun getItemCount(): Int = infras.size

    /**
     * Met à jour la liste des infrastructures et notifie l'adaptateur.
     *
     * @param newList Nouvelle liste à afficher dans le RecyclerView
     */
    fun updateList(newList: List<Infrastructure>) {
        infras = newList
        notifyDataSetChanged()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\SalleAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.FragmentUtils
import tg.univlome.epl.R
import tg.univlome.epl.models.Salle
import tg.univlome.epl.ui.home.SalleActivity

/**
 * Adapter SalleAdapter : Aperçu limité des salles avec navigation
 *
 * Description :
 * Cet adaptateur est utilisé dans des contextes comme `HomeFragment` pour présenter
 * un aperçu succinct des salles disponibles sur le campus, avec un bouton "Voir Tout".
 * Il affiche un nombre limité d’éléments (3 par défaut), et redirige vers `SalleActivity`
 * au clic sur un élément ou vers un `Fragment` complet au clic sur le bouton.
 *
 * Composants :
 * - `SalleViewHolder` : Affichage des informations principales d'une salle
 * - `ButtonViewHolder` : Affichage du bouton de navigation "Voir Tout"
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement asynchrone des images
 *
 * @param salles Liste des salles à afficher
 * @param fragmentManager Pour ouvrir le `newFragment` lorsque l'utilisateur veut voir tout
 * @param newFragment Fragment contenant la vue complète des salles
 *
 * @see tg.univlome.epl.ui.home.SalleActivity
 * @see tg.univlome.epl.ui.home.ViewAllSalleFragment
 * @see tg.univlome.epl.models.Salle
 */
class SalleAdapter(
    private var salles: List<Salle>,
    private val fragmentManager: FragmentManager,
    private val newFragment: Fragment,
) : RecyclerView.Adapter<RecyclerView.ViewHolder>() {

    private var min: Int = 3

    companion object {
        private const val VIEW_TYPE_SALLE = 0
        private const val VIEW_TYPE_BUTTON = 1
    }

    /**
     * Détermine le type de vue : salle ou bouton "Voir Tout".
     */
    override fun getItemViewType(position: Int): Int {
        return if (position < minOf(salles.size, min)) VIEW_TYPE_SALLE else VIEW_TYPE_BUTTON
    }

    /**
     * Crée les différents types de ViewHolder.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder {
        return if (viewType == VIEW_TYPE_SALLE) {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_salle, parent, false)
            SalleViewHolder(view)
        } else {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_voir_tout, parent, false)
            ButtonViewHolder(view)
        }
    }

    /**
     * Lie une salle ou un bouton à un ViewHolder.
     */
    override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) {
        if (holder is SalleViewHolder && position < minOf(salles.size, min)) {
            val salle = salles[position]
            holder.nom.text = salle.nom
            holder.situation.text = salle.situation
            holder.distance.text = salle.distance
            if (!salle.image.isNullOrEmpty()) {
                Glide.with(holder.itemView.context)
                    .asBitmap()
                    .load(salle.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable = android.graphics.drawable.BitmapDrawable(
                                holder.itemView.resources,
                                resource
                            )
                            holder.img.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                holder.img.setImageResource(salle.icon)
            }

            holder.itemView.setOnClickListener {
                val intent = Intent(holder.itemView.context, SalleActivity::class.java).apply {
                    putExtra("salle", salle)
                }
                holder.itemView.context.startActivity(intent)
            }
        } else if (holder is ButtonViewHolder) {
            holder.btnVoirTout.setOnClickListener {
                FragmentUtils.ouvrirFragment(fragmentManager, newFragment)
            }
        }
    }

    /**
     * Retourne le nombre d’éléments à afficher (limité + bouton).
     */
    override fun getItemCount(): Int {
        return minOf(salles.size, min) + 1 // +1 pour le bouton "Voir Tout"
    }

    /**
     * ViewHolder représentant une salle avec image, nom, bâtiment, et distance.
     */
    class SalleViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img: ImageView = view.findViewById(R.id.imgSalle)
        val nom: TextView = view.findViewById(R.id.txtNomSalle)
        val situation = view.findViewById<TextView>(R.id.batimentSalle)
        val distance: TextView = view.findViewById(R.id.txtDistanceSalle)
    }

    /**
     * ViewHolder contenant un bouton permettant d’ouvrir un fragment pour voir toutes les salles.
     */
    class ButtonViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val btnVoirTout = view.findViewById<ImageView>(R.id.imgVoirTout)
    }

    /**
     * Met à jour la liste des salles affichées et notifie l’adaptateur.
     *
     * @param newList Nouvelle liste des salles à afficher
     */
    fun updateList(newList: List<Salle>) {
        salles = newList
        notifyDataSetChanged()
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\SalleViewAllAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R
import tg.univlome.epl.models.Salle
import tg.univlome.epl.ui.home.SalleActivity

/**
 * Adapter SalleViewAllAdapter : Affichage détaillé de toutes les salles
 *
 * Description :
 * Cet adaptateur est utilisé dans les fragments de type `ViewAllSalleFragment` pour afficher
 * `la liste complète` des salles disponibles sur le campus avec leurs visuels, bâtiments, et distances.
 * Contrairement à `SalleAdapter`, il n’intègre pas de bouton "Voir Tout" et affiche l’ensemble des salles.
 *
 * Composants :
 * - `SalleViewHolder` : Représente une cellule individuelle de salle dans la RecyclerView.
 *
 * Bibliothèques utilisées :
 * - **Glide** : Pour le chargement asynchrone des images des salles (avec gestion d’erreur)
 *
 * @param salles Liste complète des salles à afficher
 *
 * @see tg.univlome.epl.models.Salle
 * @see tg.univlome.epl.ui.home.SalleActivity
 */
class SalleViewAllAdapter(private var salles: List<Salle>) :
    RecyclerView.Adapter<SalleViewAllAdapter.SalleViewHolder>() {

    /**
     * ViewHolder pour une salle dans la liste.
     * Contient l’image de la salle, son nom, son bâtiment d’appartenance et sa distance.
     */
    class SalleViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img: ImageView = view.findViewById(R.id.imgSalle)
        val nom: TextView = view.findViewById(R.id.txtNomSalle)
        val situation = view.findViewById<TextView>(R.id.batimentSalle)
        val distance: TextView = view.findViewById(R.id.txtDistanceSalle)
    }

    /**
     * Crée et retourne un nouveau ViewHolder pour chaque élément de la liste.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): SalleViewHolder {
        val view =
            LayoutInflater.from(parent.context).inflate(R.layout.item_all_salle, parent, false)
        return SalleViewHolder(view)
    }

    /**
     * Lie les données d'une salle à la vue de son ViewHolder.
     */
    override fun onBindViewHolder(holder: SalleViewHolder, position: Int) {
        val salle = salles[position]
        holder.nom.text = salle.nom
        holder.situation.text = salle.situation
        holder.distance.text = salle.distance
        if (!salle.image.isNullOrEmpty()) {
            Glide.with(holder.itemView.context)
                .asBitmap()
                .load(salle.image)
                .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                    ) {
                        val drawable = android.graphics.drawable.BitmapDrawable(
                            holder.itemView.resources,
                            resource
                        )
                        holder.img.setImageDrawable(drawable)
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        } else {
            holder.img.setImageResource(salle.icon)
        }

        holder.itemView.setOnClickListener {
            val intent = Intent(holder.itemView.context, SalleActivity::class.java).apply {
                putExtra("salle", salle)
            }
            holder.itemView.context.startActivity(intent)
        }
    }

    /**
     * Retourne le nombre total d'éléments à afficher dans la liste.
     */
    override fun getItemCount(): Int = salles.size

    /**
     * Met à jour dynamiquement la liste des salles affichées.
     *
     * @param newList Nouvelle liste à utiliser
     */
    fun updateList(newList: List<Salle>) {
        salles = newList
        notifyDataSetChanged()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Admin.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Modèle de données Admin : Représentation d’un administrateur de l’application
 *
 * Description :
 * Ce modèle représente les informations d’identification d’un administrateur utilisé
 * pour l’authentification ou la gestion sécurisée dans l’application.
 *
 * Champs :
 * @property nom le nom d’utilisateur ou identifiant unique de l’administrateur
 * @property motDePasse le mot de passe associé à cet administrateur
 *
 * Utilisation :
 * - Employé dans les opérations d’authentification (via Firebase ou locale)
 * - Récupéré via le service [tg.univlome.epl.services.AdminService]
 *
 * Interfaces :
 * - [Serializable] : permet de transférer l’objet entre activités ou fragments via `Intent`
 *
 * @see tg.univlome.epl.services.AdminService
 */
data class Admin(
    var nom: String,
    var motDePasse: String
) : Serializable
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Batiment.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Modèle de données Batiment : Représentation d’un bâtiment géolocalisable sur le campus
 *
 * Description :
 * Ce modèle hérite de la classe [Lieu] et représente un bâtiment spécifique au sein de l’université.
 * Il contient des informations détaillées sur son emplacement, ses images et sa typologie.
 *
 * Hérite de :
 * - [Lieu] : modèle de base contenant les propriétés communes (id, nom, description, coordonnées, etc.)
 *
 * Champs supplémentaires :
 * @property extraProp Propriété étendue (réservée à de futurs besoins ou marquages spécifiques)
 *
 * Constructeur secondaire :
 * Permet de créer un bâtiment avec toutes ses propriétés en une seule instanciation.
 *
 * Utilisation :
 * - Représentation dans les interfaces utilisateurs : [tg.univlome.epl.adapter.BatimentAdapter], [tg.univlome.epl.adapter.BatimentFragmentAdapter]
 * - Chargement depuis Firebase via [tg.univlome.epl.services.BatimentService]
 * - Affichage détaillé dans [tg.univlome.epl.ui.batiment.BatimentActivity]
 *
 * @see tg.univlome.epl.models.Lieu
 * @see tg.univlome.epl.services.BatimentService
 * @see tg.univlome.epl.adapter.BatimentAdapter
 * @see tg.univlome.epl.ui.batiment.BatimentActivity
 */
data class Batiment(
    val extraProp: String = "" // uniquement les ajouts spécifiques
) : Lieu(), Serializable {

    /**
     * Constructeur secondaire pour initialiser un bâtiment avec toutes ses propriétés.
     *
     * @param id Identifiant unique du bâtiment
     * @param nom Nom du bâtiment
     * @param description Description détaillée
     * @param longitude Coordonnée GPS - longitude
     * @param latitude Coordonnée GPS - latitude
     * @param image URL de l’image principale
     * @param situation Zone ou localisation dans le campus (ex : Nord, Sud)
     * @param type Type du bâtiment (ex : enseignement, administratif)
     * @param images Liste des images secondaires
     * @param distance Distance calculée depuis la position de l’utilisateur
     */
    constructor(
        id: String,
        nom: String,
        description: String,
        longitude: String,
        latitude: String,
        image: String,
        situation: String,
        type: String,
        images: List<String> = emptyList(),
        distance: String = ""
    ) : this("") {
        this.id = id
        this.nom = nom
        this.description = description
        this.longitude = longitude
        this.latitude = latitude
        this.image = image
        this.situation = situation
        this.type = type
        this.images = images
        this.distance = distance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Infrastructure.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Modèle de données Infrastructure : Représentation d’une infrastructure présente sur le campus
 *
 * Description :
 * Cette classe hérite de [Lieu] et décrit une infrastructure physique telle qu’un parking, une cafétéria,
 * un laboratoire ou tout autre équipement important. Elle contient les informations nécessaires à son affichage,
 * sa localisation, et son identification.
 *
 * Hérite de :
 * - [Lieu] : modèle commun regroupant les propriétés génériques comme l’identifiant, le nom, les coordonnées, etc.
 *
 * Champs supplémentaires :
 * @property extraProp Propriété personnalisée permettant d’ajouter des métadonnées spécifiques à une infrastructure
 *
 * Constructeur secondaire :
 * Permet l’instanciation complète de l’objet avec tous les attributs pertinents pour l’affichage ou la géolocalisation.
 *
 * Utilisation :
 * - Gestion et affichage via [tg.univlome.epl.adapter.InfraAdapter], [tg.univlome.epl.adapter.InfraFragmentAdapter]
 * - Chargement depuis Firestore via [tg.univlome.epl.services.InfrastructureService]
 * - Consultation détaillée dans [tg.univlome.epl.ui.infrastructure.InfraActivity]
 *
 * @see tg.univlome.epl.models.Lieu
 * @see tg.univlome.epl.services.InfrastructureService
 * @see tg.univlome.epl.adapter.InfraAdapter
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 */
data class Infrastructure(
    val extraProp: String = "" // uniquement les ajouts spécifiques
) : Lieu(), Serializable {

    /**
     * Constructeur secondaire permettant d’initialiser une infrastructure avec toutes ses propriétés.
     *
     * @param id Identifiant unique de l’infrastructure
     * @param nom Nom de l’infrastructure
     * @param description Description de l’infrastructure
     * @param longitude Coordonnée GPS - longitude
     * @param latitude Coordonnée GPS - latitude
     * @param image Image principale de l’infrastructure
     * @param situation Position ou zone (Nord, Sud...) sur le campus
     * @param type Type ou catégorie de l’infrastructure
     * @param images Liste des images supplémentaires
     * @param distance Distance depuis l'utilisateur (calculée dynamiquement)
     */
    constructor(
        id: String,
        nom: String,
        description: String,
        longitude: String,
        latitude: String,
        image: String,
        situation: String,
        type: String,
        images: List<String> = emptyList(),
        distance: String = ""
    ) : this("") {
        this.id = id
        this.nom = nom
        this.description = description
        this.longitude = longitude
        this.latitude = latitude
        this.image = image
        this.situation = situation
        this.type = type
        this.images = images
        this.distance = distance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Lieu.kt 
=============================================== 
package tg.univlome.epl.models

import tg.univlome.epl.R
import java.io.Serializable

/**
 * Classe abstraite Lieu : Représentation générique d’un emplacement géographique sur le campus
 *
 * Description :
 * Cette classe représente la base commune à tous les éléments géolocalisables de l’application
 * tels que les bâtiments, les infrastructures ou les salles. Elle regroupe les propriétés nécessaires
 * à l'affichage, à la localisation GPS et à la catégorisation.
 *
 * Propriétés principales :
 * @property id Identifiant unique du lieu (généré par Firebase)
 * @property nom Nom du lieu (ex : "Bibliothèque", "Amphi A")
 * @property description Description textuelle du lieu
 * @property longitude Coordonnée GPS - longitude (sous forme de chaîne)
 * @property latitude Coordonnée GPS - latitude (sous forme de chaîne)
 * @property image URL de l’image principale du lieu
 * @property situation Emplacement ou zone (Nord, Sud) sur le campus
 * @property type Catégorie du lieu (enseignement, administratif, détente, etc.)
 * @property images Liste d’URLs vers des images secondaires ou supplémentaires
 * @property distance Distance entre l’utilisateur et ce lieu (calculée dynamiquement)
 * @property icon Ressource par défaut à afficher si aucune image n’est disponible (valeur par défaut : [R.drawable.img])
 *
 * Utilisation :
 * - Superclasse héritée par : [Batiment], [Infrastructure], [Salle]
 * - Affichage et traitement via des adaptateurs spécialisés
 * - Exploitation dans les vues de détail (ex : [tg.univlome.epl.ui.batiment.BatimentActivity])
 *
 * @see Batiment
 * @see Infrastructure
 * @see Salle
 */
open class Lieu(
    open var id: String = "",
    open var nom: String = "",
    open var description: String = "",
    open var longitude: String = "",
    open var latitude: String = "",
    open var image: String = "",
    open var situation: String = "",
    open var type: String = "",
    open var images: List<String> = emptyList(),
    open var distance: String = "",
    open val icon: Int = R.drawable.img
) : Serializable 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\NavItem.kt 
=============================================== 
package tg.univlome.epl.models

import android.widget.ImageView
import android.widget.LinearLayout
import android.widget.TextView
import androidx.fragment.app.Fragment

/**
 * Classe NavItem : Élément de navigation personnalisé dans l'interface utilisateur.
 *
 * Description :
 * Cette classe encapsule les composants visuels et logiques d’un item de navigation
 * dans l’application, permettant d’associer une vue de navigation (texte + icône + layouts)
 * à un fragment correspondant.
 *
 * Utilisation :
 * - Employé dans les fragments comme `BatimentFragment` ou `InfraFragment`
 *   pour basculer dynamiquement entre différents sous-fragments.
 * - Fournit une structure pratique pour gérer l’état de sélection et les interactions UI.
 *
 * Composants :
 * @property layout Le layout principal de l’item (incluant l’icône et le texte)
 * @property minLayout Layout réduit ou secondaire, souvent utilisé pour l’effet de sélection
 * @property textView Texte affiché pour cet item (ex: "Tous", "Nord", "Sud")
 * @property icon Icône associée à cet item
 * @property fragment Fragment associé à cet item, à afficher lors de la sélection
 *
 * Exemple :
 * ```kotlin
 * val navItem = NavItem(
 *     layout = view.findViewById(R.id.nav_all),
 *     minLayout = view.findViewById(R.id.indicator_all),
 *     textView = view.findViewById(R.id.txt_all),
 *     icon = view.findViewById(R.id.icon_all),
 *     fragment = AllBatimentFragment()
 * )
 * ```
 *
 * @see androidx.fragment.app.Fragment
 * @see tg.univlome.epl.ui.batiment.BatimentFragment
 * @see tg.univlome.epl.ui.infrastructure.InfraFragment
 */
data class NavItem(
    val layout: LinearLayout,
    val minLayout: LinearLayout,
    val textView: TextView,
    val icon: ImageView,
    val fragment: Fragment
)
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Salle.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Classe Salle : Représentation d'une salle physique sur le campus universitaire.
 *
 * Description :
 * Cette classe hérite de [Lieu] et représente une salle d’enseignement, de réunion ou de laboratoire.
 * Elle contient des informations spécifiques telles que sa capacité d’accueil et l’identifiant du bâtiment
 * auquel elle appartient.
 *
 * Composants spécifiques :
 * @property infrastructureId Identifiant du bâtiment auquel cette salle est rattachée (clé étrangère)
 * @property capacite Capacité d’accueil de la salle (ex : "40", "100", "15")
 *
 * Hérite de :
 * - [Lieu] : fournit les coordonnées, nom, description, image principale, type et autres attributs communs
 *
 * Constructeur secondaire :
 * Permet d’instancier une salle avec toutes ses propriétés héritées et spécifiques
 *
 * Utilisation :
 * - Affichée dans les listes ou détails via les adaptateurs comme [tg.univlome.epl.adapter.SalleAdapter]
 * - Consultée dans [tg.univlome.epl.ui.home.SalleActivity] pour les détails
 * - Chargée dynamiquement via [tg.univlome.epl.services.SalleService]
 *
 * @see Lieu
 * @see Batiment
 * @see Infrastructure
 * @see tg.univlome.epl.services.SalleService
 * @see tg.univlome.epl.ui.home.SalleActivity
 */
data class Salle(
    var infrastructureId: String = "",
    var capacite: String = ""
) : Lieu(), Serializable {

    /**
     * Constructeur secondaire pour instancier une salle avec toutes ses propriétés.
     *
     * @param id Identifiant unique de la salle
     * @param infrastructureId ID du bâtiment parent
     * @param nom Nom de la salle
     * @param description Description textuelle
     * @param capacite Capacité d'accueil
     * @param longitude Coordonnée longitude
     * @param latitude Coordonnée latitude
     * @param image URL de l’image principale
     * @param situation Zone ou localisation (Nord/Sud)
     * @param type Type ou fonction de la salle
     * @param images Liste d’images supplémentaires
     * @param distance Distance par rapport à l'utilisateur
     */
    constructor(
        id: String,
        infrastructureId: String,
        nom: String,
        description: String,
        capacite: String,
        longitude: String,
        latitude: String,
        image: String,
        situation: String,
        type: String,
        images: List<String> = emptyList(),
        distance: String = ""
    ) : this(infrastructureId, capacite) {
        this.id = id
        this.nom = nom
        this.description = description
        this.longitude = longitude
        this.latitude = latitude
        this.image = image
        this.situation = situation
        this.type = type
        this.images = images
        this.distance = distance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\modelsfragments\FragmentModel.kt 
=============================================== 
package tg.univlome.epl.models.modelsfragments

import android.content.Context
import android.view.View
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.LifecycleOwner
import java.io.Serializable

data class FragmentModel(
    var view: View,
    var fragmentContext: Context,
    var fragmentActivity: FragmentActivity,
    var viewLifecycleOwner: LifecycleOwner,
    var recyclerViewId: Int,
    var situation: String = "",
    var type: String = ""
) : Serializable 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\modelsfragments\HomeFragmentModel.kt 
=============================================== 
package tg.univlome.epl.models.modelsfragments

import android.content.Context
import android.view.View
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentActivity
import androidx.fragment.app.FragmentManager
import androidx.lifecycle.LifecycleOwner
import java.io.Serializable

data class HomeFragmentModel(
    var view: View,
    var fragmentContext: Context,
    var fragmentActivity: FragmentActivity,
    var viewLifecycleOwner: LifecycleOwner,
    var recyclerViewId: Int,
    var fragmentManager: FragmentManager,
    var newFragment: Fragment,
    var type: String = ""
) : Serializable 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\AdminService.kt 
=============================================== 
package tg.univlome.epl.services

import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Admin

/**
 * Service AdminService : Récupération des données d’administration
 *
 * Description :
 * Service dédié à la **récupération des informations d’authentification des administrateurs** à partir de Firestore.
 * Il permet de centraliser la gestion des comptes admin dans l'application.
 * Cette classe a donc pour but de :
 * - Accéder à la collection `admins` de Firebase Firestore.
 * - Fournir les données des administrateurs à l’application sous forme de `LiveData`.
 *
 * Composants :
 * - Firebase Firestore
 * - AndroidX LiveData
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @constructor Initialise la connexion à Firestore pour accéder à la collection `admins`
 *
 * @see tg.univlome.epl.models.Admin
 */
class AdminService {
    private val db = FirebaseFirestore.getInstance()
    private val adminsCollection = db.collection("admins")

    /**
     * Récupère la liste des administrateurs depuis Firestore.
     *
     * @return LiveData contenant une liste de [Admin]
     */
    fun getAdmins(): LiveData<List<Admin>> {
        val adminsLiveData = MutableLiveData<List<Admin>>()

        adminsCollection.get()
            .addOnSuccessListener { result ->
                val adminsList = mutableListOf<Admin>()
                for (document in result) {
                    adminsList.add(createAdminFromDocument(document))
                }
                adminsLiveData.value = adminsList
            }
            .addOnFailureListener { exception ->
                Log.e("AdminService", "Erreur lors de la récupération des admins", exception)
            }

        return adminsLiveData
    }

    /**
     * Construit un objet [Admin] à partir d’un document Firestore.
     *
     * @param document Le document Firestore contenant les informations de l’administrateur
     * @return Une instance de [Admin] avec les champs `username` et `password`
     */
    private fun createAdminFromDocument(document: DocumentSnapshot): Admin {
        val username = document.getString("username") ?: ""
        val password = document.getString("password") ?: ""
        return Admin(username, password)
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\BatimentService.kt 
=============================================== 
package tg.univlome.epl.services

import android.content.Context
import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.utils.BatimentUtils

/**
 * Service BatimentService : Récupération des données de bâtiments
 *
 * Description :
 * Classe responsable de la **gestion et récupération des bâtiments** depuis la base de données
 * Firestore. Elle propose une approche hybride : d’abord via un cache local (SharedPreferences), puis
 * via le cloud pour assurer des données à jour.
 * Cette classe a pour but de :
 * - Fournir une liste observable de bâtiments via `LiveData`.
 * - Réduire les temps de chargement grâce à la persistance locale.
 * - Assurer la synchronisation automatique des données avec Firebase Firestore.
 *
 * Composants :
 * - Firebase Firestore (Cloud)
 * - SharedPreferences (Stockage local via `BatimentUtils`)
 * - AndroidX LiveData
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @param context Contexte Android utilisé pour l'accès au cache local
 *
 * @see tg.univlome.epl.models.Batiment
 * @see tg.univlome.epl.utils.BatimentUtils
 */
class BatimentService(private val context: Context) {
    private val db = FirebaseFirestore.getInstance()
    private val batimentsCollection = db.collection("batiments")

    /**
     * Récupère la liste des bâtiments de manière asynchrone depuis Firestore ou localement.
     *
     * @return LiveData contenant une liste de [Batiment]
     */
    fun getBatiments(): LiveData<List<Batiment>> {
        val batimentsLiveData = MutableLiveData<List<Batiment>>()

        val loadBatiments = BatimentUtils.loadBatiments(context)
        if (loadBatiments != null) {
            batimentsLiveData.value = loadBatiments!!
            batimentsCollection.get()
                .addOnSuccessListener { result ->
                    val batimentsList = mutableListOf<Batiment>()
                    for (document in result) {
                        batimentsList.add(createBatimentFromDocument(document))
                    }
                    BatimentUtils.saveBatiments(context, batimentsList)
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "BatimentService",
                        "Erreur lors de la récupération des bâtiments",
                        exception
                    )
                }
        } else {
            batimentsCollection.get()
                .addOnSuccessListener { result ->
                    val batimentsList = mutableListOf<Batiment>()
                    for (document in result) {
                        batimentsList.add(createBatimentFromDocument(document))
                    }
                    BatimentUtils.saveBatiments(context, batimentsList)

                    batimentsLiveData.value = batimentsList
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "BatimentService",
                        "Erreur lors de la récupération des bâtiments",
                        exception
                    )
                }
        }

        return batimentsLiveData
    }

    /**
     * Transforme un document Firestore en instance de [Batiment].
     *
     * @param document Le document Firestore contenant les données du bâtiment
     * @return Une instance de [Batiment] construite à partir des données du document
     */
    private fun createBatimentFromDocument(document: DocumentSnapshot): Batiment {
        val id = document.id
        val nom = document.getString("nom") ?: ""
        val description = document.getString("description") ?: ""
        val longitude = document.getString("longitude") ?: ""
        val latitude = document.getString("latitude") ?: ""
        val images = document.get("images") as? List<String> ?: emptyList()
        val image = images.firstOrNull() ?: ""
        val situation = document.getString("situation") ?: ""
        val type = document.getString("type") ?: ""

        return Batiment(id, nom, description, longitude, latitude, image, situation, type, images)
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\InfrastructureService.kt 
=============================================== 
package tg.univlome.epl.services

import android.content.Context
import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.utils.InfraUtils

/**
 * Service InfrastructureService : Récupération des données d'infrastructures
 *
 * Description :
 * Cette classe fournit un service permettant de **charger les données d'infrastructures** depuis
 * Firebase Firestore et de les mettre en cache localement via `SharedPreferences`.
 * Cette a pour but de :
 * - Fournir une liste observable d'objets [Infrastructure] via `LiveData`.
 * - Optimiser le temps de chargement avec un système de cache (via `InfraUtils`).
 * - Assurer la synchronisation des données entre Firestore et le cache.
 *
 * Composants :
 * - Firebase Firestore
 * - SharedPreferences (via `InfraUtils`)
 * - AndroidX LiveData
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @param context Contexte Android utilisé pour accéder au système de stockage local
 *
 * @see tg.univlome.epl.models.Infrastructure
 * @see tg.univlome.epl.utils.InfraUtils
 */
class InfrastructureService(private val context: Context) {
    private val db = FirebaseFirestore.getInstance()
    private val infrastructuresCollection = db.collection("infrastructures")

    /**
     * Récupère la liste des infrastructures depuis Firestore.
     * Utilise le cache local s’il est disponible, et met à jour en arrière-plan.
     *
     * @return LiveData contenant la liste des infrastructures
     */
    fun getInfrastructures(): LiveData<List<Infrastructure>> {
        val infrastructuresLiveData = MutableLiveData<List<Infrastructure>>()

        val loadInfrastructures = InfraUtils.loadInfras(context)
        if (loadInfrastructures != null) {
            infrastructuresLiveData.value = loadInfrastructures!!
            infrastructuresCollection.get()
                .addOnSuccessListener { result ->
                    val infrastructuresList = mutableListOf<Infrastructure>()
                    for (document in result) {
                        infrastructuresList.add(createInfrastructureFromDocument(document))
                    }
                    InfraUtils.saveInfras(context, infrastructuresList)
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "InfrastructureService",
                        "Erreur lors de la récupération des infrastructures",
                        exception
                    )
                }
        } else {
            infrastructuresCollection.get()
                .addOnSuccessListener { result ->
                    val infrastructuresList = mutableListOf<Infrastructure>()
                    for (document in result) {
                        infrastructuresList.add(createInfrastructureFromDocument(document))
                    }
                    InfraUtils.saveInfras(context, infrastructuresList)
                    infrastructuresLiveData.value = infrastructuresList
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "InfrastructureService",
                        "Erreur lors de la récupération des infrastructures",
                        exception
                    )
                }
        }

        return infrastructuresLiveData
    }

    /**
     * Convertit un document Firestore en objet [Infrastructure].
     *
     * @param document Document Firestore contenant les données de l'infrastructure
     * @return Une instance d’[Infrastructure] initialisée
     */
    private fun createInfrastructureFromDocument(document: DocumentSnapshot): Infrastructure {
        val id = document.id
        val nom = document.getString("nom") ?: ""
        val description = document.getString("description") ?: ""
        val longitude = document.getString("longitude") ?: ""
        val latitude = document.getString("latitude") ?: ""
        val images = document.get("images") as? List<String> ?: emptyList()
        val image = images.firstOrNull() ?: ""
        val situation = document.getString("situation") ?: ""
        val type = document.getString("type") ?: ""

        return Infrastructure(
            id,
            nom,
            description,
            longitude,
            latitude,
            image,
            situation,
            type,
            images
        )
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\SalleService.kt 
=============================================== 
package tg.univlome.epl.services

import android.content.Context
import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Salle
import tg.univlome.epl.utils.SalleUtils

/**
 * Service SalleService : Récupération des données des salles
 *
 * Description :
 * Cette classe gère la **récupération et la mise en cache des données des salles** depuis Firebase Firestore.
 * Elle assure un chargement rapide grâce à un cache local (`SharedPreferences`) et une mise à jour
 * asynchrone en arrière-plan avec les données plus fraîches depuis Firestore.
 * Cette classe a donc pour but de :
 * - Lire les données des salles depuis Firestore.
 * - Associer chaque salle à son bâtiment via `buildingId`.
 * - Fournir un LiveData<List<Salle>> pour l'observation par les vues.
 * - Utiliser le cache local (`SalleUtils.loadSalles`, `SalleUtils.saveSalles`) pour les performances.
 *
 * Composants :
 * - Firebase Firestore
 * - SharedPreferences (via `SalleUtils`)
 * - `LiveData` et `MutableLiveData` pour observer les salles
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @param context Contexte Android pour accéder au système de fichiers local
 *
 * @see tg.univlome.epl.models.Salle
 * @see tg.univlome.epl.utils.SalleUtils
 */
class SalleService(private val context: Context) {

    private val db = FirebaseFirestore.getInstance()
    private val sallesCollection = db.collection("salles")
    private val batimentsCollection = db.collection("batiments")

    /**
     * Récupère la liste des salles, en utilisant d'abord le cache local (SharedPreferences),
     * puis en mettant à jour les données via Firebase Firestore si disponible.
     *
     * @return LiveData contenant la liste des salles
     */
    fun getSalles(): LiveData<List<Salle>> {
        val sallesLiveData = MutableLiveData<List<Salle>>()
        val batimentMap = mutableMapOf<String, String>()

        // 1. Charger les salles depuis SharedPreferences (cache rapide)
        val loadSalles = SalleUtils.loadSalles(context)
        if (loadSalles != null) {
            sallesLiveData.value = loadSalles!!
            // 2. Charger les bâtiments depuis Firebase (plus lent)
            batimentsCollection.get()
                .addOnSuccessListener { batimentResult ->
                    for (document in batimentResult) {
                        val id = document.id
                        val nom = document.getString("nom") ?: ""
                        batimentMap[id] = nom
                    }

                    // 3. Puis les salles
                    sallesCollection.get()
                        .addOnSuccessListener { result ->
                            val sallesList = mutableListOf<Salle>()
                            for (document in result) {
                                sallesList.add(createSalleFromDocument(document, batimentMap))
                            }

                            // Sauvegarde UNE SEULE FOIS après avoir tout ajouté
                            SalleUtils.saveSalles(context, sallesList)

                        }
                        .addOnFailureListener { exception ->
                            Log.e(
                                "SalleService",
                                "Erreur lors de la récupération des salles",
                                exception
                            )
                        }
                }
                .addOnFailureListener { exception ->
                    Log.e("SalleService", "Erreur lors de la récupération des bâtiments", exception)
                }
        } else {
            // 2. Charger les bâtiments depuis Firebase (plus lent)
            batimentsCollection.get()
                .addOnSuccessListener { batimentResult ->
                    for (document in batimentResult) {
                        val id = document.id
                        val nom = document.getString("nom") ?: ""
                        batimentMap[id] = nom
                    }

                    // 3. Puis les salles
                    sallesCollection.get()
                        .addOnSuccessListener { result ->
                            val sallesList = mutableListOf<Salle>()
                            for (document in result) {
                                sallesList.add(createSalleFromDocument(document, batimentMap))
                            }

                            // Sauvegarde UNE SEULE FOIS après avoir tout ajouté
                            SalleUtils.saveSalles(context, sallesList)

                            sallesLiveData.value = sallesList

                        }
                        .addOnFailureListener { exception ->
                            Log.e(
                                "SalleService",
                                "Erreur lors de la récupération des salles",
                                exception
                            )
                        }
                }
                .addOnFailureListener { exception ->
                    Log.e("SalleService", "Erreur lors de la récupération des bâtiments", exception)
                }
        }

        return sallesLiveData
    }

    /**
     * Transforme un document Firestore en instance de [Salle], en liant les ID de bâtiments
     * à leur nom via une map générée au préalable.
     *
     * @param document Document Firestore de la salle
     * @param batimentMap Map des ID de bâtiments vers leurs noms
     * @return Salle initialisée avec ses attributs
     */
    private fun createSalleFromDocument(
        document: DocumentSnapshot,
        batimentMap: Map<String, String>
    ): Salle {
        val id = document.id
        val infrastructureId = document.getString("buildingId") ?: ""
        val nom = document.getString("nom") ?: ""
        val description = document.getString("description") ?: ""
        val capacite = document.getString("capacity") ?: ""
        val longitude = document.getString("longitude") ?: ""
        val latitude = document.getString("latitude") ?: ""
        val images = document.get("images") as? List<String> ?: emptyList()
        val image = images.firstOrNull() ?: ""
        val type = document.getString("type") ?: ""

        val situation = batimentMap[infrastructureId] ?: "Bâtiment inconnu"

        return Salle(
            id,
            infrastructureId,
            nom,
            description,
            capacite,
            longitude,
            latitude,
            image,
            situation,
            type,
            images
        )
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\LocULFragment.kt 
=============================================== 
package tg.univlome.epl.ui

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment LocULFragment : Localisation statique de l'Université de Lomé
 *
 * Description :
 * Ce fragment affiche un écran de **localisation générale ou symbolique** de l’Université de Lomé.
 * Il peut servir à présenter une carte figée, une bannière descriptive ou toute autre vue informative
 * concernant la position ou l'identité géographique de l’UL.
 * Cette classe a donc pour but de :
 * - Fournir un point d’entrée statique à la localisation de l’université.
 * - Affichage complémentaire ou introductif dans le système de navigation de l'application.
 *
 * Composants :
 * - `fragment_loc_ul.xml` : layout associé à la représentation de l’UL.
 *
 * Bibliothèques utilisées :
 * - AndroidX Fragment
 *
 * Exemple d’utilisation :
 * ```
 * val fragment = LocULFragment()
 * supportFragmentManager.beginTransaction()
 *     .replace(R.id.container, fragment)
 *     .commit()
 * ```
 */
class LocULFragment : Fragment() {

    /**
     * Crée la vue du fragment à partir du layout `fragment_loc_ul`.
     *
     * @param inflater Le LayoutInflater utilisé pour gonfler la vue
     * @param container Le ViewGroup parent dans lequel la vue sera insérée
     * @param savedInstanceState État précédemment enregistré du fragment
     * @return La vue représentant la localisation de l’UL
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        return inflater.inflate(R.layout.fragment_loc_ul, container, false)
    }

    /**
     * Appelée après que la vue a été créée. Peut être utilisée pour initialiser
     * les composants d'interface ou déclencher des animations/données.
     *
     * @param view La vue racine du fragment
     * @param savedInstanceState L’état sauvegardé du fragment
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\LogoFragment.kt 
=============================================== 
package tg.univlome.epl.ui

import android.os.Bundle
import android.util.Log
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment LogoFragment : Affichage du logo au lancement
 *
 * Description :
 * Fragment utilisé pour **afficher temporairement un logo ou écran d’accueil** au lancement de l’application.
 * Il peut être utilisé comme un splash screen ou comme une vue d’introduction silencieuse.
 * Cette classe a donc pour but de :
 * - Fournir un écran statique avec le logo de l’application.
 * - Notifier un composant parent via une interface optionnelle (`LogoListener`).
 *
 * Composants :
 * - `fragment_logo.xml` : Mise en page du logo.
 * - `LogoListener` : Interface pour l’interaction optionnelle avec d'autres fragments ou activités.
 *
 * Bibliothèques utilisées :
 * - AndroidX Fragment
 *
 * Exemple d’utilisation :
 * ```
 * val fragment = LogoFragment()
 * fragment.setLogoListener(object : LogoFragment.LogoListener { ... })
 * ```
 */
class LogoFragment : Fragment() {

    /**
     * Interface de rappel optionnelle pour interagir avec des composants parents
     * (comme une activité ou un autre fragment) après l’affichage du logo.
     */
    interface LogoListener

    private var logoListener: LogoListener? = null

    /**
     * Permet d’enregistrer un listener pour réagir à des événements du fragment.
     *
     * @param listener Une implémentation de [LogoListener]
     */
    fun setLogoListener(listener: LogoListener) {
        logoListener = listener
    }

    /**
     * Récupère le listener actuellement assigné au fragment.
     *
     * @return L’instance de [LogoListener] ou `null` si aucun n’a été défini
     */
    fun getLogoListener(): LogoListener? {
        return this.logoListener
    }

    /**
     * Crée la vue du fragment à partir du layout `fragment_logo`.
     *
     * @return La vue représentant le logo
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        return inflater.inflate(R.layout.fragment_logo, container, false)
    }

    /**
     * Méthode appelée après que la vue a été créée. Affiche un log dans la console pour suivi du cycle de vie.
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        Log.d("LOGO_FRAGMENT", "LogoFragment visible")
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\SearchBarFragment.kt 
=============================================== 
package tg.univlome.epl.ui

import android.os.Bundle
import android.text.Editable
import android.text.TextWatcher
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.EditText
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment SearchBarFragment : Barre de recherche dynamique
 *
 * Description :
 * Ce fragment fournit une interface utilisateur permettant à l'utilisateur de taper du texte
 * pour effectuer une recherche. Il déclenche dynamiquement des mises à jour de contenu
 * via une interface `SearchListener`.
 * Cette classe a donc pour but de :
 * - Fournir une zone de saisie pour filtrer dynamiquement des éléments (bâtiments, salles, infrastructures, etc.)
 * - Notifier les fragments hébergeurs des changements en temps réel
 *
 * Composants :
 * - `fragment_search_bar.xml` : contient un `EditText` pour la recherche
 *
 * Bibliothèques utilisées :
 * - AndroidX Fragment
 *
 * @see SearchListener — interface de communication pour la transmission des requêtes
 * @see tg.univlome.epl.ui.batiment.AllBatimentFragment
 * @see tg.univlome.epl.ui.infrastructure.AllInfraFragment
 * @see tg.univlome.epl.ui.home.ViewAllSalleFragment
 */
class SearchBarFragment : Fragment() {

    /**
     * Interface utilisée pour transmettre le texte saisi à un écouteur externe.
     */
    interface SearchListener {
        /**
         * Appelée à chaque fois que le texte dans la barre de recherche est modifié.
         * @param query texte saisi par l'utilisateur
         */
        fun onSearch(query: String)
    }

    private var searchListener: SearchListener? = null

    /**
     * Enregistre un écouteur pour les événements de recherche.
     *
     * @param listener l’objet implémentant SearchListener
     */
    fun setSearchListener(listener: SearchListener) {
        searchListener = listener
    }

    /**
     * Récupère l'écouteur actuellement enregistré.
     *
     * @return le SearchListener actif, ou null s'il n'est pas défini
     */
    fun getSearchListener(): SearchListener? {
        return this.searchListener
    }

    /**
     * Gonfle la vue associée au fragment.
     *
     * @param inflater le LayoutInflater
     * @param container le conteneur parent
     * @param savedInstanceState état antérieur du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        return inflater.inflate(R.layout.fragment_search_bar, container, false)
    }

    /**
     * Initialise les interactions après que la vue est créée. Ajoute notamment un `TextWatcher`
     * à l'élément `EditText` pour capturer les recherches.
     *
     * @param view vue racine du fragment
     * @param savedInstanceState état antérieur du fragment
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        val searchEditText = view.findViewById<EditText>(R.id.search_edit_text)

        searchEditText.addTextChangedListener(object : TextWatcher {
            override fun afterTextChanged(s: Editable?) {
                searchListener?.onSearch(s.toString())
            }

            override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) {}
            override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) {}
        })
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\AllBatimentFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment AllBatimentFragment : Affiche tous les bâtiments sans filtrage géographique
 *
 * Description :
 * Ce fragment présente la liste complète des bâtiments disponibles sur le campus universitaire,
 * sans distinction de situation (nord/sud). Il utilise :
 *  - un effet de chargement Shimmer pour l’attente des données
 *  - la localisation de l’utilisateur pour calculer les distances par bâtiment
 *  - une interface de recherche (SearchBar) pour filtrer dynamiquement par nom
 *
 * Une fois les données chargées, elles sont affichées dans une `RecyclerView` avec
 * l’adaptateur `BatimentFragmentAdapter`. Ce fragment communique avec `BatimentUtils`
 * pour le traitement de la logique métier et la géolocalisation.
 *
 * Composants principaux :
 *  - `RecyclerView` : liste des bâtiments
 *  - `ShimmerFrameLayout` : animation de chargement
 *  - `FusedLocationProviderClient` : localisation utilisateur
 *  - `SearchBarFragment` : filtrage via une barre de recherche
 *
 * Bibliothèques utilisées :
 *  - Google Location Services
 *  - Facebook Shimmer
 *  - OSMDroid pour la gestion des coordonnées
 *
 * @see BatimentUtils pour la logique de filtrage et calcul de distance
 * @see BatimentFragmentAdapter pour l’affichage des éléments
 * @see SearchBarFragment pour la recherche textuelle
 */
class AllBatimentFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batiments: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter
    private lateinit var batimentService: BatimentService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerAllBatiments: ShimmerFrameLayout
    private lateinit var recyclerAllBatiments: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise le layout du fragment, les vues UI, la localisation,
     * les listes de données et lance le chargement.
     *
     * @return Vue initialisée du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_all_batiment, container, false)

        shimmerAllBatiments = view.findViewById(R.id.shimmerAllBatiments)
        recyclerAllBatiments = view.findViewById(R.id.recyclerAllBatiments)
        shimmerAllBatiments.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batiments = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batiments)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllBatiments
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la position actuelle de l’utilisateur à l’aide de Google Location Services.
     * Une fois la position obtenue, déclenche le chargement des bâtiments via `BatimentUtils`.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerAllBatiments.stopShimmer()
                shimmerAllBatiments.visibility = View.GONE
                recyclerAllBatiments.visibility = View.VISIBLE
            }

            BatimentUtils.updateBatiments(
                userGeoPoint,
                batiments,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Effectue un filtrage dynamique de la liste des bâtiments en fonction du texte recherché.
     * Met à jour l’adaptateur avec les résultats filtrés.
     *
     * @param query Chaîne entrée par l’utilisateur dans la barre de recherche
     */
    override fun onSearch(query: String) {
        filteredList =
            batiments.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\BatimentActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.Intent
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.os.Bundle
import android.view.View
import android.view.ViewGroup
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import com.google.android.material.tabs.TabLayoutMediator
import org.osmdroid.config.Configuration
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import tg.univlome.epl.R
import tg.univlome.epl.adapter.ImageAdapter
import tg.univlome.epl.databinding.ActivityBatimentBinding
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.ui.maps.MapsActivity
import tg.univlome.epl.utils.MapsUtils

/**
 * Activité BatimentActivity : Activité de détail d’un bâtiment
 *
 * Description :
 * Cette activité affiche les détails complets d’un bâtiment sélectionné, y compris :
 *  - Le nom, la situation géographique, la distance, et la description
 *  - Un carrousel d’images si plusieurs photos sont disponibles
 *  - Une carte miniature affichant la position du bâtiment et celle de l’utilisateur
 *  - Un bouton de navigation qui redirige vers la carte principale (`MapsActivity`)
 *
 * Elle gère également la récupération de la position de l'utilisateur en temps réel à l'aide de
 * l'API `FusedLocationProviderClient`, ainsi que les permissions de localisation.
 *
 * Composants UI :
 *  - `ActivityBatimentBinding` pour accéder aux vues via ViewBinding
 *  - `MapView` (OSMDroid) pour l'affichage de la carte
 *  - `TabLayout` + `ViewPager2` pour les images
 *
 * Composants techniques :
 *  - Glide pour le chargement dynamique des images
 *  - OSMDroid pour la carte miniature statique
 *  - `MapsUtils` pour configurer la carte et calculer les itinéraires
 *
 * Permissions requises :
 *  - `ACCESS_FINE_LOCATION` pour afficher la position de l’utilisateur
 *
 * @see MapsUtils.setMiniMap pour la configuration de la carte miniature
 * @see MapsActivity pour la navigation complète
 * @see ImageAdapter pour le carrousel d’images
 */
class BatimentActivity : AppCompatActivity() {

    lateinit var ui: ActivityBatimentBinding
    private lateinit var miniMap: MapView
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Point d’entrée de l’activité. Initialise l’interface utilisateur,
     * applique les paramètres OSMDroid, extrait l’objet `Batiment`
     * depuis l’intent, configure l’affichage des images, les informations textuelles,
     * la carte miniature, et le bouton de navigation.
     *
     * Gère également les permissions de localisation.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        ui = ActivityBatimentBinding.inflate(layoutInflater)
        setContentView(ui.root)

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)
        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        val batiment = intent.getSerializableExtra("batiment") as? Batiment

        // Mettre à jour l'interface utilisateur avec les données reçues

        val images = batiment?.images ?: emptyList()

        if (images.size <= 1) {
            ui.imageContainer.visibility = View.GONE
        } else {
            ui.imageContainer.visibility = View.VISIBLE
            val viewPager = ui.imagePager
            val tabLayout = ui.imageIndicator

            // Déplacer la première image à la fin de la liste
            val mainImage = batiment?.image
            val reorderedImages = (images.filter { it != mainImage }) + mainImage

            viewPager.adapter = ImageAdapter(reorderedImages as List<String>)

            TabLayoutMediator(tabLayout, viewPager) { _, _ -> }.attach()

            for (i in 0 until tabLayout.tabCount) {
                val tabView = (tabLayout.getChildAt(0) as ViewGroup).getChildAt(i)
                val params = tabView.layoutParams as ViewGroup.MarginLayoutParams

                // Définition de la taille des points
                params.width = resources.getDimensionPixelSize(R.dimen.custom_dot_width)
                params.height = resources.getDimensionPixelSize(R.dimen.custom_dot_height)

                // Définition des marges entre les points
                params.setMargins(
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0,
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0
                )

                tabView.layoutParams = params
            }
        }

        if (batiment != null) {
            ui.txtNomBatiment.text = batiment.nom
            ui.situationBat.text = batiment.situation
            ui.txtDistance.text = batiment.distance
            ui.desc.text = batiment.description
            if (!batiment.image.isNullOrEmpty()) {
                Glide.with(this)
                    .asBitmap()
                    .load(batiment.image)
                    .into(object : CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: Transition<in Bitmap>?
                        ) {
                            val drawable =
                                BitmapDrawable(resources, resource)
                            ui.imgBatiment.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                ui.imgBatiment.setImageResource(batiment.icon)
            }
            if (!batiment.latitude.isNullOrBlank() && !batiment.longitude.isNullOrBlank()) {
                val latitude = batiment.latitude.toDouble()
                val longitude = batiment.longitude.toDouble()

                ui.aller.setOnClickListener {
                    MapsUtils.saveDestination(this, GeoPoint(latitude, longitude))
                    val intent = Intent(this, MapsActivity::class.java)
                    ui.aller.context.startActivity(intent)
                }

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    != PackageManager.PERMISSION_GRANTED
                ) {

                    requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
                    return
                }

                miniMap = ui.miniMap

                // Fallback si la localisation n'est pas disponible
                val destination = GeoPoint(latitude, longitude)
                var userLocation: GeoPoint? = null

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    == PackageManager.PERMISSION_GRANTED
                ) {

                    fusedLocationClient.lastLocation.addOnSuccessListener { location ->
                        location?.let {
                            userLocation = GeoPoint(it.latitude, it.longitude)
                            setupMiniMap(userLocation!!, destination)
                        } ?: run {
                            // Si la localisation n'est pas disponible, utiliser seulement la destination
                            setupMiniMap(destination, destination)
                        }
                    }.addOnFailureListener {
                        // En cas d'échec, utiliser seulement la destination
                        setupMiniMap(destination, destination)
                    }
                } else {
                    // Sans permission, utiliser seulement la destination
                    setupMiniMap(destination, destination)
                }
            } else {
                // Affiche un message ou fais une action par défaut
                ui.aller.visibility = View.GONE
                ui.miniMapLayout.visibility = View.GONE
            }

        }

        ui.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }
    }

    /**
     * Configure et affiche une carte miniature (`miniMap`) montrant l’itinéraire
     * entre deux points : la position de l’utilisateur et celle du bâtiment.
     *
     * @param start Position de départ (utilisateur)
     * @param end Position d’arrivée (bâtiment)
     *
     * @requiresPermission Manifest.permission.ACCESS_FINE_LOCATION
     * @requiresPermission Manifest.permission.ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun setupMiniMap(start: GeoPoint, end: GeoPoint) {
        // Postpone pour s'assurer que la vue est bien layoutée
        ui.miniMapLayout.visibility = View.VISIBLE
        ui.miniMap.post {
            MapsUtils.setMiniMap(miniMap, start, end, this, this, resources)
            // Forcer un recalcul des dimensions
            miniMap.invalidate()
            miniMap.requestLayout()
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\BatimentFragment.kt 
=============================================== 
package tg.univlome.epl.ui.batiment

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.AnimationUtils
import android.widget.LinearLayout
import androidx.appcompat.app.AppCompatActivity
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment BatimentFragment : Fragment de navigation des bâtiments par zone géographique
 *
 * Description :
 * Ce fragment offre une interface utilisateur permettant de filtrer et d'afficher
 * les bâtiments du campus selon leur situation géographique :
 *  - Tous les bâtiments
 *  - Bâtiments situés au Campus Nord
 *  - Bâtiments situés au Campus Sud
 *
 * L’utilisateur peut naviguer entre ces catégories via une barre de navigation personnalisée,
 * avec des indicateurs visuels animés pour refléter la sélection.
 * Chaque filtre déclenche le chargement d’un sous-fragment spécifique (`AllBatimentFragment`, etc.).
 *
 * Composants principaux :
 *  - `LinearLayout` interactif pour chaque onglet de navigation (nav_all, nav_nord, nav_sud)
 *  - `View` utilisé comme indicateur visuel de sélection
 *  - `AnimationUtils` pour une animation d’indicateur fluide
 *  - Sous-fragments affichés dynamiquement dans un conteneur (`R.id.batiment_container`)
 *
 * Bibliothèques utilisées :
 *  - AndroidX Fragment
 *  - Android AnimationUtils (animation de scale)
 *
 * @see AllBatimentFragment pour l’affichage de tous les bâtiments
 * @see NordBatimentFragment pour les bâtiments du Campus Nord
 * @see SudBatimentFragment pour les bâtiments du Campus Sud
 */
class BatimentFragment : Fragment() {

    private var currentSelectedNav: View? = null
    private var currentIndicator: View? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée la vue du fragment à partir de `fragment_batiment.xml`.
     *
     * @return Vue principale contenant la navigation par zone
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_batiment, container, false)
    }

    /**
     * Initialise l’état initial du fragment et configure la navigation
     * entre les différentes zones géographiques des bâtiments.
     *
     * Par défaut, charge `AllBatimentFragment`.
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // Par défaut, "Tout" est sélectionné
        val allNav = view.findViewById<LinearLayout>(R.id.nav_all)
        val allIndicator = view.findViewById<View>(R.id.indicator_all)
        currentSelectedNav = allNav
        currentIndicator = allIndicator
        loadFragment(AllBatimentFragment())

        // Configurer les listeners pour chaque élément de navigation
        setupNavItem(view, R.id.nav_all, R.id.indicator_all) {
            loadFragment(AllBatimentFragment())
        }

        setupNavItem(view, R.id.nav_nord, R.id.indicator_nord) {
            loadFragment(NordBatimentFragment())
        }

        setupNavItem(view, R.id.nav_sud, R.id.indicator_sud) {
            loadFragment(SudBatimentFragment())
        }
    }

    /**
     * Associe un écouteur à un bouton de navigation et son indicateur.
     * Gère la sélection visuelle, les animations et le changement de fragment.
     *
     * @param view Vue racine contenant l’élément
     * @param navItemId ID de l’élément de navigation cliquable
     * @param indicatorId ID de l’indicateur à afficher
     * @param action Action à exécuter au clic (chargement d’un sous-fragment)
     */
    private fun setupNavItem(view: View, navItemId: Int, indicatorId: Int, action: () -> Unit) {
        val navItem = view.findViewById<LinearLayout>(navItemId)
        val indicator = view.findViewById<View>(indicatorId)

        navItem.setOnClickListener {
            // Si c'est déjà l'élément sélectionné, ne rien faire
            if (currentSelectedNav == navItem) return@setOnClickListener

            // Désélectionner l'élément précédent
            currentIndicator?.visibility = View.INVISIBLE

            // Sélectionner le nouvel élément
            indicator.visibility = View.VISIBLE
            animateIndicator(indicator)
            currentSelectedNav = navItem
            currentIndicator = indicator

            // Exécuter l'action associée à cet élément
            action()
        }
    }

    /**
     * Applique une animation de type "scale" à l’indicateur sélectionné.
     *
     * @param indicator Vue représentant l’indicateur actif
     */
    private fun animateIndicator(indicator: View) {
        // Charger l'animation
        val scaleAnimation = AnimationUtils.loadAnimation(context, R.anim.indicator_scale)

        // Appliquer l'animation à l'indicateur
        indicator.startAnimation(scaleAnimation)
    }

    /**
     * Remplace dynamiquement le fragment affiché dans le conteneur central.
     *
     * @param fragment Fragment à afficher dans `batiment_container`
     */
    private fun loadFragment(fragment: Fragment) {
        (requireActivity() as AppCompatActivity).supportFragmentManager.beginTransaction()
            .replace(R.id.batiment_container, fragment)
            .commit()
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\NordBatimentFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment NordBatimentFragment : Affiche les bâtiments situés sur le Campus Nord.
 *
 * Description :
 * Ce fragment permet de visualiser dynamiquement les bâtiments du **campus nord**,
 * en se basant sur la localisation actuelle de l’utilisateur.
 * Il calcule les distances entre l’utilisateur et les bâtiments, les affiche dans
 * une `RecyclerView` avec un effet de chargement shimmer, et permet un filtrage
 * en temps réel via la barre de recherche.
 *
 * Composants principaux :
 * - `BatimentUtils` : outil central de récupération, filtrage et affichage
 * - `BatimentFragmentAdapter` : adaptateur de liste pour les bâtiments
 * - `FragmentModel` : encapsule les métadonnées de fragment (vue, contexte, type)
 *
 * Bibliothèques utilisées :
 * - Google Play Services (`FusedLocationProviderClient`) : pour la géolocalisation
 * - OSMDroid : pour manipuler les coordonnées géographiques
 * - Facebook Shimmer : pour l’effet de chargement fluide
 *
 * @see BatimentUtils pour la logique métier de mise à jour
 * @see SearchBarFragment pour le support du filtrage textuel en direct
 */
class NordBatimentFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batiments: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter
    private lateinit var batimentService: BatimentService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerNordBatiments: ShimmerFrameLayout
    private lateinit var recyclerNordBatiments: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée et retourne la vue du fragment, initialise les composants UI,
     * démarre l’effet shimmer et déclenche la récupération de la localisation.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_nord_batiment, container, false)

        shimmerNordBatiments = view.findViewById(R.id.shimmerNordBatiments)
        recyclerNordBatiments = view.findViewById(R.id.recyclerNordBatiments)
        shimmerNordBatiments.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batiments = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batiments)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerNordBatiments,
            "nord"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la localisation actuelle de l'utilisateur pour filtrer les bâtiments.
     * Utilise `BatimentUtils.updateBatiments` avec le paramètre de situation "nord".
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerNordBatiments.stopShimmer()
                shimmerNordBatiments.visibility = View.GONE
                recyclerNordBatiments.visibility = View.VISIBLE
            }
            BatimentUtils.updateBatiments(
                userGeoPoint,
                batiments,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des bâtiments selon le texte de recherche saisi.
     *
     * @param query Le mot-clé saisi dans la barre de recherche
     */
    override fun onSearch(query: String) {
        filteredList =
            batiments.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\SudBatimentFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment SudBatimentFragment : Affiche les bâtiments du campus sud
 *
 * Description :
 * Ce fragment est dédié à l'affichage des bâtiments situés sur le **campus sud** de l'université.
 * Il récupère la localisation de l'utilisateur, calcule la distance jusqu'à chaque bâtiment
 * et met à jour dynamiquement une `RecyclerView` avec un indicateur de chargement (shimmer).
 *
 * Une recherche en temps réel permet de filtrer les résultats en fonction du nom du bâtiment.
 *
 * Composants principaux :
 * - `BatimentUtils` : Gère la récupération, le filtrage et la mise à jour des bâtiments
 * - `BatimentFragmentAdapter` : Affiche les bâtiments dans une liste verticale
 * - `FragmentModel` : Fournit le contexte et les paramètres de configuration
 *
 * Bibliothèques utilisées :
 * - **OSMDroid** pour la gestion des coordonnées géographiques
 * - **Google Play Services** (`FusedLocationProviderClient`) pour la géolocalisation
 * - **Facebook Shimmer** pour l'effet de chargement pendant l'attente des données
 *
 * @see BatimentUtils
 * @see SearchBarFragment
 */
class SudBatimentFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batiments: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter
    private lateinit var batimentService: BatimentService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerSudBatiments: ShimmerFrameLayout
    private lateinit var recyclerSudBatiments: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise la vue du fragment et déclenche la localisation pour charger les données.
     *
     * @return La vue du fragment sud contenant la liste des bâtiments filtrés.
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_sud_batiment, container, false)

        shimmerSudBatiments = view.findViewById(R.id.shimmerSudBatiments)
        recyclerSudBatiments = view.findViewById(R.id.recyclerSudBatiments)
        shimmerSudBatiments.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batiments = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batiments)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerSudBatiments,
            "sud"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la position actuelle de l'utilisateur puis met à jour la liste des bâtiments du campus sud.
     * Affiche ensuite la `RecyclerView` et cache le shimmer une fois les données prêtes.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerSudBatiments.stopShimmer()
                shimmerSudBatiments.visibility = View.GONE
                recyclerSudBatiments.visibility = View.VISIBLE
            }

            BatimentUtils.updateBatiments(
                userGeoPoint,
                batiments,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre les bâtiments affichés selon le mot-clé saisi dans la barre de recherche.
     * @param query Texte de recherche saisi par l'utilisateur
     */
    override fun onSearch(query: String) {
        filteredList =
            batiments.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\HomeFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentAdapter
import tg.univlome.epl.adapter.InfraAdapter
import tg.univlome.epl.adapter.SalleAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.ui.LogoFragment
import tg.univlome.epl.utils.HomeBatimentUtils
import tg.univlome.epl.utils.HomeInfraUtils
import tg.univlome.epl.utils.HomeSalleUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment HomeFragment : Fragment d’accueil affichant les sections principales
 * de l'application de géolocalisation du campus universitaire.
 *
 * Description :
 * Ce fragment constitue l’écran d’accueil de l’application. Il permet d’afficher
 * les différentes entités présentes sur le campus :
 *  - Bâtiments d’enseignement
 *  - Bâtiments administratifs
 *  - Infrastructures
 *  - Salles
 *
 * Il utilise des animations Shimmer pour améliorer l’expérience utilisateur durant le chargement.
 * Les données sont récupérées depuis Firestore via des services dédiés, et filtrées selon leur type.
 * La position de l’utilisateur est utilisée pour calculer les distances relatives à chaque entité.
 *
 * Composants principaux :
 *  - `RecyclerView` pour chaque section (enseignement, administratif, infrastructures, salles)
 *  - `ShimmerFrameLayout` pour les effets de chargement
 *  - `HomeFragmentModel` pour encapsuler les métadonnées liées à chaque section
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour la géolocalisation
 *  - Google Location Services pour récupérer la position de l'utilisateur
 *  - Facebook Shimmer pour les animations de chargement
 *  - AndroidX Fragment, RecyclerView, Lifecycle
 *
 * @see HomeBatimentUtils, HomeInfraUtils, HomeSalleUtils pour le traitement des données
 * @see HomeFragmentModel pour le modèle utilisé dans chaque section
 */
class HomeFragment : Fragment(), LogoFragment.LogoListener {

    private lateinit var batimentsEns: MutableList<Batiment>
    private lateinit var batimentsEnsFilteredList: MutableList<Batiment>
    private lateinit var batimentsEnsAdapter: BatimentAdapter

    private lateinit var batimentsAdmin: MutableList<Batiment>
    private lateinit var batimentsAdminFilteredList: MutableList<Batiment>
    private lateinit var batimentsAdminAdapter: BatimentAdapter

    private lateinit var infras: MutableList<Infrastructure>
    private lateinit var infrasFilteredList: MutableList<Infrastructure>
    private lateinit var infrasAdapter: InfraAdapter

    private lateinit var salles: MutableList<Salle>
    private lateinit var sallesFilteredList: MutableList<Salle>
    private lateinit var sallesAdapter: SalleAdapter

    private lateinit var batsEnsHomeFragmentModel: HomeFragmentModel
    private lateinit var batsAdminHomeFragmentModel: HomeFragmentModel
    private lateinit var sallesHomeFragmentModel: HomeFragmentModel
    private lateinit var infrasHomeFragmentModel: HomeFragmentModel

    // Shimmer FrameLayouts
    private lateinit var shimmerBatimentsEns: ShimmerFrameLayout
    private lateinit var shimmerBatimentsAdmin: ShimmerFrameLayout
    private lateinit var shimmerSalles: ShimmerFrameLayout
    private lateinit var shimmerInfra: ShimmerFrameLayout

    // RecyclerViews
    private lateinit var recyclerBatimentsEns: RecyclerView
    private lateinit var recyclerBatimentsAdmin: RecyclerView
    private lateinit var recyclerSalles: RecyclerView
    private lateinit var recyclerInfra: RecyclerView

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    private var rootView: View? = null

    /**
     * Initialise les vues du fragment et déclenche le chargement des données.
     * Affiche les effets Shimmer durant le chargement.
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        rootView = inflater.inflate(R.layout.fragment_home, container, false)

        // Initialiser les shimmer layouts et recyclerviews
        initializeViews(rootView!!)

        // Montrer les shimmer et cacher les recyclerviews
        showShimmer()

        // Charger les données
        loadData(rootView!!)

        return rootView
    }

    /**
     * Initialise tous les éléments de l’interface graphique :
     * les animations shimmer et les `RecyclerView`.
     *
     * @param view Vue racine du fragment
     */
    private fun initializeViews(view: View) {
        // Initialiser les shimmer layouts
        shimmerBatimentsEns = view.findViewById(R.id.shimmerBatimentsEnsContainer)
        shimmerBatimentsAdmin = view.findViewById(R.id.shimmerBatimentsAdminContainer)
        shimmerSalles = view.findViewById(R.id.shimmerSalleContainer)
        shimmerInfra = view.findViewById(R.id.shimmerInfraContainer)

        // Initialiser les recyclerviews
        recyclerBatimentsEns = view.findViewById(R.id.recyclerBatiments)
        recyclerBatimentsAdmin = view.findViewById(R.id.recyclerBatimentsAdmin)
        recyclerSalles = view.findViewById(R.id.recyclerSalles)
        recyclerInfra = view.findViewById(R.id.recyclerInfra)
    }

    /**
     * Active les animations Shimmer sur toutes les sections de contenu.
     */
    private fun showShimmer() {
        // Démarrer les animations shimmer
        shimmerBatimentsEns.startShimmer()
        shimmerBatimentsAdmin.startShimmer()
        shimmerSalles.startShimmer()
        shimmerInfra.startShimmer()
    }

    /**
     * Désactive les animations Shimmer et affiche les `RecyclerView` avec les données chargées.
     */
    private fun hideShimmer() {
        // Arrêter les animations shimmer
        shimmerBatimentsEns.stopShimmer()
        shimmerBatimentsAdmin.stopShimmer()
        shimmerSalles.stopShimmer()
        shimmerInfra.stopShimmer()

        // Cacher les shimmer layouts
        shimmerBatimentsEns.visibility = View.GONE
        shimmerBatimentsAdmin.visibility = View.GONE
        shimmerSalles.visibility = View.GONE
        shimmerInfra.visibility = View.GONE

        // Montrer les recyclerviews
        recyclerBatimentsEns.visibility = View.VISIBLE
        recyclerBatimentsAdmin.visibility = View.VISIBLE
        recyclerSalles.visibility = View.VISIBLE
        recyclerInfra.visibility = View.VISIBLE
    }

    /**
     * Initialise les listes, adaptateurs et modèles pour toutes les sections.
     * Déclenche la récupération de la position utilisateur.
     *
     * @param view Vue contenant les composants d’interface
     */
    fun loadData(view: View) {
        val fragmentManager = requireActivity().supportFragmentManager

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentsEns = mutableListOf()
        batimentsEnsFilteredList = mutableListOf()
        batimentsEnsAdapter =
            BatimentAdapter(batimentsEns, fragmentManager, ViewAllBatEnsFragment())

        batimentsAdmin = mutableListOf()
        batimentsAdminFilteredList = mutableListOf()
        batimentsAdminAdapter =
            BatimentAdapter(batimentsAdmin, fragmentManager, ViewAllBatAdminFragment())

        infras = mutableListOf()
        infrasFilteredList = mutableListOf()
        infrasAdapter = InfraAdapter(infras, fragmentManager, ViewAllInfraFragment())

        salles = mutableListOf()
        sallesFilteredList = mutableListOf()
        sallesAdapter = SalleAdapter(salles, fragmentManager, ViewAllSalleFragment())

        batsEnsHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerBatiments,
            fragmentManager,
            ViewAllBatEnsFragment(),
            "enseignement"
        )
        batsAdminHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerBatimentsAdmin,
            fragmentManager,
            ViewAllBatAdminFragment(),
            "administratif"
        )
        sallesHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerSalles,
            fragmentManager,
            ViewAllSalleFragment()
        )
        infrasHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerInfra,
            fragmentManager,
            ViewAllInfraFragment()
        )

        getUserLocation()
    }

    /**
     * Recharge manuellement toutes les données, utile après une permission ou mise à jour.
     * Affiche à nouveau les effets de chargement (Shimmer).
     */
    fun rechargerDonnees() {
        // Afficher à nouveau les shimmer pendant le rechargement
        rootView?.let {
            showShimmer()
            loadData(it)
        }
    }

    /**
     * Récupère la position géographique de l'utilisateur et déclenche le chargement
     * des données pour les quatre sections principales.
     *
     * Si la permission n'est pas encore accordée, elle est demandée à l’utilisateur.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            /*val userGeoPoint = if (location != null) {
                // Sauvegarde la localisation obtenue
                MapsUtils.saveUserLocation(requireContext(), GeoPoint(location.latitude, location.longitude))
                GeoPoint(location.latitude, location.longitude)
            } else {
                // 🔄 Récupère la dernière position sauvegardée ou utilise une valeur par défaut
                val savedLocation = MapsUtils.loadUserLocation(requireContext())
                if (savedLocation.latitude != 0.0 || savedLocation.longitude != 0.0) {
                    savedLocation
                } else {
                    // Valeur par défaut (ex : Université de Lomé)
                    GeoPoint(6.1707, 1.2310)
                }
            }*/

            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)

            // Créer un compteur pour suivre les chargements terminés
            var loadedSections = 0
            val totalSections = 4 // 4 sections à charger

            val onDataLoadedCallback = {
                loadedSections++
                if (loadedSections >= totalSections) {
                    hideShimmer()
                }
            }

            // Modification pour notifier quand les données sont chargées
            HomeBatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsEns,
                batimentsEnsFilteredList,
                batimentsEnsAdapter,
                batsEnsHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }

            HomeBatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsAdmin,
                batimentsAdminFilteredList,
                batimentsAdminAdapter,
                batsAdminHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }

            HomeInfraUtils.updateInfrastructures(
                userGeoPoint,
                infras,
                infrasFilteredList,
                infrasAdapter,
                infrasHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }

            HomeSalleUtils.updateSalles(
                userGeoPoint,
                salles,
                sallesFilteredList,
                sallesAdapter,
                sallesHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Cache la barre de recherche si l’utilisateur quitte ce fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    override fun onResume() {
        super.onResume()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\SalleActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.Intent
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.os.Bundle
import android.view.View
import android.view.ViewGroup
import android.widget.FrameLayout
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import androidx.viewpager2.widget.ViewPager2
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import com.google.android.material.tabs.TabLayout
import com.google.android.material.tabs.TabLayoutMediator
import org.osmdroid.config.Configuration
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import tg.univlome.epl.R
import tg.univlome.epl.adapter.ImageAdapter
import tg.univlome.epl.databinding.ActivitySalleBinding
import tg.univlome.epl.models.Salle
import tg.univlome.epl.ui.maps.MapsActivity
import tg.univlome.epl.utils.MapsUtils

/**
 * Activité SalleActivity : Activité de détail d’une salle
 *
 * Description :
 * Cette activité permet d'afficher les informations complètes d'une salle universitaire :
 *  - Nom, situation géographique, description et distance par rapport à l’utilisateur
 *  - Images supplémentaires affichées dans un carrousel avec indicateurs personnalisés
 *  - Carte miniature (`miniMap`) indiquant la position de la salle et, si possible, celle de l’utilisateur
 *  - Un bouton "Aller" permettant d’ouvrir la carte principale (`MapsActivity`) avec l’itinéraire
 *
 * Elle utilise les bibliothèques `Glide` pour le chargement des images, `OSMDroid` pour la carte
 * et `FusedLocationProviderClient` pour la récupération de la position actuelle.
 *
 * Composants UI :
 *  - `ActivitySalleBinding` : ViewBinding pour accéder aux éléments d’interface
 *  - `ViewPager2` + `TabLayout` : affichage des images avec points personnalisés
 *  - `MapView` : carte statique pour visualisation de l’itinéraire
 *
 * Composants techniques :
 *  - `Glide` pour le chargement des images
 *  - `MapsUtils` pour configurer la carte miniature et enregistrer la destination
 *
 * Permissions requises :
 *  - `ACCESS_FINE_LOCATION` : localisation précise
 *  - `ACCESS_COARSE_LOCATION` : localisation approximative
 *
 * @see MapsUtils.setMiniMap pour l'affichage de la carte
 * @see MapsActivity pour la navigation détaillée
 * @see ImageAdapter pour le carrousel d’images
 */
class SalleActivity : AppCompatActivity() {

    lateinit var ui: ActivitySalleBinding
    private lateinit var miniMap: MapView
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Méthode principale appelée à la création de l'activité.
     * Initialise l’interface utilisateur, récupère les données de la salle,
     * configure les images, la carte miniature, les actions, et applique les autorisations.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        ui = ActivitySalleBinding.inflate(layoutInflater)
        setContentView(ui.root)

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)
        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        val salle = intent.getSerializableExtra("salle") as? Salle

        val images = salle?.images ?: emptyList()

        if (images.size <= 1) {
            ui.imageContainer.visibility = View.GONE
        } else {
            ui.imageContainer.visibility = View.VISIBLE
            val viewPager = ui.imagePager
            val tabLayout = ui.imageIndicator

            // Déplacer la première image à la fin de la liste
            val mainImage = salle?.image
            val reorderedImages = (images.filter { it != mainImage }) + mainImage

            viewPager.adapter = ImageAdapter(reorderedImages as List<String>)

            TabLayoutMediator(tabLayout, viewPager) { _, _ -> }.attach()

            for (i in 0 until tabLayout.tabCount) {
                val tabView = (tabLayout.getChildAt(0) as ViewGroup).getChildAt(i)
                val params = tabView.layoutParams as ViewGroup.MarginLayoutParams

                // Définition de la taille des points
                params.width = resources.getDimensionPixelSize(R.dimen.custom_dot_width)
                params.height = resources.getDimensionPixelSize(R.dimen.custom_dot_height)

                // Définition des marges entre les points
                params.setMargins(
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0,
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0
                )

                tabView.layoutParams = params
            }
        }

        if (salle != null) {
            ui.txtNomSalle.text = salle.nom
            ui.situationSalle.text = salle.situation
            ui.txtDistance.text = salle.distance
            ui.desc.text = salle.description
            if (!salle.image.isNullOrEmpty()) {
                Glide.with(this)
                    .asBitmap()
                    .load(salle.image)
                    .into(object : CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: Transition<in Bitmap>?
                        ) {
                            val drawable =
                                BitmapDrawable(resources, resource)
                            ui.imgSalle.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                ui.imgSalle.setImageResource(salle.icon)
            }
            if (!salle.latitude.isNullOrBlank() && !salle.longitude.isNullOrBlank()) {
                val latitude = salle.latitude.toDouble()
                val longitude = salle.longitude.toDouble()

                ui.aller.setOnClickListener {
                    MapsUtils.saveDestination(this, GeoPoint(latitude, longitude))
                    val intent = Intent(this, MapsActivity::class.java)
                    ui.aller.context.startActivity(intent)
                }

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    != PackageManager.PERMISSION_GRANTED
                ) {

                    requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
                    return
                }

                miniMap = ui.miniMap

                // Fallback si la localisation n'est pas disponible
                val destination = GeoPoint(latitude, longitude)
                var userLocation: GeoPoint? = null

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    == PackageManager.PERMISSION_GRANTED
                ) {

                    fusedLocationClient.lastLocation.addOnSuccessListener { location ->
                        location?.let {
                            userLocation = GeoPoint(it.latitude, it.longitude)
                            setupMiniMap(userLocation!!, destination)
                        } ?: run {
                            // Si la localisation n'est pas disponible, utiliser seulement la destination
                            setupMiniMap(destination, destination)
                        }
                    }.addOnFailureListener {
                        // En cas d'échec, utiliser seulement la destination
                        setupMiniMap(destination, destination)
                    }
                } else {
                    // Sans permission, utiliser seulement la destination
                    setupMiniMap(destination, destination)
                }
            } else {
                // Affiche un message ou fais une action par défaut
                ui.aller.visibility = View.GONE
                ui.miniMapLayout.visibility = View.GONE
            }

        }

        ui.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }
    }

    /**
     * Configure une carte miniature (`miniMap`) pour afficher la position de la salle
     * et celle de l’utilisateur, si disponible.
     *
     * @param start Point de départ (position de l’utilisateur)
     * @param end Point de destination (salle)
     *
     * @requiresPermission Manifest.permission.ACCESS_FINE_LOCATION
     * @requiresPermission Manifest.permission.ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun setupMiniMap(start: GeoPoint, end: GeoPoint) {
        // Postpone pour s'assurer que la vue est bien layoutée
        ui.miniMapLayout.visibility = View.VISIBLE
        ui.miniMap.post {
            MapsUtils.setMiniMap(miniMap, start, end, this, this, resources)
            // Forcer un recalcul des dimensions
            miniMap.invalidate()
            miniMap.requestLayout()
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllBatAdminFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment ViewAllBatAdminFragment : Affiche tous les bâtiments à usage administratif
 *
 * Description :
 * Ce fragment est destiné à afficher l’ensemble des bâtiments classés comme *administratifs*
 * sur le campus universitaire. Il exploite :
 *  - la localisation de l’utilisateur pour calculer les distances
 *  - une `RecyclerView` pour afficher la liste complète
 *  - une `SearchBar` intégrée pour filtrer dynamiquement par nom
 *
 * Les données sont récupérées depuis un service distant (`BatimentService`) et
 * traitées via l’objet `BatimentUtils`, qui applique les règles de filtrage selon le type
 * et la situation géographique définis dans le `FragmentModel`.
 *
 * Composants principaux :
 *  - `RecyclerView` : liste scrollable des bâtiments
 *  - `BatimentFragmentAdapter` : adaptateur d’affichage
 *  - `FusedLocationProviderClient` : pour la récupération de la position GPS de l'utilisateur
 *  - `FragmentModel` : encapsule le contexte et les métadonnées nécessaires à l’affichage
 *
 * Bibliothèques utilisées :
 *  - Google Location Services (FusedLocationProviderClient)
 *  - OSMDroid pour la gestion des coordonnées géographiques
 *
 * @see BatimentUtils pour le traitement logique et les calculs de distances
 * @see BatimentFragmentAdapter pour l’affichage des éléments dans la liste
 * @see FragmentModel pour les métadonnées du fragment
 */
class ViewAllBatAdminFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batimentsAdmin: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter

    private lateinit var batimentService: BatimentService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Crée et initialise la vue du fragment, configure la `RecyclerView`, instancie le modèle
     * et lance la récupération de la localisation de l'utilisateur.
     *
     * @return Vue complète initialisée
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_bat_admin, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batimentsAdmin = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batimentsAdmin)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllBatimentsAdmin
        )
        fragmentModel.type = "administratif"
        getUserLocation()

        return view
    }

    /**
     * Récupère la localisation actuelle de l'utilisateur (si permission accordée) et
     * déclenche la mise à jour de la liste des bâtiments administratifs via `BatimentUtils`.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            BatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsAdmin,
                filteredList,
                adapter,
                fragmentModel
            )
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des bâtiments administratifs en fonction du
     * nom saisi par l’utilisateur dans la barre de recherche.
     *
     * @param query Texte recherché
     */
    override fun onSearch(query: String) {
        filteredList =
            batimentsAdmin.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllBatEnsFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment ViewAllBatEnsFragment : Affiche la liste complète des bâtiments d’enseignement
 *
 * Description :
 * Ce fragment permet la visualisation de tous les bâtiments liés à l’enseignement
 * sur le campus universitaire. Il récupère les données depuis `BatimentService` et
 * les affiche à l’aide d’un `RecyclerView` géré par `BatimentFragmentAdapter`.
 *
 * Il utilise la géolocalisation de l’utilisateur pour calculer la distance avec
 * chaque bâtiment via `MapsUtils`, et permet une recherche dynamique sur le nom
 * des bâtiments grâce à `SearchBarFragment`.
 *
 * Composants principaux :
 * - `RecyclerView` : affiche la liste complète des bâtiments d’enseignement
 * - `FusedLocationProviderClient` : pour localiser l’utilisateur
 * - `BatimentFragmentAdapter` : adaptateur d’affichage des bâtiments
 * - `FragmentModel` : modèle contenant les informations du fragment
 * - `SearchBarFragment` : barre de recherche dynamique
 *
 * Bibliothèques utilisées :
 * - Google Play Services pour la localisation
 * - OSMDroid pour les coordonnées
 *
 * @see BatimentUtils pour le traitement des données de bâtiment
 * @see MapsUtils pour le calcul des distances géographiques
 * @see SearchBarFragment pour la recherche utilisateur
 */
class ViewAllBatEnsFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batimentsEns: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter

    private lateinit var batimentService: BatimentService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Initialise la vue du fragment, configure la localisation, le modèle de fragment
     * et déclenche la récupération des données de bâtiments d’enseignement.
     *
     * @return Vue construite pour le fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_bat_ens, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batimentsEns = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batimentsEns)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllBatimentsEns
        )
        fragmentModel.type = "enseignement"
        getUserLocation()

        return view
    }

    /**
     * Récupère la localisation actuelle de l’utilisateur pour permettre
     * le calcul de la distance entre l’utilisateur et chaque bâtiment.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            BatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsEns,
                filteredList,
                adapter,
                fragmentModel
            )
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des bâtiments affichés selon le texte
     * saisi par l’utilisateur dans la barre de recherche.
     *
     * @param query Texte recherché
     */
    override fun onSearch(query: String) {
        filteredList =
            batimentsEns.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment ViewAllInfraFragment : Affiche la liste complète des infrastructures
 *
 * Description :
 * Ce fragment permet d’afficher toutes les infrastructures présentes sur le campus
 * universitaire. Il récupère les données via `InfrastructureService` et utilise
 * `InfraFragmentAdapter` pour les présenter sous forme de liste.
 *
 * Il calcule dynamiquement la distance entre l’utilisateur et chaque infrastructure,
 * et permet la recherche en temps réel sur le nom des infrastructures.
 *
 * Composants principaux :
 * - RecyclerView : affichage de la liste des infrastructures
 * - FusedLocationProviderClient : localisation de l’utilisateur
 * - InfraFragmentAdapter : adaptateur des infrastructures
 * - FragmentModel : modèle de configuration du fragment
 * - SearchBarFragment : interface de recherche utilisateur
 *
 * Bibliothèques utilisées :
 * - Google Play Services : pour la géolocalisation
 * - OSMDroid : gestion des coordonnées géographiques
 *
 * @see InfraUtils pour les fonctions utilitaires liées aux infrastructures
 * @see SearchBarFragment pour la recherche interactive
 */
class ViewAllInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infras: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter

    private lateinit var infraService: InfrastructureService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Initialise la vue du fragment et configure les composants nécessaires,
     * y compris la localisation, l’adaptateur et le modèle de fragment.
     *
     * @return Vue racine du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_infra, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infras = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infras)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllInfraHome
        )
        getUserLocation()

        return view
    }

    /**
     * Récupère la position actuelle de l'utilisateur et met à jour la liste
     * des infrastructures avec la distance calculée.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infras,
                filteredList,
                adapter,
                fragmentModel
            )
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Met à jour dynamiquement la liste affichée en fonction du texte saisi.
     *
     * @param query Texte de recherche fourni par l'utilisateur
     */
    override fun onSearch(query: String) {
        filteredList = infras.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllSalleFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.SalleViewAllAdapter
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.MapsUtils
import tg.univlome.epl.utils.SalleUtils

/**
 * Fragment ViewAllSalleFragment : Affiche la liste complète des salles
 *
 * Description :
 * Ce fragment permet d'afficher toutes les salles présentes sur le campus universitaire,
 * qu'elles soient d'enseignement, d'administration ou polyvalentes. Les données sont
 * récupérées depuis `SalleUtils`, enrichies par la distance depuis l'utilisateur, et
 * affichées grâce à un `SalleViewAllAdapter`.
 *
 * Il offre également une fonctionnalité de recherche en temps réel sur le nom des salles.
 *
 * Composants principaux :
 * - SalleUtils : utilitaire pour le chargement et la mise à jour des salles
 * - SalleViewAllAdapter : adaptateur pour l'affichage des salles dans une RecyclerView
 * - FragmentModel : modèle de configuration du fragment
 * - SearchBarFragment : barre de recherche dynamique
 *
 * Bibliothèques utilisées :
 * - Google Play Services : récupération de la position GPS
 * - OSMDroid : manipulation de coordonnées géographiques
 *
 * @see SalleUtils pour la gestion des données de salle
 * @see SearchBarFragment pour les fonctionnalités de recherche utilisateur
 */
class ViewAllSalleFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var salles: MutableList<Salle>
    private lateinit var filteredList: MutableList<Salle>
    private lateinit var adapter: SalleViewAllAdapter

    private lateinit var infraService: InfrastructureService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Initialise la vue du fragment, configure les composants et déclenche
     * la récupération de la localisation de l’utilisateur.
     *
     * @return Vue racine du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_salle, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        salles = mutableListOf()
        filteredList = mutableListOf()
        adapter = SalleViewAllAdapter(salles)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllSalle
        )
        getUserLocation()

        return view
    }

    /**
     * Récupère la position actuelle de l’utilisateur et met à jour la liste des salles
     * avec les distances correspondantes.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            SalleUtils.updateSalles(userGeoPoint, salles, filteredList, adapter, fragmentModel)
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des salles selon la recherche utilisateur.
     *
     * @param query Texte de recherche fourni par l'utilisateur
     */
    override fun onSearch(query: String) {
        filteredList = salles.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\AllInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment AllInfraFragment : Affiche toutes les infrastructures sans filtrage de situation
 *
 * Description :
 * Ce fragment est chargé d’afficher la liste complète des infrastructures disponibles
 * sur le campus universitaire, quelle que soit leur situation géographique (nord ou sud).
 * Il utilise les services de géolocalisation de l’utilisateur pour afficher la distance
 * entre lui et chaque infrastructure.
 *
 * Les données sont récupérées depuis un service distant via `InfrastructureService`,
 * affichées dans une `RecyclerView`, et mises en forme avec un `Shimmer` de chargement.
 * Un champ de recherche permet un filtrage dynamique par nom d’infrastructure.
 *
 * Composants principaux :
 *  - `ShimmerFrameLayout` : animation de chargement en attendant les données
 *  - `RecyclerView` : affichage de la liste des infrastructures
 *  - `FusedLocationProviderClient` : localisation utilisateur
 *  - `InfraUtils` : traitement des données, distances, filtrage
 *
 * Bibliothèques utilisées :
 *  - Facebook Shimmer pour les effets de chargement
 *  - OSMDroid pour la manipulation des coordonnées
 *  - Google Location Services pour la localisation utilisateur
 *
 * @see InfraUtils pour la mise à jour et la logique métier
 * @see InfraFragmentAdapter pour l’affichage des infrastructures
 * @see SearchBarFragment pour la fonctionnalité de recherche dynamique
 */
class AllInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infrasAll: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter
    private lateinit var infraService: InfrastructureService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerAllInfra: ShimmerFrameLayout
    private lateinit var recyclerAllInfra: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise la vue du fragment, configure les composants UI,
     * instancie les listes et adaptateurs, puis déclenche la géolocalisation.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_all_infra, container, false)

        shimmerAllInfra = view.findViewById(R.id.shimmerAllInfra)
        recyclerAllInfra = view.findViewById(R.id.recyclerAllInfra)
        shimmerAllInfra.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infrasAll = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infrasAll)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllInfra
        )
        getUserLocation()

        return view
    }

    /**
     * Récupère la position actuelle de l’utilisateur (avec permission),
     * puis appelle `InfraUtils.updateInfrastructures()` pour charger et filtrer les données.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerAllInfra.stopShimmer()
                shimmerAllInfra.visibility = View.GONE
                recyclerAllInfra.visibility = View.VISIBLE
            }

            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infrasAll,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Effectue une recherche en temps réel dans la liste des infrastructures
     * à partir du nom saisi par l’utilisateur.
     *
     * @param query Chaîne entrée par l’utilisateur dans la barre de recherche
     */
    override fun onSearch(query: String) {
        filteredList =
            infrasAll.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\InfraActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.Intent
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.os.Bundle
import android.view.View
import android.view.ViewGroup
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import com.bumptech.glide.Glide
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import com.google.android.material.tabs.TabLayoutMediator
import org.osmdroid.config.Configuration
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import tg.univlome.epl.R
import tg.univlome.epl.adapter.ImageAdapter
import tg.univlome.epl.databinding.ActivityInfraBinding
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.ui.maps.MapsActivity
import tg.univlome.epl.utils.MapsUtils

/**
 * Activité InfraActivity : Activité de visualisation d’une infrastructure
 *
 * Description :
 * Cette activité permet d’afficher les détails complets d’une infrastructure sélectionnée.
 * Elle fournit à l’utilisateur :
 *  - Une interface descriptive contenant le nom, la situation, la distance et la description
 *  - Un affichage d’images multiples dans un carrousel avec des points d’indicateur personnalisés
 *  - Une carte miniature (`miniMap`) représentant la position de l'infrastructure
 *  - Un bouton de navigation permettant de lancer l’itinéraire dans `MapsActivity`
 *
 * Cette activité exploite l’API de localisation (`FusedLocationProviderClient`) pour détecter
 * la position de l’utilisateur, et utilise la bibliothèque OSMDroid pour afficher une carte embarquée.
 *
 * Composants principaux :
 *  - `ImageAdapter` : pour l’affichage des images de l’infrastructure
 *  - `MapsUtils` : pour la configuration de la carte miniature
 *  - `MapsActivity` : pour la navigation complète entre utilisateur et destination
 *
 * Bibliothèques utilisées :
 *  - OSMDroid (cartographie)
 *  - Glide (chargement d’images)
 *  - Google Location Services (géolocalisation)
 *  - Material Components (UI : TabLayout)
 *
 * Permissions requises :
 *  - `ACCESS_FINE_LOCATION`
 *  - `ACCESS_COARSE_LOCATION`
 *
 * @see MapsUtils.setMiniMap pour l'affichage de la carte miniature
 * @see MapsActivity pour la carte principale avec itinéraire
 * @see ImageAdapter pour l’affichage dynamique des images
 */
class InfraActivity : AppCompatActivity() {

    lateinit var ui: ActivityInfraBinding
    private lateinit var miniMap: MapView
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Point d’entrée de l’activité. Récupère les données de l’infrastructure envoyées via l’intent,
     * initialise l’interface graphique, gère le carrousel d’images, la carte miniature
     * et le bouton de navigation.
     *
     * Si les données de géolocalisation sont disponibles et les permissions accordées,
     * une mini carte est affichée avec itinéraire. Sinon, seule la destination est affichée.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        ui = ActivityInfraBinding.inflate(layoutInflater)
        setContentView(ui.root)

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)
        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        val infrastructure = intent.getSerializableExtra("infrastructure") as? Infrastructure

        // Mettre à jour l'interface utilisateur avec les données reçues

        val images = infrastructure?.images ?: emptyList()

        if (images.size <= 1) {
            ui.imageContainer.visibility = View.GONE
        } else {
            ui.imageContainer.visibility = View.VISIBLE
            val viewPager = ui.imagePager
            val tabLayout = ui.imageIndicator

            // Déplacer la première image à la fin de la liste
            val mainImage = infrastructure?.image
            val reorderedImages = (images.filter { it != mainImage }) + mainImage

            viewPager.adapter = ImageAdapter(reorderedImages as List<String>)

            TabLayoutMediator(tabLayout, viewPager) { _, _ -> }.attach()

            for (i in 0 until tabLayout.tabCount) {
                val tabView = (tabLayout.getChildAt(0) as ViewGroup).getChildAt(i)
                val params = tabView.layoutParams as ViewGroup.MarginLayoutParams

                // Définition de la taille des points
                params.width = resources.getDimensionPixelSize(R.dimen.custom_dot_width)
                params.height = resources.getDimensionPixelSize(R.dimen.custom_dot_height)

                // Définition des marges entre les points
                params.setMargins(
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0,
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0
                )

                tabView.layoutParams = params
            }
        }

        if (infrastructure != null) {
            ui.txtNomInfra.text = infrastructure.nom
            ui.situationInfra.text = infrastructure.situation
            ui.txtDistance.text = infrastructure.distance
            ui.desc.text = infrastructure.description
            if (!infrastructure.image.isNullOrEmpty()) {
                Glide.with(this)
                    .asBitmap()
                    .load(infrastructure.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable =
                                android.graphics.drawable.BitmapDrawable(resources, resource)
                            ui.imgInfra.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                ui.imgInfra.setImageResource(infrastructure.icon)
            }
            if (!infrastructure.latitude.isNullOrBlank() && !infrastructure.longitude.isNullOrBlank()) {
                val latitude = infrastructure.latitude.toDouble()
                val longitude = infrastructure.longitude.toDouble()

                ui.aller.setOnClickListener {
                    MapsUtils.saveDestination(this, GeoPoint(latitude, longitude))
                    val intent = Intent(this, MapsActivity::class.java)
                    ui.aller.context.startActivity(intent)
                }

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    != PackageManager.PERMISSION_GRANTED
                ) {

                    requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
                    return
                }

                miniMap = ui.miniMap

                // Fallback si la localisation n'est pas disponible
                val destination = GeoPoint(latitude, longitude)
                var userLocation: GeoPoint? = null

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    == PackageManager.PERMISSION_GRANTED
                ) {

                    fusedLocationClient.lastLocation.addOnSuccessListener { location ->
                        location?.let {
                            userLocation = GeoPoint(it.latitude, it.longitude)
                            setupMiniMap(userLocation!!, destination)
                        } ?: run {
                            // Si la localisation n'est pas disponible, utiliser seulement la destination
                            setupMiniMap(destination, destination)
                        }
                    }.addOnFailureListener {
                        // En cas d'échec, utiliser seulement la destination
                        setupMiniMap(destination, destination)
                    }
                } else {
                    // Sans permission, utiliser seulement la destination
                    setupMiniMap(destination, destination)
                }
            } else {
                // Affiche un message ou fais une action par défaut
                ui.aller.visibility = View.GONE
                ui.miniMapLayout.visibility = View.GONE
            }

        }

        ui.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }
    }

    /**
     * Configure la carte miniature (`miniMap`) en affichant l’itinéraire entre la position actuelle
     * de l’utilisateur et l’infrastructure.
     *
     * @param start Position de départ (utilisateur ou fallback)
     * @param end Position de destination (infrastructure)
     *
     * @requiresPermission Manifest.permission.ACCESS_FINE_LOCATION
     * @requiresPermission Manifest.permission.ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun setupMiniMap(start: GeoPoint, end: GeoPoint) {
        // Postpone pour s'assurer que la vue est bien layoutée
        ui.miniMapLayout.visibility = View.VISIBLE
        ui.miniMap.post {
            MapsUtils.setMiniMap(miniMap, start, end, this, this, resources)
            // Forcer un recalcul des dimensions
            miniMap.invalidate()
            miniMap.requestLayout()
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\InfraFragment.kt 
=============================================== 
package tg.univlome.epl.ui.infrastructure

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.AnimationUtils
import android.widget.LinearLayout
import androidx.appcompat.app.AppCompatActivity
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment InfraFragment : Fragment de navigation des infrastructures du campus
 *
 * Description :
 * Ce fragment permet à l’utilisateur de filtrer les infrastructures universitaires
 * selon leur position géographique :
 *  - Toutes les infrastructures
 *  - Infrastructures situées au Campus Nord
 *  - Infrastructures situées au Campus Sud
 *
 * Chaque filtre déclenche dynamiquement l’affichage d’un sous-fragment correspondant
 * (ex : `AllInfraFragment`, `NordInfraFragment`, `SudInfraFragment`) dans le conteneur central.
 * La navigation est enrichie par un indicateur visuel animé qui signale l’élément actif.
 *
 * Composants principaux :
 *  - `LinearLayout` pour les onglets de navigation (nav_all, nav_nord, nav_sud)
 *  - `View` servant d’indicateur actif pour chaque onglet
 *  - `Fragment` chargé dynamiquement dans `infra_container`
 *  - Animation `scale` appliquée à l’indicateur actif
 *
 * Bibliothèques utilisées :
 *  - AndroidX Fragment
 *  - Android AnimationUtils (animation personnalisée de l’indicateur)
 *
 * @see AllInfraFragment pour l’affichage global
 * @see NordInfraFragment pour les infrastructures du campus nord
 * @see SudInfraFragment pour les infrastructures du campus sud
 */
class InfraFragment : Fragment() {

    private var currentSelectedNav: View? = null
    private var currentIndicator: View? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée et retourne la vue racine du fragment à partir du fichier `fragment_infra.xml`.
     *
     * @return Vue contenant les boutons de navigation et le conteneur dynamique
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_infra, container, false)
    }

    /**
     * Initialise les éléments de navigation par défaut et configure les écouteurs
     * pour les sections "Tout", "Nord" et "Sud".
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // Par défaut, "Tout" est sélectionné
        val allNav = view.findViewById<LinearLayout>(R.id.nav_all)
        val allIndicator = view.findViewById<View>(R.id.indicator_all)
        currentSelectedNav = allNav
        currentIndicator = allIndicator
        loadFragment(AllInfraFragment())

        // Configurer les listeners pour chaque élément de navigation
        setupNavItem(view, R.id.nav_all, R.id.indicator_all) {
            loadFragment(AllInfraFragment())
        }

        setupNavItem(view, R.id.nav_nord, R.id.indicator_nord) {
            loadFragment(NordInfraFragment())
        }

        setupNavItem(view, R.id.nav_sud, R.id.indicator_sud) {
            loadFragment(SudInfraFragment())
        }
    }

    /**
     * Initialise un élément de navigation cliquable avec son indicateur et son action associée.
     *
     * @param view Vue racine du fragment
     * @param navItemId ID du bouton de navigation
     * @param indicatorId ID de l’indicateur visuel
     * @param action Action à exécuter lors du clic (chargement du fragment correspondant)
     */
    private fun setupNavItem(view: View, navItemId: Int, indicatorId: Int, action: () -> Unit) {
        val navItem = view.findViewById<LinearLayout>(navItemId)
        val indicator = view.findViewById<View>(indicatorId)

        navItem.setOnClickListener {
            // Si c'est déjà l'élément sélectionné, ne rien faire
            if (currentSelectedNav == navItem) return@setOnClickListener

            // Désélectionner l'élément précédent
            currentIndicator?.visibility = View.INVISIBLE

            // Sélectionner le nouvel élément
            indicator.visibility = View.VISIBLE
            animateIndicator(indicator)
            currentSelectedNav = navItem
            currentIndicator = indicator

            // Exécuter l'action associée à cet élément
            action()
        }
    }

    /**
     * Lance une animation de type "scale" sur l’indicateur sélectionné
     * pour améliorer la perception visuelle de la navigation.
     *
     * @param indicator Indicateur à animer
     */
    private fun animateIndicator(indicator: View) {
        // Charger l'animation
        val scaleAnimation = AnimationUtils.loadAnimation(context, R.anim.indicator_scale)

        // Appliquer l'animation à l'indicateur
        indicator.startAnimation(scaleAnimation)
    }

    /**
     * Remplace dynamiquement le contenu du conteneur `infra_container` par le fragment fourni.
     *
     * @param fragment Fragment à charger dynamiquement dans l’interface
     */
    private fun loadFragment(fragment: Fragment) {
        (requireActivity() as AppCompatActivity).supportFragmentManager.beginTransaction()
            .replace(R.id.infra_container, fragment)
            .commit()
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\NordInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment NordInfraFragment : Affiche les infrastructures situées au nord du campus
 *
 * Description :
 * Ce fragment permet d’afficher dynamiquement toutes les infrastructures localisées
 * sur le campus nord. Les données sont chargées à partir de `InfraUtils`, enrichies
 * avec la distance depuis la localisation actuelle de l’utilisateur et affichées
 * à l’aide d’un `InfraFragmentAdapter`.
 *
 * Il inclut également une barre de recherche permettant un filtrage en temps réel.
 * Un effet Shimmer est utilisé durant le chargement pour améliorer l’expérience utilisateur.
 *
 * Composants principaux :
 * - InfraUtils : utilitaire de chargement et filtrage des infrastructures
 * - InfraFragmentAdapter : adaptateur pour l’affichage dans la RecyclerView
 * - FragmentModel : modèle d’interaction entre la vue, le contexte et le cycle de vie
 *
 * Bibliothèques utilisées :
 * - Google Play Services : récupération de la géolocalisation
 * - OSMDroid : manipulation de coordonnées GPS
 * - Facebook Shimmer : effet de chargement visuel
 *
 * @see InfraUtils pour la logique métier et la mise à jour des données
 * @see SearchBarFragment pour la gestion de la recherche utilisateur
 */
class NordInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infrasNord: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter
    private lateinit var infraService: InfrastructureService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerNordInfra: ShimmerFrameLayout
    private lateinit var recyclerNordInfra: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise et retourne la vue du fragment,
     * prépare les composants et déclenche la localisation utilisateur.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_nord_infra, container, false)

        shimmerNordInfra = view.findViewById(R.id.shimmerNordInfra)
        recyclerNordInfra = view.findViewById(R.id.recyclerNordInfra)
        shimmerNordInfra.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infrasNord = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infrasNord)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerNordInfra,
            "nord"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la géolocalisation de l’utilisateur et appelle
     * InfraUtils pour charger les infrastructures du campus nord.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerNordInfra.stopShimmer()
                shimmerNordInfra.visibility = View.GONE
                recyclerNordInfra.visibility = View.VISIBLE
            }

            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infrasNord,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Met à jour dynamiquement la liste affichée selon le texte saisi dans la barre de recherche.
     *
     * @param query Chaîne de caractères à rechercher dans les noms d'infrastructures
     */
    override fun onSearch(query: String) {
        filteredList =
            infrasNord.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\SudInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment SudInfraFragment : Affiche les infrastructures du campus sud
 *
 * Description :
 * Ce fragment permet de lister dynamiquement toutes les infrastructures situées sur
 * le **campus sud**. Il s’appuie sur les services de géolocalisation pour calculer
 * la distance entre l’utilisateur et chaque infrastructure, et affiche les résultats
 * dans une `RecyclerView` accompagnée d’un effet Shimmer pendant le chargement.
 *
 * Il intègre également une barre de recherche via `SearchBarFragment` pour permettre
 * un filtrage en temps réel.
 *
 * Composants principaux :
 * - `InfraUtils` : Fournit les méthodes de récupération, filtrage et mise à jour des données
 * - `InfraFragmentAdapter` : Adaptateur pour l’affichage des infrastructures
 * - `FragmentModel` : Modèle contenant le contexte, la vue, l’activité, etc.
 *
 * Bibliothèques utilisées :
 * - Google Play Services (`FusedLocationProviderClient`) : géolocalisation de l’utilisateur
 * - OSMDroid : manipulation des coordonnées géographiques
 * - Facebook Shimmer : effet de chargement visuel avant l’affichage des données
 *
 * @see InfraUtils pour le traitement des infrastructures
 * @see SearchBarFragment pour la gestion de la recherche dynamique
 */
class SudInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infrasSud: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter
    private lateinit var infraService: InfrastructureService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerSudInfra: ShimmerFrameLayout
    private lateinit var recyclerSudInfra: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée et retourne la vue du fragment.
     * Initialise les composants visuels et déclenche la récupération de la position utilisateur.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_sud_infra, container, false)

        shimmerSudInfra = view.findViewById(R.id.shimmerSudInfra)
        recyclerSudInfra = view.findViewById(R.id.recyclerSudInfra)
        shimmerSudInfra.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infrasSud = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infrasSud)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerSudInfra,
            "sud"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la localisation de l'utilisateur.
     * Appelle `InfraUtils.updateInfrastructures` pour charger les données du campus sud.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerSudInfra.stopShimmer()
                shimmerSudInfra.visibility = View.GONE
                recyclerSudInfra.visibility = View.VISIBLE
            }

            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infrasSud,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre les infrastructures affichées selon une recherche textuelle.
     *
     * @param query Texte à rechercher
     */
    override fun onSearch(query: String) {
        filteredList =
            infrasSud.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\maps\MapsActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.maps

import android.Manifest
import android.annotation.SuppressLint
import android.content.Context
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.location.Location
import android.location.LocationListener
import android.location.LocationManager
import android.os.Bundle
import android.os.Handler
import android.os.Looper
import android.util.Log
import android.view.View
import android.widget.Toast
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.config.Configuration
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Polyline
import org.osmdroid.views.overlay.ScaleBarOverlay
import org.osmdroid.views.overlay.compass.CompassOverlay
import org.osmdroid.views.overlay.mylocation.MyLocationNewOverlay
import tg.univlome.epl.R
import tg.univlome.epl.databinding.ActivityMapsBinding
import tg.univlome.epl.models.Lieu
import tg.univlome.epl.models.Salle
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.utils.MapsUtils
import java.io.IOException

class MapsActivity : AppCompatActivity(), LocationListener {

    private lateinit var binding: ActivityMapsBinding

    private lateinit var mapView: MapView
    private lateinit var locationOverlay: MyLocationNewOverlay
    private val client = OkHttpClient()

    private lateinit var batimentService: BatimentService
    private lateinit var infrastructureService: InfrastructureService
    private lateinit var salleService: SalleService

    private lateinit var locationManager: LocationManager
    private var currentPolyline: Polyline? = null
    private var lastLocation: Location? = null

    // Déclaration des variables globales
    private var userLocation: GeoPoint? = null
    private var destination: GeoPoint? = null

    private val markerList = mutableListOf<Marker>()
    private var currentUserMarker: Marker? = null
    private var currentDestinationMarker: Marker? = null
    private var preDestinationIcon: Drawable? = null
    private var isNightMode = false
    private var isOtherMarkersHidden = true
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMapsBinding.inflate(layoutInflater)
        setContentView(binding.root)

        loadMapData()
    }

    private fun loadMapData() {
        // Initialiser mapView en premier
        mapView = binding.mapView

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        destination = MapsUtils.loadDestination(this)

        // Initialisation du service Firebase
        batimentService = BatimentService(this)
        infrastructureService = InfrastructureService(this)
        //salleService = SalleService()
        salleService = SalleService(this)

        //mapView = binding.mapView
        mapView.setTileSource(TileSourceFactory.MAPNIK)
        mapView.setMultiTouchControls(true)

        val prefs = getSharedPreferences("map_state", 0)
        val latitude = prefs.getString("latitude", "6.1375")!!.toDouble()
        val longitude = prefs.getString("longitude", "1.2123")!!.toDouble()
        val zoom = prefs.getFloat("zoom", 17.0f)
        isNightMode = prefs.getBoolean("isNightMode", false)

        val savedPoint = GeoPoint(latitude, longitude)
        mapView.controller.setZoom(zoom.toDouble())
        mapView.controller.setCenter(savedPoint)

        // Ajouter une boussole
        val compassOverlay = CompassOverlay(this, mapView)
        compassOverlay.enableCompass()
        mapView.overlays.add(compassOverlay)

        // Ajouter une barre d'échelle
        val scaleBarOverlay = ScaleBarOverlay(mapView)
        scaleBarOverlay.setScaleBarOffset(130, 20) // Ajuster la position sur l'écran
        mapView.overlays.add(scaleBarOverlay)

        // Charger les données depuis Firebase et les afficher sur la carte
        loadLieux()

        if (ActivityCompat.checkSelfPermission(
                this,
                Manifest.permission.ACCESS_FINE_LOCATION
            ) != PackageManager.PERMISSION_GRANTED
        ) {
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1)
        } else {
            binding.root.post {
                initLocationOverlay()
                initLocationTracking()
            }
        }

        binding.focusLocation.setOnClickListener {
            userLocation?.let {
                mapView.controller.animateTo(it)
            } ?: Toast.makeText(this, "Position actuelle inconnue", Toast.LENGTH_SHORT).show()
        }

        binding.focusDestination.setOnClickListener {
            if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                destination?.let {
                    mapView.controller.animateTo(it)
                } ?: Toast.makeText(this, "Destination inconnue", Toast.LENGTH_SHORT).show()
            } else {
                Toast.makeText(this, "Destination inconnue", Toast.LENGTH_SHORT).show()
            }
        }

        binding.themeIcon.setOnClickListener {
            isNightMode = !isNightMode
            mapView.setTileSource(
                if (isNightMode) TileSourceFactory.WIKIMEDIA else TileSourceFactory.MAPNIK
            )
            mapView.invalidate()
        }

        binding.hide.setOnClickListener {
            if (isOtherMarkersHidden) {
                reloadOtherMarker()
            } else {
                hideOtherMarkers()
            }
        }

        binding.recharger.setOnClickListener {
            reloadPreDestinationIcon()
            destination = null
            MapsUtils.clearDestination(this)
            currentPolyline?.let { mapView.overlays.remove(it) }
            currentPolyline = null
            mapView.controller.setCenter(userLocation ?: GeoPoint(6.1375, 1.2123))
            mapView.invalidate()
            loadLieux()
        }

        binding.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }

    }

    @SuppressLint("MissingPermission")
    private fun initLocationTracking() {
        locationManager = getSystemService(LocationManager::class.java)
        val isLocationEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)
        if (!isLocationEnabled) {
            Toast.makeText(this, "Veuillez activer la localisation", Toast.LENGTH_SHORT).show()
        } else {
            locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 3000, 10f, this)
        }
    }

    override fun onLocationChanged(location: Location) {
        runOnUiThread {
            try {
                userLocation = GeoPoint(location.latitude, location.longitude)
                addMarkerUserLocation()

                if (userLocation != null && (lastLocation == null || location.distanceTo(
                        lastLocation!!
                    ) > 3)
                ) {
                    lastLocation = location
                    if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                        if (markerList.isNotEmpty()) {
                            updateRoute(userLocation!!, destination!!)
                        }
                    }
                }
            } catch (e: Exception) {
                Log.e("MapsActivity", "Erreur dans onLocationChanged", e)
            }
        }
    }

    private fun loadLieux() {
        removeAllMarkers()

        // Charger les bâtiments
        batimentService.getBatiments().observe(this) { batiments ->
            if (batiments != null) {
                for (batiment in batiments) {
                    ajouterLieuSurCarte(batiment)
                }
            }
        }

        // Charger les infrastructures
        infrastructureService.getInfrastructures().observe(this) { infrastructures ->
            if (infrastructures != null) {
                for (infrastructure in infrastructures) {
                    ajouterLieuSurCarte(infrastructure)
                }
            }
        }

        // Charger les salles
        salleService.getSalles().observe(this) { salles ->
            if (salles != null) {
                for (salle in salles) {
                    ajouterLieuSurCarte(salle)
                }
            }
        }
    }

    private fun ajouterLieuSurCarte(lieu: Lieu) {
        if (lieu.latitude.isNotEmpty() && lieu.longitude.isNotEmpty()) {
            try {
                val lat = lieu.latitude.toDouble()
                val lon = lieu.longitude.toDouble()
                val position = GeoPoint(lat, lon)

                // Déterminer l'image à afficher selon le type de lieu
                val icon = when (lieu) {
                    is tg.univlome.epl.models.Batiment -> R.drawable.batiment_nav_icon
                    is tg.univlome.epl.models.Infrastructure -> R.drawable.infra_nav_icon
                    is Salle -> R.drawable.salle_nav_icon
                    else -> R.drawable.default_marker
                }

                //addMarker(position, lieu.nom, icon, lieu.image)
                // CACHER LES MARQUEURS A CE NIVEAU
                var marker = addMarker(position, lieu.nom, icon, lieu.image)
                if (marker!!.position != userLocation && marker!!.position != destination) {
                    mapView.overlays.remove(marker)
                }
            } catch (e: NumberFormatException) {
                Log.e("MapsActivity", "Coordonnées invalides pour ${lieu.nom}")
            }
        }
    }

    private fun initLocationOverlay() {
        binding.locationProgressBar.visibility = View.VISIBLE
        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)

        // Vérification de la permission
        if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION)
            == PackageManager.PERMISSION_GRANTED
        ) {

            // Essai rapide via FusedLocationProviderClient
            fusedLocationClient.lastLocation
                .addOnSuccessListener { location ->
                    if (location != null) {
                        val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                        userLocation = userGeoPoint

                        mapView.controller.setCenter(userLocation)
                        addMarkerUserLocation()

                        destination = MapsUtils.loadDestination(this)
                        if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                            updateRoute(userLocation!!, destination!!)
                        }

                        binding.locationProgressBar.visibility = View.GONE

                    } else {
                        // Fallback GPS si lastLocation est null
                        startGPSLocation()
                    }
                }
                .addOnFailureListener { e ->
                    Toast.makeText(this, "Erreur de localisation : ${e.message}", Toast.LENGTH_LONG)
                        .show()
                    binding.locationProgressBar.visibility = View.GONE
                }

        } else {
            // Demande de permission si elle n'est pas accordée
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
        }
    }

    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun startGPSLocation() {
        val locationManager = this.getSystemService(LOCATION_SERVICE) as LocationManager
        val provider = LocationManager.GPS_PROVIDER

        locationManager.requestSingleUpdate(provider, object : LocationListener {
            override fun onLocationChanged(location: Location) {
                val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                userLocation = userGeoPoint

                mapView.controller.setCenter(userLocation)
                addMarkerUserLocation()

                destination = MapsUtils.loadDestination(this@MapsActivity)
                if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                    updateRoute(userLocation!!, destination!!)
                }

                binding.locationProgressBar.visibility = View.GONE
            }

            @Deprecated("Deprecated in Java")
            override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) {
            }

            override fun onProviderEnabled(provider: String) {}
            override fun onProviderDisabled(provider: String) {}
        }, null)
    }

    private fun updateRoute(userLocation: GeoPoint, userDestination: GeoPoint) {
        addMarkerUserLocation(userLocation)

        if (userDestination == null || userDestination == GeoPoint(0.0, 0.0)) {
            Log.e("MapsActivity", "Destination is null or {0,0}, cannot update route")
            return
        }

        currentPolyline?.let { mapView.overlays.remove(it) }

        updateDestination(userDestination)
        getRoute(userLocation, userDestination)
    }

    private fun addMarker(
        position: GeoPoint,
        title: String,
        icon: Int = R.drawable.default_marker,
        imageUrl: String? = null
    ): Marker? {
        if (mapView == null) {
            Log.w(
                "MapsActivity",
                "mapView n'est pas encore initialisé. Nouvelle tentative dans 200 ms..."
            )
            Handler(Looper.getMainLooper()).postDelayed({
                addMarker(position, title, icon, imageUrl)
            }, 200)
            return null
        }

        var oldMarker: Marker? = null

        for (marker in markerList) {
            if (marker.position == position && marker.title == title) {
                oldMarker = marker
                mapView.overlays.remove(oldMarker)
            }
        }
        if (oldMarker != null) {
            markerList.remove(oldMarker)
        }

        if (mapView == null) {
            Log.e("MapsActivity", "MapView est nul. Impossible d'ajouter un marqueur.")
            return null
        }

        Log.d("MapsActivity", "Ajout du marqueur: $title à $position")
        val marker = Marker(mapView)
        marker.position = position
        marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
        marker.title = title

        if (!imageUrl.isNullOrEmpty()) {
            Glide.with(this)
                .asBitmap()
                .load(imageUrl)
                .into(object : CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: Transition<in Bitmap>?
                    ) {
                        val drawable = BitmapDrawable(resources, resource)
                        marker.image = drawable
                        mapView.invalidate()
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        }

        val resizedDrawable = MapsUtils.resizeIcon(icon, resources)
        marker.icon = resizedDrawable

        mapView.overlays.add(marker)
        mapView.invalidate()

        markerList.add(marker)
        return marker
    }

    private fun removeAllMarkers() {
        for (marker in markerList) {
            mapView.overlays.remove(marker)
        }
        markerList.clear()
        mapView.invalidate()
    }

    private fun hideOtherMarkers() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.remove(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = true
        binding.hide.setImageResource(R.drawable.no_hide)
    }

    private fun reloadOtherMarker() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.add(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = false
        binding.hide.setImageResource(R.drawable.hide)
    }

    private fun getRoute(start: GeoPoint, end: GeoPoint) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                Log.e(
                    "MapsActivity",
                    "Erreur lors de la récupération de l'itinéraire : ${e.message}"
                )
                runOnUiThread {
                    Toast.makeText(
                        this@MapsActivity,
                        "Impossible de récupérer l'itinéraire",
                        Toast.LENGTH_LONG
                    ).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                if (response.isSuccessful) {
                    response.body?.string()?.let { jsonString ->
                        try {
                            val jsonObject = JSONObject(jsonString)
                            val features = jsonObject.getJSONArray("features")
                            if (features.length() > 0) {
                                val geometry = features.getJSONObject(0).getJSONObject("geometry")
                                val coordinates = geometry.getJSONArray("coordinates")

                                val geoPoints = mutableListOf<GeoPoint>()
                                for (i in 0 until coordinates.length()) {
                                    val coord = coordinates.getJSONArray(i)
                                    val lon = coord.getDouble(0)
                                    val lat = coord.getDouble(1)
                                    geoPoints.add(GeoPoint(lat, lon))
                                }

                                runOnUiThread {
                                    currentPolyline = Polyline()
                                    currentPolyline!!.setPoints(geoPoints)
                                    currentPolyline!!.outlinePaint.color =
                                        resources.getColor(R.color.mainColor, null)
                                    currentPolyline!!.outlinePaint.strokeWidth = 5f

                                    mapView.overlays.add(currentPolyline)
                                    mapView.invalidate()
                                }
                            }
                        } catch (e: JSONException) {
                            Log.e("MapsActivity", "Erreur JSON: ${e.message}")
                        }
                    }
                } else {
                    Log.e("MapsActivity", "Erreur dans la réponse de l'API de routage")
                }
            }
        })
    }

    private fun addMarkerUserLocation(userLocation: GeoPoint? = this.userLocation) {
        if (mapView == null || userLocation == null) {
            Log.w("MapsActivity", "Conditions non remplies pour ajouter le marqueur de position")
            return
        }

        currentUserMarker?.let {
            mapView.overlays.remove(it)
            markerList.remove(it)
        }

        currentUserMarker =
            addMarker(userLocation, "Ma position actuelle", R.drawable.maps_and_flags)
    }

    private fun updateDestination(destination: GeoPoint) {
        var find = false
        reloadPreDestinationIcon()
        if (markerList.isNotEmpty()) {
            for (marker in markerList) {
                if (marker.position == destination) {
                    find = true
                    preDestinationIcon = marker.icon
                    marker.icon = MapsUtils.resizeIcon(R.drawable.destination, resources)
                    currentDestinationMarker = marker
                    mapView.invalidate()
                    break
                }
            }
        }
    }

    private fun reloadPreDestinationIcon() {
        currentDestinationMarker?.icon = preDestinationIcon
        mapView.invalidate()
    }

    override fun onResume() {
        super.onResume()
        mapView.onResume()
    }

    override fun onPause() {
        super.onPause()
        try {
            locationManager.removeUpdates(this)
        } catch (e: Exception) {
            Log.w("MapsActivity", "Erreur lors de l'arrêt des mises à jour de localisation", e)
        }

        val prefs = getSharedPreferences("map_state", 0)
        val editor = prefs.edit()

        val mapCenter = mapView.mapCenter as GeoPoint
        val zoomLevel = mapView.zoomLevelDouble

        editor.putString("latitude", mapCenter.latitude.toString())
        editor.putString("longitude", mapCenter.longitude.toString())
        editor.putFloat("zoom", zoomLevel.toFloat())
        editor.putBoolean("isNightMode", isNightMode)

        editor.apply()
        mapView.onPause()
    }

    override fun onDestroy() {
        super.onDestroy()
        removeAllMarkers()
    }

    override fun onRequestPermissionsResult(
        requestCode: Int,
        permissions: Array<out String>,
        grantResults: IntArray
    ) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults)
        if (requestCode == 1) {
            if (grantResults.isNotEmpty() && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                initLocationOverlay()
                initLocationTracking()
            } else {
                Toast.makeText(this, "Permission de localisation refusée.", Toast.LENGTH_LONG)
                    .show()
            }
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\maps\MapsFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.maps

import android.Manifest
import android.annotation.SuppressLint
import android.content.Context
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.location.Location
import android.location.LocationListener
import android.location.LocationManager
import android.os.Bundle
import android.os.Handler
import android.os.Looper
import android.util.Log
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.DecelerateInterpolator
import android.widget.Toast
import androidx.annotation.RequiresPermission
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import androidx.fragment.app.Fragment
import androidx.lifecycle.Observer
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.config.Configuration
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Polyline
import org.osmdroid.views.overlay.ScaleBarOverlay
import org.osmdroid.views.overlay.compass.CompassOverlay
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.databinding.FragmentMapsBinding
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.Lieu
import tg.univlome.epl.models.Salle
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.MapsUtils
import java.io.IOException

class MapsFragment : Fragment(), SearchBarFragment.SearchListener, LocationListener {
    private var _binding: FragmentMapsBinding? = null
    private val binding get() = _binding!!

    private lateinit var mapView: MapView
    private val client = OkHttpClient()

    private lateinit var batimentService: BatimentService
    private lateinit var infrastructureService: InfrastructureService
    private lateinit var salleService: SalleService

    private lateinit var locationManager: LocationManager
    private var currentPolyline: Polyline? = null
    private var lastLocation: Location? = null

    // Déclaration des variables globales
    private var userLocation: GeoPoint? = null
    private var destination: GeoPoint? = null

    private val markerList = mutableListOf<Marker>()
    private var currentUserMarker: Marker? = null
    private var currentDestinationMarker: Marker? = null
    private var preDestinationIcon: Drawable? = null
    private var isNightMode = false
    private var isOtherMarkersHidden = false
    private val tousLesLieux = mutableListOf<Lieu>()
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        _binding = FragmentMapsBinding.inflate(inflater, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        loadMapData(view)
    }

    private fun loadMapData(view: View) {
        // Initialiser mapView en premier
        mapView = binding.mapView

        Configuration.getInstance()
            .load(requireContext(), requireActivity().getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = requireActivity().packageName

        if (isAdded && isVisible && context != null && activity != null) { // Ajout de vérifs
            activity?.runOnUiThread {
                context?.let { ctx ->
                    destination = MapsUtils.loadDestination(requireContext())
                }
            }
        }

        // Initialisation du service Firebase
        batimentService = BatimentService(requireContext())
        infrastructureService = InfrastructureService(requireContext())
        salleService = SalleService(requireContext())

        mapView.setTileSource(TileSourceFactory.MAPNIK)
        mapView.setMultiTouchControls(true)

        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val latitude = prefs.getString("latitude", "6.1375")!!.toDouble()
        val longitude = prefs.getString("longitude", "1.2123")!!.toDouble()
        val zoom = prefs.getFloat("zoom", 17.0f)
        isNightMode = prefs.getBoolean("isNightMode", false)

        val savedPoint = GeoPoint(latitude, longitude)
        mapView.controller.setZoom(zoom.toDouble())
        mapView.controller.setCenter(savedPoint)

        // Ajouter une boussole
        val compassOverlay = CompassOverlay(requireActivity(), mapView)
        compassOverlay.enableCompass()
        mapView.overlays.add(compassOverlay)

        // Ajouter une barre d'échelle
        val scaleBarOverlay = ScaleBarOverlay(mapView)
        scaleBarOverlay.setScaleBarOffset(130, 20) // Ajuster la position sur l'écran
        mapView.overlays.add(scaleBarOverlay)

        // Charger les données depuis Firebase et les afficher sur la carte
        loadLieux()

        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            ) != PackageManager.PERMISSION_GRANTED
        ) {
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1)
        } else {
            view.post {
                initLocationOverlay()
                initLocationTracking()
            }
        }

        binding.focusLocation.setOnClickListener {
            userLocation?.let {
                mapView.controller.animateTo(it)
            } ?: Toast.makeText(requireContext(), "Position actuelle inconnue", Toast.LENGTH_SHORT)
                .show()
        }

        binding.focusDestination.setOnClickListener {
            if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                destination?.let {
                    mapView.controller.animateTo(it)
                } ?: Toast.makeText(requireContext(), "Destination inconnue", Toast.LENGTH_SHORT)
                    .show()
            } else {
                Toast.makeText(requireContext(), "Destination inconnue", Toast.LENGTH_SHORT).show()
            }
        }

        binding.themeIcon.setOnClickListener {
            isNightMode = !isNightMode
            mapView.setTileSource(
                if (isNightMode) TileSourceFactory.WIKIMEDIA else TileSourceFactory.MAPNIK
            )
            mapView.invalidate()
        }

        binding.hide.setOnClickListener {
            if (isOtherMarkersHidden) {
                reloadOtherMarker()
            } else {
                hideOtherMarkers()
            }
        }

        binding.recharger.setOnClickListener {
            reloadPreDestinationIcon()
            destination = null
            MapsUtils.clearDestination(requireContext())
            hideDestinationLayout()
            removeAllMarkers()
            reloadOtherMarker()
            currentPolyline?.let { mapView.overlays.remove(it) }
            currentPolyline = null
            mapView.controller.setCenter(userLocation ?: GeoPoint(6.1375, 1.2123))
            mapView.invalidate()
            binding.destinationText.text = ""
            loadLieux()
        }
    }

    @SuppressLint("MissingPermission")
    private fun initLocationTracking() {
        if (isAdded) {
            locationManager = requireActivity().getSystemService(LocationManager::class.java)
            val isLocationEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)
            if (!isLocationEnabled) {
                Toast.makeText(
                    requireContext(),
                    "Veuillez activer la localisation",
                    Toast.LENGTH_SHORT
                ).show()
            } else {
                locationManager.requestLocationUpdates(
                    LocationManager.GPS_PROVIDER,
                    3000,
                    10f,
                    this
                ) // Maj toutes les 3 sec, 10m de différence
            }
        }
    }

    override fun onLocationChanged(location: Location) {

        // Vérification si MapView est bien initialisé
        if (!isAdded || mapView == null) {
            Log.w("MapsFragment", "Fragment non attaché ou MapView null, ignore la mise à jour")
            return
        }

        activity?.runOnUiThread {
            try {
                userLocation = GeoPoint(location.latitude, location.longitude)
                addMarkerUserLocation()

                if (userLocation != null && (lastLocation == null || location.distanceTo(
                        lastLocation!!
                    ) > 3)
                ) {
                    lastLocation = location
                    if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                        if (markerList.isNotEmpty()) {
                            updateRoute(userLocation!!, destination!!)
                        }
                    }
                }
            } catch (e: Exception) {
                Log.e("MapsFragment", "Erreur dans onLocationChanged", e)
            }
        }
    }

    private fun loadLieux() {
        removeAllMarkers()
        tousLesLieux.clear()

        batimentService.getBatiments().observe(viewLifecycleOwner, Observer { batiments ->
            batiments?.let { tousLesLieux.addAll(it) }
            filtrerLieux("") // Affiche tout au départ
        })

        infrastructureService.getInfrastructures()
            .observe(viewLifecycleOwner, Observer { infrastructures ->
                infrastructures?.let { tousLesLieux.addAll(it) }
                filtrerLieux("")
            })

        salleService.getSalles().observe(viewLifecycleOwner, Observer { salles ->
            salles?.let { tousLesLieux.addAll(it) }
            filtrerLieux("")
        })
    }

    fun filtrerLieux(query: String) {
        removeAllMarkers()

        val recherche = query.lowercase().trim()

        val lieuxFiltres = if (recherche.isEmpty()) {
            tousLesLieux
        } else {
            tousLesLieux.filter { lieu ->
                lieu.nom.lowercase().contains(recherche)
            }
        }

        for (lieu in lieuxFiltres) {
            ajouterLieuSurCarte(lieu)
        }

        if (userLocation != null) {
            addMarkerUserLocation()
        }
    }

    // Nouvelle méthode pour ajouter un lieu sur la carte
    private fun ajouterLieuSurCarte(lieu: Lieu) {
        if (lieu.latitude.isNotEmpty() && lieu.longitude.isNotEmpty()) {
            try {
                val lat = lieu.latitude.toDouble()
                val lon = lieu.longitude.toDouble()
                val position = GeoPoint(lat, lon)

                // Déterminer l'image à afficher selon le type de lieu
                val icon = when (lieu) {
                    is Batiment -> R.drawable.batiment_nav_icon
                    is Infrastructure -> R.drawable.infra_nav_icon
                    is Salle -> R.drawable.salle_nav_icon
                    else -> R.drawable.default_marker
                }

                addMarker(position, lieu.nom, icon, lieu.image)  // Store the marker in the list
            } catch (e: NumberFormatException) {
                Log.e("MapsFragment", "Coordonnées invalides pour ${lieu.nom}")
            }
        }
    }

    private fun initLocationOverlay() {
        binding.locationProgressBar.visibility = View.VISIBLE
        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireContext())

        // Vérification de la permission
        if (ContextCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            == PackageManager.PERMISSION_GRANTED
        ) {

            // Essai rapide via FusedLocationProviderClient
            fusedLocationClient.lastLocation
                .addOnSuccessListener { location ->
                    if (location != null) {
                        val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                        userLocation = userGeoPoint

                        mapView.controller.setCenter(userLocation)
                        addMarkerUserLocation()

                        destination = MapsUtils.loadDestination(requireContext())
                        if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                            updateRoute(userLocation!!, destination!!)
                        }

                        binding.locationProgressBar.visibility = View.GONE

                    } else {
                        // Fallback GPS si lastLocation est null
                        startGPSLocation()
                    }
                }
                .addOnFailureListener { e ->
                    Toast.makeText(
                        requireContext(),
                        "Erreur de localisation : ${e.message}",
                        Toast.LENGTH_LONG
                    ).show()
                    binding.locationProgressBar.visibility = View.GONE
                }

        } else {
            // Demande de permission si elle n'est pas accordée
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
        }
    }

    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun startGPSLocation() {
        val locationManager =
            requireActivity().getSystemService(Context.LOCATION_SERVICE) as LocationManager
        val provider = LocationManager.GPS_PROVIDER

        locationManager.requestSingleUpdate(provider, object : LocationListener {
            override fun onLocationChanged(location: Location) {
                val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                userLocation = userGeoPoint

                mapView.controller.setCenter(userLocation)
                addMarkerUserLocation()

                destination = MapsUtils.loadDestination(requireContext())
                if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                    updateRoute(userLocation!!, destination!!)
                }

                binding.locationProgressBar.visibility = View.GONE
            }

            @Deprecated("Deprecated in Java")
            override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) {
            }

            override fun onProviderEnabled(provider: String) {}
            override fun onProviderDisabled(provider: String) {}
        }, null)
    }

    private fun updateRoute(userLocation: GeoPoint, userDestination: GeoPoint) {

        addMarkerUserLocation(userLocation!!)

        if (userDestination == null || userDestination == GeoPoint(0.0, 0.0)) {
            Log.e("MapsFragment", "Destination is null or {0,0} , cannot update route")
            return
        }

        // Vérifier currentPolyline
        currentPolyline?.let { mapView.overlays.remove(it) }

        updateDestination(userDestination!!)
        // Récupérer le nouvel itinéraire
        getRoute(userLocation, userDestination)
    }

    private fun addMarker(
        position: GeoPoint,
        title: String,
        icon: Int = R.drawable.default_marker,
        imageUrl: String? = null
    ): Marker? {

        if (!isAdded || mapView == null) {
            Log.w(
                "MapsFragment",
                "Fragment non attaché ou MapView null, impossible d'ajouter le marqueur"
            )
            return null
        }

        if (mapView == null) {
            Log.w(
                "MapsFragment",
                "mapView n'est pas encore initialisé. Nouvelle tentative dans 200 ms..."
            )
            Handler(Looper.getMainLooper()).postDelayed({
                addMarker(position, title, icon, imageUrl)
            }, 200)
            return null
        }

        var oldMarker: Marker? = null

        for (marker in markerList) {
            if (marker.position == position && marker.title == title) {
                oldMarker = marker
                mapView.overlays.remove(oldMarker)
            }
        }
        if (oldMarker != null) {
            markerList.remove(oldMarker)
        }

        if (mapView == null) {
            Log.e("MapsFragment", "MapView est nul. Impossible d'ajouter un marqueur.")
            return null
        }
        Log.d("MapsFragment", "Ajout du marqueur: $title à $position")
        val marker = Marker(mapView)
        marker.position = position
        marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
        marker.title = title
        if (!imageUrl.isNullOrEmpty()) {
            Glide.with(this)
                .asBitmap()
                .load(imageUrl)
                .into(object : CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: Transition<in Bitmap>?
                    ) {
                        if (isAdded) {
                            val drawable = BitmapDrawable(resources, resource)
                            marker.image = drawable
                            mapView.invalidate() // Rafraîchir la carte après chargement
                        }
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        }

        val resizedDrawable = MapsUtils.resizeIcon(icon, resources)

        marker.icon = resizedDrawable
        marker.setOnMarkerClickListener { clickedMarker, _ ->
            if (clickedMarker.title != binding.destinationText.text && clickedMarker.position != userLocation && clickedMarker.position != destination) {
                binding.destinationText.text = clickedMarker.title
                //binding.destinationLayout.visibility = View.VISIBLE
                showDestinationLayout()
                clickedMarker.showInfoWindow()
                binding.valider.setOnClickListener {
                    destination = clickedMarker.position
                    MapsUtils.saveDestination(requireContext(), destination!!)
                    updateRoute(userLocation!!, destination!!)
                    hideOtherMarkers()
                }
                binding.annuler.setOnClickListener {
                    hideDestinationLayout()
                }
            } else {
                clickedMarker.showInfoWindow()
            }
            true
        }

        mapView.overlays.add(marker)
        mapView.invalidate()

        markerList.add(marker)
        return marker
    }

    fun showDestinationLayout() {
        if (binding.destinationLayout.visibility != View.VISIBLE) {
            binding.destinationLayout.apply {
                visibility = View.VISIBLE
                translationX = -width.toFloat()  // commence hors de l'écran à gauche
                animate()
                    .translationX(0f)  // revient à sa position normale
                    .setDuration(300)
                    .setInterpolator(DecelerateInterpolator())
                    .start()
            }
        }
    }

    fun hideDestinationLayout() {
        if (binding.destinationLayout.visibility != View.INVISIBLE) {
            binding.destinationLayout.apply {
                translationX = width.toFloat()
                animate()
                    .setDuration(300)
                    .setInterpolator(DecelerateInterpolator())
                    .start()
            }
            binding.destinationLayout.visibility = View.INVISIBLE
        }
    }

    private fun removeAllMarkers() {
        for (marker in markerList) {
            mapView.overlays.remove(marker)
        }
        markerList.clear()  // Optionally, clear the list after removal
        mapView.invalidate()  // Refresh the map
    }

    private fun hideOtherMarkers() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.remove(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = true
        binding.hide.setImageResource(R.drawable.no_hide)
    }

    private fun reloadOtherMarker() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.add(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = false
        binding.hide.setImageResource(R.drawable.hide)
    }

    private fun getRoute(start: GeoPoint, end: GeoPoint) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                Log.e(
                    "MapsFragment",
                    "Erreur lors de la récupération de l'itinéraire : ${e.message}"
                )
                requireActivity().runOnUiThread {
                    Toast.makeText(
                        requireContext(),
                        "Impossible de récupérer l'itinéraire",
                        Toast.LENGTH_LONG
                    ).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                if (response.isSuccessful) {
                    response.body?.string()?.let { jsonString ->
                        try {
                            val jsonObject = JSONObject(jsonString)
                            val features = jsonObject.getJSONArray("features")
                            if (features.length() > 0) {
                                val geometry = features.getJSONObject(0).getJSONObject("geometry")
                                val coordinates = geometry.getJSONArray("coordinates")

                                val geoPoints = mutableListOf<GeoPoint>()
                                for (i in 0 until coordinates.length()) {
                                    val coord = coordinates.getJSONArray(i)
                                    val lon = coord.getDouble(0)
                                    val lat = coord.getDouble(1)
                                    geoPoints.add(GeoPoint(lat, lon))
                                }

                                if (isAdded) {
                                    requireActivity().runOnUiThread {
                                        currentPolyline = Polyline()
                                        currentPolyline!!.setPoints(geoPoints)
                                        currentPolyline!!.outlinePaint.color =
                                            resources.getColor(R.color.mainColor, null)
                                        currentPolyline!!.outlinePaint.strokeWidth = 5f

                                        mapView.overlays.add(currentPolyline)
                                        mapView.invalidate()
                                    }
                                }
                            }
                        } catch (e: JSONException) {
                            Log.e("MapsFragment", "Erreur JSON: ${e.message}")
                        }
                    }
                } else {
                    Log.e("MapsFragment", "Erreur dans la réponse de l'API de routage")
                }
            }
        })
    }

    private fun addMarkerUserLocation(userLocation: GeoPoint? = this.userLocation) {
        if (!isAdded || mapView == null || userLocation == null) {
            Log.w("MapsFragment", "Conditions non remplies pour ajouter le marqueur de position")
            return
        }

        // Supprimer l'ancien marqueur s'il existe
        currentUserMarker?.let {
            mapView.overlays.remove(it)
            markerList.remove(it)
        }

        currentUserMarker =
            addMarker(userLocation!!, "Ma position actuelle", R.drawable.maps_and_flags)
    }

    private fun updateDestination(destination: GeoPoint) {
        var find = false
        reloadPreDestinationIcon()
        if (markerList.isNotEmpty()) {
            for (marker in markerList) {
                if (marker.position == destination) {
                    find = true
                    preDestinationIcon = marker.icon
                    marker.icon = MapsUtils.resizeIcon(R.drawable.destination, resources)
                    currentDestinationMarker = marker
                    mapView.invalidate()
                    break
                }
            }
        }
    }

    private fun reloadPreDestinationIcon() {
        currentDestinationMarker?.icon = preDestinationIcon
        mapView.invalidate()
    }


    override fun onResume() {
        super.onResume()
        mapView.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
        (activity as MainActivity).showLogo(null)
    }

    override fun onPause() {
        super.onPause()
        try {
            locationManager.removeUpdates(this)
        } catch (e: Exception) {
            Log.w("MapsFragment", "Erreur lors de l'arrêt des mises à jour de localisation", e)
        }

        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val editor = prefs.edit()

        val mapCenter = mapView.mapCenter as GeoPoint
        val zoomLevel = mapView.zoomLevelDouble

        editor.putString("latitude", mapCenter.latitude.toString())
        editor.putString("longitude", mapCenter.longitude.toString())
        editor.putFloat("zoom", zoomLevel.toFloat())
        editor.putBoolean("isNightMode", isNightMode)

        editor.apply()
        mapView.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    override fun onDestroyView() {
        super.onDestroyView()
        removeAllMarkers()  // Supprime tous les marqueurs
        _binding = null
    }

    override fun onSearch(query: String) {
        filtrerLieux(query)
    }

    @Deprecated("Deprecated in Java")
    override fun onRequestPermissionsResult(
        requestCode: Int,
        permissions: Array<out String>,
        grantResults: IntArray
    ) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults)
        if (requestCode == 1) {
            if (grantResults.isNotEmpty() && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                initLocationOverlay()
                initLocationTracking()
            } else {
                Toast.makeText(
                    requireContext(),
                    "Permission de localisation refusée.",
                    Toast.LENGTH_LONG
                ).show()
            }
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\maps\MapsFragmentOld.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.maps

import android.Manifest
import android.annotation.SuppressLint
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.location.Location
import android.location.LocationListener
import android.location.LocationManager
import android.os.Bundle
import android.util.Log
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.Toast
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.lifecycle.Observer
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.config.Configuration
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Polyline
import org.osmdroid.views.overlay.ScaleBarOverlay
import org.osmdroid.views.overlay.compass.CompassOverlay
import org.osmdroid.views.overlay.mylocation.MyLocationNewOverlay
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.databinding.FragmentMapsBinding
import tg.univlome.epl.models.Lieu
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.SearchBarFragment
import java.io.IOException

class MapsFragmentOld : Fragment(), SearchBarFragment.SearchListener, LocationListener {

    private var _binding: FragmentMapsBinding? = null
    private val binding get() = _binding!!

    private lateinit var mapView: MapView
    private lateinit var locationOverlay: MyLocationNewOverlay
    private val client = OkHttpClient()

    private lateinit var batimentService: BatimentService
    private lateinit var infrastructureService: InfrastructureService
    private lateinit var salleService: SalleService

    private lateinit var locationManager: LocationManager
    private var currentPolyline: Polyline? = null
    private var lastLocation: Location? = null

    // Déclaration des variables globales
    private var userLocation: GeoPoint? = null
    private var destination: GeoPoint? = null

    private val markerList = mutableListOf<Marker>()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        _binding = FragmentMapsBinding.inflate(inflater, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        Configuration.getInstance()
            .load(requireContext(), requireActivity().getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = requireActivity().packageName

        // Initialisation du service Firebase
        batimentService = BatimentService(requireContext())
        infrastructureService = InfrastructureService(requireContext())
        //salleService = SalleService()
        salleService = SalleService(requireContext())

        mapView = binding.mapView
        mapView.setTileSource(TileSourceFactory.MAPNIK)
        mapView.setMultiTouchControls(true)

        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val latitude = prefs.getString("latitude", "6.1375")!!.toDouble()
        val longitude = prefs.getString("longitude", "1.2123")!!.toDouble()
        val zoom = prefs.getFloat("zoom", 17.0f)

        val savedPoint = GeoPoint(latitude, longitude)
        mapView.controller.setZoom(zoom.toDouble())
        mapView.controller.setCenter(savedPoint)

        // Ajouter une boussole
        val compassOverlay = CompassOverlay(requireActivity(), mapView)
        compassOverlay.enableCompass()
        mapView.overlays.add(compassOverlay)

        // Ajouter une barre d'échelle
        val scaleBarOverlay = ScaleBarOverlay(mapView)
        scaleBarOverlay.setScaleBarOffset(130, 20) // Ajuster la position sur l'écran
        mapView.overlays.add(scaleBarOverlay)

        // Charger les données depuis Firebase et les afficher sur la carte
        loadLieux()

        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            ) != PackageManager.PERMISSION_GRANTED
        ) {
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1)
        } else {
            view.post {
                initLocationOverlay()
                initLocationTracking()
            }
        }


        arguments?.let {
            val lat = it.getDouble("latitude", 0.0)
            val lon = it.getDouble("longitude", 0.0)
            if (lat != 0.0 && lon != 0.0) {
                destination = GeoPoint(lat, lon)
                Log.e("MapsFragment", "Destination changée: $destination")
            }
        }

    }

    @SuppressLint("MissingPermission")
    private fun initLocationTracking() {
        if (isAdded) {
            locationManager = requireActivity().getSystemService(LocationManager::class.java)
            locationManager.requestLocationUpdates(
                LocationManager.GPS_PROVIDER,
                3000,
                10f,
                this
            ) // Maj toutes les 3 sec, 10m de différence
        }
    }

    override fun onLocationChanged(location: Location) {
        userLocation = GeoPoint(location.latitude, location.longitude)

        if (userLocation != null && (lastLocation == null || location.distanceTo(lastLocation!!) > 3)) {
            lastLocation = location
            updateRoute(userLocation!!, destination!!)
        }
    }

    private fun loadLieux() {

        // Charger les bâtiments
        batimentService.getBatiments().observe(viewLifecycleOwner, Observer { batiments ->
            if (batiments != null) {
                for (batiment in batiments) {
                    ajouterLieuSurCarte(batiment)
                }
            }
        })

        // Charger les infrastructures
        infrastructureService.getInfrastructures()
            .observe(viewLifecycleOwner, Observer { infrastructures ->
                if (infrastructures != null) {
                    for (infrastructure in infrastructures) {
                        ajouterLieuSurCarte(infrastructure)
                    }
                }
            })

        // Charger les salles
        salleService.getSalles().observe(viewLifecycleOwner, Observer { salles ->
            if (salles != null) {
                for (salle in salles) {
                    ajouterLieuSurCarte(salle)
                }
            }
        })
    }

    // Nouvelle méthode pour ajouter un lieu sur la carte
    private fun ajouterLieuSurCarte(lieu: Lieu) {
        if (lieu.latitude.isNotEmpty() && lieu.longitude.isNotEmpty()) {
            try {
                val lat = lieu.latitude.toDouble()
                val lon = lieu.longitude.toDouble()
                val position = GeoPoint(lat, lon)
                markerList.add(
                    addMarker(
                        position,
                        lieu.nom,
                        lieu.image
                    )
                )  // Store the marker in the list
            } catch (e: NumberFormatException) {
                Log.e("MapsFragment", "Coordonnées invalides pour ${lieu.nom}")
            }
        }
    }

    private fun initLocationOverlay() {
        locationOverlay = MyLocationNewOverlay(mapView)
        locationOverlay.enableMyLocation()
        locationOverlay.enableFollowLocation() // Pour suivre la position en temps réel
        mapView.overlays.add(locationOverlay)

        locationOverlay.runOnFirstFix {
            userLocation = locationOverlay.myLocation
            if (isAdded) {
                requireActivity().runOnUiThread {
                    if (userLocation != null) {
                        mapView.controller.setCenter(userLocation)

                        // Définition de la destination
                        if (destination == null) {
                            destination =
                                GeoPoint(userLocation!!.latitude + 0.009, userLocation!!.longitude)
                        } else {
                            updateRoute(userLocation!!, destination!!)
                        }

                        // getRoute(userLocation!!, destination!!)
                    } else {
                        Toast.makeText(
                            requireContext(),
                            "Localisation non trouvée !",
                            Toast.LENGTH_LONG
                        ).show()
                    }
                }
            }
        }
        mapView.overlays.add(locationOverlay)
    }

    private fun updateRoute(userLocation: GeoPoint, userDestination: GeoPoint) {

        addMarker(userLocation!!, "Ma position actuelle")
        addMarker(userDestination!!, "Ma destination")

        //val destination = GeoPoint(userLocation.latitude + 0.009, userLocation.longitude) // Ex. Destination fixe

        //if (destination == null) {
        if (userDestination == null) {
            Log.e("MapsFragment", "Destination is null, cannot update route")
            return
        }

        // Vérifier currentPolyline
        currentPolyline?.let { mapView.overlays.remove(it) }

        // Récupérer le nouvel itinéraire
        //getRoute(userLocation, destination!!)
        getRoute(userLocation, userDestination!!)
    }

    private fun addMarker(position: GeoPoint, title: String, imageUrl: String? = null): Marker {
        var oldMarker = Marker(mapView)
        for (marker in markerList) {
            if (marker.position == position && marker.title == title) {
                oldMarker = marker
                mapView.overlays.remove(oldMarker)
                //return marker
            }
        }
        markerList.remove(oldMarker)

        Log.d("MapsFragment", "Ajout du marqueur: $title à $position")
        val marker = Marker(mapView)
        marker.position = position
        marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
        marker.title = title
        if (!imageUrl.isNullOrEmpty()) {
            Glide.with(this)
                .asBitmap()
                .load(imageUrl)
                .into(object : CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: Transition<in Bitmap>?
                    ) {
                        val drawable = BitmapDrawable(resources, resource)
                        marker.image = drawable
                        mapView.invalidate() // Rafraîchir la carte après chargement
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        }

        val drawable = resources.getDrawable(R.drawable.default_marker, null)
        val bitmap = (drawable as BitmapDrawable).bitmap

        // Redimensionner l'image
        val scaledBitmap =
            Bitmap.createScaledBitmap(bitmap, 40, 40, false) // Modifier la taille selon le besoin
        val resizedDrawable = BitmapDrawable(resources, scaledBitmap)

        marker.icon = resizedDrawable

        mapView.overlays.add(marker)
        mapView.invalidate()
        return marker
    }

    private fun removeAllMarkers() {
        for (marker in markerList) {
            mapView.overlays.remove(marker)
        }
        markerList.clear()  // Optionally, clear the list after removal
        mapView.invalidate()  // Refresh the map
    }

    private fun getRoute(start: GeoPoint, end: GeoPoint) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                requireActivity().runOnUiThread {
                    Toast.makeText(requireContext(), "Erreur réseau !", Toast.LENGTH_LONG).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                response.body?.string()?.let { jsonResponse ->
                    try {
                        val jsonObject = JSONObject(jsonResponse)
                        if (jsonObject.has("features")) {
                            val features = jsonObject.getJSONArray("features")
                            val geometry = features.getJSONObject(0).getJSONObject("geometry")
                            val coordinates = geometry.getJSONArray("coordinates")

                            val polyline = Polyline()
                            if (isAdded) {
                                //polyline.color = resources.getColor(android.R.color.holo_blue_dark, null)
                                polyline.color = resources.getColor(R.color.mainColor, null)
                            }

                            for (i in 0 until coordinates.length()) {
                                val coord = coordinates.getJSONArray(i)
                                val lon = coord.getDouble(0)
                                val lat = coord.getDouble(1)
                                polyline.addPoint(GeoPoint(lat, lon))
                            }

                            if (isAdded) {
                                requireActivity().runOnUiThread {
                                    currentPolyline?.let { mapView.overlays.remove(it) }
                                    currentPolyline = polyline
                                    mapView.overlays.add(polyline)
                                    mapView.invalidate()
                                }
                            }
                        } else {
                            Log.e("API_ERROR", "La clé 'features' est absente de la réponse JSON")
                        }
                    } catch (e: JSONException) {
                        Log.e("JSON_ERROR", "Erreur lors du parsing JSON: ${e.message}")
                    }
                } ?: Log.e("API_ERROR", "Réponse vide de l'API")
            }
        })
    }

    private fun filterMarkers(query: String?) {
        removeAllMarkers()

        if (query.isNullOrEmpty()) {
            loadLieux()
            return
        }

        val lowerCaseQuery = query.lowercase()

        batimentService.getBatiments().observe(viewLifecycleOwner, Observer { batiments ->
            if (batiments != null) {
                val batiments = batiments.filter { batiment ->
                    val name = batiment.nom?.lowercase() ?: ""
                    return@filter name.contains(lowerCaseQuery) || isSubsequence(
                        lowerCaseQuery,
                        name
                    )
                }
                for (batiment in batiments) {
                    ajouterLieuSurCarte(batiment)
                }
            }
        })

        infrastructureService.getInfrastructures()
            .observe(viewLifecycleOwner, Observer { infrastructures ->
                if (infrastructures != null) {
                    val infrastructures = infrastructures.filter { infrastructure ->
                        val name = infrastructure.nom?.lowercase() ?: ""
                        return@filter name.contains(lowerCaseQuery) || isSubsequence(
                            lowerCaseQuery,
                            name
                        )
                    }
                    for (infrastructure in infrastructures) {
                        ajouterLieuSurCarte(infrastructure)
                    }
                }
            })

        salleService.getSalles().observe(viewLifecycleOwner, Observer { salles ->
            if (salles != null) {
                val salles = salles.filter { salle ->
                    val name = salle.nom?.lowercase() ?: ""
                    return@filter name.contains(lowerCaseQuery) || isSubsequence(
                        lowerCaseQuery,
                        name
                    )
                }
                for (salle in salles) {
                    ajouterLieuSurCarte(salle)
                }
            }
        })

        removeAllMarkers()
        mapView.invalidate()
    }

    private fun isSubsequence(sub: String, word: String): Boolean {
        var i = 0
        var j = 0
        while (i < sub.length && j < word.length) {
            if (sub[i] == word[j]) i++
            j++
        }
        return i == sub.length
    }

    override fun onResume() {
        super.onResume()
        mapView.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    override fun onPause() {
        super.onPause()
        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val editor = prefs.edit()

        val mapCenter = mapView.mapCenter as GeoPoint
        val zoomLevel = mapView.zoomLevelDouble

        editor.putString("latitude", mapCenter.latitude.toString())
        editor.putString("longitude", mapCenter.longitude.toString())
        editor.putFloat("zoom", zoomLevel.toFloat())

        editor.apply()
        mapView.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    override fun onDestroyView() {
        super.onDestroyView()
        _binding = null
    }

    override fun onSearch(query: String) {
        filterMarkers(query)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\BatimentUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.content.Context
import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet BatimentUtils : Fournit des fonctions utilitaires pour la gestion
 * des bâtiments sur le campus universitaire.
 *
 * Description :
 * Cet objet centralise les opérations relatives aux bâtiments :
 *  - Chargement dynamique des bâtiments à partir du service distant (Firestore)
 *  - Filtrage selon la situation géographique (sud, nord, etc.) ou le type (enseignement, administratif...)
 *  - Calcul de la distance entre l'utilisateur et chaque bâtiment
 *  - Ouverture d'une carte localisant un bâtiment spécifique
 *  - Sauvegarde et chargement local de la liste des bâtiments (JSON via SharedPreferences)
 *
 * Composants principaux :
 *  - BatimentService : service de récupération des données depuis Firestore
 *  - BatimentFragmentAdapter : adaptateur RecyclerView pour afficher les bâtiments
 *  - MapsFragment : fragment de carte pour localiser un bâtiment
 *  - FragmentModel : modèle encapsulant le contexte de fragment (UI + logique)
 *
 * Bibliothèques utilisées :
 *  - Gson pour la sérialisation JSON
 *  - OSMDroid pour la manipulation de coordonnées géographiques
 *
 * @see BatimentService pour la gestion distante des bâtiments
 * @see MapsFragment pour la carte centrée sur un bâtiment
 */
object BatimentUtils {

    private lateinit var batimentService: BatimentService
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var batiments: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter

    /**
     * Ouvre un fragment de carte (MapsFragment) centré sur la position du bâtiment donné.
     *
     * @param batiment Bâtiment à localiser sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(batiment: Batiment, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", batiment.latitude.toDouble())
        bundle.putDouble("longitude", batiment.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Ouvre le fragment de carte depuis une activité en sauvegardant la destination.
     *
     * @param batiment Bâtiment cible à localiser.
     * @param activity Activité actuelle (doit hériter de MainActivity).
     * @param fragmentContext Contexte utilisé pour accéder aux préférences partagées.
     */
    fun ouvrirMapsFragment(
        batiment: Batiment,
        activity: FragmentActivity,
        fragmentContext: Context
    ) {
        MapsUtils.saveDestination(
            fragmentContext,
            GeoPoint(batiment.latitude.toDouble(), batiment.longitude.toDouble())
        )
        (activity as? MainActivity)?.loadMapsFragment()
    }

    /**
     * Met à jour dynamiquement la liste des bâtiments avec la distance depuis l’utilisateur,
     * applique des filtres par type ou situation (sud, nord, etc.), et recharge la RecyclerView.
     *
     * @param userLocation Position géographique actuelle de l'utilisateur.
     * @param batiments Liste cible à remplir avec les bâtiments chargés.
     * @param filteredList Liste utilisée pour stocker les bâtiments filtrés.
     * @param adapter Adaptateur lié à la RecyclerView pour l'affichage.
     * @param fragmentModel Modèle contenant la vue, le contexte et les métadonnées du fragment.
     * @param onDataLoaded Callback optionnel à exécuter après chargement.
     */
    fun updateBatiments(
        userLocation: GeoPoint,
        batiments: MutableList<Batiment>,
        filteredList: MutableList<Batiment>,
        adapter: BatimentFragmentAdapter,
        fragmentModel: FragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        batimentService = BatimentService(fragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.batiments = batiments
        this.adapter = adapter

        Log.d("BatimentUtils", "updateBatiments appelée avec : $userLocation")
        // Charger les bâtiments
        batimentService.getBatiments().observe(fragmentModel.viewLifecycleOwner, Observer { bats ->
            if (bats != null) {
                for (batiment in bats) {
                    try {
                        val batimentLocation =
                            GeoPoint(batiment.latitude.toDouble(), batiment.longitude.toDouble())
                        val distance = MapsUtils.calculateDistance(userLocation, batimentLocation)
                        Log.d(
                            "BatimentUtils",
                            "Distance calculée pour ${batiment.nom}: $distance mètres"
                        )

                        // Conversion en km si la distance dépasse 1000 m
                        val formattedDistance = if (distance >= 1000) {
                            String.format("%.2f km", distance / 1000)
                        } else {
                            String.format("%.2f m", distance)
                        }

                        batiment.distance = formattedDistance

                        Log.d(
                            "BatimentUtils",
                            "Distance mise à jour pour ${batiment.nom}: ${batiment.distance}"
                        )

                    } catch (e: Exception) {
                        Log.e(
                            "BatimentUtils",
                            "Erreur lors de la mise à jour de la distance pour ${batiment.nom}",
                            e
                        )
                    }
                    when (fragmentModel.situation) {
                        "" -> {
                            if (fragmentModel.type != "" && batiment.type.lowercase() == fragmentModel.type.lowercase()) {
                                batiments.add(batiment)
                            } else if (fragmentModel.type == "") {
                                batiments.add(batiment)
                            }
                        }

                        "sud" -> {
                            if (batiment.situation == "Campus sud") {
                                batiments.add(batiment)
                            }
                        }

                        "nord" -> {
                            if (batiment.situation == "Campus nord") {
                                batiments.add(batiment)
                            }
                        }
                    }
                }
            }
            this.filteredList = batiments.toMutableList()

            this.adapter = BatimentFragmentAdapter(batiments)

            val recyclerBatiments =
                fragmentModel.view?.findViewById<RecyclerView>(fragmentModel.recyclerViewId)
            recyclerBatiments?.layoutManager =
                LinearLayoutManager(
                    fragmentModel.fragmentContext,
                    LinearLayoutManager.VERTICAL,
                    false
                )
            recyclerBatiments?.adapter = adapter
        })
        onDataLoaded()
    }

    /**
     * Sauvegarde la liste des bâtiments localement dans les préférences partagées (JSON).
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @param batiments Liste des bâtiments à sauvegarder.
     */
    fun saveBatiments(context: Context, batiments: MutableList<Batiment>) {
        val sharedPreferences = context.getSharedPreferences("BatimentsPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(batiments)
        editor.putString("batiment", json)
        editor.apply()
    }

    /**
     * Charge les bâtiments précédemment sauvegardés depuis les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @return Liste des bâtiments sauvegardés ou null si aucune donnée.
     */
    fun loadBatiments(context: Context): MutableList<Batiment>? {
        val sharedPreferences = context.getSharedPreferences("BatimentsPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("batiment", null)
        val type = object : TypeToken<MutableList<Batiment>>() {}.type
        return gson.fromJson(json, type)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\HomeBatimentUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet HomeBatimentUtils : Fournit des fonctions utilitaires spécifiques à l'affichage
 * des bâtiments sur l'écran d'accueil de l'application.
 *
 * Description :
 * Cet objet permet de :
 *  - Charger dynamiquement la liste des bâtiments filtrés par type (enseignement, administratif, etc.)
 *  - Calculer et afficher la distance entre chaque bâtiment et l'utilisateur
 *  - Afficher les bâtiments sous forme de liste horizontale dans un `RecyclerView`
 *  - Ouvrir une carte localisant un bâtiment sélectionné
 *
 * Il est utilisé principalement par le `HomeFragment` via un modèle `HomeFragmentModel` qui encapsule
 * le contexte et les vues nécessaires.
 *
 * Composants principaux :
 *  - BatimentService : service de récupération des données Firestore
 *  - BatimentAdapter : adaptateur RecyclerView pour afficher les bâtiments sur l’écran d’accueil
 *  - MapsFragment : fragment de carte pour visualiser la localisation d’un bâtiment
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour la manipulation de géopoints
 *  - Gson (via MapsUtils si extension)
 *  - AndroidX Fragment/RecyclerView
 *
 * @see BatimentService pour l'accès aux données des bâtiments
 * @see MapsFragment pour la localisation sur carte
 */
object HomeBatimentUtils {

    private lateinit var batimentService: BatimentService
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var batiments: MutableList<Batiment>
    private lateinit var adapter: BatimentAdapter

    /**
     * Ouvre un `MapsFragment` centré sur la position du bâtiment sélectionné.
     *
     * @param batiment Bâtiment à localiser sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(batiment: Batiment, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", batiment.latitude.toDouble())
        bundle.putDouble("longitude", batiment.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour la liste des bâtiments affichés sur l'écran d'accueil :
     *  - Applique un filtre par type (défini dans `HomeFragmentModel`)
     *  - Calcule la distance entre chaque bâtiment et l'utilisateur
     *  - Met à jour le `RecyclerView` horizontal avec l'adaptateur
     *
     * @param userLocation Position géographique actuelle de l'utilisateur.
     * @param batiments Liste cible contenant les bâtiments chargés.
     * @param filteredList Liste filtrée utilisée pour l'affichage.
     * @param adapter Adaptateur initial (sera remplacé).
     * @param homeFragmentModel Modèle encapsulant le contexte et les vues de HomeFragment.
     * @param onDataLoaded Callback optionnel exécuté après le chargement.
     */
    fun updateBatiments(
        userLocation: GeoPoint,
        batiments: MutableList<Batiment>,
        filteredList: MutableList<Batiment>,
        adapter: BatimentAdapter,
        homeFragmentModel: HomeFragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        batimentService = BatimentService(homeFragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.batiments = batiments
        this.adapter = adapter

        Log.d("HomeBatimentUtils", "updateBatiments appelée avec : $userLocation")
        // Charger les bâtiments
        batimentService.getBatiments()
            .observe(homeFragmentModel.viewLifecycleOwner, Observer { bats ->
                if (bats != null) {
                    for (batiment in bats) {
                        if (batiment.type.lowercase() == homeFragmentModel.type.lowercase()) {
                            try {
                                val batimentLocation = GeoPoint(
                                    batiment.latitude.toDouble(),
                                    batiment.longitude.toDouble()
                                )
                                val distance =
                                    MapsUtils.calculateDistance(userLocation, batimentLocation)
                                Log.d(
                                    "HomeBatimentUtils",
                                    "Distance calculée pour ${batiment.nom}: $distance mètres"
                                )

                                // Conversion en km si la distance dépasse 1000 m
                                val formattedDistance = if (distance >= 1000) {
                                    String.format("%.2f km", distance / 1000)
                                } else {
                                    String.format("%.2f m", distance)
                                }

                                batiment.distance = formattedDistance

                                Log.d(
                                    "HomeBatimentUtils",
                                    "Distance mise à jour pour ${batiment.nom}: ${batiment.distance}"
                                )

                            } catch (e: Exception) {
                                Log.e(
                                    "HomeBatimentUtils",
                                    "Erreur lors de la mise à jour de la distance pour ${batiment.nom}",
                                    e
                                )
                            }
                            batiments.add(batiment)
                        }
                    }
                }
                this.filteredList = batiments.toMutableList()

                this.adapter = BatimentAdapter(
                    batiments,
                    homeFragmentModel.fragmentManager,
                    homeFragmentModel.newFragment
                )

                val recyclerBatiments =
                    homeFragmentModel.view?.findViewById<RecyclerView>(homeFragmentModel.recyclerViewId)
                recyclerBatiments?.layoutManager =
                    LinearLayoutManager(
                        homeFragmentModel.fragmentContext,
                        LinearLayoutManager.HORIZONTAL,
                        false
                    )
                recyclerBatiments?.adapter = adapter
            })
        onDataLoaded()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\HomeInfraUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet HomeInfraUtils : Fournit des utilitaires pour la gestion des infrastructures
 * sur l’écran d’accueil de l’application.
 *
 * Description :
 * Cet objet permet d'afficher dynamiquement les infrastructures filtrées par type
 * ou situation géographique dans un `RecyclerView` horizontal sur la page d'accueil.
 * Il calcule également la distance entre l'utilisateur et chaque infrastructure,
 * et permet d'ouvrir une carte localisant l'infrastructure sélectionnée.
 *
 * Composants principaux :
 *  - InfrastructureService : service de récupération des infrastructures depuis Firestore
 *  - InfraAdapter : adaptateur pour afficher les infrastructures horizontalement
 *  - MapsFragment : fragment de carte centré sur une infrastructure
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour les coordonnées géographiques
 *  - AndroidX RecyclerView et Fragment
 *
 * @see InfrastructureService pour la gestion des données
 * @see MapsFragment pour l'affichage de la carte
 */
object HomeInfraUtils {

    private lateinit var infrastructureService: InfrastructureService
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var infrastructures: MutableList<Infrastructure>
    private lateinit var adapter: InfraAdapter

    /**
     * Ouvre un fragment de carte centré sur la position de l’infrastructure sélectionnée.
     *
     * @param infrastructure Infrastructure à afficher sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(infrastructure: Infrastructure, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", infrastructure.latitude.toDouble())
        bundle.putDouble("longitude", infrastructure.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour dynamiquement la liste des infrastructures à afficher sur l’écran d’accueil :
     *  - Récupère les données depuis Firestore
     *  - Calcule la distance entre l’utilisateur et chaque infrastructure
     *  - Met à jour la RecyclerView avec les éléments chargés
     *
     * @param userLocation Position géographique actuelle de l'utilisateur.
     * @param infrastructures Liste à remplir avec les infrastructures récupérées.
     * @param filteredList Liste utilisée pour l’affichage après filtrage.
     * @param adapter Adaptateur pour la RecyclerView (sera remplacé après chargement).
     * @param homeFragmentModel Modèle contenant le contexte et les vues du fragment appelant.
     * @param onDataLoaded Callback optionnel exécuté après chargement.
     */
    fun updateInfrastructures(
        userLocation: GeoPoint,
        infrastructures: MutableList<Infrastructure>,
        filteredList: MutableList<Infrastructure>,
        adapter: InfraAdapter,
        homeFragmentModel: HomeFragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        infrastructureService = InfrastructureService(homeFragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.infrastructures = infrastructures
        this.adapter = adapter

        Log.d("HomeInfraUtils", "updateInfrastructures appelée avec : $userLocation")
        // Charger les bâtiments
        infrastructureService.getInfrastructures()
            .observe(homeFragmentModel.viewLifecycleOwner, Observer { infras ->
                if (infras != null) {
                    for (infrastructure in infras) {
                        try {
                            val infrastructureLocation = GeoPoint(
                                infrastructure.latitude.toDouble(),
                                infrastructure.longitude.toDouble()
                            )
                            val distance =
                                MapsUtils.calculateDistance(userLocation, infrastructureLocation)
                            Log.d(
                                "HomeInfraUtils",
                                "Distance calculée pour ${infrastructure.nom}: $distance mètres"
                            )

                            // Conversion en km si la distance dépasse 1000 m
                            val formattedDistance = if (distance >= 1000) {
                                String.format("%.2f km", distance / 1000)
                            } else {
                                String.format("%.2f m", distance)
                            }

                            infrastructure.distance = formattedDistance

                            Log.d(
                                "HomeInfraUtils",
                                "Distance mise à jour pour ${infrastructure.nom}: ${infrastructure.distance}"
                            )

                        } catch (e: Exception) {
                            Log.e(
                                "HomeInfraUtils",
                                "Erreur lors de la mise à jour de la distance pour ${infrastructure.nom}",
                                e
                            )
                        }
                        infrastructures.add(infrastructure)
                    }
                }
                // Mise à jour de l’affichage
                this.filteredList = infrastructures.toMutableList()

                this.adapter = InfraAdapter(
                    infrastructures,
                    homeFragmentModel.fragmentManager,
                    homeFragmentModel.newFragment
                )

                val recyclerBatiments =
                    homeFragmentModel.view?.findViewById<RecyclerView>(homeFragmentModel.recyclerViewId)
                recyclerBatiments?.layoutManager =
                    LinearLayoutManager(
                        homeFragmentModel.fragmentContext,
                        LinearLayoutManager.HORIZONTAL,
                        false
                    )
                recyclerBatiments?.adapter = adapter
            })
        onDataLoaded()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\HomeSalleUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.SalleAdapter
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet HomeSalleUtils : Fournit des utilitaires pour la gestion et l’affichage
 * des salles sur l’écran d’accueil de l’application.
 *
 * Description :
 * Cet objet permet d’afficher dynamiquement les salles dans un `RecyclerView` horizontal,
 * en calculant la distance entre chaque salle et la position actuelle de l’utilisateur.
 * Il offre également la possibilité d’ouvrir une carte localisant une salle sélectionnée.
 *
 * Composants principaux :
 *  - SalleService : service de récupération des données des salles via Firestore
 *  - SalleAdapter : adaptateur utilisé pour afficher les salles dans un `RecyclerView`
 *  - MapsFragment : fragment de carte centré sur une salle
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour la manipulation géographique
 *  - AndroidX Lifecycle, RecyclerView, Fragment
 *
 * @see SalleService pour la gestion des données Firestore
 * @see MapsFragment pour la localisation sur carte
 */
object HomeSalleUtils {

    private lateinit var salleService: SalleService
    private lateinit var filteredList: MutableList<Salle>
    private lateinit var salles: MutableList<Salle>
    private lateinit var adapter: SalleAdapter

    /**
     * Ouvre un fragment de carte (`MapsFragment`) centré sur la position
     * d’une salle donnée.
     *
     * @param salle Salle à localiser sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle afficher le fragment.
     */
    fun ouvrirMapsFragment(salle: Salle, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", salle.latitude.toDouble())
        bundle.putDouble("longitude", salle.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour la liste des salles affichées sur l’écran d’accueil :
     *  - Charge les données depuis Firestore via `SalleService`
     *  - Calcule la distance entre l'utilisateur et chaque salle
     *  - Met à jour dynamiquement l'adaptateur et le `RecyclerView`
     *
     * @param userLocation Position actuelle de l'utilisateur.
     * @param salles Liste à remplir avec les salles récupérées.
     * @param filteredList Liste utilisée pour l’affichage après filtrage.
     * @param adapter Adaptateur RecyclerView (sera remplacé).
     * @param homeFragmentModel Modèle contenant les informations de vue et de contexte.
     * @param onDataLoaded Callback exécuté après chargement des données (optionnel).
     */
    fun updateSalles(
        userLocation: GeoPoint,
        salles: MutableList<Salle>,
        filteredList: MutableList<Salle>,
        adapter: SalleAdapter,
        homeFragmentModel: HomeFragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        salleService = SalleService(homeFragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.salles = salles
        this.adapter = adapter

        Log.d("HomeSalleUtils", "updateSalles appelée avec : $userLocation")
        // Charger les bâtiments
        salleService.getSalles().observe(homeFragmentModel.viewLifecycleOwner, Observer { sals ->
            if (sals != null) {
                for (salle in sals) {
                    try {
                        val salleLocation =
                            GeoPoint(salle.latitude.toDouble(), salle.longitude.toDouble())
                        val distance = MapsUtils.calculateDistance(userLocation, salleLocation)
                        Log.d(
                            "HomeSalleUtils",
                            "Distance calculée pour ${salle.nom}: $distance mètres"
                        )

                        // Conversion en km si la distance dépasse 1000 m
                        val formattedDistance = if (distance >= 1000) {
                            String.format("%.2f km", distance / 1000)
                        } else {
                            String.format("%.2f m", distance)
                        }

                        salle.distance = formattedDistance

                        Log.d(
                            "HomeSalleUtils",
                            "Distance mise à jour pour ${salle.nom}: ${salle.distance}"
                        )

                    } catch (e: Exception) {
                        Log.e(
                            "HomeSalleUtils",
                            "Erreur lors de la mise à jour de la distance pour ${salle.nom}",
                            e
                        )
                    }
                    salles.add(salle)
                }
            }
            // Mise à jour de l’adaptateur et du RecyclerView
            this.filteredList = salles.toMutableList()

            this.adapter = SalleAdapter(
                salles,
                homeFragmentModel.fragmentManager,
                homeFragmentModel.newFragment
            )

            val recyclerBatiments =
                homeFragmentModel.view?.findViewById<RecyclerView>(homeFragmentModel.recyclerViewId)
            recyclerBatiments?.layoutManager =
                LinearLayoutManager(
                    homeFragmentModel.fragmentContext,
                    LinearLayoutManager.HORIZONTAL,
                    false
                )
            recyclerBatiments?.adapter = adapter
        })
        onDataLoaded()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\InfraUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.content.Context
import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet InfraUtils : Fournit des fonctions utilitaires pour la gestion
 * des infrastructures sur le campus universitaire.
 *
 * Description :
 * Cet objet permet d'interagir avec les infrastructures en facilitant :
 *  - Le chargement dynamique des infrastructures à partir d'un service distant
 *  - Le filtrage selon leur situation géographique (Campus sud, nord, etc.)
 *  - L'affichage de la distance par rapport à l'utilisateur
 *  - L'ouverture d'une carte localisant une infrastructure
 *  - La sauvegarde et le chargement local des infrastructures via SharedPreferences
 *
 * Composants principaux :
 *  - InfrastructureService : service de récupération des données
 *  - InfraFragmentAdapter : adaptateur RecyclerView pour afficher les infrastructures
 *  - MapsFragment : fragment de carte utilisé pour localiser une infrastructure
 *
 * Bibliothèques utilisées :
 *  - Gson pour la sérialisation JSON
 *  - OSMDroid pour la manipulation des points géographiques
 *
 * @see InfrastructureService pour l'accès aux données des infrastructures
 * @see MapsFragment pour l'affichage de la carte d'une infrastructure
 */
object InfraUtils {

    private lateinit var infraService: InfrastructureService
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var infras: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter

    /**
     * Ouvre le fragment de carte (MapsFragment) centré sur la position d'une infrastructure donnée.
     *
     * @param infrastructure Infrastructure dont la position est à afficher.
     * @param fragmentActivity L’activité hôte dans laquelle charger le fragment.
     */
    fun ouvrirMapsFragment(infrastructure: Infrastructure, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", infrastructure.latitude.toDouble())
        bundle.putDouble("longitude", infrastructure.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour dynamiquement la liste des infrastructures avec la distance depuis l’utilisateur,
     * filtre selon la situation (sud, nord...), et recharge la RecyclerView avec l’adaptateur.
     *
     * @param userLocation Position géographique actuelle de l’utilisateur.
     * @param infrastructures Liste cible à remplir avec les infrastructures chargées.
     * @param filteredList Liste utilisée pour afficher les éléments filtrés.
     * @param adapter Adaptateur lié à la RecyclerView à mettre à jour.
     * @param fragmentModel Modèle contenant le contexte, la vue et les infos du fragment appelant.
     * @param onDataLoaded Callback optionnel exécuté après le chargement.
     */
    fun updateInfrastructures(
        userLocation: GeoPoint,
        infrastructures: MutableList<Infrastructure>,
        filteredList: MutableList<Infrastructure>,
        adapter: InfraFragmentAdapter,
        fragmentModel: FragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        infraService = InfrastructureService(fragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.infras = infrastructures
        this.adapter = adapter

        Log.d("InfraUtils", "updateInfrastructures appelée avec : $userLocation")

        // Récupération des infrastructures depuis le service
        infraService.getInfrastructures()
            .observe(fragmentModel.viewLifecycleOwner, Observer { infras ->
                if (infras != null) {
                    for (infrastructure in infras) {
                        try {
                            val infrastructureLocation = GeoPoint(
                                infrastructure.latitude.toDouble(),
                                infrastructure.longitude.toDouble()
                            )
                            val distance =
                                MapsUtils.calculateDistance(userLocation, infrastructureLocation)
                            Log.d(
                                "InfraUtils",
                                "Distance calculée pour ${infrastructure.nom}: $distance mètres"
                            )

                            // Conversion en km si la distance dépasse 1000 m
                            val formattedDistance = if (distance >= 1000) {
                                String.format("%.2f km", distance / 1000)
                            } else {
                                String.format("%.2f m", distance)
                            }

                            infrastructure.distance = formattedDistance

                            Log.d(
                                "InfraUtils",
                                "Distance mise à jour pour ${infrastructure.nom}: ${infrastructure.distance}"
                            )

                        } catch (e: Exception) {
                            Log.e(
                                "InfraUtils",
                                "Erreur lors de la mise à jour de la distance pour ${infrastructure.nom}",
                                e
                            )
                        }
                        // Filtrage selon la situation géographique
                        when (fragmentModel.situation) {
                            "" -> {
                                infrastructures.add(infrastructure)
                            }

                            "sud" -> {
                                if (infrastructure.situation == "Campus sud") {
                                    infrastructures.add(infrastructure)
                                }
                            }

                            "nord" -> {
                                if (infrastructure.situation == "Campus nord") {
                                    infrastructures.add(infrastructure)
                                }
                            }
                        }
                    }
                }

                // Mise à jour de la liste filtrée et de l'adaptateur
                this.filteredList = infrastructures.toMutableList()
                this.adapter = InfraFragmentAdapter(infrastructures)

                val recyclerBatiments =
                    fragmentModel.view?.findViewById<RecyclerView>(fragmentModel.recyclerViewId)
                recyclerBatiments?.layoutManager =
                    LinearLayoutManager(
                        fragmentModel.fragmentContext,
                        LinearLayoutManager.VERTICAL,
                        false
                    )
                recyclerBatiments?.adapter = adapter
            })
        onDataLoaded()
    }

    /**
     * Sauvegarde la liste des infrastructures localement dans les préférences partagées (JSON).
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @param infras Liste des infrastructures à sauvegarder.
     */
    fun saveInfras(context: Context, infras: MutableList<Infrastructure>) {
        val sharedPreferences = context.getSharedPreferences("InfrasPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(infras)
        editor.putString("infrastructure", json)
        editor.apply()
    }

    /**
     * Charge les infrastructures précédemment sauvegardées depuis les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @return Liste des infrastructures sauvegardées ou null si aucune donnée trouvée.
     */
    fun loadInfras(context: Context): MutableList<Infrastructure>? {
        val sharedPreferences = context.getSharedPreferences("InfrasPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("infrastructure", null)
        val type = object : TypeToken<MutableList<Infrastructure>>() {}.type
        return gson.fromJson(json, type)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\MapsUtils.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.utils

import android.Manifest
import android.app.Activity
import android.content.Context
import android.content.res.Resources
import android.graphics.Bitmap
import android.graphics.Canvas
import android.graphics.drawable.BitmapDrawable
import android.util.Log
import android.view.MotionEvent
import android.widget.Toast
import androidx.annotation.RequiresPermission
import androidx.core.content.ContextCompat
import androidx.core.content.res.ResourcesCompat
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.BoundingBox
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Overlay
import org.osmdroid.views.overlay.Polyline
import tg.univlome.epl.R
import java.io.IOException

/**
 * Objet MapsUtils : Fournit des utilitaires liés à la carte et à la géolocalisation,
 * utilisés pour la manipulation de données sur les cartes OpenStreetMap avec OSMDroid.
 *
 * Description :
 * Cet objet contient un ensemble de fonctions utilitaires pour gérer les cartes,
 * la géolocalisation, les marqueurs, et l’itinéraire entre deux points. Elle permet
 * également la sauvegarde et la récupération des données de géolocalisation via
 * les préférences partagées de l’application Android.
 * Elle est utilisée dans le contexte d'une application de visualisation et navigation
 * vers des bâtiments à l'aide d'une carte embarquée.
 *
 * Composants principaux :
 *  - Calcul de distance entre deux points géographiques
 *  - Sauvegarde/chargement des positions utilisateur et destination
 *  - Gestion et affichage des marqueurs
 *  - Affichage de l’itinéraire sur carte (OpenRouteService)
 *  - Configuration d'une carte miniature (miniMap)
 *
 * Bibliothèques utilisées :
 * - OSMDroid pour l’affichage et la manipulation de la carte
 * - OpenRouteService pour le calcul d’itinéraires
 *
 * @see MapsActivity pour l'utilisation principale de cette classe
 */
object MapsUtils {

    private val client = OkHttpClient()
    private val iconCache = mutableMapOf<Int, BitmapDrawable>()

    /**
     * Calcule la distance en mètres entre deux points géographiques.
     *
     * @param start Le point de départ.
     * @param end Le point d’arrivée.
     * @return Distance en mètres.
     */
    fun calculateDistance(start: GeoPoint, end: GeoPoint): Double {
        val results = FloatArray(1)
        android.location.Location.distanceBetween(
            start.latitude, start.longitude,
            end.latitude, end.longitude,
            results
        )
        return results[0].toDouble() // Retourne la distance en mètres
    }

    fun fusedLocationClient(location: android.location.Location?, context: Context): GeoPoint {
        return if (location != null) {
            // Sauvegarde la localisation obtenue
            MapsUtils.saveUserLocation(context, GeoPoint(location.latitude, location.longitude))
            GeoPoint(location.latitude, location.longitude)
        } else {
            // 🔄 Récupère la dernière position sauvegardée ou utilise une valeur par défaut
            val savedLocation = MapsUtils.loadUserLocation(context)
            if (savedLocation.latitude != 0.0 || savedLocation.longitude != 0.0) {
                savedLocation
            } else {
                // Valeur par défaut (ex : Université de Lomé)
                GeoPoint(6.1707, 1.2310)
            }
        }
    }

    /**
     * Sauvegarde la position de l’utilisateur dans les préférences partagées.
     *
     * @param context Contexte de l’application.
     * @param location Localisation à sauvegarder.
     */
    fun saveUserLocation(context: Context, location: GeoPoint) {
        val sharedPreferences =
            context.getSharedPreferences("UserLocationPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(location)
        editor.putString("userLocation", json)
        editor.apply()
    }

    /**
     * Charge la position de l’utilisateur depuis les préférences partagées.
     *
     * @param context Contexte de l’application.
     * @return La position sauvegardée, ou (0.0, 0.0) par défaut.
     */
    fun loadUserLocation(context: Context): GeoPoint {
        val sharedPreferences =
            context.getSharedPreferences("UserLocationPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("userLocation", null)
        val type = object : TypeToken<GeoPoint>() {}.type
        return gson.fromJson(json, type) ?: GeoPoint(0.0, 0.0)
    }

    /**
     * Sauvegarde une nouvelle destination dans les préférences.
     *
     * @param context Contexte de l’application.
     * @param destination Destination à sauvegarder.
     */
    fun saveDestination(context: Context, destination: GeoPoint) {
        val sharedPreferences =
            context.getSharedPreferences("DestinationPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(destination)
        editor.putString("destination", json)
        editor.apply()
    }


    /**
     * Récupère la dernière destination sauvegardée depuis les préférences.
     *
     * @param context Contexte de l’application.
     * @return Destination sauvegardée ou (0.0, 0.0) si aucune.
     */
    fun loadDestination(context: Context): GeoPoint {
        val sharedPreferences =
            context.getSharedPreferences("DestinationPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("destination", null)
        val type = object : TypeToken<GeoPoint>() {}.type
        return gson.fromJson(json, type) ?: GeoPoint(0.0, 0.0)
    }

    /**
     * Supprime la destination sauvegardée.
     *
     * @param context Contexte de l’application.
     */
    fun clearDestination(context: Context) {
        val sharedPreferences =
            context.getSharedPreferences("DestinationPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        editor.remove("destination")
        editor.apply()
    }

    /**
     * Sauvegarde la liste des marqueurs récupérés depuis la map dans les préférences.
     *
     * @param context Contexte de l’application.
     * @param markerList Liste des marqueurs à sauvegarder.
     */
    fun saveMarkerList(context: Context, markerList: MutableList<Marker>) {
        val sharedPreferences =
            context.getSharedPreferences("MarkerListPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(markerList)
        editor.putString("markerList", json)
        editor.apply()
    }

    /**
     * Récupère la liste des marqueurs depuis les préférences.
     *
     * @param context Contexte de l’application.
     * @return Liste de marqueurs sauvegardés ou une liste vide.
     */
    fun loadMarkerList(context: Context): MutableList<Marker> {
        val sharedPreferences =
            context.getSharedPreferences("MarkerListPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("markerList", null)
        val type = object : TypeToken<MutableList<Marker>>() {}.type
        return gson.fromJson(json, type) ?: mutableListOf()
    }

    /**
     * Supprime la liste des marqueurs sauvegardés.
     *
     * @param context Contexte de l’application.
     */
    fun clearMarkerList(context: Context) {
        val sharedPreferences =
            context.getSharedPreferences("MarkerListPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        editor.remove("markerList")
        editor.apply()
    }

    /**
     * Redimensionne une icône pour l'affichage sur la carte et la met en cache pour les chargements
     * ultérieurs.
     *
     * @param icon ID de la ressource drawable.
     * @param resources Accès aux ressources.
     * @return Drawable redimensionné ou `null` si non disponible.
     */
    fun resizeIcon(
        icon: Int = R.drawable.default_marker,
        resources: Resources,
        tintColor: Int = android.graphics.Color.BLACK
    ): BitmapDrawable? {
        return iconCache[icon] ?: run {
            val drawable = ResourcesCompat.getDrawable(resources, icon, null) ?: return null

            // Nettoie toute teinte existante
            drawable.setTintList(null)
            drawable.clearColorFilter()

            // Applique la teinte noire
            drawable.setTint(tintColor)

            val bitmap = Bitmap.createBitmap(
                drawable.intrinsicWidth,
                drawable.intrinsicHeight,
                Bitmap.Config.ARGB_8888
            )
            val canvas = Canvas(bitmap)
            drawable.setBounds(0, 0, canvas.width, canvas.height)
            drawable.draw(canvas)

            val scaledBitmap = Bitmap.createScaledBitmap(bitmap, 75, 75, false)
            val scaledDrawable = BitmapDrawable(resources, scaledBitmap)
            iconCache[icon] = scaledDrawable
            scaledDrawable
        }
    }

    /**
     * Configure une carte miniature statique montrant la position de l'utilisateur et sa destination.
     * Affiche les marqueurs de départ et d’arrivée ainsi que l’itinéraire calculé.
     *
     * @param miniMap Vue MapView à configurer.
     * @param userLocation Position de l'utilisateur (par défaut (0,0)).
     * @param destination Position de destination (par défaut (0,0)).
     * @param context Contexte de l’application.
     * @param activity Activité appelante.
     * @param resources Accès aux ressources.
     *
     * @permission ACCESS_FINE_LOCATION
     * @permission ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    fun setMiniMap(
        miniMap: MapView,
        userLocation: GeoPoint = GeoPoint(0, 0),
        destination: GeoPoint = GeoPoint(0, 0),
        context: Context,
        activity: Activity,
        resources: Resources
    ) {
        var start = userLocation
        var end = destination
        // Si la localisation utilisateur n'est pas valide, utiliser la destination comme point de départ
        if (start.latitude == 0.0 && start.longitude == 0.0) {
            start = end
        }
        miniMap.setTileSource(TileSourceFactory.MAPNIK)
        miniMap.setMultiTouchControls(false)
        // Rendre la carte totalement statique
        miniMap.setBuiltInZoomControls(false) // désactiver les boutons zoom
        miniMap.isTilesScaledToDpi = false

        val latPadding = 0.001
        val lonPadding = 0.001
        val boundingBox = BoundingBox(
            maxOf(start.latitude, end.latitude) + latPadding,
            maxOf(start.longitude, end.longitude) + lonPadding,
            minOf(start.latitude, end.latitude) - latPadding,
            minOf(start.longitude, end.longitude) - lonPadding
        )

        // Ajuster la vue pour montrer les deux points
        miniMap.post {
            miniMap.zoomToBoundingBox(boundingBox, false, 50, 14.0, 14.0.toLong())


            // Marqueur de départ
            val startMarker = Marker(miniMap).apply {
                position = start
                setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
                icon = resizeIcon(R.drawable.maps_and_flags, resources)
            }

            // Marqueur de destination
            val endMarker = Marker(miniMap).apply {
                position = end
                setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
                icon = resizeIcon(R.drawable.destination, resources)
            }

            miniMap.overlays.clear()
            miniMap.overlays.add(startMarker)
            miniMap.overlays.add(endMarker)

            // Désactiver le toucher utilisateur
            miniMap.isFocusable = false
            miniMap.isEnabled = false

            // Bloquer tous les gestes de l'utilisateur
            val touchInterceptor = object : Overlay() {
                override fun onTouchEvent(event: MotionEvent?, mapView: MapView?): Boolean {
                    return true // bloque tous les touch events
                }
            }
            miniMap.overlays.add(touchInterceptor)

            // Obtenir l'itinéraire
            getRoute(start, end, activity, miniMap)

            miniMap.invalidate()
        }
    }

    /**
     * Récupère et trace l’itinéraire entre deux points en utilisant l’API OpenRouteService.
     *
     * @param start Point de départ.
     * @param end Point d’arrivée.
     * @param activity Activité pour l’exécution sur le thread principal.
     * @param mapView Carte à mettre à jour.
     */
    private fun getRoute(start: GeoPoint, end: GeoPoint, activity: Activity, mapView: MapView) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                Log.e(
                    "MapsActivity",
                    "Erreur lors de la récupération de l'itinéraire : ${e.message}"
                )
                activity.runOnUiThread {
                    Toast.makeText(
                        activity,
                        "Impossible de récupérer l'itinéraire",
                        Toast.LENGTH_LONG
                    ).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                if (response.isSuccessful) {
                    response.body?.string()?.let { jsonString ->
                        try {
                            val jsonObject = JSONObject(jsonString)
                            val features = jsonObject.getJSONArray("features")
                            if (features.length() > 0) {
                                val geometry = features.getJSONObject(0).getJSONObject("geometry")
                                val coordinates = geometry.getJSONArray("coordinates")

                                val geoPoints = mutableListOf<GeoPoint>()
                                for (i in 0 until coordinates.length()) {
                                    val coord = coordinates.getJSONArray(i)
                                    val lon = coord.getDouble(0)
                                    val lat = coord.getDouble(1)
                                    geoPoints.add(GeoPoint(lat, lon))
                                }

                                activity.runOnUiThread {
                                    var currentPolyline = Polyline()
                                    currentPolyline!!.setPoints(geoPoints)
                                    currentPolyline!!.outlinePaint.color =
                                        ContextCompat.getColor(activity, R.color.mainColor)
                                    currentPolyline!!.outlinePaint.strokeWidth = 5f

                                    mapView.overlays.add(currentPolyline)
                                    mapView.invalidate()
                                }
                            }
                        } catch (e: JSONException) {
                            Log.e("MapsUtils", "Erreur JSON: ${e.message}")
                        }
                    }
                } else {
                    Log.e("MapsUtils", "Erreur dans la réponse de l'API de routage")
                }
            }
        })
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\OthersUtils.kt 
=============================================== 
package tg.univlome.epl.utils

/**
 * Objet OthersUtils : Contient des fonctions utilitaires générales utilisées dans l'application.
 *
 * Description :
 * Cet objet regroupe des méthodes d'utilité courante ne relevant pas directement
 * d’un domaine spécifique comme les bâtiments ou les infrastructures.
 * Il est destiné à accueillir des fonctions de conversion, de formatage, ou d'aide au calcul.
 *
 * Fonctionnalité actuelle :
 *  - Conversion d’une distance exprimée en mètres vers un format lisible (mètres ou kilomètres)
 *
 * Ce type d’objet permet de centraliser les fonctions utilitaires partagées
 * par plusieurs composants de l’application.
 */
object OthersUtils {

    /**
     * Convertit une distance en mètres vers une représentation lisible :
     * - en mètres (m) si la valeur est inférieure à 1000
     * - en kilomètres (km) avec deux décimales sinon
     *
     * @param distance Distance en mètres à convertir.
     * @return Une chaîne formatée avec l’unité appropriée (par ex. "850.00 m" ou "1.25 km").
     */
    fun convertDistance(distance: Double): String {
        // Conversion en km si la distance dépasse 1000 m
        val formattedDistance = if (distance >= 1000) {
            String.format("%.2f km", distance / 1000)
        } else {
            String.format("%.2f m", distance)
        }
        return formattedDistance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\SalleUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.content.Context
import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.SalleViewAllAdapter
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet SalleUtils : Fournit des fonctions utilitaires pour la gestion complète
 * des salles de cours ou de réunion sur le campus universitaire.
 *
 * Description :
 * Cet objet permet de :
 *  - Charger dynamiquement les salles depuis Firestore
 *  - Filtrer les salles par situation géographique (sud, nord, etc.)
 *  - Calculer la distance entre l'utilisateur et chaque salle
 *  - Afficher dynamiquement les salles dans un `RecyclerView`
 *  - Ouvrir une carte localisant une salle
 *  - Sauvegarder et charger localement les salles via `SharedPreferences`
 *
 * Composants principaux :
 *  - SalleService : service Firestore pour la récupération des données
 *  - SalleViewAllAdapter : adaptateur utilisé pour l’affichage de toutes les salles
 *  - MapsFragment : fragment de carte pour la localisation
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour les géopoints
 *  - Gson pour la sérialisation JSON
 *  - AndroidX Fragment, RecyclerView, Lifecycle
 *
 * @see SalleService pour les opérations de récupération de données
 * @see MapsFragment pour la visualisation géographique
 */
object SalleUtils {

    private lateinit var salleService: SalleService
    private lateinit var filteredList: MutableList<Salle>
    private lateinit var salles: MutableList<Salle>
    private lateinit var adapter: SalleViewAllAdapter

    /**
     * Ouvre un `MapsFragment` centré sur la salle sélectionnée.
     *
     * @param salle Salle à afficher sur la carte.
     * @param fragmentActivity Activité dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(salle: Salle, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", salle.latitude.toDouble())
        bundle.putDouble("longitude", salle.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour dynamiquement la liste des salles :
     *  - Calcule la distance avec l'utilisateur
     *  - Applique un filtrage géographique (nord, sud, ou tous)
     *  - Recharge la RecyclerView avec les nouvelles données
     *
     * @param userLocation Position actuelle de l'utilisateur.
     * @param salles Liste à remplir avec les salles récupérées.
     * @param filteredList Liste utilisée pour le rendu visuel.
     * @param adapter Adaptateur initial de la RecyclerView.
     * @param fragmentModel Modèle encapsulant les éléments de contexte et de vue.
     */
    fun updateSalles(
        userLocation: GeoPoint,
        salles: MutableList<Salle>,
        filteredList: MutableList<Salle>,
        adapter: SalleViewAllAdapter,
        fragmentModel: FragmentModel
    ) {
        salleService = SalleService(fragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.salles = salles
        this.adapter = adapter

        Log.d("SalleUtils", "updateSalles appelée avec : $userLocation")
        // Charger les salles
        salleService.getSalles().observe(fragmentModel.viewLifecycleOwner, Observer { sals ->
            if (sals != null) {
                for (salle in sals) {
                    try {
                        val salleLocation =
                            GeoPoint(salle.latitude.toDouble(), salle.longitude.toDouble())
                        val distance = MapsUtils.calculateDistance(userLocation, salleLocation)
                        Log.d("SalleUtils", "Distance calculée pour ${salle.nom}: $distance mètres")

                        // Conversion en km si la distance dépasse 1000 m
                        val formattedDistance = if (distance >= 1000) {
                            String.format("%.2f km", distance / 1000)
                        } else {
                            String.format("%.2f m", distance)
                        }

                        salle.distance = formattedDistance

                        Log.d(
                            "SalleUtils",
                            "Distance mise à jour pour ${salle.nom}: ${salle.distance}"
                        )

                    } catch (e: Exception) {
                        Log.e(
                            "SalleUtils",
                            "Erreur lors de la mise à jour de la distance pour ${salle.nom}",
                            e
                        )
                    }
                    when (fragmentModel.situation) {
                        "" -> {
                            salles.add(salle)
                        }

                        "sud" -> {
                            if (salle.situation == "Campus sud") {
                                salles.add(salle)
                            }
                        }

                        "nord" -> {
                            if (salle.situation == "Campus nord") {
                                salles.add(salle)
                            }
                        }
                    }
                }
            }
            this.filteredList = salles.toMutableList()

            this.adapter = SalleViewAllAdapter(salles)

            val recyclerBatiments =
                fragmentModel.view?.findViewById<RecyclerView>(fragmentModel.recyclerViewId)
            recyclerBatiments?.layoutManager =
                LinearLayoutManager(
                    fragmentModel.fragmentContext,
                    LinearLayoutManager.VERTICAL,
                    false
                )
            recyclerBatiments?.adapter = adapter
        })
    }

    /**
     * Sauvegarde la liste des salles localement dans les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @param salles Liste des salles à sauvegarder.
     */
    fun saveSalles(context: Context, salles: MutableList<Salle>) {
        val sharedPreferences = context.getSharedPreferences("SallePrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(salles)
        editor.putString("salle", json)
        editor.apply()
    }

    /**
     * Charge les salles sauvegardées précédemment depuis les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @return Liste des salles sauvegardées, ou null si aucune donnée.
     */
    fun loadSalles(context: Context): MutableList<Salle>? {
        val sharedPreferences = context.getSharedPreferences("SallePrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("salle", null)
        val type = object : TypeToken<MutableList<Salle>>() {}.type
        return gson.fromJson(json, type)
    }

    /**
     * Supprime la liste des salles sauvegardée localement.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     */
    fun clearSalles(context: Context) {
        val sharedPreferences = context.getSharedPreferences("SallePrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        editor.remove("salle")
        editor.apply()
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\test\java\tg\univlome\epl\ExampleUnitTest.kt 
=============================================== 
package tg.univlome.epl

import org.junit.Assert.assertEquals
import org.junit.Test

/**
 * Example local unit test, which will execute on the development machine (host).
 *
 * See [testing documentation](http://d.android.com/tools/testing).
 */
class ExampleUnitTest {
    @Test
    fun addition_isCorrect() {
        assertEquals(4, 2 + 2)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\build.gradle.kts 
=============================================== 
// Top-level build file where you can add configuration options common to all sub-projects/modules.
plugins {
    alias(libs.plugins.android.application) apply false
    alias(libs.plugins.kotlin.android) apply false
    id("com.google.gms.google-services") version "4.4.2" apply false
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\settings.gradle.kts 
=============================================== 
pluginManagement {
    repositories {
        google {
            content {
                includeGroupByRegex("com\\.android.*")
                includeGroupByRegex("com\\.google.*")
                includeGroupByRegex("androidx.*")
            }
        }
        mavenCentral()
        gradlePluginPortal()
    }
}
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
    }
}

rootProject.name = "LocUL"
include(":app")
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\build.gradle.kts 
=============================================== 
plugins {
    alias(libs.plugins.android.application)
    alias(libs.plugins.kotlin.android)
    id("com.google.gms.google-services")
    id("org.jetbrains.dokka") version "1.9.10"
}

android {
    namespace = "tg.univlome.epl"
    compileSdk = 35

    defaultConfig {
        applicationId = "tg.univlome.epl"
        minSdk = 24
        targetSdk = 34
        versionCode = 1
        versionName = "1.0"

        testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            isMinifyEnabled = false
            proguardFiles(
                getDefaultProguardFile("proguard-android-optimize.txt"),
                "proguard-rules.pro"
            )
        }
    }

    buildFeatures {
        viewBinding = true
    }

    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
    }
    kotlinOptions {
        jvmTarget = "11"
    }
}

dependencies {

    implementation(libs.androidx.core.ktx)
    implementation(libs.androidx.appcompat)
    implementation(libs.material)
    implementation(libs.androidx.activity)
    implementation(libs.androidx.constraintlayout)
    implementation(libs.firebase.firestore)
    implementation(libs.androidx.animation.graphics.android)
    testImplementation(libs.junit)
    androidTestImplementation(libs.androidx.junit)
    androidTestImplementation(libs.androidx.espresso.core)

    implementation("com.google.android.material:material:1.9.0")
    implementation("androidx.drawerlayout:drawerlayout:1.2.0")

    implementation(platform("com.google.firebase:firebase-bom:33.10.0"))

    implementation("org.osmdroid:osmdroid-wms:6.1.16") // Optionnel si besoin de WMS
    implementation("org.osmdroid:osmdroid-android:6.1.16")
    implementation("org.osmdroid:osmdroid-mapsforge:6.1.16") // Ajout pour ScaleBarOverlay
    implementation("com.squareup.okhttp3:okhttp:4.9.0")  // Pour les requêtes HTTP (GraphHopper)

    implementation("com.google.android.gms:play-services-location:21.1.0") //exemple
    implementation("com.google.android.gms:play-services-maps:18.2.0") //exemple

    implementation("com.github.bumptech.glide:glide:4.15.1")
    annotationProcessor("com.github.bumptech.glide:compiler:4.15.1")

    // Retrofit
    implementation("com.squareup.retrofit2:retrofit:2.6.0")
    implementation("com.squareup.retrofit2:converter-gson:2.6.0")
    implementation("com.squareup.okhttp3:logging-interceptor:4.5.0")

    // CircleImageView
    implementation("de.hdodenhof:circleimageview:3.1.0")

    implementation("androidx.appcompat:appcompat:1.6.1")
    implementation("androidx.viewpager2:viewpager2:1.0.0")
    implementation("com.airbnb.android:lottie:+")
    implementation("com.facebook.shimmer:shimmer:0.5.0")

    implementation(kotlin("stdlib"))
}

tasks.dokkaHtml.configure {
    @Suppress("DEPRECATION")
    outputDirectory.set(buildDir.resolve("dokka/html"))
}

@Suppress("DEPRECATION")
val dokkaPdf by tasks.registering(Exec::class) {
    dependsOn("dokkaHtml")
    group = "documentation"
    description = "Génère la documentation PDF depuis HTML avec wkhtmltopdf"

    val htmlPath = buildDir.resolve("dokka/html/index.html")
    val outputPdf = buildDir.resolve("dokka/documentation.pdf")

    commandLine("wkhtmltopdf", htmlPath.absolutePath, outputPdf.absolutePath)
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\AndroidManifest.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="com.google.android.gms.permission.AD_ID" />
    <uses-permission android:name="com.google.android.gms.permission.ACTIVITY_RECOGNITION" />

    <application
        android:name=".MyApp"
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:hardwareAccelerated="true"
        android:icon="@mipmap/loc_ul_launcher"
        android:label="@string/app_name"
        android:largeHeap="true"
        android:roundIcon="@mipmap/loc_ul_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.LocUL"
        android:usesCleartextTraffic="true"
        tools:targetApi="31">
        <activity
            android:name=".ui.maps.MapsActivity"
            android:exported="false" />

        <meta-data
            android:name="android.hardware.opengles.aep"
            android:value="false" />
        <meta-data
            android:name="org.osmdroid.config"
            android:value="true" />
        <meta-data
            android:name="android.max_aspect"
            android:value="2.1" />

        <activity
            android:name=".ui.batiment.BatimentActivity"
            android:exported="false" />
        <activity
            android:name=".ui.infrastructure.InfraActivity"
            android:exported="false" />
        <activity
            android:name=".ui.home.SalleActivity"
            android:exported="false" />
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:windowSoftInputMode="adjustNothing">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\anim\indicator_scale.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator="@android:anim/accelerate_decelerate_interpolator">

    <scale
        android:duration="150"
        android:fromXScale="0.0"
        android:fromYScale="1.0"
        android:pivotX="50%"
        android:pivotY="50%"
        android:toXScale="1.0"
        android:toYScale="1.0" />

</set> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\about_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="512"
    android:viewportHeight="512">
    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M256,42.67C138.18,42.67 42.67,138.18 42.67,256C42.67,373.82 138.18,469.33 256,469.33C373.82,469.33 469.33,373.82 469.33,256C469.33,138.18 373.82,42.67 256,42.67ZM256,426.67C161.89,426.67 85.33,350.11 85.33,256C85.33,161.89 161.89,85.33 256,85.33C350.11,85.33 426.67,161.89 426.67,256C426.67,350.11 350.11,426.67 256,426.67ZM282.71,170.67C282.71,186.13 271.45,197.33 256.22,197.33C240.37,197.33 229.38,186.13 229.38,170.37C229.38,155.22 240.66,144 256.22,144C271.45,144 282.71,155.22 282.71,170.67ZM234.71,234.67L277.38,234.67L277.38,362.67L234.71,362.67L234.71,234.67Z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />

</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\activity_img_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners
        android:bottomLeftRadius="10dp"
        android:bottomRightRadius="10dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\background_circulaire.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">

    <solid android:color="#BFFFFFFF" />
    <corners android:radius="13dp" />

</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\background_circulaire_2.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">

    <solid android:color="#F0E9F6" />
    <corners android:radius="13dp" />

</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\back_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M15.707,4.293C16.098,4.683 16.098,5.317 15.707,5.707L9.414,12L15.707,18.293C16.098,18.683 16.098,19.317 15.707,19.707C15.317,20.098 14.683,20.098 14.293,19.707L7.293,12.707C7.105,12.52 7,12.265 7,12C7,11.735 7.105,11.48 7.293,11.293L14.293,4.293C14.683,3.902 15.317,3.902 15.707,4.293Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\back_icon_maps.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/black"
        android:fillType="evenOdd"
        android:pathData="M15.707,4.293C16.098,4.683 16.098,5.317 15.707,5.707L9.414,12L15.707,18.293C16.098,18.683 16.098,19.317 15.707,19.707C15.317,20.098 14.683,20.098 14.293,19.707L7.293,12.707C7.105,12.52 7,12.265 7,12C7,11.735 7.105,11.48 7.293,11.293L14.293,4.293C14.683,3.902 15.317,3.902 15.707,4.293Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\batiment_nav_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="960"
    android:viewportHeight="960">
    <path
        android:fillColor="@color/black"
        android:pathData="M140,806.15v-520h160v-160h360v320h160v360L540,806.15v-160L420,646.15v160L140,806.15ZM180,766.15h120v-120L180,646.15v120ZM180,606.15h120v-120L180,486.15v120ZM180,446.15h120v-120L180,326.15v120ZM340,606.15h120v-120L340,486.15v120ZM340,446.15h120v-120L340,326.15v120ZM340,286.15h120v-120L340,166.15v120ZM500,606.15h120v-120L500,486.15v120ZM500,446.15h120v-120L500,326.15v120ZM500,286.15h120v-120L500,166.15v120ZM660,766.15h120v-120L660,646.15v120ZM660,606.15h120v-120L660,486.15v120Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\bottom_nav_background.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">

    <solid android:color="@color/bottom_nav_default" />

    <corners android:radius="40dp" />

</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\contact_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#00000000"
        android:pathData="M5,12C3.343,12 2,10.657 2,9C2,7.343 3.343,6 5,6C6.657,6 8,7.343 8,9C8,10.657 6.657,12 5,12ZM9,18L9,16C9,13.75 7.213,12 4.964,12L5.018,12C2.769,12 1,13.75 1,16L1,18M12,7L24,7M12,17L22,17M12,12L19,12"
        android:strokeWidth="2"
        android:strokeColor="@color/mainColor" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\dot_selector.xml 
=============================================== 
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_selected="true">
        <shape android:shape="oval">
            <solid android:color="@color/selected_dot_color" />
            <size android:width="8dp" android:height="8dp" />
        </shape>
    </item>
    <item>
        <shape android:shape="oval">
            <solid android:color="@color/unselected_dot_color" />
            <size android:width="8dp" android:height="8dp" />
        </shape>
    </item>
</selector> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\drawer_nav_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners
        android:bottomRightRadius="15dp"
        android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\hamburger_menu.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="35dp"
    android:height="35dp"
    android:viewportWidth="64"
    android:viewportHeight="64">

    <path
        android:fillColor="@color/mainColor"
        android:fillType="nonZero"
        android:pathData="M7.971,43.925l16.031,0l0,5.992l-16.031,0z" />

    <path
        android:fillColor="@color/mainColor"
        android:fillType="nonZero"
        android:pathData="M8.181,29.004l31.821,0l0,5.992l-31.821,0z" />

    <path
        android:fillColor="@color/mainColor"
        android:fillType="nonZero"
        android:pathData="M8.181,14.082l47.821,0l0,5.992l-47.821,0z" />

</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\header_nav_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/mainColor" />
    <corners android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\home_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="960"
    android:viewportHeight="960">
    <path
        android:fillColor="@color/black"
        android:pathData="M230.26,769.74h148.46v-242.56h202.56v242.56h148.46v-374.61L480,206.92 230.26,395.04v374.7ZM180,820v-450l300,-225.77L780,370v450L531.03,820v-242.57L428.97,577.43L428.97,820L180,820ZM480,488.13Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\ic_launcher_background.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path
        android:fillColor="#3DDC84"
        android:pathData="M0,0h108v108h-108z" />
    <path
        android:fillColor="#00000000"
        android:pathData="M9,0L9,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,0L19,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,0L29,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,0L39,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,0L49,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,0L59,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,0L69,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,0L79,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M89,0L89,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M99,0L99,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,9L108,9"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,19L108,19"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,29L108,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,39L108,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,49L108,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,59L108,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,69L108,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,79L108,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,89L108,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,99L108,99"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,29L89,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,39L89,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,49L89,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,59L89,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,69L89,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,79L89,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,19L29,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,19L39,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,19L49,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,19L59,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,19L69,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,19L79,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\ic_launcher_foreground.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:aapt="http://schemas.android.com/aapt"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path android:pathData="M31,63.928c0,0 6.4,-11 12.1,-13.1c7.2,-2.6 26,-1.4 26,-1.4l38.1,38.1L107,108.928l-32,-1L31,63.928z">
        <aapt:attr name="android:fillColor">
            <gradient
                android:endX="85.84757"
                android:endY="92.4963"
                android:startX="42.9492"
                android:startY="49.59793"
                android:type="linear">
                <item
                    android:color="#44000000"
                    android:offset="0.0" />
                <item
                    android:color="#00000000"
                    android:offset="1.0" />
            </gradient>
        </aapt:attr>
    </path>
    <path
        android:fillColor="#FFFFFF"
        android:fillType="nonZero"
        android:pathData="M65.3,45.828l3.8,-6.6c0.2,-0.4 0.1,-0.9 -0.3,-1.1c-0.4,-0.2 -0.9,-0.1 -1.1,0.3l-3.9,6.7c-6.3,-2.8 -13.4,-2.8 -19.7,0l-3.9,-6.7c-0.2,-0.4 -0.7,-0.5 -1.1,-0.3C38.8,38.328 38.7,38.828 38.9,39.228l3.8,6.6C36.2,49.428 31.7,56.028 31,63.928h46C76.3,56.028 71.8,49.428 65.3,45.828zM43.4,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2c-0.3,-0.7 -0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C45.3,56.528 44.5,57.328 43.4,57.328L43.4,57.328zM64.6,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2s-0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C66.5,56.528 65.6,57.328 64.6,57.328L64.6,57.328z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />
</vector> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\img_backgroung.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="#DDDDDD" />
    <corners android:radius="10dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\indicator_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/mainColor" />
    <corners android:radius="2000dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\location_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="960"
    android:viewportHeight="960">
    <path
        android:fillColor="#e8eaed"
        android:pathData="M480.07,474.61q29.85,0 51.04,-21.26 21.2,-21.26 21.2,-51.11 0,-29.85 -21.26,-51.05Q509.79,330 479.93,330q-29.85,0 -51.04,21.26 -21.2,21.26 -21.2,51.12 0,29.85 21.26,51.04 21.26,21.19 51.12,21.19ZM480,780.54q117.38,-105.08 179.65,-201.58 62.27,-96.5 62.27,-169.04 0,-109.38 -69.5,-179.84 -69.5,-70.46 -172.42,-70.46 -102.92,0 -172.42,70.46 -69.5,70.46 -69.5,179.84 0,72.54 62.27,169.04 62.27,96.5 179.65,201.58ZM480,860.38Q329,729.54 253.54,616.85q-75.46,-112.7 -75.46,-206.93 0,-138.46 89.57,-224.19Q357.23,100 480,100t212.35,85.73q89.57,85.73 89.57,224.19 0,94.23 -75.46,206.93Q631,729.54 480,860.38ZM480,402.31Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\maps_destination.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/white" />
    <corners
        android:bottomRightRadius="15dp"
        android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\maps_destination_remove.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="#69545454" />
    <corners
        android:bottomRightRadius="15dp"
        android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\map_loc.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/white"
        android:fillType="evenOdd"
        android:pathData="M8.25,9C8.25,6.929 9.929,5.25 12,5.25C14.071,5.25 15.75,6.929 15.75,9C15.75,11.071 14.071,12.75 12,12.75C9.929,12.75 8.25,11.071 8.25,9ZM12,6.75C10.757,6.75 9.75,7.757 9.75,9C9.75,10.243 10.757,11.25 12,11.25C13.243,11.25 14.25,10.243 14.25,9C14.25,7.757 13.243,6.75 12,6.75Z" />
    <path
        android:fillColor="@color/white"
        android:fillType="evenOdd"
        android:pathData="M5.456,8.127C5.73,4.806 8.506,2.25 11.838,2.25H12.162C15.495,2.25 18.27,4.806 18.544,8.127C18.69,9.908 18.14,11.675 17.01,13.058L13.415,17.455C12.684,18.349 11.316,18.349 10.585,17.455L6.99,13.058C5.86,11.675 5.31,9.908 5.456,8.127ZM11.838,3.75C9.286,3.75 7.161,5.707 6.951,8.25C6.837,9.643 7.267,11.027 8.152,12.109L11.746,16.505C11.877,16.665 12.123,16.665 12.254,16.505L15.849,12.109C16.733,11.027 17.163,9.643 17.049,8.25C16.839,5.707 14.714,3.75 12.162,3.75H11.838Z" />
    <path
        android:fillColor="@color/white"
        android:pathData="M7.671,16.335C7.856,15.965 7.706,15.514 7.335,15.329C6.965,15.144 6.514,15.294 6.329,15.665L4.329,19.665C4.213,19.897 4.225,20.173 4.362,20.394C4.499,20.615 4.74,20.75 5,20.75H19C19.26,20.75 19.501,20.615 19.638,20.394C19.775,20.173 19.787,19.897 19.671,19.665L17.671,15.665C17.486,15.294 17.035,15.144 16.665,15.329C16.294,15.514 16.144,15.965 16.329,16.335L17.787,19.25H6.214L7.671,16.335Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\mini_map_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners android:radius="10dp" />
    <stroke
        android:width="1dp"
        android:color="@color/bottom_nav_default_item" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\nav_item_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <corners android:radius="25dp" />
    <solid android:color="@color/bottom_nav_default_item" />
</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\rounded_frame.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners android:radius="10dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\round_view_all.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="19"
    android:viewportHeight="19">
    <path
        android:fillColor="@color/bottom_nav_default_item"
        android:pathData="M17.416,9.579A7.917,7.917 0,1 1,9.5 1.662a7.916,7.916 0,0 1,7.916 7.917zM13.256,8.973 L8.446,4.164a0.792,0.792 0,1 0,-1.12 1.12l4.25,4.248 -4.25,4.25a0.792,0.792 0,0 0,1.12 1.119l4.808,-4.809a0.792,0.792 0,0 0,0 -1.12z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\route_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">

    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M18,16C19.657,16 21,17.343 21,19C21,20.657 19.657,22 18,22C16.343,22 15,20.657 15,19C15,17.343 16.343,16 18,16ZM15.5,4C17.985,4 20,6.015 20,8.5C20,10.985 17.985,13 15.5,13L8.5,13C7.119,13 6,14.119 6,15.5C6,16.881 7.119,18 8.5,18L13,18C13.552,18 14,18.448 14,19C14,19.552 13.552,20 13,20L8.5,20C6.015,20 4,17.985 4,15.5C4,13.015 6.015,11 8.5,11L15.5,11C16.881,11 18,9.881 18,8.5C18,7.119 16.881,6 15.5,6L11,6C10.448,6 10,5.552 10,5C10,4.448 10.448,4 11,4L15.5,4ZM18,18C17.448,18 17,18.448 17,19C17,19.552 17.448,20 18,20C18.552,20 19,19.552 19,19C19,18.448 18.552,18 18,18ZM6,2C7.657,2 9,3.343 9,5C9,6.657 7.657,8 6,8C4.343,8 3,6.657 3,5C3,3.343 4.343,2 6,2ZM6,4C5.448,4 5,4.448 5,5C5,5.552 5.448,6 6,6C6.552,6 7,5.552 7,5C7,4.448 6.552,4 6,4Z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />

</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\search_background.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/white" />
    <stroke
        android:width="1dp"
        android:color="@color/bottom_nav_default_item" />
    <corners android:radius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\search_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#00000000"
        android:pathData="M10,10m-6,0a6,6 0,1 1,12 0a6,6 0,1 1,-12 0"
        android:strokeWidth="2"
        android:strokeColor="@color/white"
        android:strokeLineCap="round"
        android:strokeLineJoin="round" />
    <path
        android:fillColor="#00000000"
        android:pathData="M14.5,14.5L19,19"
        android:strokeWidth="2"
        android:strokeColor="@color/white"
        android:strokeLineCap="round"
        android:strokeLineJoin="round" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\search_icon_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/mainColor" />
    <corners android:radius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\settings_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="64"
    android:viewportHeight="64">
    <path
        android:fillColor="#00000000"
        android:pathData="M27.954,14.394C30.232,12.09 33.172,10.555 36.365,10.004C39.558,9.453 42.843,9.913 45.761,11.32L38.099,19.042C37.365,19.784 36.953,20.786 36.953,21.83C36.953,22.874 37.365,23.876 38.099,24.618L39.945,26.479C40.307,26.845 40.738,27.135 41.213,27.334C41.687,27.532 42.197,27.634 42.711,27.634C43.226,27.634 43.736,27.532 44.21,27.334C44.685,27.135 45.116,26.845 45.478,26.479L53.14,18.757C54.697,22.041 55.079,25.761 54.22,29.293C53.361,32.825 51.315,35.954 48.424,38.157C46.142,39.885 43.428,40.95 40.581,41.236C37.733,41.523 34.861,41.019 32.281,39.781L18.418,53.751C18.056,54.117 17.625,54.407 17.151,54.606C16.676,54.804 16.167,54.906 15.652,54.906C15.137,54.906 14.628,54.804 14.153,54.606C13.679,54.407 13.248,54.117 12.886,53.751L11.04,51.89C10.305,51.148 9.893,50.146 9.893,49.102C9.893,48.058 10.305,47.056 11.04,46.314L24.905,32.34C23.508,29.398 23.052,26.097 23.597,22.886C24.143,19.675 25.664,16.71 27.954,14.394V14.394Z"
        android:strokeWidth="4"
        android:strokeColor="@color/mainColor"
        android:strokeLineCap="round"
        android:strokeLineJoin="round" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\share_2_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#00000000"
        android:pathData="M9,11.5C9,12.881 7.881,14 6.5,14C5.119,14 4,12.881 4,11.5C4,10.119 5.119,9 6.5,9C7.881,9 9,10.119 9,11.5Z"
        android:strokeWidth="1.5"
        android:strokeColor="@color/mainColor" />
    <path
        android:fillAlpha="0.5"
        android:fillColor="#00000000"
        android:pathData="M14.321,16.802L9,13.29"
        android:strokeWidth="1.5"
        android:strokeAlpha="0.5"
        android:strokeColor="@color/mainColor"
        android:strokeLineCap="round" />
    <path
        android:fillAlpha="0.5"
        android:fillColor="#00000000"
        android:pathData="M14.421,6.84L9.1,10.351"
        android:strokeWidth="1.5"
        android:strokeAlpha="0.5"
        android:strokeColor="@color/mainColor"
        android:strokeLineCap="round" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,18.5C19,19.881 17.881,21 16.5,21C15.119,21 14,19.881 14,18.5C14,17.119 15.119,16 16.5,16C17.881,16 19,17.119 19,18.5Z"
        android:strokeWidth="1.5"
        android:strokeColor="@color/mainColor" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,5.5C19,6.881 17.881,8 16.5,8C15.119,8 14,6.881 14,5.5C14,4.119 15.119,3 16.5,3C17.881,3 19,4.119 19,5.5Z"
        android:strokeWidth="1.5"
        android:strokeColor="@color/mainColor" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\share_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M13.803,5.333C13.803,3.492 15.302,2 17.152,2C19.001,2 20.5,3.492 20.5,5.333C20.5,7.174 19.001,8.667 17.152,8.667C16.218,8.667 15.374,8.286 14.767,7.673L10.132,10.83C10.175,11.042 10.197,11.262 10.197,11.487C10.197,11.932 10.109,12.358 9.95,12.746L15.032,16.086C15.609,15.616 16.347,15.333 17.152,15.333C19.001,15.333 20.5,16.826 20.5,18.667C20.5,20.508 19.001,22 17.152,22C15.302,22 13.803,20.508 13.803,18.667C13.803,18.184 13.906,17.726 14.092,17.311L9.05,13.999C8.462,14.51 7.692,14.821 6.848,14.821C4.999,14.821 3.5,13.328 3.5,11.487C3.5,9.646 4.999,8.154 6.848,8.154C7.912,8.154 8.859,8.647 9.471,9.415L13.964,6.356C13.859,6.034 13.803,5.69 13.803,5.333Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\view_all.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#727272"
        android:fillType="evenOdd"
        android:pathData="M8.293,4.293C8.683,3.902 9.317,3.902 9.707,4.293L16.707,11.293C17.098,11.683 17.098,12.317 16.707,12.707L9.707,19.707C9.317,20.098 8.683,20.098 8.293,19.707C7.902,19.317 7.902,18.683 8.293,18.293L14.586,12L8.293,5.707C7.902,5.317 7.902,4.683 8.293,4.293Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    android:padding="0dp">

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="250dp"
        android:layout_marginBottom="8dp">

        <ImageView
            android:id="@+id/imgBatiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/activity_img_bg"
            android:clipToOutline="true"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="35dp"
            android:layout_height="35dp"
            android:layout_gravity="start|top"
            android:layout_margin="16dp"
            android:background="@drawable/rounded_frame"
            android:gravity="center">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon" />

        </LinearLayout>
    </FrameLayout>

    <!-- ScrollView pour tout le contenu qui déborde -->
    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:paddingHorizontal="15dp">

            <TextView
                android:id="@+id/txtNomBatiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginEnd="20dp"
                android:layout_marginBottom="30dp"
                android:fontFamily="@font/gotham_black"
                android:text="Ecole Polytechnique de Lomé"
                android:textSize="22sp" />

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical">

                <TextView
                    android:id="@+id/descLabel"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="14dp"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Description"
                    android:textSize="18sp"
                    android:textStyle="bold" />

                <TextView
                    android:id="@+id/desc"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_book"
                    android:lineSpacingExtra="3dp"
                    android:text="Situé au niveau du parking juste derrière AUF, la bibliothèque et I'Auditorium de l'université"
                    android:textSize="16sp"
                    android:textStyle="bold" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dp"
                android:orientation="horizontal">

                <ImageView
                    android:layout_width="30dp"
                    android:layout_height="30dp"
                    android:layout_marginEnd="15dp"
                    android:contentDescription="Icône bâtiment"
                    android:src="@drawable/route_icon" />

                <TextView
                    android:id="@+id/txtDistance"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:layout_marginEnd="20dp"
                    android:fontFamily="@font/gotham_book"
                    android:text="200m"
                    android:textSize="16sp" />

                <TextView
                    android:id="@+id/situationBat"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Campus Nord"
                    android:textSize="16sp" />

            </LinearLayout>

            <FrameLayout
                android:id="@+id/imageContainer"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:visibility="gone">

                <androidx.viewpager2.widget.ViewPager2
                    android:id="@+id/imagePager"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipChildren="false"
                    android:clipToOutline="true"
                    android:clipToPadding="false"
                    android:scaleType="fitXY" />

                <com.google.android.material.tabs.TabLayout
                    android:id="@+id/imageIndicator"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center_horizontal"
                    android:layout_marginBottom="-30dp"
                    android:background="@android:color/transparent"
                    app:tabBackground="@drawable/dot_selector"
                    app:tabIndicatorColor="@android:color/transparent"
                    app:tabIndicatorHeight="0dp"
                    app:tabSelectedTextColor="@color/selected_dot_color"
                    app:tabTextColor="@color/unselected_dot_color" />

            </FrameLayout>

            <LinearLayout
                android:id="@+id/miniMapLayout"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginHorizontal="6dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:padding="1dp"
                android:visibility="gone">

                <!-- res/layout/minimap_layout.xml -->
                <org.osmdroid.views.MapView
                    android:id="@+id/miniMap"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipToOutline="true"
                    android:gravity="center"
                    android:scaleType="fitXY" />

            </LinearLayout>

            <LinearLayout
                android:id="@+id/aller"
                android:layout_width="240dp"
                android:layout_height="50dp"
                android:layout_gravity="center"
                android:layout_margin="25dp"
                android:background="@drawable/search_icon_bg"
                android:clickable="true"
                android:gravity="center">

                <ImageView
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="10dp"
                    android:clipToOutline="true"
                    android:src="@drawable/map_loc" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_book"
                    android:text="Aller à l'endroit"
                    android:textColor="@color/white"
                    android:textSize="15sp" />

            </LinearLayout>


        </LinearLayout>

    </ScrollView>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    android:padding="0dp">

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="250dp"
        android:layout_marginBottom="8dp">

        <ImageView
            android:id="@+id/imgInfra"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/activity_img_bg"
            android:clipToOutline="true"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="35dp"
            android:layout_height="35dp"
            android:layout_gravity="start|top"
            android:layout_margin="16dp"
            android:background="@drawable/rounded_frame"
            android:gravity="center">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon" />

        </LinearLayout>
    </FrameLayout>

    <!-- ScrollView pour tout le contenu qui déborde -->
    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:paddingHorizontal="15dp">

            <TextView
                android:id="@+id/txtNomInfra"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginEnd="20dp"
                android:layout_marginBottom="30dp"
                android:fontFamily="@font/gotham_black"
                android:text="Espace Bella Below"
                android:textSize="22sp" />

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical">

                <TextView
                    android:id="@+id/descLabel"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="14dp"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Description"
                    android:textSize="18sp"
                    android:textStyle="bold" />

                <TextView
                    android:id="@+id/desc"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_book"
                    android:lineSpacingExtra="3dp"
                    android:text="Situé au niveau du parking juste derrière AUF, la bibliothèque et I'Auditorium de l'université"
                    android:textSize="16sp"
                    android:textStyle="bold" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dp"
                android:orientation="horizontal">

                <ImageView
                    android:layout_width="30dp"
                    android:layout_height="30dp"
                    android:layout_marginEnd="15dp"
                    android:contentDescription="Icône bâtiment"
                    android:src="@drawable/route_icon" />

                <TextView
                    android:id="@+id/txtDistance"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:layout_marginEnd="20dp"
                    android:fontFamily="@font/gotham_book"
                    android:text="200m"
                    android:textSize="16sp" />

                <TextView
                    android:id="@+id/situationInfra"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Campus Nord"
                    android:textSize="16sp" />

            </LinearLayout>

            <FrameLayout
                android:id="@+id/imageContainer"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:visibility="gone">

                <androidx.viewpager2.widget.ViewPager2
                    android:id="@+id/imagePager"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipChildren="false"
                    android:clipToOutline="true"
                    android:clipToPadding="false"
                    android:scaleType="fitXY" />

                <com.google.android.material.tabs.TabLayout
                    android:id="@+id/imageIndicator"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center_horizontal"
                    android:layout_marginBottom="-30dp"
                    android:background="@android:color/transparent"
                    app:tabBackground="@drawable/dot_selector"
                    app:tabIndicatorColor="@android:color/transparent"
                    app:tabIndicatorHeight="0dp"
                    app:tabSelectedTextColor="@color/selected_dot_color"
                    app:tabTextColor="@color/unselected_dot_color" />

            </FrameLayout>

            <LinearLayout
                android:id="@+id/miniMapLayout"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginHorizontal="6dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:padding="1dp"
                android:visibility="gone">

                <!-- res/layout/minimap_layout.xml -->
                <org.osmdroid.views.MapView
                    android:id="@+id/miniMap"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipToOutline="true"
                    android:gravity="center"
                    android:scaleType="fitXY" />

            </LinearLayout>

            <LinearLayout
                android:id="@+id/aller"
                android:layout_width="240dp"
                android:layout_height="50dp"
                android:layout_gravity="center"
                android:layout_margin="25dp"
                android:background="@drawable/search_icon_bg"
                android:gravity="center">

                <ImageView
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="10dp"
                    android:clipToOutline="true"
                    android:src="@drawable/map_loc" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_book"
                    android:text="Aller à l'endroit"
                    android:textColor="@color/white"
                    android:textSize="15sp" />

            </LinearLayout>

        </LinearLayout>

    </ScrollView>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_main.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<androidx.drawerlayout.widget.DrawerLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/drawer_layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    tools:context=".MainActivity">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@color/white"
        android:orientation="vertical"
        tools:context=".MainActivity">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal">

            <!-- Toolbar fixe en haut -->
            <com.google.android.material.appbar.AppBarLayout
                android:layout_width="80dp"
                android:layout_height="wrap_content"
                android:background="@color/white">

                <androidx.appcompat.widget.Toolbar
                    android:id="@+id/toolbarHome"
                    android:layout_width="80dp"
                    android:layout_height="?attr/actionBarSize"
                    android:background="@color/white"
                    android:gravity="center"
                    app:navigationIcon="@drawable/hamburger_menu" />

            </com.google.android.material.appbar.AppBarLayout>

            <FrameLayout
                android:id="@+id/search_bar_container"
                android:layout_width="match_parent"
                android:layout_height="?attr/actionBarSize"
                android:layout_gravity="center" />

        </LinearLayout>

        <!-- Conteneur pour afficher les fragments -->
        <FrameLayout
            android:id="@+id/container"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight="5" />

        <!-- Bottom Navigation -->
        <include layout="@layout/custom_bottom_nav" />

    </LinearLayout>

    <com.google.android.material.navigation.NavigationView
        android:id="@+id/nav_view"
        android:layout_width="290dp"
        android:layout_height="match_parent"
        android:layout_gravity="start"
        android:background="@drawable/drawer_nav_bg"
        android:clipChildren="true"
        app:headerLayout="@layout/nav_header"
        app:itemIconSize="30dp"
        app:itemIconTint="@color/logo_color"
        app:itemTextAppearance="@style/NavigationDrawerText"
        app:itemTextColor="@color/logo_color"
        app:menu="@menu/drawer_menu" />

</androidx.drawerlayout.widget.DrawerLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_maps.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".ui.maps.MapsActivity">

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <org.osmdroid.views.MapView
            android:id="@+id/mapView"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            tools:layout_editor_absoluteX="0dp"
            tools:layout_editor_absoluteY="0dp" />

        <ProgressBar
            android:id="@+id/locationProgressBar"
            style="?android:attr/progressBarStyleLarge"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true"
            android:visibility="gone"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_gravity="start|top"
            android:layout_marginHorizontal="16dp"
            android:layout_marginVertical="75dp"
            android:background="@drawable/background_circulaire_2"
            android:gravity="center"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintTop_toTopOf="parent">

            <ImageView
                android:layout_width="30dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon_maps"
                app:tint="@color/black" />

        </LinearLayout>

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/theme_icon"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:background="@drawable/background_circulaire_2"
            android:padding="2dp"
            android:src="@drawable/theme_icon"
            android:visibility="gone"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_location"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/focus_location"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_destination"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/destination"
            app:layout_constraintBottom_toTopOf="@id/focus_location"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/recharger"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire_2"
            android:padding="7dp"
            android:src="@drawable/recharger"
            android:visibility="gone"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/theme_icon" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/hide"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire_2"
            android:padding="3dp"
            android:src="@drawable/no_hide"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/recharger" />

    </androidx.constraintlayout.widget.ConstraintLayout>

</androidx.constraintlayout.widget.ConstraintLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    android:padding="0dp">

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="250dp"
        android:layout_marginBottom="8dp">

        <ImageView
            android:id="@+id/imgSalle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/activity_img_bg"
            android:clipToOutline="true"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="35dp"
            android:layout_height="35dp"
            android:layout_gravity="start|top"
            android:layout_margin="16dp"
            android:background="@drawable/rounded_frame"
            android:gravity="center">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon" />

        </LinearLayout>
    </FrameLayout>

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:paddingHorizontal="15dp">

            <TextView
                android:id="@+id/txtNomSalle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginEnd="20dp"
                android:layout_marginBottom="30dp"
                android:fontFamily="@font/gotham_black"
                android:text="Espace Bella Below"
                android:textSize="22sp" />

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical">

                <TextView
                    android:id="@+id/descLabel"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="14dp"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Description"
                    android:textSize="18sp"
                    android:textStyle="bold" />

                <TextView
                    android:id="@+id/desc"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_book"
                    android:lineSpacingExtra="3dp"
                    android:text="Situé au niveau du parking juste derrière AUF, la bibliothèque et I'Auditorium de l'université"
                    android:textSize="16sp"
                    android:textStyle="bold" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dp"
                android:orientation="horizontal">

                <ImageView
                    android:layout_width="30dp"
                    android:layout_height="30dp"
                    android:layout_marginEnd="15dp"
                    android:contentDescription="Icône bâtiment"
                    android:src="@drawable/route_icon" />

                <TextView
                    android:id="@+id/txtDistance"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:layout_marginEnd="20dp"
                    android:fontFamily="@font/gotham_book"
                    android:text="200m"
                    android:textSize="16sp" />

                <TextView
                    android:id="@+id/situationSalle"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Campus Nord"
                    android:textSize="16sp" />

            </LinearLayout>

            <FrameLayout
                android:id="@+id/imageContainer"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg">

                <androidx.viewpager2.widget.ViewPager2
                    android:id="@+id/imagePager"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipChildren="false"
                    android:clipToOutline="true"
                    android:clipToPadding="false"
                    android:scaleType="fitXY" />

                <com.google.android.material.tabs.TabLayout
                    android:id="@+id/imageIndicator"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center_horizontal"
                    android:layout_marginBottom="-30dp"
                    android:background="@android:color/transparent"
                    app:tabBackground="@drawable/dot_selector"
                    app:tabIndicatorColor="@android:color/transparent"
                    app:tabIndicatorHeight="0dp"
                    app:tabSelectedTextColor="@color/selected_dot_color"
                    app:tabTextColor="@color/unselected_dot_color" />

            </FrameLayout>

            <LinearLayout
                android:id="@+id/miniMapLayout"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginHorizontal="6dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:padding="1dp"
                android:visibility="gone">

                <!-- res/layout/minimap_layout.xml -->
                <org.osmdroid.views.MapView
                    android:id="@+id/miniMap"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipToOutline="true"
                    android:gravity="center"
                    android:scaleType="fitXY" />

            </LinearLayout>


            <LinearLayout
                android:id="@+id/aller"
                android:layout_width="240dp"
                android:layout_height="50dp"
                android:layout_gravity="center"
                android:layout_margin="25dp"
                android:background="@drawable/search_icon_bg"
                android:gravity="center">

                <ImageView
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="10dp"
                    android:clipToOutline="true"
                    android:src="@drawable/map_loc" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_book"
                    android:text="Aller à l'endroit"
                    android:textColor="@color/white"
                    android:textSize="15sp" />

            </LinearLayout>

        </LinearLayout>

    </ScrollView>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\custom_bottom_nav.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/customBottomNav"
    android:layout_width="match_parent"
    android:layout_height="60dp"
    android:layout_marginStart="8dp"
    android:layout_marginTop="5dp"
    android:layout_marginEnd="8dp"
    android:background="@drawable/bottom_nav_background"
    android:gravity="center"
    android:orientation="horizontal"
    android:padding="10dp">

    <LinearLayout
        android:id="@+id/container_home"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <!-- Item Accueil -->
        <LinearLayout
            android:id="@+id/nav_home"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_home"
                android:layout_width="17dp"
                android:layout_height="22dp"
                android:src="@drawable/home_icon"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_home"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="80dp"
                android:text="@string/accueil"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:id="@+id/container_batiment"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <LinearLayout
            android:id="@+id/nav_batiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_batiment"
                android:layout_width="22dp"
                android:layout_height="22dp"
                android:src="@drawable/batiment_nav_icon"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_batiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="100dp"
                android:paddingStart="8dp"
                android:text="@string/batiments"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:id="@+id/container_salle"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <LinearLayout
            android:id="@+id/nav_salle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_salle"
                android:layout_width="22dp"
                android:layout_height="22dp"
                android:src="@drawable/infra_nav_icon"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_salle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="60dp"
                android:paddingStart="8dp"
                android:text="@string/infrastructures"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:id="@+id/container_maps"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <LinearLayout
            android:id="@+id/nav_maps"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_maps"
                android:layout_width="22dp"
                android:layout_height="22dp"
                android:src="@drawable/map_loc"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_maps"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="60dp"
                android:paddingStart="8dp"
                android:text="@string/carte"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_all_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.batiment.AllBatimentFragment">

    <include
        android:id="@+id/shimmerAllBatiments"
        layout="@layout/shimmer_all_bat_container" />

    <!-- Liste horizontale des bâtiments -->
    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllBatiments"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_all_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.infrastructure.AllInfraFragment">

    <include
        android:id="@+id/shimmerAllInfra"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllInfra"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    tools:context=".ui.batiment.BatimentFragment">

    <!-- Barre de navigation horizontale -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="horizontal"
        android:padding="16dp">

        <LinearLayout
            android:id="@+id/nav_all"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="28dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="Tout"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_all"
                android:layout_width="38dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_nord"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="32dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="Campus Nord"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_nord"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_sud"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="Campus Sud"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_sud"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>
    </LinearLayout>

    <FrameLayout
        android:id="@+id/batiment_container"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_home.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:layout_behavior="@string/appbar_scrolling_view_behavior"
    tools:context=".ui.home.HomeFragment">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:paddingVertical="16dp"
        android:paddingStart="16dp"
        android:paddingEnd="8dp">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/batiments_d_enseignement"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerBatimentsEnsContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerBatiments"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_batiment" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="25dp"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/batiment_administratifs"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerBatimentsAdminContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerBatimentsAdmin"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_batiment" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="25dp"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/salles"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerSalleContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerSalles"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_salle" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="25dp"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/autres_infrastructures"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerInfraContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerInfra"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_infra" />

    </LinearLayout>

</androidx.core.widget.NestedScrollView> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    tools:context=".ui.infrastructure.InfraFragment">

    <!-- Barre de navigation horizontale -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="horizontal"
        android:padding="16dp">

        <LinearLayout
            android:id="@+id/nav_all"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="28dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="@string/tout"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_all"
                android:layout_width="38dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_nord"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="32dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="@string/campus_nord"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_nord"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_sud"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="@string/campus_sud"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_sud"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>
    </LinearLayout>

    <FrameLayout
        android:id="@+id/infra_container"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_loc_ul.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="48dp"
    android:layout_gravity="center"
    android:layout_marginHorizontal="8dp"
    android:background="@drawable/search_background"
    android:gravity="center"
    android:orientation="horizontal">

    <de.hdodenhof.circleimageview.CircleImageView
        android:layout_width="35dp"
        android:layout_height="35dp"
        android:layout_margin="5dp"
        android:src="@drawable/loc_ul" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="LocUL"
        android:textColor="@color/mainColor"
        android:textSize="20sp"
        android:textStyle="bold" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_logo.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="48dp"
    android:layout_gravity="center"
    android:layout_marginTop="5dp"
    android:gravity="end"
    android:orientation="horizontal"
    android:paddingEnd="0dp">

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"

        android:paddingHorizontal="10dp">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginEnd="13dp"
            android:fontFamily="@font/gotham_black"
            android:text="LocUL"
            android:textColor="@color/logo_color"
            android:textSize="25sp"
            android:textStyle="bold" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:layout_width="38dp"
            android:layout_height="38dp"
            android:layout_gravity="center"
            android:layout_margin="5dp"
            android:src="@drawable/loc_ul" />

    </LinearLayout>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_maps.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".ui.maps.MapsFragment">

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <org.osmdroid.views.MapView
            android:id="@+id/mapView"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            tools:layout_editor_absoluteX="0dp"
            tools:layout_editor_absoluteY="0dp" />

        <ProgressBar
            android:id="@+id/locationProgressBar"
            style="?android:attr/progressBarStyleLarge"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true"
            android:visibility="gone"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />


        <LinearLayout
            android:id="@+id/destination_layout"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginVertical="63dp"
            android:layout_marginRight="150dp"
            android:background="@drawable/maps_destination_remove"
            android:gravity="center"
            android:orientation="horizontal"
            android:visibility="invisible"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintTop_toTopOf="parent">

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_weight="0.9"
                android:background="@drawable/maps_destination"
                android:gravity="center"
                android:orientation="vertical"
                android:padding="5dp"
                app:layout_constraintLeft_toLeftOf="parent"
                app:layout_constraintTop_toTopOf="parent">

                <TextView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_medium"
                    android:gravity="center"
                    android:text="Nouvelle destination ?"
                    android:textColor="@color/mainColor"
                    android:textStyle="bold" />

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:gravity="center"
                    android:orientation="horizontal">

                    <TextView
                        android:id="@+id/destination_text"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_margin="3dp"
                        android:layout_weight="0.9"
                        android:ellipsize="end"
                        android:fontFamily="@font/gotham_medium"
                        android:gravity="center"
                        android:lines="2"
                        android:maxLines="2"
                        android:text="Nouvelle destination ?"
                        android:textColor="@color/mainColor" />

                    <LinearLayout
                        android:id="@+id/btnRetour"
                        android:layout_width="35dp"
                        android:layout_height="35dp"
                        android:layout_gravity="start|top"
                        android:layout_weight="0.1"
                        android:gravity="center">

                        <ImageView
                            android:id="@+id/valider"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                            android:background="?attr/selectableItemBackgroundBorderless"
                            android:scaleType="centerInside"
                            android:src="@drawable/valider" />

                    </LinearLayout>
                </LinearLayout>
            </LinearLayout>

            <LinearLayout
                android:id="@+id/annuler"
                android:layout_width="14dp"
                android:layout_height="match_parent"
                android:layout_gravity="start|top"
                android:gravity="center">

                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:scaleType="centerInside"
                    android:src="@drawable/back_icon"
                    app:tint="@color/black" />

            </LinearLayout>

        </LinearLayout>

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/theme_icon"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:background="@drawable/background_circulaire"
            android:padding="2dp"
            android:src="@drawable/theme_icon"
            android:visibility="gone"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_location"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/focus_location"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_destination"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/destination"
            app:layout_constraintBottom_toTopOf="@id/focus_location"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/recharger"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire"
            android:padding="7dp"
            android:src="@drawable/recharger"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/theme_icon" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/hide"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire"
            android:padding="3dp"
            android:src="@drawable/hide"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/recharger" />

    </androidx.constraintlayout.widget.ConstraintLayout>
</FrameLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_nord_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.batiment.NordBatimentFragment">

    <include
        android:id="@+id/shimmerNordBatiments"
        layout="@layout/shimmer_all_bat_container" />

    <!-- Liste horizontale des bâtiments -->
    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerNordBatiments"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_nord_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.infrastructure.NordInfraFragment">

    <include
        android:id="@+id/shimmerNordInfra"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerNordInfra"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_search_bar.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="44dp"
    android:layout_gravity="center"
    android:layout_marginHorizontal="8dp"
    android:layout_marginTop="5dp"
    android:background="@drawable/search_background"
    android:gravity="center_vertical"
    android:orientation="horizontal">

    <EditText
        android:id="@+id/search_edit_text"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_marginHorizontal="5dp"
        android:layout_weight="1"
        android:background="@null"
        android:hint="Recherche..."
        android:imeOptions="actionSearch"
        android:paddingStart="10dp"
        android:singleLine="true"
        android:textColor="@color/black"
        android:textColorHint="#A0A0A0"
        android:textSize="15sp" />

    <LinearLayout
        android:layout_width="44dp"
        android:layout_height="44dp"
        android:background="@drawable/search_icon_bg"
        android:gravity="center"
        android:orientation="horizontal">

        <ImageView
            android:id="@+id/searchIcon"
            android:layout_width="24dp"
            android:layout_height="24dp"
            android:contentDescription="Search"
            android:src="@drawable/search_icon" />

    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_sud_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.batiment.SudBatimentFragment">

    <include
        android:id="@+id/shimmerSudBatiments"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerSudBatiments"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_sud_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.infrastructure.SudInfraFragment">

    <include
        android:id="@+id/shimmerSudInfra"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerSudInfra"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_bat_admin.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllBatAdminFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllBatimentsAdmin"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_bat_ens.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllBatEnsFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllBatimentsEns"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllInfraFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllInfraHome"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllSalleFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllSalle"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_salle" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_all_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <!-- Icône du bâtiment -->
    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgBatiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomBatiment"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Bâtiment"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationBat"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:src="@drawable/route_icon" />

            <TextView
                android:id="@+id/txtDistanceBatiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="500m"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_all_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgInfra"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Infra"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:contentDescription="Icône bâtiment"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceInfra"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_all_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <!-- Icône de la salle -->
    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgSalle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <!-- Bloc nom + distance -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <!-- Nom de la salle -->
        <TextView
            android:id="@+id/txtNomSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:maxLines="1"
            android:text="Nom Salle"
            android:textSize="15sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/situationSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp"
            android:visibility="gone" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="8dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/batimentSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_horizontal"
            android:maxLines="2"
            android:text="EPL (Ecole Polytechnique de Lome---)"
            android:textSize="13sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="10dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:contentDescription="Icône bâtiment"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceSalle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgBatiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomBatiment"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Bâtiment"
            android:textSize="15sp"
            android:textStyle="bold" />

        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationBat"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:src="@drawable/route_icon" />

            <TextView
                android:id="@+id/txtDistanceBatiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="500m"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="8dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgInfra"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <!-- Bloc nom + distance -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Infra"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="8dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="14dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceInfra"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="8dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgSalle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <!-- Bloc nom + distance -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="7dp"
            android:layout_marginBottom="7dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:maxLines="1"
            android:text="Nom Salle"
            android:textSize="15sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/situationSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp"
            android:visibility="gone" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="8dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/batimentSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="2dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:maxLines="2"
            android:text="Batiment A"
            android:textSize="13sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:contentDescription="Icône bâtiment"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceSalle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_voir_tout.xml 
=============================================== 
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="125dp"
    android:layout_marginStart="-7dp"
    android:gravity="center">

    <ImageView
        android:id="@+id/imgVoirTout"
        android:layout_width="75dp"
        android:layout_height="75dp"
        android:layout_gravity="center"
        android:src="@drawable/view_all" />
</FrameLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\nav_header.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="176dp"
    android:background="@drawable/header_nav_bg"
    android:gravity="center_vertical"
    android:orientation="vertical"
    android:padding="16dp"
    android:theme="@style/ThemeOverlay.AppCompat.Dark">


    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:fontFamily="@font/gotham_bold"
        android:paddingTop="8dp"
        android:text="LocUL"
        android:textAppearance="@style/TextAppearance.AppCompat.Body1"
        android:textSize="25sp"
        android:textStyle="bold" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:fontFamily="@font/gotham_book"
        android:text="@string/app_desc" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\settings.xml 
=============================================== 
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/rounded_frame"
    android:paddingLeft="16dp"
    android:paddingTop="16dp"
    android:paddingRight="16dp"
    android:paddingBottom="10dp">

    <TextView
        android:id="@+id/title"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:fontFamily="@font/gotham_book"
        android:gravity="center"
        android:paddingBottom="25dp"
        android:text="@string/reglages"
        android:textColor="@color/black"
        android:textSize="18sp"
        android:textStyle="bold" />

    <TextView
        android:id="@+id/languageLabel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/title"
        android:layout_alignParentStart="true"
        android:layout_marginEnd="20dp"
        android:layout_marginBottom="10dp"
        android:fontFamily="@font/gotham_medium"
        android:text="@string/langage"
        android:textColor="@color/black"
        android:textSize="16sp"
        android:textStyle="bold" />

    <Spinner
        android:id="@+id/languageSpinner"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/title"
        android:layout_alignBaseline="@id/languageLabel"
        android:layout_alignParentEnd="true"
        android:layout_marginTop="16dp"
        android:layout_toEndOf="@id/languageLabel"
        android:fontFamily="@font/gotham_book"
        android:textColor="@color/black" />

    <TextView
        android:id="@+id/themeLabel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/languageLabel"
        android:layout_alignParentStart="true"
        android:layout_marginTop="16dp"
        android:layout_marginEnd="20dp"
        android:layout_marginBottom="10dp"
        android:fontFamily="@font/gotham_medium"
        android:text="@string/theme"
        android:textColor="@color/black"
        android:textSize="16sp"
        android:textStyle="bold" />

    <Spinner
        android:id="@+id/themeSpinner"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/languageLabel"
        android:layout_alignBaseline="@id/themeLabel"
        android:layout_alignParentEnd="true"
        android:layout_marginTop="16dp"
        android:layout_toEndOf="@id/themeLabel"
        android:fontFamily="@font/gotham_book"
        android:textColor="@color/black" />

    <Button
        android:id="@+id/appliquer"
        android:layout_width="120dp"
        android:layout_height="wrap_content"
        android:layout_alignParentEnd="true"
        android:layout_alignParentBottom="true"
        android:layout_marginTop="10dp"
        android:fontFamily="@font/gotham_book"
        android:text="@string/appliquer"
        android:textColor="@color/white" />
</RelativeLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_all_bat_container.xml 
=============================================== 
<com.facebook.shimmer.ShimmerFrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/shimmerBatimentsEns"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:shimmer_auto_start="true"
    app:shimmer_duration="800">

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scrollbars="none">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical">

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

        </LinearLayout>
    </ScrollView>
</com.facebook.shimmer.ShimmerFrameLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_batiments_container.xml 
=============================================== 
<com.facebook.shimmer.ShimmerFrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/shimmerBatimentsEns"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:shimmer_auto_start="true"
    app:shimmer_duration="800">

    <HorizontalScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scrollbars="none">

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="horizontal">

            <include layout="@layout/shimmer_item_batiment" />

            <include layout="@layout/shimmer_item_batiment" />

            <include layout="@layout/shimmer_item_batiment" />

            <include layout="@layout/shimmer_item_batiment" />

        </LinearLayout>
    </HorizontalScrollView>
</com.facebook.shimmer.ShimmerFrameLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_item_all_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <!-- Icône du bâtiment -->
    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <View
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <View
            android:layout_width="match_parent"
            android:layout_height="30dp"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:background="@color/shimmer_placeholder_color"
            android:ellipsize="end"
            android:gravity="center_vertical"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <View
            android:layout_width="120dp"
            android:layout_height="20dp"
            android:background="@color/shimmer_placeholder_color"
            android:fontFamily="@font/gotham_book"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <View
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:background="@color/shimmer_placeholder_color" />

            <View
                android:layout_width="60dp"
                android:layout_height="16dp"
                android:background="@color/shimmer_placeholder_color"
                android:fontFamily="@font/gotham_book"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_item_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <View
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <View
            android:layout_width="120dp"
            android:layout_height="20dp"
            android:layout_gravity="center"
            android:layout_marginTop="10dp"
            android:layout_marginBottom="10dp"
            android:background="@color/shimmer_placeholder_color" />

        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="10dp"
            android:background="@android:color/darker_gray" />

        <View
            android:layout_width="100dp"
            android:layout_height="16dp"
            android:layout_marginBottom="15dp"
            android:background="@color/shimmer_placeholder_color" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal">

            <View
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:background="@color/shimmer_placeholder_color" />

            <View
                android:layout_width="60dp"
                android:layout_height="16dp"
                android:background="@color/shimmer_placeholder_color" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\spinner_item.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/text1"
    style="?android:attr/spinnerItemStyle"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ellipsize="marquee"
    android:fontFamily="@font/gotham_book"
    android:singleLine="true"
    android:textAlignment="inherit"
    android:textColor="@color/black" /> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\test.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:background="@drawable/search_icon_bg"
    android:gravity="center"
    android:orientation="horizontal">

    <ImageView
        android:id="@+id/searchIcon"
        android:layout_width="24dp"
        android:layout_height="24dp"
        android:contentDescription="Search"
        android:src="@drawable/search_icon" />


</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\menu\bottom_nav_menu.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">

    <item
        android:id="@+id/nav_home"
        android:icon="@drawable/home_icon"
        android:title="Accueil" />

    <item
        android:id="@+id/nav_batiment"
        android:icon="@drawable/batiment_nav_icon"
        android:title="Batiments" />

    <item
        android:id="@+id/nav_salle"
        android:icon="@drawable/salle_nav_icon"
        android:title="Infrastructures" />

    <item
        android:id="@+id/nav_maps"
        android:icon="@drawable/salle_nav_icon"
        android:title="maps" />

</menu> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\menu\bouton_nav_menu.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item
        android:id="@+id/nav_home"
        android:icon="@drawable/home"
        android:textStyle="bold"
        android:title="Home" />
    <item
        android:id="@+id/nav_maps"
        android:icon="@drawable/maps_and_flags"
        android:textStyle="bold"
        android:title="Maps" />
</menu> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\menu\drawer_menu.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">

    <group android:id="@+id/group1">
        <item
            android:id="@+id/settings"
            android:icon="@drawable/settings_icon"
            android:title="Reglages" />
    </group>

    <group android:id="@+id/group2">
        <item
            android:id="@+id/share"
            android:icon="@drawable/share_2_icon"
            android:title="Partager" />
    </group>

    <group android:id="@+id/group3">
        <item
            android:id="@+id/contact"
            android:icon="@drawable/contact_icon"
            android:title="Contact" />
    </group>

    <group android:id="@+id/group4">
        <item
            android:id="@+id/about"
            android:icon="@drawable/about_icon"
            android:title="A propos" />
    </group>

</menu> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\ic_launcher.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
    <monochrome android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\ic_launcher_round.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
    <monochrome android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\loc_ul_launcher.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@mipmap/loc_ul_launcher_background" />
    <foreground android:drawable="@mipmap/loc_ul_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\loc_ul_launcher_round.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@mipmap/loc_ul_launcher_background" />
    <foreground android:drawable="@mipmap/loc_ul_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\colors.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="black">#FF000000</color>
    <color name="white">#FFFFFFFF</color>
    <color name="bottom_nav_default">#F0E9F6</color>
    <color name="bottom_nav_default_item">#E6DEF6</color>
    <color name="red">#D7FF0000</color>
    <color name="gray">#808080</color>
    <color name="mainColor">#1F3563</color>
    <color name="selected_dot_color">@color/white</color>
    <color name="unselected_dot_color">#B0B0B0</color>
    <color name="shimmer_placeholder_color">#DDDDDD</color>
    <color name="shimmer_highlight_color">#EEEEEE</color>
    <color name="logo_color">#1F3563</color>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\dimens.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <dimen name="custom_dot_width">10dp</dimen>
    <dimen name="custom_dot_height">10dp</dimen>
    <dimen name="custom_dot_margin_horizontal">4dp</dimen>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\strings.xml 
=============================================== 
<resources>
    <string name="app_name">LocUL</string>
    <!-- TODO: Remove or change this placeholder text -->
    <string name="hello_blank_fragment">Hello blank fragment</string>
    <string name="navigation_drawer_open">Ouvrir le menu de navigation</string>
    <string name="navigation_drawer_close">Fermer le menu de navigation</string>
    <string name="francais">Français</string>
    <string name="anglais">Anglais</string>
    <string name="clair">Clair</string>
    <string name="sombre">Sombre</string>
    <string name="systeme">Système</string>
    <string name="infrastructures">Infrastructures</string>
    <string name="accueil">Accueil</string>
    <string name="carte">Carte</string>
    <string name="batiments_d_enseignement">Bâtiments d\'enseignement</string>
    <string name="batiment_administratifs">Bâtiments administratifs</string>
    <string name="batiments">Bâtiments</string>
    <string name="salles">Salles</string>
    <string name="autres_infrastructures">Autres infrastructures</string>
    <string name="tout">Tout</string>
    <string name="campus_nord">Campus Nord</string>
    <string name="campus_sud">Campus Sud</string>
    <string name="reglages">Réglages</string>
    <string name="langage">Langage</string>
    <string name="theme">Thème</string>
    <string name="appliquer">Appliquer</string>
    <string name="recherche">Recherche...</string>
    <string name="app_desc">Repérer vous à l\'Université de Lomé</string>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\themes.xml 
=============================================== 
<resources>
    <!-- Base application theme. -->
    <style name="Base.Theme.LocUL" parent="Theme.Material3.DayNight.NoActionBar">
        <!-- Customize your light theme here. -->
        <!-- <item name="colorPrimary">@color/my_light_primary</item> -->
        <item name="colorPrimary">@color/mainColor</item>
    </style>

    <style name="NavigationDrawerText">
        <item name="android:fontFamily">@font/gotham_medium</item>
        <item name="android:textSize">16sp</item>
    </style>

    <style name="NavigationDrawerItemStyle">
        <item name="android:layout_marginTop">5dp</item>
        <item name="android:layout_marginBottom">5dp</item>
    </style>

    <style name="CustomTabDots" parent="Widget.Design.TabLayout">
        <item name="tabIndicatorHeight">0dp</item>
        <item name="tabPaddingStart">6dp</item>
        <item name="tabPaddingEnd">6dp</item>
        <item name="tabMinWidth">8dp</item>
    </style>

    <style name="Theme.LocUL" parent="Base.Theme.LocUL" />
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values-en\strings.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name">LocUL</string>
    <!-- TODO: Remove or change this placeholder text -->
    <string name="hello_blank_fragment">Hello blank fragment</string>
    <string name="navigation_drawer_open">Open navigation menu</string>
    <string name="navigation_drawer_close">Close navigation menu</string>
    <string name="francais">French</string>
    <string name="anglais">English</string>
    <string name="clair">Light</string>
    <string name="sombre">Dark</string>
    <string name="systeme">System</string>
    <string name="infrastructures">Facilities</string>
    <string name="accueil">Home</string>
    <string name="carte">Map</string>
    <string name="batiments_d_enseignement">Teaching buildings</string>
    <string name="batiment_administratifs">Administrative buildings</string>
    <string name="batiments">Buildings</string>
    <string name="salles">Rooms</string>
    <string name="autres_infrastructures">Other facilities</string>
    <string name="tout">All</string>
    <string name="campus_nord">North Campus</string>
    <string name="campus_sud">South Campus</string>
    <string name="reglages">Settings</string>
    <string name="langage">Language</string>
    <string name="theme">Theme</string>
    <string name="appliquer">Apply</string>
    <string name="recherche">Search...</string>
    <string name="app_desc">Find your way at the University of Lomé</string>
</resources>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values-night\colors.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="white">#282828</color>
    <color name="mainColor">#437FF6</color>
    <color name="black">#E0E0E0</color>
    <color name="bottom_nav_default">#333333</color>
    <color name="bottom_nav_default_item">#3A3A3A</color>
    <color name="gray">#606060</color>
    <color name="selected_dot_color">#FFFFFF</color>
    <color name="unselected_dot_color">#B0B0B0</color>
    <color name="shimmer_placeholder_color">#2D2D2D</color>
    <color name="shimmer_highlight_color">#3D3D3D</color>
    <color name="logo_color">#E0E0E0</color>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values-night\themes.xml 
=============================================== 
<resources>
    <!-- Base application theme. -->
    <style name="Base.Theme.LocUL.Dark" parent="Theme.Material3.DayNight.NoActionBar">
        <item name="colorPrimary">@color/mainColor</item>
    </style>

    <style name="Theme.LocUL" parent="Base.Theme.LocUL.Dark">
        <item name="colorPrimary">@color/mainColor</item>
    </style>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\xml\backup_rules.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?><!--
   Sample backup rules file; uncomment and customize as necessary.
   See https://developer.android.com/guide/topics/data/autobackup
   for details.
   Note: This file is ignored for devices older than API 31
   See https://developer.android.com/about/versions/12/backup-restore
-->
<full-backup-content>
    <!--
   <include domain="sharedpref" path="."/>
   <exclude domain="sharedpref" path="device.xml"/>
-->
</full-backup-content> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\xml\data_extraction_rules.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?><!--
   Sample data extraction rules file; uncomment and customize as necessary.
   See https://developer.android.com/about/versions/12/backup-restore#xml-changes
   for details.
-->
<data-extraction-rules>
    <cloud-backup>
        <!-- TODO: Use <include> and <exclude> to control what is backed up.
        <include .../>
        <exclude .../>
        -->
    </cloud-backup>
    <!--
    <device-transfer>
        <include .../>
        <exclude .../>
    </device-transfer>
    -->
</data-extraction-rules> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\google-services.json 
=============================================== 
{
  "project_info": {
    "project_number": "599549183484",
    "project_id": "admin-site-4b122",
    "storage_bucket": "admin-site-4b122.firebasestorage.app"
  },
  "client": [
    {
      "client_info": {
        "mobilesdk_app_id": "1:599549183484:android:1bf3fd4bddd275a0d6de79",
        "android_client_info": {
          "package_name": "tg.univlome.epl"
        }
      },
      "oauth_client": [],
      "api_key": [
        {
          "current_key": "AIzaSyBPpQo7PtM8e0eY3HU3205XOOdg2S4kOeE"
        }
      ],
      "services": {
        "appinvite_service": {
          "other_platform_oauth_client": []
        }
      }
    }
  ],
  "configuration_version": "1"
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\raw\loading_animation.json 
=============================================== 
{
  "v": "5.5.8",
  "fr": 50,
  "ip": 0,
  "op": 147,
  "w": 800,
  "h": 600,
  "nm": "Paperplane",
  "ddd": 0,
  "assets": [
    {
      "id": "comp_0",
      "layers": [
        {
          "ddd": 0,
          "ind": 1,
          "ty": 4,
          "nm": "planete Outlines - Group 4",
          "sr": 1,
          "ks": {
            "o": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": [
                      0.833
                    ],
                    "y": [
                      0.833
                    ]
                  },
                  "o": {
                    "x": [
                      0.167
                    ],
                    "y": [
                      0.167
                    ]
                  },
                  "t": 0,
                  "s": [
                    0
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.833
                    ],
                    "y": [
                      0.833
                    ]
                  },
                  "o": {
                    "x": [
                      0.167
                    ],
                    "y": [
                      0.167
                    ]
                  },
                  "t": 38,
                  "s": [
                    50
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.833
                    ],
                    "y": [
                      0.833
                    ]
                  },
                  "o": {
                    "x": [
                      0.167
                    ],
                    "y": [
                      0.167
                    ]
                  },
                  "t": 88,
                  "s": [
                    50
                  ]
                },
                {
                  "t": 120,
                  "s": [
                    0
                  ]
                }
              ],
              "ix": 11
            },
            "r": {
              "a": 0,
              "k": 0,
              "ix": 10
            },
            "p": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": 0.833,
                    "y": 0.833
                  },
                  "o": {
                    "x": 0.167,
                    "y": 0.167
                  },
                  "t": 0,
                  "s": [
                    468.336,
                    323.378,
                    0
                  ],
                  "to": [
                    -29,
                    0,
                    0
                  ],
                  "ti": [
                    29,
                    0,
                    0
                  ]
                },
                {
                  "t": 102,
                  "s": [
                    294.336,
                    323.378,
                    0
                  ]
                }
              ],
              "ix": 2
            },
            "a": {
              "a": 0,
              "k": [
                453.672,
                304.756,
                0
              ],
              "ix": 1
            },
            "s": {
              "a": 0,
              "k": [
                50,
                50,
                100
              ],
              "ix": 6
            }
          },
          "ao": 0,
          "shapes": [
            {
              "ty": "gr",
              "it": [
                {
                  "ind": 0,
                  "ty": "sh",
                  "ix": 1,
                  "ks": {
                    "a": 0,
                    "k": {
                      "i": [
                        [
                          6.742,
                          0
                        ],
                        [
                          0.741,
                          -0.14
                        ],
                        [
                          0,
                          0.074
                        ],
                        [
                          13.484,
                          0
                        ],
                        [
                          1.669,
                          -0.361
                        ],
                        [
                          19.79,
                          0
                        ],
                        [
                          3.317,
                          -19.082
                        ],
                        [
                          2.691,
                          0
                        ],
                        [
                          0,
                          -13.484
                        ],
                        [
                          -0.048,
                          -0.629
                        ],
                        [
                          2.405,
                          0
                        ],
                        [
                          0,
                          -6.742
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          0,
                          6.743
                        ]
                      ],
                      "o": [
                        [
                          -0.781,
                          0
                        ],
                        [
                          0.001,
                          -0.074
                        ],
                        [
                          0,
                          -13.484
                        ],
                        [
                          -1.778,
                          0
                        ],
                        [
                          -3.594,
                          -18.742
                        ],
                        [
                          -20.03,
                          0
                        ],
                        [
                          -2.421,
                          -0.804
                        ],
                        [
                          -13.485,
                          0
                        ],
                        [
                          0,
                          0.642
                        ],
                        [
                          -1.89,
                          -1.199
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          6.743
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          6.742,
                          0
                        ],
                        [
                          0,
                          -6.742
                        ]
                      ],
                      "v": [
                        [
                          75.134,
                          16.175
                        ],
                        [
                          72.85,
                          16.396
                        ],
                        [
                          72.856,
                          16.175
                        ],
                        [
                          48.44,
                          -8.241
                        ],
                        [
                          43.262,
                          -7.685
                        ],
                        [
                          3.406,
                          -40.591
                        ],
                        [
                          -36.571,
                          -6.995
                        ],
                        [
                          -44.269,
                          -8.241
                        ],
                        [
                          -68.685,
                          16.175
                        ],
                        [
                          -68.604,
                          18.079
                        ],
                        [
                          -75.133,
                          16.175
                        ],
                        [
                          -87.341,
                          28.383
                        ],
                        [
                          -75.133,
                          40.592
                        ],
                        [
                          75.134,
                          40.592
                        ],
                        [
                          87.342,
                          28.383
                        ]
                      ],
                      "c": true
                    },
                    "ix": 2
                  },
                  "nm": "Path 1",
                  "mn": "ADBE Vector Shape - Group",
                  "hd": false
                },
                {
                  "ty": "fl",
                  "c": {
                    "a": 0,
                    "k": [
                      0.815686334348,
                      0.823529471603,
                      0.827451040231,
                      1
                    ],
                    "ix": 4
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 5
                  },
                  "r": 1,
                  "bm": 0,
                  "nm": "Fill 1",
                  "mn": "ADBE Vector Graphic - Fill",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      453.672,
                      304.756
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      0,
                      0
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      100,
                      100
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "Group 4",
              "np": 2,
              "cix": 2,
              "bm": 0,
              "ix": 1,
              "mn": "ADBE Vector Group",
              "hd": false
            }
          ],
          "ip": 0,
          "op": 151,
          "st": 0,
          "bm": 0
        },
        {
          "ddd": 0,
          "ind": 2,
          "ty": 4,
          "nm": "Merged Shape Layer",
          "sr": 1,
          "ks": {
            "o": {
              "a": 0,
              "k": 100,
              "ix": 11
            },
            "r": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.547
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 0,
                  "s": [
                    0
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.845
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 77,
                  "s": [
                    35
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    0
                  ]
                }
              ],
              "ix": 10
            },
            "p": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": 0.667,
                    "y": 1
                  },
                  "o": {
                    "x": 0.333,
                    "y": 0
                  },
                  "t": 0,
                  "s": [
                    390.319,
                    298.2,
                    0
                  ],
                  "to": [
                    0,
                    -2.583,
                    0
                  ],
                  "ti": [
                    0,
                    0,
                    0
                  ]
                },
                {
                  "i": {
                    "x": 0.667,
                    "y": 1
                  },
                  "o": {
                    "x": 0.333,
                    "y": 0
                  },
                  "t": 44,
                  "s": [
                    390.319,
                    282.7,
                    0
                  ],
                  "to": [
                    0,
                    0,
                    0
                  ],
                  "ti": [
                    0,
                    0,
                    0
                  ]
                },
                {
                  "i": {
                    "x": 0.667,
                    "y": 1
                  },
                  "o": {
                    "x": 0.333,
                    "y": 0
                  },
                  "t": 110,
                  "s": [
                    390.319,
                    319.25,
                    0
                  ],
                  "to": [
                    0,
                    0,
                    0
                  ],
                  "ti": [
                    0,
                    0,
                    0
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    390.319,
                    298.2,
                    0
                  ]
                }
              ],
              "ix": 2
            },
            "a": {
              "a": 0,
              "k": [
                664.319,
                256.2,
                0
              ],
              "ix": 1
            },
            "s": {
              "a": 0,
              "k": [
                100,
                100,
                100
              ],
              "ix": 6
            }
          },
          "ao": 0,
          "shapes": [
            {
              "ty": "gr",
              "it": [
                {
                  "ty": "gr",
                  "it": [
                    {
                      "ind": 0,
                      "ty": "sh",
                      "ix": 1,
                      "ks": {
                        "a": 0,
                        "k": {
                          "i": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "o": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "v": [
                            [
                              18.967,
                              -3.189
                            ],
                            [
                              -18.967,
                              19.935
                            ],
                            [
                              -0.949,
                              -19.935
                            ]
                          ],
                          "c": true
                        },
                        "ix": 2
                      },
                      "nm": "Path 1",
                      "mn": "ADBE Vector Shape - Group",
                      "hd": false
                    },
                    {
                      "ty": "fl",
                      "c": {
                        "a": 0,
                        "k": [
                          0.223528981209,
                          0.192156970501,
                          0.674510002136,
                          1
                        ],
                        "ix": 4
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 5
                      },
                      "r": 1,
                      "bm": 0,
                      "nm": "Fill 1",
                      "mn": "ADBE Vector Graphic - Fill",
                      "hd": false
                    },
                    {
                      "ty": "tr",
                      "p": {
                        "a": 0,
                        "k": [
                          236.879,
                          292.737
                        ],
                        "ix": 2
                      },
                      "a": {
                        "a": 0,
                        "k": [
                          0,
                          0
                        ],
                        "ix": 1
                      },
                      "s": {
                        "a": 0,
                        "k": [
                          100,
                          100
                        ],
                        "ix": 3
                      },
                      "r": {
                        "a": 0,
                        "k": 0,
                        "ix": 6
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 7
                      },
                      "sk": {
                        "a": 0,
                        "k": 0,
                        "ix": 4
                      },
                      "sa": {
                        "a": 0,
                        "k": 0,
                        "ix": 5
                      },
                      "nm": "Transform"
                    }
                  ],
                  "nm": "Group 1",
                  "np": 2,
                  "cix": 2,
                  "bm": 0,
                  "ix": 1,
                  "mn": "ADBE Vector Group",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      633.939,
                      275.369
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      236.879,
                      292.737
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      50,
                      50
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "planete Outlines - Group 1",
              "np": 1,
              "cix": 2,
              "bm": 0,
              "ix": 1,
              "mn": "ADBE Vector Group",
              "hd": false
            },
            {
              "ty": "gr",
              "it": [
                {
                  "ty": "gr",
                  "it": [
                    {
                      "ind": 0,
                      "ty": "sh",
                      "ix": 1,
                      "ks": {
                        "a": 0,
                        "k": {
                          "i": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "o": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "v": [
                            [
                              -98.335,
                              64.79
                            ],
                            [
                              -105.619,
                              4.984
                            ],
                            [
                              105.619,
                              -64.79
                            ],
                            [
                              -80.316,
                              24.919
                            ]
                          ],
                          "c": true
                        },
                        "ix": 2
                      },
                      "nm": "Path 1",
                      "mn": "ADBE Vector Shape - Group",
                      "hd": false
                    },
                    {
                      "ty": "fl",
                      "c": {
                        "a": 0,
                        "k": [
                          0.278430998325,
                          0.294117987156,
                          0.847059011459,
                          1
                        ],
                        "ix": 4
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 5
                      },
                      "r": 1,
                      "bm": 0,
                      "nm": "Fill 1",
                      "mn": "ADBE Vector Graphic - Fill",
                      "hd": false
                    },
                    {
                      "ty": "tr",
                      "p": {
                        "a": 0,
                        "k": [
                          316.247,
                          247.882
                        ],
                        "ix": 2
                      },
                      "a": {
                        "a": 0,
                        "k": [
                          0,
                          0
                        ],
                        "ix": 1
                      },
                      "s": {
                        "a": 0,
                        "k": [
                          100,
                          100
                        ],
                        "ix": 3
                      },
                      "r": {
                        "a": 0,
                        "k": 0,
                        "ix": 6
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 7
                      },
                      "sk": {
                        "a": 0,
                        "k": 0,
                        "ix": 4
                      },
                      "sa": {
                        "a": 0,
                        "k": 0,
                        "ix": 5
                      },
                      "nm": "Transform"
                    }
                  ],
                  "nm": "Group 2",
                  "np": 2,
                  "cix": 2,
                  "bm": 0,
                  "ix": 1,
                  "mn": "ADBE Vector Group",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      673.623,
                      252.941
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      316.247,
                      247.882
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      50,
                      50
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "planete Outlines - Group 2",
              "np": 1,
              "cix": 2,
              "bm": 0,
              "ix": 2,
              "mn": "ADBE Vector Group",
              "hd": false
            },
            {
              "ty": "gr",
              "it": [
                {
                  "ty": "gr",
                  "it": [
                    {
                      "ind": 0,
                      "ty": "sh",
                      "ix": 1,
                      "ks": {
                        "a": 0,
                        "k": {
                          "i": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "o": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "v": [
                            [
                              -133.812,
                              -42.171
                            ],
                            [
                              133.812,
                              -75.141
                            ],
                            [
                              5.765,
                              75.141
                            ],
                            [
                              -61.708,
                              18.402
                            ],
                            [
                              124.227,
                              -71.307
                            ],
                            [
                              -87.011,
                              -1.534
                            ]
                          ],
                          "c": true
                        },
                        "ix": 2
                      },
                      "nm": "Path 1",
                      "mn": "ADBE Vector Shape - Group",
                      "hd": false
                    },
                    {
                      "ty": "fl",
                      "c": {
                        "a": 0,
                        "k": [
                          0.365000009537,
                          0.407999992371,
                          0.976000010967,
                          1
                        ],
                        "ix": 4
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 5
                      },
                      "r": 1,
                      "bm": 0,
                      "nm": "Fill 1",
                      "mn": "ADBE Vector Graphic - Fill",
                      "hd": false
                    },
                    {
                      "ty": "tr",
                      "p": {
                        "a": 0,
                        "k": [
                          297.638,
                          254.4
                        ],
                        "ix": 2
                      },
                      "a": {
                        "a": 0,
                        "k": [
                          0,
                          0
                        ],
                        "ix": 1
                      },
                      "s": {
                        "a": 0,
                        "k": [
                          100,
                          100
                        ],
                        "ix": 3
                      },
                      "r": {
                        "a": 0,
                        "k": 0,
                        "ix": 6
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 7
                      },
                      "sk": {
                        "a": 0,
                        "k": 0,
                        "ix": 4
                      },
                      "sa": {
                        "a": 0,
                        "k": 0,
                        "ix": 5
                      },
                      "nm": "Transform"
                    }
                  ],
                  "nm": "Group 3",
                  "np": 2,
                  "cix": 2,
                  "bm": 0,
                  "ix": 1,
                  "mn": "ADBE Vector Group",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      664.319,
                      256.2
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      297.638,
                      254.4
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      50,
                      50
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "planete Outlines - Group 3",
              "np": 1,
              "cix": 2,
              "bm": 0,
              "ix": 3,
              "mn": "ADBE Vector Group",
              "hd": false
            }
          ],
          "ip": 0,
          "op": 151,
          "st": 0,
          "bm": 0
        },
        {
          "ddd": 0,
          "ind": 3,
          "ty": 4,
          "nm": "planete Outlines - Group 5",
          "sr": 1,
          "ks": {
            "o": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 0,
                  "s": [
                    0
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 45,
                  "s": [
                    100
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 102,
                  "s": [
                    100
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    0
                  ]
                }
              ],
              "ix": 11
            },
            "r": {
              "a": 0,
              "k": 0,
              "ix": 10
            },
            "p": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": 0.833,
                    "y": 0.833
                  },
                  "o": {
                    "x": 0.167,
                    "y": 0.167
                  },
                  "t": 0,
                  "s": [
                    327.38,
                    267.583,
                    0
                  ],
                  "to": [
                    25.833,
                    0,
                    0
                  ],
                  "ti": [
                    -25.833,
                    0,
                    0
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    482.38,
                    267.583,
                    0
                  ]
                }
              ],
              "ix": 2
            },
            "a": {
              "a": 0,
              "k": [
                171.76,
                193.166,
                0
              ],
              "ix": 1
            },
            "s": {
              "a": 0,
              "k": [
                50,
                50,
                100
              ],
              "ix": 6
            }
          },
          "ao": 0,
          "shapes": [
            {
              "ty": "gr",
              "it": [
                {
                  "ind": 0,
                  "ty": "sh",
                  "ix": 1,
                  "ks": {
                    "a": 0,
                    "k": {
                      "i": [
                        [
                          13.485,
                          0
                        ],
                        [
                          4.38,
                          -4.171
                        ],
                        [
                          21.913,
                          0
                        ],
                        [
                          3.575,
                          -18.765
                        ],
                        [
                          1.851,
                          0
                        ],
                        [
                          0,
                          -13.484
                        ],
                        [
                          -0.011,
                          -0.291
                        ],
                        [
                          1.599,
                          0
                        ],
                        [
                          0,
                          -6.743
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          0,
                          13.485
                        ]
                      ],
                      "o": [
                        [
                          -6.526,
                          0
                        ],
                        [
                          -0.793,
                          -21.719
                        ],
                        [
                          -19.806,
                          0
                        ],
                        [
                          -1.734,
                          -0.391
                        ],
                        [
                          -13.485,
                          0
                        ],
                        [
                          0,
                          0.293
                        ],
                        [
                          -1.4,
                          -0.559
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          6.742
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          13.485,
                          0
                        ],
                        [
                          0,
                          -13.484
                        ]
                      ],
                      "v": [
                        [
                          59.669,
                          -8.242
                        ],
                        [
                          42.84,
                          -1.506
                        ],
                        [
                          2.287,
                          -40.592
                        ],
                        [
                          -37.576,
                          -7.638
                        ],
                        [
                          -42.962,
                          -8.242
                        ],
                        [
                          -67.378,
                          16.174
                        ],
                        [
                          -67.356,
                          17.049
                        ],
                        [
                          -71.878,
                          16.174
                        ],
                        [
                          -84.086,
                          28.383
                        ],
                        [
                          -71.878,
                          40.591
                        ],
                        [
                          59.669,
                          40.591
                        ],
                        [
                          84.086,
                          16.174
                        ]
                      ],
                      "c": true
                    },
                    "ix": 2
                  },
                  "nm": "Path 1",
                  "mn": "ADBE Vector Shape - Group",
                  "hd": false
                },
                {
                  "ty": "fl",
                  "c": {
                    "a": 0,
                    "k": [
                      0.816000007181,
                      0.823999980852,
                      0.827000038297,
                      1
                    ],
                    "ix": 4
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 5
                  },
                  "r": 1,
                  "bm": 0,
                  "nm": "Fill 1",
                  "mn": "ADBE Vector Graphic - Fill",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      171.76,
                      193.166
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      0,
                      0
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      100,
                      100
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "Group 5",
              "np": 2,
              "cix": 2,
              "bm": 0,
              "ix": 1,
              "mn": "ADBE Vector Group",
              "hd": false
            }
          ],
          "ip": 0,
          "op": 151,
          "st": 0,
          "bm": 0
        }
      ]
    }
  ],
  "layers": [
    {
      "ddd": 0,
      "ind": 1,
      "ty": 0,
      "nm": "Pre-comp 1",
      "refId": "comp_0",
      "sr": 1,
      "ks": {
        "o": {
          "a": 0,
          "k": 100,
          "ix": 11
        },
        "r": {
          "a": 0,
          "k": 0,
          "ix": 10
        },
        "p": {
          "a": 0,
          "k": [
            406,
            306,
            0
          ],
          "ix": 2
        },
        "a": {
          "a": 0,
          "k": [
            400,
            300,
            0
          ],
          "ix": 1
        },
        "s": {
          "a": 0,
          "k": [
            179,
            179,
            100
          ],
          "ix": 6
        }
      },
      "ao": 0,
      "w": 800,
      "h": 600,
      "ip": 0,
      "op": 147,
      "st": 0,
      "bm": 0
    }
  ],
  "markers": []
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\codesource.txt 
=============================================== 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\androidTest\java\tg\univlome\epl\ExampleInstrumentedTest.kt 
=============================================== 
package tg.univlome.epl

import androidx.test.ext.junit.runners.AndroidJUnit4
import androidx.test.platform.app.InstrumentationRegistry
import org.junit.Assert.assertEquals
import org.junit.Test
import org.junit.runner.RunWith

/**
 * Instrumented test, which will execute on an Android device.
 *
 * See [testing documentation](http://d.android.com/tools/testing).
 */
@RunWith(AndroidJUnit4::class)
class ExampleInstrumentedTest {
    @Test
    fun useAppContext() {
        // Context of the app under test.
        val appContext = InstrumentationRegistry.getInstrumentation().targetContext
        assertEquals("tg.univlome.epl", appContext.packageName)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\FragmentUtils.kt 
=============================================== 
package tg.univlome.epl

import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager

/**
 * Objet FragmentUtils : Fournit une fonction utilitaire simplifiée
 * pour effectuer une transition vers un nouveau fragment.
 *
 * Description :
 * Cette classe utilitaire encapsule la logique standard de remplacement
 * de fragment dans l'application. Elle permet de :
 *  - Remplacer dynamiquement un fragment existant
 *  - Ajouter l'opération à la pile de retour (`BackStack`)
 *
 * Elle est principalement utilisée pour centraliser le code lié
 * aux transactions de fragments, assurant une meilleure maintenabilité.
 *
 * Composants principaux :
 *  - FragmentManager : gestionnaire de fragments fourni par AndroidX
 *  - Fragment : nouveau fragment à afficher
 *
 * @see androidx.fragment.app.Fragment
 * @see androidx.fragment.app.FragmentManager
 */
object FragmentUtils {

    /**
     * Remplace le fragment courant par un nouveau, et ajoute l’opération à la pile de retour.
     *
     * @param fragmentManager Instance de `FragmentManager` utilisée pour exécuter la transaction.
     * @param newFragment Nouveau fragment à afficher dans le conteneur `R.id.container`.
     */
    fun ouvrirFragment(fragmentManager: FragmentManager, newFragment: Fragment) {
        val transaction = fragmentManager.beginTransaction()
        transaction.replace(R.id.container, newFragment)
        transaction.addToBackStack(null)
        transaction.commit()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\MainActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl

import android.Manifest
import android.animation.Animator
import android.animation.AnimatorListenerAdapter
import android.animation.ValueAnimator
import android.app.Activity
import android.app.Dialog
import android.content.pm.PackageManager
import android.graphics.Color
import android.graphics.Rect
import android.os.Bundle
import android.os.Handler
import android.os.Looper
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.DecelerateInterpolator
import android.widget.ArrayAdapter
import android.widget.Button
import android.widget.Spinner
import android.widget.Toast
import androidx.activity.result.contract.ActivityResultContracts
import androidx.appcompat.app.ActionBarDrawerToggle
import androidx.appcompat.app.AppCompatActivity
import androidx.appcompat.app.AppCompatDelegate
import androidx.appcompat.widget.Toolbar
import androidx.core.content.ContextCompat
import androidx.core.os.LocaleListCompat
import androidx.core.view.GravityCompat
import androidx.drawerlayout.widget.DrawerLayout
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.google.android.material.navigation.NavigationView
import tg.univlome.epl.databinding.ActivityMainBinding
import tg.univlome.epl.models.NavItem
import tg.univlome.epl.ui.LogoFragment
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.ui.batiment.BatimentFragment
import tg.univlome.epl.ui.home.HomeFragment
import tg.univlome.epl.ui.infrastructure.InfraFragment
import tg.univlome.epl.ui.maps.MapsFragment
import java.util.Locale

/**
 * Activité principale de l'application : `MainActivity`
 *
 * Description :
 * Cette activité est le point d’entrée visuel de l’application. Elle centralise :
 * - L’interface de navigation latérale (`DrawerLayout`)
 * - L’affichage des fragments (accueil, bâtiments, salles, carte)
 * - La gestion de la langue, du thème et des permissions de localisation
 * - L’intégration des fragments `LogoFragment` et `SearchBarFragment` pour la barre de recherche dynamique
 *
 * Composants principaux :
 * - `DrawerLayout`, `NavigationView`, `Toolbar` : composants d'interface
 * - `NavItem` : modèle utilisé pour représenter les éléments de navigation
 * - `HomeFragment`, `BatimentFragment`, `InfraFragment`, `MapsFragment` : fragments principaux
 * - `SearchBarFragment`, `LogoFragment` : fragments d’en-tête dynamiques
 *
 * Bibliothèques utilisées :
 * - OSMDroid (via MapsFragment)
 * - Firebase (optionnel, indirect)
 * - AndroidX : AppCompat, RecyclerView, Fragment, Lifecycle
 *
 * Fonctionnalités intégrées :
 * - Gestion du thème (clair, sombre, système)
 * - Gestion multilingue (français/anglais)
 * - Permissions runtime pour la localisation
 * - Comportement personnalisé du bouton retour (double clic pour quitter)
 *
 * @see NavItem
 * @see HomeFragment
 * @see LogoFragment
 * @see SearchBarFragment
 */
class MainActivity : AppCompatActivity(), SearchBarFragment.SearchListener,
    LogoFragment.LogoListener {

    // Liaison de la vue
    lateinit var ui: ActivityMainBinding

    // Navigation
    private var selectedItem: NavItem? = null
    private lateinit var drawerLayout: DrawerLayout
    private lateinit var navigationView: NavigationView
    private lateinit var toolbar: Toolbar

    // Fragments de recherche et logo
    private lateinit var searchBarFragment: SearchBarFragment
    private lateinit var logoFragment: LogoFragment
    private var currentLanguageCode: String? = null

    private var doubleBackToExitPressedOnce = false // Variable pour gérer le double appui
    private var currentFragment: Fragment? = null // Pour suivre quel fragment est affiché
    private var navItems = listOf<NavItem>()

    // Demande de permission de localisation
    private val locationPermissionRequest =
        registerForActivityResult(ActivityResultContracts.RequestPermission()) { isGranted: Boolean ->
            if (isGranted) {
                // Permission accordée, on recharge les données si HomeFragment est actif
                (currentFragment as? HomeFragment)?.rechargerDonnees()
            } else {
                Toast.makeText(this, "Permission localisation refusée", Toast.LENGTH_SHORT).show()
            }
        }

    /**
     * Méthode appelée lors de la création de l'activité.
     * Initialise la navigation, le thème, la langue, les fragments et les permissions.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        val sharedPreferences = getSharedPreferences("AppSettings", MODE_PRIVATE)

        // Vérifie si l'activité a déjà été redémarrée
        val hasRestarted = sharedPreferences.getBoolean("theme_applied_once", false)

        // Appliquer langue
        currentLanguageCode =
            sharedPreferences.getString("language_code", Locale.getDefault().language)
        if (currentLanguageCode != null) {
            setLocale(this, currentLanguageCode!!)
        }

        // Appliquer le thème
        val savedTheme = sharedPreferences.getInt("theme_mode", AppCompatDelegate.MODE_NIGHT_NO)
        AppCompatDelegate.setDefaultNightMode(savedTheme)

        if (!hasRestarted) {
            // Marque comme redémarré
            sharedPreferences.edit().putBoolean("theme_applied_once", true).apply()

            // Redémarre l'activité pour appliquer le thème proprement
            finish()
            startActivity(intent)
            return // Stoppe ici le flux du premier démarrage
        }

        super.onCreate(savedInstanceState)
        ui = ActivityMainBinding.inflate(layoutInflater)
        setContentView(ui.root)

        /*// Charger les paramètres sauvegardés
        val sharedPreferences = getSharedPreferences("AppSettings", MODE_PRIVATE)

        // Appliquer la langue
        currentLanguageCode =
            sharedPreferences.getString("language_code", Locale.getDefault().language)
        if (currentLanguageCode != null) {
            setLocale(this, currentLanguageCode!!)
        }

        // Appliquer le thème
        val savedTheme = sharedPreferences.getInt("theme_mode", AppCompatDelegate.MODE_NIGHT_NO)
        AppCompatDelegate.setDefaultNightMode(savedTheme)*/

        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        drawerLayout = findViewById(R.id.drawer_layout)
        navigationView = findViewById<NavigationView>(R.id.nav_view)
        toolbar = findViewById(R.id.toolbarHome)

        // Configurer la toolbar
        setSupportActionBar(toolbar)
        setTitle("")

        // Configurer le toggle pour le drawer
        val toggle = ActionBarDrawerToggle(
            this, drawerLayout, toolbar,
            R.string.navigation_drawer_open,
            R.string.navigation_drawer_close
        )
        drawerLayout.addDrawerListener(toggle)
        toggle.syncState()

        toolbar.setNavigationIcon(R.drawable.hamburger_menu)

        val menuView = navigationView.getChildAt(0) as RecyclerView
        menuView.addItemDecoration(object : RecyclerView.ItemDecoration() {
            override fun getItemOffsets(
                outRect: Rect, view: View, parent: RecyclerView, state: RecyclerView.State
            ) {
                val position = parent.getChildAdapterPosition(view)
                if (position > 0) {
                    outRect.top = 10
                }
            }
        })

        // Gérer les événements de clic sur les items du menu
        navigationView.setNavigationItemSelectedListener { item ->
            // Gérer les clics sur les options du menu
            when (item.itemId) {
                R.id.settings -> {
                    showSettingsDialog(this, true)
                }

                R.id.share -> {

                }

                R.id.contact -> {

                }

                R.id.about -> {

                }
            }

            drawerLayout.closeDrawer(GravityCompat.START)
            true
        }

        searchBarFragment = SearchBarFragment()
        logoFragment = LogoFragment()

        // Ajouter la barre de recherche à l'activité, mais la cacher au début
        if (savedInstanceState == null) {
            supportFragmentManager.beginTransaction()
                .add(R.id.search_bar_container, searchBarFragment)
                .hide(searchBarFragment)
                .add(R.id.search_bar_container, logoFragment)
                .show(logoFragment)
                .commit()
        }

        // Ensuite tu fais registerFragmentLifecycleCallbacks + verification immédiate
        supportFragmentManager.registerFragmentLifecycleCallbacks(object :
            FragmentManager.FragmentLifecycleCallbacks() {
            override fun onFragmentResumed(fm: FragmentManager, fragment: Fragment) {
                super.onFragmentResumed(fm, fragment)

                when (fragment) {
                    is SearchBarFragment.SearchListener -> {
                        showSearchBarFragment(fragment)
                        showLogo(null)
                    }

                    is LogoFragment.LogoListener -> {
                        showLogo(fragment)
                        showSearchBarFragment(null)
                    }
                }
            }
        }, true)

        chargerItems()

        if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION)
            != PackageManager.PERMISSION_GRANTED
        ) {
            locationPermissionRequest.launch(Manifest.permission.ACCESS_FINE_LOCATION)
        } else {
            // Si déjà accordée, on recharge immédiatement les données du HomeFragment
            (currentFragment as? HomeFragment)?.rechargerDonnees()
        }
    }

    /**
     * Initialise les éléments de navigation (`NavItem`) et configure le comportement de sélection.
     * Chaque item déclenche le chargement de son fragment associé.
     */
    private fun chargerItems() {
        navItems = listOf(
            NavItem(
                findViewById(R.id.container_home),
                findViewById(R.id.nav_home),
                findViewById(R.id.text_home),
                findViewById(R.id.icon_home),
                HomeFragment()
            ),
            NavItem(
                findViewById(R.id.container_batiment),
                findViewById(R.id.nav_batiment),
                findViewById(R.id.text_batiment),
                findViewById(R.id.icon_batiment),
                BatimentFragment()
            ),
            NavItem(
                findViewById(R.id.container_salle),
                findViewById(R.id.nav_salle),
                findViewById(R.id.text_salle),
                findViewById(R.id.icon_salle),
                InfraFragment()
            ),
            NavItem(
                findViewById(R.id.container_maps),
                findViewById(R.id.nav_maps),
                findViewById(R.id.text_maps),
                findViewById(R.id.icon_maps),
                MapsFragment()
            )
        )

        for (item in navItems) {
            item.minLayout.setBackgroundColor(Color.TRANSPARENT)
            item.textView.visibility = View.GONE
            item.icon.setColorFilter(
                ContextCompat.getColor(
                    this,
                    R.color.gray
                )
            )
        }

        val defaultItem = navItems[0]
        selectedItem = defaultItem
        defaultItem.layout.setBackgroundResource(R.drawable.nav_item_bg)
        defaultItem.textView.visibility = View.VISIBLE
        defaultItem.textView.setTextColor(ContextCompat.getColor(this, R.color.mainColor))
        defaultItem.icon.setColorFilter(ContextCompat.getColor(this, R.color.mainColor))

        animateItemSelection(defaultItem)

        // Charge le fragment par défaut
        loadFragment(defaultItem.fragment)

        if (defaultItem.fragment is HomeFragment) {
            showLogo(defaultItem.fragment as LogoFragment.LogoListener)
            showSearchBarFragment(null)
        } else if (defaultItem.fragment is SearchBarFragment.SearchListener) {
            showSearchBarFragment(defaultItem.fragment as SearchBarFragment.SearchListener)
            showLogo(null)
        }

        for (item in navItems) {
            item.layout.setOnClickListener {
                if (selectedItem == item) {
                    return@setOnClickListener // Ne rien faire si l'item est déjà sélectionné
                }

                setItem(item, navItems)

            }
        }
    }

    /**
     * Applique les effets visuels et la logique de sélection d’un élément du menu.
     *
     * @param item Élément sélectionné dans le menu.
     * @param navItems Liste complète des items pour réinitialisation.
     */
    fun setItem(item: NavItem, navItems: List<NavItem>) {
        // Réinitialiser tous les items
        for (otherItem in navItems) {
            otherItem.layout.setBackgroundColor(Color.TRANSPARENT)
            otherItem.textView.visibility = View.GONE
            otherItem.icon.setColorFilter(
                ContextCompat.getColor(
                    this,
                    R.color.gray
                )
            ) // Couleur inactive
            if (otherItem.textView.text == this.getString(R.string.infrastructures)) {
                item.textView.minWidth = 0
            }
        }

        // Animer l'élément sélectionné
        _animateItemSelection(item)

        // Mettre à jour l'item sélectionné
        selectedItem = item

        // Charger le fragment correspondant
        loadFragment(item.fragment)
    }

    /**
     * Effectue également une animation d'arrière-plan pour l'item sélectionné.
     */
    private fun animateItemSelection(item: NavItem) {
        item.layout.setBackgroundResource(R.drawable.nav_item_bg)

        // Animation d'apparition progressive du texte
        item.textView.alpha = 0f
        item.textView.visibility = View.VISIBLE
        item.textView.setTextColor(ContextCompat.getColor(this, R.color.black))
        item.textView.animate()
            .alpha(1f)
            .setDuration(350)
            .start()

        item.icon.setColorFilter(ContextCompat.getColor(this, R.color.black))
    }

    /**
     * Effectue une animation d'arrière-plan pour l'item sélectionné.
     */
    private fun _animateItemSelection(item: NavItem) {
        // Appliquer le style de fond
        item.layout.setBackgroundResource(R.drawable.nav_item_bg)

        // Colorier l'icône
        item.icon.setColorFilter(ContextCompat.getColor(this, R.color.black))

        // Préparer le texte pour l'animation
        item.textView.alpha = 0f
        item.textView.visibility = View.VISIBLE
        item.textView.setTextColor(ContextCompat.getColor(this, R.color.black))

        // Mesurer la largeur que devrait avoir le layout en mode wrap_content
        val widthSpec = View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED)
        val heightSpec = View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED)

        // Garder la largeur actuelle (avant expansion)
        val startWidth = item.layout.width

        // Mesurer la largeur cible avec le texte visible
        item.layout.measure(widthSpec, heightSpec)
        val targetWidth = item.layout.measuredWidth

        // Animation d'expansion horizontale
        val layoutParams = item.layout.layoutParams
        val animator = ValueAnimator.ofInt(startWidth, targetWidth)
        animator.duration = 500
        animator.interpolator = DecelerateInterpolator()

        animator.addUpdateListener { animation ->
            val value = animation.animatedValue as Int
            layoutParams.width = value
            item.layout.layoutParams = layoutParams
        }

        animator.addListener(object : AnimatorListenerAdapter() {
            override fun onAnimationEnd(animation: Animator) {
                // Quand l'animation est terminée, définir en wrap_content
                layoutParams.width = ViewGroup.LayoutParams.WRAP_CONTENT
                item.layout.layoutParams = layoutParams
            }
        })

        // Démarrer l'animation d'expansion
        animator.start()

        // Animation d'apparition progressive du texte
        item.textView.animate()
            .alpha(1f)
            .setDuration(350)
            .start()
    }

    /**
     * Affiche la barre de recherche (`SearchBarFragment`) si un listener est fourni.
     *
     * @param listener Listener implémenté par le fragment actuel ou `null` pour masquer la barre.
     */
    fun showSearchBarFragment(listener: SearchBarFragment.SearchListener?) {
        if (listener != null) {
            // Afficher la barre de recherche et définir le listener du fragment actif
            searchBarFragment.setSearchListener(listener)
            supportFragmentManager.beginTransaction()
                .show(searchBarFragment)
                .commit()
        } else {
            // Cacher la barre de recherche
            supportFragmentManager.beginTransaction()
                .hide(searchBarFragment)
                .commit()
        }
    }

    /**
     * Affiche ou masque le logo (`LogoFragment`) en fonction du fragment actif.
     */
    fun showLogo(listener: LogoFragment.LogoListener?) {
        if (listener != null) {
            logoFragment.setLogoListener(listener)
            supportFragmentManager.beginTransaction()
                .show(logoFragment)
                .commit()
        } else {
            supportFragmentManager.beginTransaction()
                .hide(logoFragment)
                .commit()
        }
    }

    /**
     * Charge dynamiquement un fragment dans le conteneur principal.
     *
     * @param fragment Fragment à afficher.
     */
    fun loadFragment(fragment: Fragment) {
        supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .commit()
        currentFragment = fragment
    }

    /**
     * Charge le fragment MapsFragment dans le conteneur principal.
     *
     * @param fragment Fragment à afficher.
     */
    fun loadMapsFragment() {
        for (item in navItems) {
            if (item.fragment is MapsFragment) {
                setItem(item, navItems)
                break
            }
        }
    }

    /**
     * Affiche une boîte de dialogue de paramètres permettant à l'utilisateur
     * de choisir la langue et le thème de l'application.
     *
     * @param activity Activité appelante.
     * @param show Si `true`, la boîte de dialogue est immédiatement affichée.
     */
    fun showSettingsDialog(activity: Activity, show: Boolean) {
        val dialog = Dialog(activity)
        val view = LayoutInflater.from(activity).inflate(R.layout.settings, null)
        dialog.setContentView(view)

        val languageSpinner = view.findViewById<Spinner>(R.id.languageSpinner)
        val themeSpinner = view.findViewById<Spinner>(R.id.themeSpinner)
        val applyButton = view.findViewById<Button>(R.id.appliquer)

        val languageOptions =
            listOf(activity.getString(R.string.francais), activity.getString(R.string.anglais))
        val themeOptions = listOf(
            activity.getString(R.string.clair),
            activity.getString(R.string.sombre),
            activity.getString(R.string.systeme)
        )

        val languageAdapter = ArrayAdapter(activity, R.layout.spinner_item, languageOptions)
        languageAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)
        languageSpinner.adapter = languageAdapter

        val themeAdapter = ArrayAdapter(activity, R.layout.spinner_item, themeOptions)
        themeAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)
        themeSpinner.adapter = themeAdapter

        // Charger les préférences sauvegardées
        val sharedPreferences =
            activity.getSharedPreferences("AppSettings", MODE_PRIVATE)
        val savedLanguageCode = sharedPreferences.getString(
            "language_code",
            Locale.getDefault().language
        ) // Langue par défaut du système
        val savedTheme = sharedPreferences.getInt(
            "theme_mode",
            AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM
        ) // Thème par défaut : Système

        // Appliquer les préférences sauvegardées
        setLocale(activity, savedLanguageCode!!)
        //AppCompatDelegate.setDefaultNightMode(savedTheme)

        // Définir les sélections des spinners
        val savedLanguagePosition = when (savedLanguageCode) {
            "fr" -> 0
            "en" -> 1
            else -> 0 // Français par défaut
        }
        languageSpinner.setSelection(savedLanguagePosition)

        val savedThemePosition = when (savedTheme) {
            AppCompatDelegate.MODE_NIGHT_NO -> 0
            AppCompatDelegate.MODE_NIGHT_YES -> 1
            AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM -> 2 // Système
            else -> 0 // Clair par défaut
        }
        themeSpinner.setSelection(savedThemePosition)

        // Appliquer les choix au clic sur "Appliquer"
        applyButton.setOnClickListener {
            val selectedLanguagePosition = languageSpinner.selectedItemPosition
            val selectedThemePosition = themeSpinner.selectedItemPosition

            // Appliquer la langue
            val selectedLanguageCode = when (selectedLanguagePosition) {
                0 -> "fr" // Français
                1 -> "en" // Anglais
                else -> "fr"
            }
            val appLocale = LocaleListCompat.forLanguageTags(selectedLanguageCode)
            AppCompatDelegate.setApplicationLocales(appLocale)

            // Appliquer le thème
            val selectedThemeMode = when (selectedThemePosition) {
                0 -> AppCompatDelegate.MODE_NIGHT_NO // Clair
                1 -> AppCompatDelegate.MODE_NIGHT_YES // Sombre
                2 -> AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM // Système
                else -> AppCompatDelegate.MODE_NIGHT_NO
            }
            AppCompatDelegate.setDefaultNightMode(selectedThemeMode)

            // Sauvegarder les préférences
            val editor = sharedPreferences.edit()
            editor.putString("language_code", selectedLanguageCode)
            editor.putInt("theme_mode", selectedThemeMode)
            editor.apply()

            dialog.dismiss()
            val fragmentManager = (activity as AppCompatActivity).supportFragmentManager
            fragmentManager.fragments.forEach {
                fragmentManager.beginTransaction().remove(it).commitAllowingStateLoss()
            }

            //activity.recreate() // Recréer l'activité pour appliquer les changements
            activity.finish()
            activity.startActivity(activity.intent)
        }

        // Personnaliser l'apparence du Dialog
        dialog.window?.setBackgroundDrawableResource(R.drawable.rounded_frame)
        dialog.window?.setLayout(
            (activity.resources.displayMetrics.widthPixels * 0.8).toInt(), // 65% de la largeur de l'écran
            (activity.resources.displayMetrics.heightPixels * 0.28).toInt(),
        )
        if (show) {
            dialog.show()
        }
    }

    /**
     * Applique la langue spécifiée à l'application en mettant à jour la configuration du contexte.
     *
     * @param activity Activité cible.
     * @param languageCode Code de langue (ex: "fr", "en").
     */
    fun setLocale(activity: Activity, languageCode: String) {
        val locale = Locale(languageCode)
        Locale.setDefault(locale)

        val config = activity.resources.configuration
        config.setLocale(locale)
        config.setLayoutDirection(locale)

        activity.resources.updateConfiguration(config, activity.resources.displayMetrics)
    }

    /**
     * Gère le comportement du bouton retour, avec une vérification de double appui
     * pour quitter l'application depuis le `HomeFragment`.
     */
    @Deprecated("Deprecated in Java")
    override fun onBackPressed() {
        if (drawerLayout.isDrawerOpen(GravityCompat.START)) {
            // Si le drawer est ouvert, fermez-le
            drawerLayout.closeDrawer(GravityCompat.START)
        } else {
            if (currentFragment is HomeFragment) {
                // Si on est sur HomeFragment, gérer le double appui pour quitter l'application
                if (doubleBackToExitPressedOnce) {
                    super.onBackPressed() // Quitter l'application
                    return
                }

                this.doubleBackToExitPressedOnce = true
                // Afficher un message à l'utilisateur
                Toast.makeText(this, "Appuyez à nouveau pour quitter", Toast.LENGTH_SHORT)
                    .show()

                // Remettre la variable à false après un délai
                Handler(Looper.getMainLooper()).postDelayed({
                    doubleBackToExitPressedOnce = false
                }, 2000) // Le délai pour un deuxième appui est de 2 secondes
            } else {
                chargerItems()
            }
        }
    }

    override fun onResume() {
        super.onResume()
    }

    override fun onPause() {
        super.onPause()
    }

    override fun onSearch(query: String) {}
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\MyApp.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl

import android.app.Application
import android.preference.PreferenceManager
import com.google.firebase.firestore.FirebaseFirestore
import com.google.firebase.firestore.FirebaseFirestoreSettings
import org.osmdroid.config.Configuration

/**
 * Classe MyApp : Point d’entrée principal de l’application.
 *
 * Description :
 * Cette classe étend `Application` et est utilisée pour effectuer des configurations
 * globales dès le lancement de l’application Android.
 *
 * Deux initialisations majeures sont effectuées :
 *  - **OSMDroid** : Chargement des préférences partagées pour la configuration de la carte
 *  - **Firebase Firestore** : Activation de la persistance hors-ligne des données
 *
 * Elle est référencée dans le fichier `AndroidManifest.xml` via l’attribut `android:name`.
 *
 * Composants principaux :
 *  - `Configuration.getInstance().load(...)` pour OSMDroid
 *  - `FirebaseFirestoreSettings.setPersistenceEnabled(true)` pour Firestore
 *
 * Bibliothèques utilisées :
 *  - OSMDroid : bibliothèque de cartographie open source
 *  - Firebase Firestore : base de données NoSQL temps réel
 *
 * @see android.app.Application
 * @see org.osmdroid.config.Configuration
 * @see com.google.firebase.firestore.FirebaseFirestore
 */
class MyApp : Application() {

    /**
     * Initialise les composants globaux de l’application.
     * Appelé automatiquement au lancement de l’application.
     */
    override fun onCreate() {
        super.onCreate()

        // osmdroid
        Configuration.getInstance().load(this, PreferenceManager.getDefaultSharedPreferences(this))

        // Firestore offline
        val settings = FirebaseFirestoreSettings.Builder()
            .setPersistenceEnabled(true)
            .build()
        FirebaseFirestore.getInstance().firestoreSettings = settings
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\BatimentAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.FragmentUtils
import tg.univlome.epl.R
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.ui.batiment.BatimentActivity

/**
 * Adapter BatimentAdapter : Adaptateur pour l'affichage des bâtiments dans un RecyclerView
 *
 * Description :
 * Cet adaptateur permet d'afficher une liste réduite de bâtiments (jusqu’à 3 éléments) suivie d’un bouton
 * "Voir tout" qui redirige vers un fragment listant l'ensemble des bâtiments disponibles.
 * Il gère le rendu des informations clés d’un bâtiment (nom, situation, distance, image) ainsi que
 * la navigation vers l'activité de détails `BatimentActivity`.
 *
 * Composants principaux :
 * - `BatimentViewHolder` : Gère l’affichage d’un élément de type bâtiment.
 * - `ButtonViewHolder` : Gère l’affichage du bouton "Voir tout".
 * - `updateList()` : Met à jour dynamiquement la liste de bâtiments affichés.
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement et la mise en cache d’images à distance
 * - `AndroidX RecyclerView` pour la gestion optimisée des listes scrollables
 * - `Intent` pour le passage aux détails (`BatimentActivity`)
 * - `FragmentUtils` pour la navigation entre fragments
 *
 * @param batiments Liste initiale de bâtiments à afficher
 * @param fragmentManager Gestionnaire de fragments pour les transitions
 * @param newFragment Fragment à charger lors du clic sur "Voir tout"
 *
 * @see BatimentActivity
 * @see tg.univlome.epl.utils.BatimentUtils
 */
class BatimentAdapter(
    private var batiments: List<Batiment>,
    private val fragmentManager: FragmentManager,
    private val newFragment: Fragment,
) : RecyclerView.Adapter<RecyclerView.ViewHolder>() {

    private var min: Int = 3

    companion object {
        private const val VIEW_TYPE_BATIMENT = 0
        private const val VIEW_TYPE_BUTTON = 1
    }

    /**
     * Définit le type de vue à afficher selon la position (bâtiment ou bouton).
     */
    override fun getItemViewType(position: Int): Int {
        return if (position < minOf(batiments.size, min)) VIEW_TYPE_BATIMENT else VIEW_TYPE_BUTTON
    }

    /**
     * Crée et retourne le bon type de ViewHolder selon le type défini.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder {
        return if (viewType == VIEW_TYPE_BATIMENT) {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_batiment, parent, false)
            BatimentViewHolder(view)
        } else {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_voir_tout, parent, false)
            ButtonViewHolder(view)
        }
    }

    /**
     * Lie les données d’un bâtiment ou configure le bouton "Voir tout".
     */
    override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) {
        if (holder is BatimentViewHolder && position < minOf(batiments.size, min)) {
            val batiment = batiments[position]
            holder.nom.text = batiment.nom
            holder.situation.text = batiment.situation
            holder.distance.text = batiment.distance
            if (!batiment.image.isNullOrEmpty()) {
                Glide.with(holder.itemView.context)
                    .asBitmap()
                    .load(batiment.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable = android.graphics.drawable.BitmapDrawable(
                                holder.itemView.resources,
                                resource
                            )
                            holder.img.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                holder.img.setImageResource(batiment.icon)
            }

            holder.itemView.setOnClickListener {
                val intent = Intent(holder.itemView.context, BatimentActivity::class.java).apply {
                    putExtra("batiment", batiment)
                }
                holder.itemView.context.startActivity(intent)
            }
        } else if (holder is ButtonViewHolder) {
            holder.btnVoirTout.setOnClickListener {
                FragmentUtils.ouvrirFragment(fragmentManager, newFragment)
            }
        }
    }

    /**
     * Retourne le nombre total d’éléments à afficher (3 max + 1 bouton).
     */
    override fun getItemCount(): Int {
        return minOf(batiments.size, min) + 1 // 3 batiments max + 1 bouton "voir tout"
    }

    /**
     * Met à jour dynamiquement la liste de bâtiments affichée.
     * @param newList Nouvelle liste de bâtiments à afficher
     */
    fun updateList(newList: List<Batiment>) {
        batiments = newList
        notifyDataSetChanged()
    }

    /**
     * ViewHolder pour l’affichage d’un bâtiment (image, nom, situation, distance).
     */
    class BatimentViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img = view.findViewById<ImageView>(R.id.imgBatiment)
        val nom = view.findViewById<TextView>(R.id.txtNomBatiment)
        val situation = view.findViewById<TextView>(R.id.situationBat)
        val distance = view.findViewById<TextView>(R.id.txtDistanceBatiment)
    }

    /**
     * ViewHolder pour le bouton "Voir tout" (utilise une icône).
     */
    class ButtonViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val btnVoirTout = view.findViewById<ImageView>(R.id.imgVoirTout)
    }

}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\BatimentFragmentAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.ui.batiment.BatimentActivity

/**
 * Adapter BatimentFragmentAdapter : Adaptateur d'affichage des bâtiments (vue étendue)
 *
 * Description :
 * Cet adaptateur est utilisé pour afficher l’ensemble des bâtiments dans les fragments
 * "Voir tout", sans limitation du nombre d’éléments. Chaque élément représente un bâtiment avec
 * son image, son nom, sa situation et sa distance. Un clic sur un bâtiment ouvre
 * l'activité de détail `BatimentActivity`.
 *
 * Composants principaux :
 * - `ViewHolder` : Gère l’affichage des informations d’un bâtiment.
 * - `updateList()` : Met à jour dynamiquement la liste des bâtiments affichés.
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement d'images à partir d’URL
 * - `AndroidX RecyclerView` pour l’affichage efficace d’une liste scrollable
 * - `Intent` pour la navigation vers l’activité de détail `BatimentActivity`
 *
 * @param batiments Liste des bâtiments à afficher dans le RecyclerView
 *
 * @see BatimentActivity
 * @see tg.univlome.epl.utils.BatimentUtils
 */
class BatimentFragmentAdapter(private var batiments: List<Batiment>) :
    RecyclerView.Adapter<BatimentFragmentAdapter.ViewHolder>() {

    /**
     * ViewHolder représentant un bâtiment avec :
     * - Une image (ou icône par défaut)
     * - Son nom
     * - Sa situation géographique (ex: "Campus Nord")
     * - La distance calculée depuis la position de l'utilisateur
     */
    class ViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img = view.findViewById<ImageView>(R.id.imgBatiment)
        val nom = view.findViewById<TextView>(R.id.txtNomBatiment)
        val situation = view.findViewById<TextView>(R.id.situationBat)
        val distance = view.findViewById<TextView>(R.id.txtDistanceBatiment)
    }

    /**
     * Crée un ViewHolder pour l’affichage d’un bâtiment.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ViewHolder {
        val view =
            LayoutInflater.from(parent.context).inflate(R.layout.item_all_batiment, parent, false)
        return ViewHolder(view)
    }

    /**
     * Lie les données du bâtiment à la vue correspondante.
     */
    override fun onBindViewHolder(holder: ViewHolder, position: Int) {
        val batiment = batiments[position]
        holder.nom.text = batiment.nom
        holder.situation.text = batiment.situation
        holder.distance.text = batiment.distance
        if (!batiment.image.isNullOrEmpty()) {
            Glide.with(holder.itemView.context)
                .asBitmap()
                .load(batiment.image)
                .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                    ) {
                        val drawable = android.graphics.drawable.BitmapDrawable(
                            holder.itemView.resources,
                            resource
                        )
                        holder.img.setImageDrawable(drawable)
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        } else {
            holder.img.setImageResource(batiment.icon)
        }

        holder.itemView.setOnClickListener {
            val intent = Intent(holder.itemView.context, BatimentActivity::class.java).apply {
                putExtra("batiment", batiment)
            }
            holder.itemView.context.startActivity(intent)
        }
    }

    /**
     * Retourne le nombre total de bâtiments à afficher.
     */
    override fun getItemCount(): Int = batiments.size

    /**
     * Met à jour la liste affichée avec de nouvelles données.
     *
     * @param newList Nouvelle liste de bâtiments
     */
    fun updateList(newList: List<Batiment>) {
        batiments = newList
        notifyDataSetChanged()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\ImageAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.view.ViewGroup
import android.widget.ImageView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R

/**
 * Adapter ImageAdapter : Affichage en carrousel d'une galerie d'images
 *
 * Description :
 * Cet adaptateur est utilisé dans un `ViewPager2` pour afficher une galerie d'images (URL) sous forme
 * de carrousel dans les activités de visualisation (`BatimentActivity`, `SalleActivity`, etc.).
 * Chaque image est affichée en plein écran avec ajustement automatique.
 *
 * Composants :
 * - `ImageViewHolder` : ViewHolder contenant une seule `ImageView` plein écran.
 * - `Glide` : Chargement des images depuis une URL avec gestion de placeholder et fallback.
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement et la mise en cache des images
 * - `RecyclerView + ViewPager2` pour le carrousel d’images
 *
 * @param images Liste d'URL des images à afficher
 *
 * @see tg.univlome.epl.ui.batiment.BatimentActivity
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 * @see tg.univlome.epl.ui.home.SalleActivity
 */
class ImageAdapter(private val images: List<String>) :
    RecyclerView.Adapter<ImageAdapter.ImageViewHolder>() {

    /**
     * ViewHolder contenant une ImageView plein écran.
     */
    class ImageViewHolder(val imageView: ImageView) : RecyclerView.ViewHolder(imageView)

    /**
     * Crée dynamiquement un ImageView en plein écran pour le carrousel.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ImageViewHolder {
        val imageView = ImageView(parent.context).apply {
            layoutParams = ViewGroup.LayoutParams(
                ViewGroup.LayoutParams.MATCH_PARENT,
                ViewGroup.LayoutParams.MATCH_PARENT
            )
            scaleType = ImageView.ScaleType.FIT_XY
        }
        return ImageViewHolder(imageView)
    }

    /**
     * Lie une URL d’image au `ImageView` avec chargement asynchrone.
     *
     * @param holder ViewHolder de l'image
     * @param position Position dans la liste d’images
     */
    override fun onBindViewHolder(holder: ImageViewHolder, position: Int) {
        val imageUrl = images[position]
        Glide.with(holder.imageView.context)
            .load(imageUrl)
            .placeholder(R.drawable.img) // image de chargement par défaut
            .error(R.drawable.img)       // image si erreur de chargement
            .into(holder.imageView)
    }

    /**
     * Retourne le nombre total d'images à afficher.
     */
    override fun getItemCount(): Int = images.size
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\InfraAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.FragmentUtils
import tg.univlome.epl.R
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.ui.infrastructure.InfraActivity

/**
 * Adapter InfraAdapter : Affichage résumé des infrastructures avec option "Voir tout"
 *
 * Description :
 * Cet adaptateur affiche une liste horizontale des infrastructures (bâtiments secondaires)
 * avec un maximum de 3 éléments, suivi d’un bouton "Voir tout". Il est utilisé dans
 * la page d’accueil (`HomeFragment`) pour un affichage synthétique, avec ouverture
 * d’une activité détaillée (`InfraActivity`) ou d’un fragment complet à la demande.
 *
 * Composants :
 * - `InfraViewHolder` : Affiche une infrastructure (image, nom, situation, distance)
 * - `ButtonViewHolder` : Affiche un bouton "Voir tout" pour ouvrir un fragment complet
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement optimisé des images distantes
 * - `FragmentManager` pour la navigation entre fragments
 *
 * @param infras Liste des infrastructures à afficher
 * @param fragmentManager FragmentManager utilisé pour ouvrir le fragment complet
 * @param newFragment Fragment à ouvrir via le bouton "Voir tout"
 *
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 * @see tg.univlome.epl.ui.home.HomeFragment
 */
class InfraAdapter(
    private var infras: List<Infrastructure>,
    private val fragmentManager: FragmentManager,
    private val newFragment: Fragment,
) : RecyclerView.Adapter<RecyclerView.ViewHolder>() {

    private var min: Int = 3

    companion object {
        private const val VIEW_TYPE_INFRA = 0
        private const val VIEW_TYPE_BUTTON = 1
    }

    /**
     * Détermine le type de vue : élément d’infrastructure ou bouton "Voir tout"
     */
    override fun getItemViewType(position: Int): Int {
        return if (position < minOf(infras.size, min)) VIEW_TYPE_INFRA else VIEW_TYPE_BUTTON
    }

    /**
     * Crée le ViewHolder adapté au type de vue : item ou bouton
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder {
        return if (viewType == VIEW_TYPE_INFRA) {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_infra, parent, false)
            InfraViewHolder(view)
        } else {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_voir_tout, parent, false)
            ButtonViewHolder(view)
        }
    }

    /**
     * Lie les données d'une infrastructure à la vue, ou configure le bouton "Voir tout"
     */
    override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) {
        if (holder is InfraViewHolder && position < minOf(infras.size, min)) {
            val infra = infras[position]
            holder.nom.text = infra.nom
            holder.situation.text = infra.situation
            holder.distance.text = infra.distance
            if (!infra.image.isNullOrEmpty()) {
                Glide.with(holder.itemView.context)
                    .asBitmap()
                    .load(infra.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable = android.graphics.drawable.BitmapDrawable(
                                holder.itemView.resources,
                                resource
                            )
                            holder.img.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                holder.img.setImageResource(infra.icon)
            }

            holder.itemView.setOnClickListener {
                val intent = Intent(holder.itemView.context, InfraActivity::class.java).apply {
                    putExtra("infrastructure", infra)
                }
                holder.itemView.context.startActivity(intent)
            }
        } else if (holder is ButtonViewHolder) {
            holder.btnVoirTout.setOnClickListener {
                FragmentUtils.ouvrirFragment(fragmentManager, newFragment)
            }
        }
    }

    /**
     * Retourne le nombre total d’éléments à afficher (max 3 infrastructures + bouton)
     */
    override fun getItemCount(): Int {
        return minOf(infras.size, min) + 1 // +1 pour le bouton "Voir Tout"
    }

    /**
     * Met à jour la liste des infrastructures et notifie l’adaptateur.
     *
     * @param newList Nouvelle liste à afficher
     */
    fun updateList(newList: List<Infrastructure>) {
        infras = newList
        notifyDataSetChanged()
    }

    /**
     * ViewHolder pour une infrastructure avec image, nom, situation, distance.
     */
    class InfraViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img = view.findViewById<ImageView>(R.id.imgInfra)
        val nom = view.findViewById<TextView>(R.id.txtNomInfra)
        val situation = view.findViewById<TextView>(R.id.situationInfra)
        val distance = view.findViewById<TextView>(R.id.txtDistanceInfra)
    }

    /**
     * ViewHolder pour le bouton "Voir tout".
     */
    class ButtonViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val btnVoirTout = view.findViewById<ImageView>(R.id.imgVoirTout)
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\InfraFragmentAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.ui.infrastructure.InfraActivity

/**
 * Adapter InfraFragmentAdapter : Affichage complet des infrastructures
 *
 * Description :
 * Cet adaptateur est utilisé dans les fragments comme `AllInfraFragment`, `NordInfraFragment`,
 * `SudInfraFragment`, ou `ViewAllInfraFragment` pour afficher toutes les infrastructures
 * disponibles dans un `RecyclerView`, avec une carte miniature, nom, distance et situation.
 *
 * Contrairement à `InfraAdapter`, il ne limite pas le nombre d’éléments ni n’inclut
 * de bouton "Voir tout". Chaque item est cliquable pour ouvrir `InfraActivity`.
 *
 * Composants :
 * - `InfraViewHolder` : Vue de chaque infrastructure avec image, nom, situation, distance
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement efficace des images distantes
 *
 * @param infras Liste complète des infrastructures à afficher
 *
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 * @see tg.univlome.epl.ui.infrastructure.AllInfraFragment
 * @see tg.univlome.epl.ui.infrastructure.ViewAllInfraFragment
 */
class InfraFragmentAdapter(private var infras: List<Infrastructure>) :
    RecyclerView.Adapter<InfraFragmentAdapter.InfraViewHolder>() {

    /**
     * ViewHolder représentant une infrastructure dans la liste.
     * Contient une image, le nom, la situation et la distance.
     */
    class InfraViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img: ImageView = view.findViewById(R.id.imgInfra)
        val nom: TextView = view.findViewById(R.id.txtNomInfra)
        val situation = view.findViewById<TextView>(R.id.situationInfra)
        val distance: TextView = view.findViewById(R.id.txtDistanceInfra)
    }

    /**
     * Crée un ViewHolder pour une infrastructure.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): InfraViewHolder {
        val view =
            LayoutInflater.from(parent.context).inflate(R.layout.item_all_infra, parent, false)
        return InfraViewHolder(view)
    }

    /**
     * Lie les données d'une infrastructure à la vue correspondante.
     */
    override fun onBindViewHolder(holder: InfraViewHolder, position: Int) {
        val infra = infras[position]
        holder.nom.text = infra.nom
        holder.situation.text = infra.situation
        holder.distance.text = infra.distance
        if (!infra.image.isNullOrEmpty()) {
            Glide.with(holder.itemView.context)
                .asBitmap()
                .load(infra.image)
                .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                    ) {
                        val drawable = android.graphics.drawable.BitmapDrawable(
                            holder.itemView.resources,
                            resource
                        )
                        holder.img.setImageDrawable(drawable)
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        } else {
            holder.img.setImageResource(infra.icon)
        }

        holder.itemView.setOnClickListener {
            val intent = Intent(holder.itemView.context, InfraActivity::class.java).apply {
                putExtra("infrastructure", infra)
            }
            holder.itemView.context.startActivity(intent)
        }
    }

    /**
     * Retourne le nombre total d'infrastructures affichées.
     */
    override fun getItemCount(): Int = infras.size

    /**
     * Met à jour la liste des infrastructures et notifie l'adaptateur.
     *
     * @param newList Nouvelle liste à afficher dans le RecyclerView
     */
    fun updateList(newList: List<Infrastructure>) {
        infras = newList
        notifyDataSetChanged()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\SalleAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentManager
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.FragmentUtils
import tg.univlome.epl.R
import tg.univlome.epl.models.Salle
import tg.univlome.epl.ui.home.SalleActivity

/**
 * Adapter SalleAdapter : Aperçu limité des salles avec navigation
 *
 * Description :
 * Cet adaptateur est utilisé dans des contextes comme `HomeFragment` pour présenter
 * un aperçu succinct des salles disponibles sur le campus, avec un bouton "Voir Tout".
 * Il affiche un nombre limité d’éléments (3 par défaut), et redirige vers `SalleActivity`
 * au clic sur un élément ou vers un `Fragment` complet au clic sur le bouton.
 *
 * Composants :
 * - `SalleViewHolder` : Affichage des informations principales d'une salle
 * - `ButtonViewHolder` : Affichage du bouton de navigation "Voir Tout"
 *
 * Bibliothèques utilisées :
 * - `Glide` pour le chargement asynchrone des images
 *
 * @param salles Liste des salles à afficher
 * @param fragmentManager Pour ouvrir le `newFragment` lorsque l'utilisateur veut voir tout
 * @param newFragment Fragment contenant la vue complète des salles
 *
 * @see tg.univlome.epl.ui.home.SalleActivity
 * @see tg.univlome.epl.ui.home.ViewAllSalleFragment
 * @see tg.univlome.epl.models.Salle
 */
class SalleAdapter(
    private var salles: List<Salle>,
    private val fragmentManager: FragmentManager,
    private val newFragment: Fragment,
) : RecyclerView.Adapter<RecyclerView.ViewHolder>() {

    private var min: Int = 3

    companion object {
        private const val VIEW_TYPE_SALLE = 0
        private const val VIEW_TYPE_BUTTON = 1
    }

    /**
     * Détermine le type de vue : salle ou bouton "Voir Tout".
     */
    override fun getItemViewType(position: Int): Int {
        return if (position < minOf(salles.size, min)) VIEW_TYPE_SALLE else VIEW_TYPE_BUTTON
    }

    /**
     * Crée les différents types de ViewHolder.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder {
        return if (viewType == VIEW_TYPE_SALLE) {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_salle, parent, false)
            SalleViewHolder(view)
        } else {
            val view =
                LayoutInflater.from(parent.context).inflate(R.layout.item_voir_tout, parent, false)
            ButtonViewHolder(view)
        }
    }

    /**
     * Lie une salle ou un bouton à un ViewHolder.
     */
    override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) {
        if (holder is SalleViewHolder && position < minOf(salles.size, min)) {
            val salle = salles[position]
            holder.nom.text = salle.nom
            holder.situation.text = salle.situation
            holder.distance.text = salle.distance
            if (!salle.image.isNullOrEmpty()) {
                Glide.with(holder.itemView.context)
                    .asBitmap()
                    .load(salle.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable = android.graphics.drawable.BitmapDrawable(
                                holder.itemView.resources,
                                resource
                            )
                            holder.img.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                holder.img.setImageResource(salle.icon)
            }

            holder.itemView.setOnClickListener {
                val intent = Intent(holder.itemView.context, SalleActivity::class.java).apply {
                    putExtra("salle", salle)
                }
                holder.itemView.context.startActivity(intent)
            }
        } else if (holder is ButtonViewHolder) {
            holder.btnVoirTout.setOnClickListener {
                FragmentUtils.ouvrirFragment(fragmentManager, newFragment)
            }
        }
    }

    /**
     * Retourne le nombre d’éléments à afficher (limité + bouton).
     */
    override fun getItemCount(): Int {
        return minOf(salles.size, min) + 1 // +1 pour le bouton "Voir Tout"
    }

    /**
     * ViewHolder représentant une salle avec image, nom, bâtiment, et distance.
     */
    class SalleViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img: ImageView = view.findViewById(R.id.imgSalle)
        val nom: TextView = view.findViewById(R.id.txtNomSalle)
        val situation = view.findViewById<TextView>(R.id.batimentSalle)
        val distance: TextView = view.findViewById(R.id.txtDistanceSalle)
    }

    /**
     * ViewHolder contenant un bouton permettant d’ouvrir un fragment pour voir toutes les salles.
     */
    class ButtonViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val btnVoirTout = view.findViewById<ImageView>(R.id.imgVoirTout)
    }

    /**
     * Met à jour la liste des salles affichées et notifie l’adaptateur.
     *
     * @param newList Nouvelle liste des salles à afficher
     */
    fun updateList(newList: List<Salle>) {
        salles = newList
        notifyDataSetChanged()
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\adapter\SalleViewAllAdapter.kt 
=============================================== 
package tg.univlome.epl.adapter

import android.content.Intent
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ImageView
import android.widget.TextView
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import tg.univlome.epl.R
import tg.univlome.epl.models.Salle
import tg.univlome.epl.ui.home.SalleActivity

/**
 * Adapter SalleViewAllAdapter : Affichage détaillé de toutes les salles
 *
 * Description :
 * Cet adaptateur est utilisé dans les fragments de type `ViewAllSalleFragment` pour afficher
 * `la liste complète` des salles disponibles sur le campus avec leurs visuels, bâtiments, et distances.
 * Contrairement à `SalleAdapter`, il n’intègre pas de bouton "Voir Tout" et affiche l’ensemble des salles.
 *
 * Composants :
 * - `SalleViewHolder` : Représente une cellule individuelle de salle dans la RecyclerView.
 *
 * Bibliothèques utilisées :
 * - **Glide** : Pour le chargement asynchrone des images des salles (avec gestion d’erreur)
 *
 * @param salles Liste complète des salles à afficher
 *
 * @see tg.univlome.epl.models.Salle
 * @see tg.univlome.epl.ui.home.SalleActivity
 */
class SalleViewAllAdapter(private var salles: List<Salle>) :
    RecyclerView.Adapter<SalleViewAllAdapter.SalleViewHolder>() {

    /**
     * ViewHolder pour une salle dans la liste.
     * Contient l’image de la salle, son nom, son bâtiment d’appartenance et sa distance.
     */
    class SalleViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val img: ImageView = view.findViewById(R.id.imgSalle)
        val nom: TextView = view.findViewById(R.id.txtNomSalle)
        val situation = view.findViewById<TextView>(R.id.batimentSalle)
        val distance: TextView = view.findViewById(R.id.txtDistanceSalle)
    }

    /**
     * Crée et retourne un nouveau ViewHolder pour chaque élément de la liste.
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): SalleViewHolder {
        val view =
            LayoutInflater.from(parent.context).inflate(R.layout.item_all_salle, parent, false)
        return SalleViewHolder(view)
    }

    /**
     * Lie les données d'une salle à la vue de son ViewHolder.
     */
    override fun onBindViewHolder(holder: SalleViewHolder, position: Int) {
        val salle = salles[position]
        holder.nom.text = salle.nom
        holder.situation.text = salle.situation
        holder.distance.text = salle.distance
        if (!salle.image.isNullOrEmpty()) {
            Glide.with(holder.itemView.context)
                .asBitmap()
                .load(salle.image)
                .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                    ) {
                        val drawable = android.graphics.drawable.BitmapDrawable(
                            holder.itemView.resources,
                            resource
                        )
                        holder.img.setImageDrawable(drawable)
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        } else {
            holder.img.setImageResource(salle.icon)
        }

        holder.itemView.setOnClickListener {
            val intent = Intent(holder.itemView.context, SalleActivity::class.java).apply {
                putExtra("salle", salle)
            }
            holder.itemView.context.startActivity(intent)
        }
    }

    /**
     * Retourne le nombre total d'éléments à afficher dans la liste.
     */
    override fun getItemCount(): Int = salles.size

    /**
     * Met à jour dynamiquement la liste des salles affichées.
     *
     * @param newList Nouvelle liste à utiliser
     */
    fun updateList(newList: List<Salle>) {
        salles = newList
        notifyDataSetChanged()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Admin.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Modèle de données Admin : Représentation d’un administrateur de l’application
 *
 * Description :
 * Ce modèle représente les informations d’identification d’un administrateur utilisé
 * pour l’authentification ou la gestion sécurisée dans l’application.
 *
 * Champs :
 * @property nom le nom d’utilisateur ou identifiant unique de l’administrateur
 * @property motDePasse le mot de passe associé à cet administrateur
 *
 * Utilisation :
 * - Employé dans les opérations d’authentification (via Firebase ou locale)
 * - Récupéré via le service [tg.univlome.epl.services.AdminService]
 *
 * Interfaces :
 * - [Serializable] : permet de transférer l’objet entre activités ou fragments via `Intent`
 *
 * @see tg.univlome.epl.services.AdminService
 */
data class Admin(
    var nom: String,
    var motDePasse: String
) : Serializable
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Batiment.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Modèle de données Batiment : Représentation d’un bâtiment géolocalisable sur le campus
 *
 * Description :
 * Ce modèle hérite de la classe [Lieu] et représente un bâtiment spécifique au sein de l’université.
 * Il contient des informations détaillées sur son emplacement, ses images et sa typologie.
 *
 * Hérite de :
 * - [Lieu] : modèle de base contenant les propriétés communes (id, nom, description, coordonnées, etc.)
 *
 * Champs supplémentaires :
 * @property extraProp Propriété étendue (réservée à de futurs besoins ou marquages spécifiques)
 *
 * Constructeur secondaire :
 * Permet de créer un bâtiment avec toutes ses propriétés en une seule instanciation.
 *
 * Utilisation :
 * - Représentation dans les interfaces utilisateurs : [tg.univlome.epl.adapter.BatimentAdapter], [tg.univlome.epl.adapter.BatimentFragmentAdapter]
 * - Chargement depuis Firebase via [tg.univlome.epl.services.BatimentService]
 * - Affichage détaillé dans [tg.univlome.epl.ui.batiment.BatimentActivity]
 *
 * @see tg.univlome.epl.models.Lieu
 * @see tg.univlome.epl.services.BatimentService
 * @see tg.univlome.epl.adapter.BatimentAdapter
 * @see tg.univlome.epl.ui.batiment.BatimentActivity
 */
data class Batiment(
    val extraProp: String = "" // uniquement les ajouts spécifiques
) : Lieu(), Serializable {

    /**
     * Constructeur secondaire pour initialiser un bâtiment avec toutes ses propriétés.
     *
     * @param id Identifiant unique du bâtiment
     * @param nom Nom du bâtiment
     * @param description Description détaillée
     * @param longitude Coordonnée GPS - longitude
     * @param latitude Coordonnée GPS - latitude
     * @param image URL de l’image principale
     * @param situation Zone ou localisation dans le campus (ex : Nord, Sud)
     * @param type Type du bâtiment (ex : enseignement, administratif)
     * @param images Liste des images secondaires
     * @param distance Distance calculée depuis la position de l’utilisateur
     */
    constructor(
        id: String,
        nom: String,
        description: String,
        longitude: String,
        latitude: String,
        image: String,
        situation: String,
        type: String,
        images: List<String> = emptyList(),
        distance: String = ""
    ) : this("") {
        this.id = id
        this.nom = nom
        this.description = description
        this.longitude = longitude
        this.latitude = latitude
        this.image = image
        this.situation = situation
        this.type = type
        this.images = images
        this.distance = distance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Infrastructure.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Modèle de données Infrastructure : Représentation d’une infrastructure présente sur le campus
 *
 * Description :
 * Cette classe hérite de [Lieu] et décrit une infrastructure physique telle qu’un parking, une cafétéria,
 * un laboratoire ou tout autre équipement important. Elle contient les informations nécessaires à son affichage,
 * sa localisation, et son identification.
 *
 * Hérite de :
 * - [Lieu] : modèle commun regroupant les propriétés génériques comme l’identifiant, le nom, les coordonnées, etc.
 *
 * Champs supplémentaires :
 * @property extraProp Propriété personnalisée permettant d’ajouter des métadonnées spécifiques à une infrastructure
 *
 * Constructeur secondaire :
 * Permet l’instanciation complète de l’objet avec tous les attributs pertinents pour l’affichage ou la géolocalisation.
 *
 * Utilisation :
 * - Gestion et affichage via [tg.univlome.epl.adapter.InfraAdapter], [tg.univlome.epl.adapter.InfraFragmentAdapter]
 * - Chargement depuis Firestore via [tg.univlome.epl.services.InfrastructureService]
 * - Consultation détaillée dans [tg.univlome.epl.ui.infrastructure.InfraActivity]
 *
 * @see tg.univlome.epl.models.Lieu
 * @see tg.univlome.epl.services.InfrastructureService
 * @see tg.univlome.epl.adapter.InfraAdapter
 * @see tg.univlome.epl.ui.infrastructure.InfraActivity
 */
data class Infrastructure(
    val extraProp: String = "" // uniquement les ajouts spécifiques
) : Lieu(), Serializable {

    /**
     * Constructeur secondaire permettant d’initialiser une infrastructure avec toutes ses propriétés.
     *
     * @param id Identifiant unique de l’infrastructure
     * @param nom Nom de l’infrastructure
     * @param description Description de l’infrastructure
     * @param longitude Coordonnée GPS - longitude
     * @param latitude Coordonnée GPS - latitude
     * @param image Image principale de l’infrastructure
     * @param situation Position ou zone (Nord, Sud...) sur le campus
     * @param type Type ou catégorie de l’infrastructure
     * @param images Liste des images supplémentaires
     * @param distance Distance depuis l'utilisateur (calculée dynamiquement)
     */
    constructor(
        id: String,
        nom: String,
        description: String,
        longitude: String,
        latitude: String,
        image: String,
        situation: String,
        type: String,
        images: List<String> = emptyList(),
        distance: String = ""
    ) : this("") {
        this.id = id
        this.nom = nom
        this.description = description
        this.longitude = longitude
        this.latitude = latitude
        this.image = image
        this.situation = situation
        this.type = type
        this.images = images
        this.distance = distance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Lieu.kt 
=============================================== 
package tg.univlome.epl.models

import tg.univlome.epl.R
import java.io.Serializable

/**
 * Classe abstraite Lieu : Représentation générique d’un emplacement géographique sur le campus
 *
 * Description :
 * Cette classe représente la base commune à tous les éléments géolocalisables de l’application
 * tels que les bâtiments, les infrastructures ou les salles. Elle regroupe les propriétés nécessaires
 * à l'affichage, à la localisation GPS et à la catégorisation.
 *
 * Propriétés principales :
 * @property id Identifiant unique du lieu (généré par Firebase)
 * @property nom Nom du lieu (ex : "Bibliothèque", "Amphi A")
 * @property description Description textuelle du lieu
 * @property longitude Coordonnée GPS - longitude (sous forme de chaîne)
 * @property latitude Coordonnée GPS - latitude (sous forme de chaîne)
 * @property image URL de l’image principale du lieu
 * @property situation Emplacement ou zone (Nord, Sud) sur le campus
 * @property type Catégorie du lieu (enseignement, administratif, détente, etc.)
 * @property images Liste d’URLs vers des images secondaires ou supplémentaires
 * @property distance Distance entre l’utilisateur et ce lieu (calculée dynamiquement)
 * @property icon Ressource par défaut à afficher si aucune image n’est disponible (valeur par défaut : [R.drawable.img])
 *
 * Utilisation :
 * - Superclasse héritée par : [Batiment], [Infrastructure], [Salle]
 * - Affichage et traitement via des adaptateurs spécialisés
 * - Exploitation dans les vues de détail (ex : [tg.univlome.epl.ui.batiment.BatimentActivity])
 *
 * @see Batiment
 * @see Infrastructure
 * @see Salle
 */
open class Lieu(
    open var id: String = "",
    open var nom: String = "",
    open var description: String = "",
    open var longitude: String = "",
    open var latitude: String = "",
    open var image: String = "",
    open var situation: String = "",
    open var type: String = "",
    open var images: List<String> = emptyList(),
    open var distance: String = "",
    open val icon: Int = R.drawable.img
) : Serializable 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\NavItem.kt 
=============================================== 
package tg.univlome.epl.models

import android.widget.ImageView
import android.widget.LinearLayout
import android.widget.TextView
import androidx.fragment.app.Fragment

/**
 * Classe NavItem : Élément de navigation personnalisé dans l'interface utilisateur.
 *
 * Description :
 * Cette classe encapsule les composants visuels et logiques d’un item de navigation
 * dans l’application, permettant d’associer une vue de navigation (texte + icône + layouts)
 * à un fragment correspondant.
 *
 * Utilisation :
 * - Employé dans les fragments comme `BatimentFragment` ou `InfraFragment`
 *   pour basculer dynamiquement entre différents sous-fragments.
 * - Fournit une structure pratique pour gérer l’état de sélection et les interactions UI.
 *
 * Composants :
 * @property layout Le layout principal de l’item (incluant l’icône et le texte)
 * @property minLayout Layout réduit ou secondaire, souvent utilisé pour l’effet de sélection
 * @property textView Texte affiché pour cet item (ex: "Tous", "Nord", "Sud")
 * @property icon Icône associée à cet item
 * @property fragment Fragment associé à cet item, à afficher lors de la sélection
 *
 * Exemple :
 * ```kotlin
 * val navItem = NavItem(
 *     layout = view.findViewById(R.id.nav_all),
 *     minLayout = view.findViewById(R.id.indicator_all),
 *     textView = view.findViewById(R.id.txt_all),
 *     icon = view.findViewById(R.id.icon_all),
 *     fragment = AllBatimentFragment()
 * )
 * ```
 *
 * @see androidx.fragment.app.Fragment
 * @see tg.univlome.epl.ui.batiment.BatimentFragment
 * @see tg.univlome.epl.ui.infrastructure.InfraFragment
 */
data class NavItem(
    val layout: LinearLayout,
    val minLayout: LinearLayout,
    val textView: TextView,
    val icon: ImageView,
    val fragment: Fragment
)
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\Salle.kt 
=============================================== 
package tg.univlome.epl.models

import java.io.Serializable

/**
 * Classe Salle : Représentation d'une salle physique sur le campus universitaire.
 *
 * Description :
 * Cette classe hérite de [Lieu] et représente une salle d’enseignement, de réunion ou de laboratoire.
 * Elle contient des informations spécifiques telles que sa capacité d’accueil et l’identifiant du bâtiment
 * auquel elle appartient.
 *
 * Composants spécifiques :
 * @property infrastructureId Identifiant du bâtiment auquel cette salle est rattachée (clé étrangère)
 * @property capacite Capacité d’accueil de la salle (ex : "40", "100", "15")
 *
 * Hérite de :
 * - [Lieu] : fournit les coordonnées, nom, description, image principale, type et autres attributs communs
 *
 * Constructeur secondaire :
 * Permet d’instancier une salle avec toutes ses propriétés héritées et spécifiques
 *
 * Utilisation :
 * - Affichée dans les listes ou détails via les adaptateurs comme [tg.univlome.epl.adapter.SalleAdapter]
 * - Consultée dans [tg.univlome.epl.ui.home.SalleActivity] pour les détails
 * - Chargée dynamiquement via [tg.univlome.epl.services.SalleService]
 *
 * @see Lieu
 * @see Batiment
 * @see Infrastructure
 * @see tg.univlome.epl.services.SalleService
 * @see tg.univlome.epl.ui.home.SalleActivity
 */
data class Salle(
    var infrastructureId: String = "",
    var capacite: String = ""
) : Lieu(), Serializable {

    /**
     * Constructeur secondaire pour instancier une salle avec toutes ses propriétés.
     *
     * @param id Identifiant unique de la salle
     * @param infrastructureId ID du bâtiment parent
     * @param nom Nom de la salle
     * @param description Description textuelle
     * @param capacite Capacité d'accueil
     * @param longitude Coordonnée longitude
     * @param latitude Coordonnée latitude
     * @param image URL de l’image principale
     * @param situation Zone ou localisation (Nord/Sud)
     * @param type Type ou fonction de la salle
     * @param images Liste d’images supplémentaires
     * @param distance Distance par rapport à l'utilisateur
     */
    constructor(
        id: String,
        infrastructureId: String,
        nom: String,
        description: String,
        capacite: String,
        longitude: String,
        latitude: String,
        image: String,
        situation: String,
        type: String,
        images: List<String> = emptyList(),
        distance: String = ""
    ) : this(infrastructureId, capacite) {
        this.id = id
        this.nom = nom
        this.description = description
        this.longitude = longitude
        this.latitude = latitude
        this.image = image
        this.situation = situation
        this.type = type
        this.images = images
        this.distance = distance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\modelsfragments\FragmentModel.kt 
=============================================== 
package tg.univlome.epl.models.modelsfragments

import android.content.Context
import android.view.View
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.LifecycleOwner
import java.io.Serializable

data class FragmentModel(
    var view: View,
    var fragmentContext: Context,
    var fragmentActivity: FragmentActivity,
    var viewLifecycleOwner: LifecycleOwner,
    var recyclerViewId: Int,
    var situation: String = "",
    var type: String = ""
) : Serializable 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\models\modelsfragments\HomeFragmentModel.kt 
=============================================== 
package tg.univlome.epl.models.modelsfragments

import android.content.Context
import android.view.View
import androidx.fragment.app.Fragment
import androidx.fragment.app.FragmentActivity
import androidx.fragment.app.FragmentManager
import androidx.lifecycle.LifecycleOwner
import java.io.Serializable

data class HomeFragmentModel(
    var view: View,
    var fragmentContext: Context,
    var fragmentActivity: FragmentActivity,
    var viewLifecycleOwner: LifecycleOwner,
    var recyclerViewId: Int,
    var fragmentManager: FragmentManager,
    var newFragment: Fragment,
    var type: String = ""
) : Serializable 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\AdminService.kt 
=============================================== 
package tg.univlome.epl.services

import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Admin

/**
 * Service AdminService : Récupération des données d’administration
 *
 * Description :
 * Service dédié à la **récupération des informations d’authentification des administrateurs** à partir de Firestore.
 * Il permet de centraliser la gestion des comptes admin dans l'application.
 * Cette classe a donc pour but de :
 * - Accéder à la collection `admins` de Firebase Firestore.
 * - Fournir les données des administrateurs à l’application sous forme de `LiveData`.
 *
 * Composants :
 * - Firebase Firestore
 * - AndroidX LiveData
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @constructor Initialise la connexion à Firestore pour accéder à la collection `admins`
 *
 * @see tg.univlome.epl.models.Admin
 */
class AdminService {
    private val db = FirebaseFirestore.getInstance()
    private val adminsCollection = db.collection("admins")

    /**
     * Récupère la liste des administrateurs depuis Firestore.
     *
     * @return LiveData contenant une liste de [Admin]
     */
    fun getAdmins(): LiveData<List<Admin>> {
        val adminsLiveData = MutableLiveData<List<Admin>>()

        adminsCollection.get()
            .addOnSuccessListener { result ->
                val adminsList = mutableListOf<Admin>()
                for (document in result) {
                    adminsList.add(createAdminFromDocument(document))
                }
                adminsLiveData.value = adminsList
            }
            .addOnFailureListener { exception ->
                Log.e("AdminService", "Erreur lors de la récupération des admins", exception)
            }

        return adminsLiveData
    }

    /**
     * Construit un objet [Admin] à partir d’un document Firestore.
     *
     * @param document Le document Firestore contenant les informations de l’administrateur
     * @return Une instance de [Admin] avec les champs `username` et `password`
     */
    private fun createAdminFromDocument(document: DocumentSnapshot): Admin {
        val username = document.getString("username") ?: ""
        val password = document.getString("password") ?: ""
        return Admin(username, password)
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\BatimentService.kt 
=============================================== 
package tg.univlome.epl.services

import android.content.Context
import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.utils.BatimentUtils

/**
 * Service BatimentService : Récupération des données de bâtiments
 *
 * Description :
 * Classe responsable de la **gestion et récupération des bâtiments** depuis la base de données
 * Firestore. Elle propose une approche hybride : d’abord via un cache local (SharedPreferences), puis
 * via le cloud pour assurer des données à jour.
 * Cette classe a pour but de :
 * - Fournir une liste observable de bâtiments via `LiveData`.
 * - Réduire les temps de chargement grâce à la persistance locale.
 * - Assurer la synchronisation automatique des données avec Firebase Firestore.
 *
 * Composants :
 * - Firebase Firestore (Cloud)
 * - SharedPreferences (Stockage local via `BatimentUtils`)
 * - AndroidX LiveData
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @param context Contexte Android utilisé pour l'accès au cache local
 *
 * @see tg.univlome.epl.models.Batiment
 * @see tg.univlome.epl.utils.BatimentUtils
 */
class BatimentService(private val context: Context) {
    private val db = FirebaseFirestore.getInstance()
    private val batimentsCollection = db.collection("batiments")

    /**
     * Récupère la liste des bâtiments de manière asynchrone depuis Firestore ou localement.
     *
     * @return LiveData contenant une liste de [Batiment]
     */
    fun getBatiments(): LiveData<List<Batiment>> {
        val batimentsLiveData = MutableLiveData<List<Batiment>>()

        val loadBatiments = BatimentUtils.loadBatiments(context)
        if (loadBatiments != null) {
            batimentsLiveData.value = loadBatiments!!
            batimentsCollection.get()
                .addOnSuccessListener { result ->
                    val batimentsList = mutableListOf<Batiment>()
                    for (document in result) {
                        batimentsList.add(createBatimentFromDocument(document))
                    }
                    BatimentUtils.saveBatiments(context, batimentsList)
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "BatimentService",
                        "Erreur lors de la récupération des bâtiments",
                        exception
                    )
                }
        } else {
            batimentsCollection.get()
                .addOnSuccessListener { result ->
                    val batimentsList = mutableListOf<Batiment>()
                    for (document in result) {
                        batimentsList.add(createBatimentFromDocument(document))
                    }
                    BatimentUtils.saveBatiments(context, batimentsList)

                    batimentsLiveData.value = batimentsList
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "BatimentService",
                        "Erreur lors de la récupération des bâtiments",
                        exception
                    )
                }
        }

        return batimentsLiveData
    }

    /**
     * Transforme un document Firestore en instance de [Batiment].
     *
     * @param document Le document Firestore contenant les données du bâtiment
     * @return Une instance de [Batiment] construite à partir des données du document
     */
    private fun createBatimentFromDocument(document: DocumentSnapshot): Batiment {
        val id = document.id
        val nom = document.getString("nom") ?: ""
        val description = document.getString("description") ?: ""
        val longitude = document.getString("longitude") ?: ""
        val latitude = document.getString("latitude") ?: ""
        val images = document.get("images") as? List<String> ?: emptyList()
        val image = images.firstOrNull() ?: ""
        val situation = document.getString("situation") ?: ""
        val type = document.getString("type") ?: ""

        return Batiment(id, nom, description, longitude, latitude, image, situation, type, images)
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\InfrastructureService.kt 
=============================================== 
package tg.univlome.epl.services

import android.content.Context
import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.utils.InfraUtils

/**
 * Service InfrastructureService : Récupération des données d'infrastructures
 *
 * Description :
 * Cette classe fournit un service permettant de **charger les données d'infrastructures** depuis
 * Firebase Firestore et de les mettre en cache localement via `SharedPreferences`.
 * Cette a pour but de :
 * - Fournir une liste observable d'objets [Infrastructure] via `LiveData`.
 * - Optimiser le temps de chargement avec un système de cache (via `InfraUtils`).
 * - Assurer la synchronisation des données entre Firestore et le cache.
 *
 * Composants :
 * - Firebase Firestore
 * - SharedPreferences (via `InfraUtils`)
 * - AndroidX LiveData
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @param context Contexte Android utilisé pour accéder au système de stockage local
 *
 * @see tg.univlome.epl.models.Infrastructure
 * @see tg.univlome.epl.utils.InfraUtils
 */
class InfrastructureService(private val context: Context) {
    private val db = FirebaseFirestore.getInstance()
    private val infrastructuresCollection = db.collection("infrastructures")

    /**
     * Récupère la liste des infrastructures depuis Firestore.
     * Utilise le cache local s’il est disponible, et met à jour en arrière-plan.
     *
     * @return LiveData contenant la liste des infrastructures
     */
    fun getInfrastructures(): LiveData<List<Infrastructure>> {
        val infrastructuresLiveData = MutableLiveData<List<Infrastructure>>()

        val loadInfrastructures = InfraUtils.loadInfras(context)
        if (loadInfrastructures != null) {
            infrastructuresLiveData.value = loadInfrastructures!!
            infrastructuresCollection.get()
                .addOnSuccessListener { result ->
                    val infrastructuresList = mutableListOf<Infrastructure>()
                    for (document in result) {
                        infrastructuresList.add(createInfrastructureFromDocument(document))
                    }
                    InfraUtils.saveInfras(context, infrastructuresList)
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "InfrastructureService",
                        "Erreur lors de la récupération des infrastructures",
                        exception
                    )
                }
        } else {
            infrastructuresCollection.get()
                .addOnSuccessListener { result ->
                    val infrastructuresList = mutableListOf<Infrastructure>()
                    for (document in result) {
                        infrastructuresList.add(createInfrastructureFromDocument(document))
                    }
                    InfraUtils.saveInfras(context, infrastructuresList)
                    infrastructuresLiveData.value = infrastructuresList
                }
                .addOnFailureListener { exception ->
                    Log.e(
                        "InfrastructureService",
                        "Erreur lors de la récupération des infrastructures",
                        exception
                    )
                }
        }

        return infrastructuresLiveData
    }

    /**
     * Convertit un document Firestore en objet [Infrastructure].
     *
     * @param document Document Firestore contenant les données de l'infrastructure
     * @return Une instance d’[Infrastructure] initialisée
     */
    private fun createInfrastructureFromDocument(document: DocumentSnapshot): Infrastructure {
        val id = document.id
        val nom = document.getString("nom") ?: ""
        val description = document.getString("description") ?: ""
        val longitude = document.getString("longitude") ?: ""
        val latitude = document.getString("latitude") ?: ""
        val images = document.get("images") as? List<String> ?: emptyList()
        val image = images.firstOrNull() ?: ""
        val situation = document.getString("situation") ?: ""
        val type = document.getString("type") ?: ""

        return Infrastructure(
            id,
            nom,
            description,
            longitude,
            latitude,
            image,
            situation,
            type,
            images
        )
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\services\SalleService.kt 
=============================================== 
package tg.univlome.epl.services

import android.content.Context
import android.util.Log
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.google.firebase.firestore.DocumentSnapshot
import com.google.firebase.firestore.FirebaseFirestore
import tg.univlome.epl.models.Salle
import tg.univlome.epl.utils.SalleUtils

/**
 * Service SalleService : Récupération des données des salles
 *
 * Description :
 * Cette classe gère la **récupération et la mise en cache des données des salles** depuis Firebase Firestore.
 * Elle assure un chargement rapide grâce à un cache local (`SharedPreferences`) et une mise à jour
 * asynchrone en arrière-plan avec les données plus fraîches depuis Firestore.
 * Cette classe a donc pour but de :
 * - Lire les données des salles depuis Firestore.
 * - Associer chaque salle à son bâtiment via `buildingId`.
 * - Fournir un LiveData<List<Salle>> pour l'observation par les vues.
 * - Utiliser le cache local (`SalleUtils.loadSalles`, `SalleUtils.saveSalles`) pour les performances.
 *
 * Composants :
 * - Firebase Firestore
 * - SharedPreferences (via `SalleUtils`)
 * - `LiveData` et `MutableLiveData` pour observer les salles
 *
 * Bibliothèques utilisées :
 * - Firebase Firestore
 * - AndroidX Lifecycle (LiveData)
 *
 * @param context Contexte Android pour accéder au système de fichiers local
 *
 * @see tg.univlome.epl.models.Salle
 * @see tg.univlome.epl.utils.SalleUtils
 */
class SalleService(private val context: Context) {

    private val db = FirebaseFirestore.getInstance()
    private val sallesCollection = db.collection("salles")
    private val batimentsCollection = db.collection("batiments")

    /**
     * Récupère la liste des salles, en utilisant d'abord le cache local (SharedPreferences),
     * puis en mettant à jour les données via Firebase Firestore si disponible.
     *
     * @return LiveData contenant la liste des salles
     */
    fun getSalles(): LiveData<List<Salle>> {
        val sallesLiveData = MutableLiveData<List<Salle>>()
        val batimentMap = mutableMapOf<String, String>()

        // 1. Charger les salles depuis SharedPreferences (cache rapide)
        val loadSalles = SalleUtils.loadSalles(context)
        if (loadSalles != null) {
            sallesLiveData.value = loadSalles!!
            // 2. Charger les bâtiments depuis Firebase (plus lent)
            batimentsCollection.get()
                .addOnSuccessListener { batimentResult ->
                    for (document in batimentResult) {
                        val id = document.id
                        val nom = document.getString("nom") ?: ""
                        batimentMap[id] = nom
                    }

                    // 3. Puis les salles
                    sallesCollection.get()
                        .addOnSuccessListener { result ->
                            val sallesList = mutableListOf<Salle>()
                            for (document in result) {
                                sallesList.add(createSalleFromDocument(document, batimentMap))
                            }

                            // Sauvegarde UNE SEULE FOIS après avoir tout ajouté
                            SalleUtils.saveSalles(context, sallesList)

                        }
                        .addOnFailureListener { exception ->
                            Log.e(
                                "SalleService",
                                "Erreur lors de la récupération des salles",
                                exception
                            )
                        }
                }
                .addOnFailureListener { exception ->
                    Log.e("SalleService", "Erreur lors de la récupération des bâtiments", exception)
                }
        } else {
            // 2. Charger les bâtiments depuis Firebase (plus lent)
            batimentsCollection.get()
                .addOnSuccessListener { batimentResult ->
                    for (document in batimentResult) {
                        val id = document.id
                        val nom = document.getString("nom") ?: ""
                        batimentMap[id] = nom
                    }

                    // 3. Puis les salles
                    sallesCollection.get()
                        .addOnSuccessListener { result ->
                            val sallesList = mutableListOf<Salle>()
                            for (document in result) {
                                sallesList.add(createSalleFromDocument(document, batimentMap))
                            }

                            // Sauvegarde UNE SEULE FOIS après avoir tout ajouté
                            SalleUtils.saveSalles(context, sallesList)

                            sallesLiveData.value = sallesList

                        }
                        .addOnFailureListener { exception ->
                            Log.e(
                                "SalleService",
                                "Erreur lors de la récupération des salles",
                                exception
                            )
                        }
                }
                .addOnFailureListener { exception ->
                    Log.e("SalleService", "Erreur lors de la récupération des bâtiments", exception)
                }
        }

        return sallesLiveData
    }

    /**
     * Transforme un document Firestore en instance de [Salle], en liant les ID de bâtiments
     * à leur nom via une map générée au préalable.
     *
     * @param document Document Firestore de la salle
     * @param batimentMap Map des ID de bâtiments vers leurs noms
     * @return Salle initialisée avec ses attributs
     */
    private fun createSalleFromDocument(
        document: DocumentSnapshot,
        batimentMap: Map<String, String>
    ): Salle {
        val id = document.id
        val infrastructureId = document.getString("buildingId") ?: ""
        val nom = document.getString("nom") ?: ""
        val description = document.getString("description") ?: ""
        val capacite = document.getString("capacity") ?: ""
        val longitude = document.getString("longitude") ?: ""
        val latitude = document.getString("latitude") ?: ""
        val images = document.get("images") as? List<String> ?: emptyList()
        val image = images.firstOrNull() ?: ""
        val type = document.getString("type") ?: ""

        val situation = batimentMap[infrastructureId] ?: "Bâtiment inconnu"

        return Salle(
            id,
            infrastructureId,
            nom,
            description,
            capacite,
            longitude,
            latitude,
            image,
            situation,
            type,
            images
        )
    }
}
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\LocULFragment.kt 
=============================================== 
package tg.univlome.epl.ui

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment LocULFragment : Localisation statique de l'Université de Lomé
 *
 * Description :
 * Ce fragment affiche un écran de **localisation générale ou symbolique** de l’Université de Lomé.
 * Il peut servir à présenter une carte figée, une bannière descriptive ou toute autre vue informative
 * concernant la position ou l'identité géographique de l’UL.
 * Cette classe a donc pour but de :
 * - Fournir un point d’entrée statique à la localisation de l’université.
 * - Affichage complémentaire ou introductif dans le système de navigation de l'application.
 *
 * Composants :
 * - `fragment_loc_ul.xml` : layout associé à la représentation de l’UL.
 *
 * Bibliothèques utilisées :
 * - AndroidX Fragment
 *
 * Exemple d’utilisation :
 * ```
 * val fragment = LocULFragment()
 * supportFragmentManager.beginTransaction()
 *     .replace(R.id.container, fragment)
 *     .commit()
 * ```
 */
class LocULFragment : Fragment() {

    /**
     * Crée la vue du fragment à partir du layout `fragment_loc_ul`.
     *
     * @param inflater Le LayoutInflater utilisé pour gonfler la vue
     * @param container Le ViewGroup parent dans lequel la vue sera insérée
     * @param savedInstanceState État précédemment enregistré du fragment
     * @return La vue représentant la localisation de l’UL
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        return inflater.inflate(R.layout.fragment_loc_ul, container, false)
    }

    /**
     * Appelée après que la vue a été créée. Peut être utilisée pour initialiser
     * les composants d'interface ou déclencher des animations/données.
     *
     * @param view La vue racine du fragment
     * @param savedInstanceState L’état sauvegardé du fragment
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\LogoFragment.kt 
=============================================== 
package tg.univlome.epl.ui

import android.os.Bundle
import android.util.Log
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment LogoFragment : Affichage du logo au lancement
 *
 * Description :
 * Fragment utilisé pour **afficher temporairement un logo ou écran d’accueil** au lancement de l’application.
 * Il peut être utilisé comme un splash screen ou comme une vue d’introduction silencieuse.
 * Cette classe a donc pour but de :
 * - Fournir un écran statique avec le logo de l’application.
 * - Notifier un composant parent via une interface optionnelle (`LogoListener`).
 *
 * Composants :
 * - `fragment_logo.xml` : Mise en page du logo.
 * - `LogoListener` : Interface pour l’interaction optionnelle avec d'autres fragments ou activités.
 *
 * Bibliothèques utilisées :
 * - AndroidX Fragment
 *
 * Exemple d’utilisation :
 * ```
 * val fragment = LogoFragment()
 * fragment.setLogoListener(object : LogoFragment.LogoListener { ... })
 * ```
 */
class LogoFragment : Fragment() {

    /**
     * Interface de rappel optionnelle pour interagir avec des composants parents
     * (comme une activité ou un autre fragment) après l’affichage du logo.
     */
    interface LogoListener

    private var logoListener: LogoListener? = null

    /**
     * Permet d’enregistrer un listener pour réagir à des événements du fragment.
     *
     * @param listener Une implémentation de [LogoListener]
     */
    fun setLogoListener(listener: LogoListener) {
        logoListener = listener
    }

    /**
     * Récupère le listener actuellement assigné au fragment.
     *
     * @return L’instance de [LogoListener] ou `null` si aucun n’a été défini
     */
    fun getLogoListener(): LogoListener? {
        return this.logoListener
    }

    /**
     * Crée la vue du fragment à partir du layout `fragment_logo`.
     *
     * @return La vue représentant le logo
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        return inflater.inflate(R.layout.fragment_logo, container, false)
    }

    /**
     * Méthode appelée après que la vue a été créée. Affiche un log dans la console pour suivi du cycle de vie.
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        Log.d("LOGO_FRAGMENT", "LogoFragment visible")
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\SearchBarFragment.kt 
=============================================== 
package tg.univlome.epl.ui

import android.os.Bundle
import android.text.Editable
import android.text.TextWatcher
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.EditText
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment SearchBarFragment : Barre de recherche dynamique
 *
 * Description :
 * Ce fragment fournit une interface utilisateur permettant à l'utilisateur de taper du texte
 * pour effectuer une recherche. Il déclenche dynamiquement des mises à jour de contenu
 * via une interface `SearchListener`.
 * Cette classe a donc pour but de :
 * - Fournir une zone de saisie pour filtrer dynamiquement des éléments (bâtiments, salles, infrastructures, etc.)
 * - Notifier les fragments hébergeurs des changements en temps réel
 *
 * Composants :
 * - `fragment_search_bar.xml` : contient un `EditText` pour la recherche
 *
 * Bibliothèques utilisées :
 * - AndroidX Fragment
 *
 * @see SearchListener — interface de communication pour la transmission des requêtes
 * @see tg.univlome.epl.ui.batiment.AllBatimentFragment
 * @see tg.univlome.epl.ui.infrastructure.AllInfraFragment
 * @see tg.univlome.epl.ui.home.ViewAllSalleFragment
 */
class SearchBarFragment : Fragment() {

    /**
     * Interface utilisée pour transmettre le texte saisi à un écouteur externe.
     */
    interface SearchListener {
        /**
         * Appelée à chaque fois que le texte dans la barre de recherche est modifié.
         * @param query texte saisi par l'utilisateur
         */
        fun onSearch(query: String)
    }

    private var searchListener: SearchListener? = null

    /**
     * Enregistre un écouteur pour les événements de recherche.
     *
     * @param listener l’objet implémentant SearchListener
     */
    fun setSearchListener(listener: SearchListener) {
        searchListener = listener
    }

    /**
     * Récupère l'écouteur actuellement enregistré.
     *
     * @return le SearchListener actif, ou null s'il n'est pas défini
     */
    fun getSearchListener(): SearchListener? {
        return this.searchListener
    }

    /**
     * Gonfle la vue associée au fragment.
     *
     * @param inflater le LayoutInflater
     * @param container le conteneur parent
     * @param savedInstanceState état antérieur du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        return inflater.inflate(R.layout.fragment_search_bar, container, false)
    }

    /**
     * Initialise les interactions après que la vue est créée. Ajoute notamment un `TextWatcher`
     * à l'élément `EditText` pour capturer les recherches.
     *
     * @param view vue racine du fragment
     * @param savedInstanceState état antérieur du fragment
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        val searchEditText = view.findViewById<EditText>(R.id.search_edit_text)

        searchEditText.addTextChangedListener(object : TextWatcher {
            override fun afterTextChanged(s: Editable?) {
                searchListener?.onSearch(s.toString())
            }

            override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) {}
            override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) {}
        })
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\AllBatimentFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment AllBatimentFragment : Affiche tous les bâtiments sans filtrage géographique
 *
 * Description :
 * Ce fragment présente la liste complète des bâtiments disponibles sur le campus universitaire,
 * sans distinction de situation (nord/sud). Il utilise :
 *  - un effet de chargement Shimmer pour l’attente des données
 *  - la localisation de l’utilisateur pour calculer les distances par bâtiment
 *  - une interface de recherche (SearchBar) pour filtrer dynamiquement par nom
 *
 * Une fois les données chargées, elles sont affichées dans une `RecyclerView` avec
 * l’adaptateur `BatimentFragmentAdapter`. Ce fragment communique avec `BatimentUtils`
 * pour le traitement de la logique métier et la géolocalisation.
 *
 * Composants principaux :
 *  - `RecyclerView` : liste des bâtiments
 *  - `ShimmerFrameLayout` : animation de chargement
 *  - `FusedLocationProviderClient` : localisation utilisateur
 *  - `SearchBarFragment` : filtrage via une barre de recherche
 *
 * Bibliothèques utilisées :
 *  - Google Location Services
 *  - Facebook Shimmer
 *  - OSMDroid pour la gestion des coordonnées
 *
 * @see BatimentUtils pour la logique de filtrage et calcul de distance
 * @see BatimentFragmentAdapter pour l’affichage des éléments
 * @see SearchBarFragment pour la recherche textuelle
 */
class AllBatimentFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batiments: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter
    private lateinit var batimentService: BatimentService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerAllBatiments: ShimmerFrameLayout
    private lateinit var recyclerAllBatiments: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise le layout du fragment, les vues UI, la localisation,
     * les listes de données et lance le chargement.
     *
     * @return Vue initialisée du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_all_batiment, container, false)

        shimmerAllBatiments = view.findViewById(R.id.shimmerAllBatiments)
        recyclerAllBatiments = view.findViewById(R.id.recyclerAllBatiments)
        shimmerAllBatiments.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batiments = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batiments)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllBatiments
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la position actuelle de l’utilisateur à l’aide de Google Location Services.
     * Une fois la position obtenue, déclenche le chargement des bâtiments via `BatimentUtils`.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerAllBatiments.stopShimmer()
                shimmerAllBatiments.visibility = View.GONE
                recyclerAllBatiments.visibility = View.VISIBLE
            }

            BatimentUtils.updateBatiments(
                userGeoPoint,
                batiments,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Effectue un filtrage dynamique de la liste des bâtiments en fonction du texte recherché.
     * Met à jour l’adaptateur avec les résultats filtrés.
     *
     * @param query Chaîne entrée par l’utilisateur dans la barre de recherche
     */
    override fun onSearch(query: String) {
        filteredList =
            batiments.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\BatimentActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.Intent
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.os.Bundle
import android.view.View
import android.view.ViewGroup
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import com.google.android.material.tabs.TabLayoutMediator
import org.osmdroid.config.Configuration
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import tg.univlome.epl.R
import tg.univlome.epl.adapter.ImageAdapter
import tg.univlome.epl.databinding.ActivityBatimentBinding
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.ui.maps.MapsActivity
import tg.univlome.epl.utils.MapsUtils

/**
 * Activité BatimentActivity : Activité de détail d’un bâtiment
 *
 * Description :
 * Cette activité affiche les détails complets d’un bâtiment sélectionné, y compris :
 *  - Le nom, la situation géographique, la distance, et la description
 *  - Un carrousel d’images si plusieurs photos sont disponibles
 *  - Une carte miniature affichant la position du bâtiment et celle de l’utilisateur
 *  - Un bouton de navigation qui redirige vers la carte principale (`MapsActivity`)
 *
 * Elle gère également la récupération de la position de l'utilisateur en temps réel à l'aide de
 * l'API `FusedLocationProviderClient`, ainsi que les permissions de localisation.
 *
 * Composants UI :
 *  - `ActivityBatimentBinding` pour accéder aux vues via ViewBinding
 *  - `MapView` (OSMDroid) pour l'affichage de la carte
 *  - `TabLayout` + `ViewPager2` pour les images
 *
 * Composants techniques :
 *  - Glide pour le chargement dynamique des images
 *  - OSMDroid pour la carte miniature statique
 *  - `MapsUtils` pour configurer la carte et calculer les itinéraires
 *
 * Permissions requises :
 *  - `ACCESS_FINE_LOCATION` pour afficher la position de l’utilisateur
 *
 * @see MapsUtils.setMiniMap pour la configuration de la carte miniature
 * @see MapsActivity pour la navigation complète
 * @see ImageAdapter pour le carrousel d’images
 */
class BatimentActivity : AppCompatActivity() {

    lateinit var ui: ActivityBatimentBinding
    private lateinit var miniMap: MapView
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Point d’entrée de l’activité. Initialise l’interface utilisateur,
     * applique les paramètres OSMDroid, extrait l’objet `Batiment`
     * depuis l’intent, configure l’affichage des images, les informations textuelles,
     * la carte miniature, et le bouton de navigation.
     *
     * Gère également les permissions de localisation.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        ui = ActivityBatimentBinding.inflate(layoutInflater)
        setContentView(ui.root)

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)
        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        val batiment = intent.getSerializableExtra("batiment") as? Batiment

        // Mettre à jour l'interface utilisateur avec les données reçues

        val images = batiment?.images ?: emptyList()

        if (images.size <= 1) {
            ui.imageContainer.visibility = View.GONE
        } else {
            ui.imageContainer.visibility = View.VISIBLE
            val viewPager = ui.imagePager
            val tabLayout = ui.imageIndicator

            // Déplacer la première image à la fin de la liste
            val mainImage = batiment?.image
            val reorderedImages = (images.filter { it != mainImage }) + mainImage

            viewPager.adapter = ImageAdapter(reorderedImages as List<String>)

            TabLayoutMediator(tabLayout, viewPager) { _, _ -> }.attach()

            for (i in 0 until tabLayout.tabCount) {
                val tabView = (tabLayout.getChildAt(0) as ViewGroup).getChildAt(i)
                val params = tabView.layoutParams as ViewGroup.MarginLayoutParams

                // Définition de la taille des points
                params.width = resources.getDimensionPixelSize(R.dimen.custom_dot_width)
                params.height = resources.getDimensionPixelSize(R.dimen.custom_dot_height)

                // Définition des marges entre les points
                params.setMargins(
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0,
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0
                )

                tabView.layoutParams = params
            }
        }

        if (batiment != null) {
            ui.txtNomBatiment.text = batiment.nom
            ui.situationBat.text = batiment.situation
            ui.txtDistance.text = batiment.distance
            ui.desc.text = batiment.description
            if (!batiment.image.isNullOrEmpty()) {
                Glide.with(this)
                    .asBitmap()
                    .load(batiment.image)
                    .into(object : CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: Transition<in Bitmap>?
                        ) {
                            val drawable =
                                BitmapDrawable(resources, resource)
                            ui.imgBatiment.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                ui.imgBatiment.setImageResource(batiment.icon)
            }
            if (!batiment.latitude.isNullOrBlank() && !batiment.longitude.isNullOrBlank()) {
                val latitude = batiment.latitude.toDouble()
                val longitude = batiment.longitude.toDouble()

                ui.aller.setOnClickListener {
                    MapsUtils.saveDestination(this, GeoPoint(latitude, longitude))
                    val intent = Intent(this, MapsActivity::class.java)
                    ui.aller.context.startActivity(intent)
                }

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    != PackageManager.PERMISSION_GRANTED
                ) {

                    requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
                    return
                }

                miniMap = ui.miniMap

                // Fallback si la localisation n'est pas disponible
                val destination = GeoPoint(latitude, longitude)
                var userLocation: GeoPoint? = null

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    == PackageManager.PERMISSION_GRANTED
                ) {

                    fusedLocationClient.lastLocation.addOnSuccessListener { location ->
                        location?.let {
                            userLocation = GeoPoint(it.latitude, it.longitude)
                            setupMiniMap(userLocation!!, destination)
                        } ?: run {
                            // Si la localisation n'est pas disponible, utiliser seulement la destination
                            setupMiniMap(destination, destination)
                        }
                    }.addOnFailureListener {
                        // En cas d'échec, utiliser seulement la destination
                        setupMiniMap(destination, destination)
                    }
                } else {
                    // Sans permission, utiliser seulement la destination
                    setupMiniMap(destination, destination)
                }
            } else {
                // Affiche un message ou fais une action par défaut
                ui.aller.visibility = View.GONE
                ui.miniMapLayout.visibility = View.GONE
            }

        }

        ui.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }
    }

    /**
     * Configure et affiche une carte miniature (`miniMap`) montrant l’itinéraire
     * entre deux points : la position de l’utilisateur et celle du bâtiment.
     *
     * @param start Position de départ (utilisateur)
     * @param end Position d’arrivée (bâtiment)
     *
     * @requiresPermission Manifest.permission.ACCESS_FINE_LOCATION
     * @requiresPermission Manifest.permission.ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun setupMiniMap(start: GeoPoint, end: GeoPoint) {
        // Postpone pour s'assurer que la vue est bien layoutée
        ui.miniMapLayout.visibility = View.VISIBLE
        ui.miniMap.post {
            MapsUtils.setMiniMap(miniMap, start, end, this, this, resources)
            // Forcer un recalcul des dimensions
            miniMap.invalidate()
            miniMap.requestLayout()
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\BatimentFragment.kt 
=============================================== 
package tg.univlome.epl.ui.batiment

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.AnimationUtils
import android.widget.LinearLayout
import androidx.appcompat.app.AppCompatActivity
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment BatimentFragment : Fragment de navigation des bâtiments par zone géographique
 *
 * Description :
 * Ce fragment offre une interface utilisateur permettant de filtrer et d'afficher
 * les bâtiments du campus selon leur situation géographique :
 *  - Tous les bâtiments
 *  - Bâtiments situés au Campus Nord
 *  - Bâtiments situés au Campus Sud
 *
 * L’utilisateur peut naviguer entre ces catégories via une barre de navigation personnalisée,
 * avec des indicateurs visuels animés pour refléter la sélection.
 * Chaque filtre déclenche le chargement d’un sous-fragment spécifique (`AllBatimentFragment`, etc.).
 *
 * Composants principaux :
 *  - `LinearLayout` interactif pour chaque onglet de navigation (nav_all, nav_nord, nav_sud)
 *  - `View` utilisé comme indicateur visuel de sélection
 *  - `AnimationUtils` pour une animation d’indicateur fluide
 *  - Sous-fragments affichés dynamiquement dans un conteneur (`R.id.batiment_container`)
 *
 * Bibliothèques utilisées :
 *  - AndroidX Fragment
 *  - Android AnimationUtils (animation de scale)
 *
 * @see AllBatimentFragment pour l’affichage de tous les bâtiments
 * @see NordBatimentFragment pour les bâtiments du Campus Nord
 * @see SudBatimentFragment pour les bâtiments du Campus Sud
 */
class BatimentFragment : Fragment() {

    private var currentSelectedNav: View? = null
    private var currentIndicator: View? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée la vue du fragment à partir de `fragment_batiment.xml`.
     *
     * @return Vue principale contenant la navigation par zone
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_batiment, container, false)
    }

    /**
     * Initialise l’état initial du fragment et configure la navigation
     * entre les différentes zones géographiques des bâtiments.
     *
     * Par défaut, charge `AllBatimentFragment`.
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // Par défaut, "Tout" est sélectionné
        val allNav = view.findViewById<LinearLayout>(R.id.nav_all)
        val allIndicator = view.findViewById<View>(R.id.indicator_all)
        currentSelectedNav = allNav
        currentIndicator = allIndicator
        loadFragment(AllBatimentFragment())

        // Configurer les listeners pour chaque élément de navigation
        setupNavItem(view, R.id.nav_all, R.id.indicator_all) {
            loadFragment(AllBatimentFragment())
        }

        setupNavItem(view, R.id.nav_nord, R.id.indicator_nord) {
            loadFragment(NordBatimentFragment())
        }

        setupNavItem(view, R.id.nav_sud, R.id.indicator_sud) {
            loadFragment(SudBatimentFragment())
        }
    }

    /**
     * Associe un écouteur à un bouton de navigation et son indicateur.
     * Gère la sélection visuelle, les animations et le changement de fragment.
     *
     * @param view Vue racine contenant l’élément
     * @param navItemId ID de l’élément de navigation cliquable
     * @param indicatorId ID de l’indicateur à afficher
     * @param action Action à exécuter au clic (chargement d’un sous-fragment)
     */
    private fun setupNavItem(view: View, navItemId: Int, indicatorId: Int, action: () -> Unit) {
        val navItem = view.findViewById<LinearLayout>(navItemId)
        val indicator = view.findViewById<View>(indicatorId)

        navItem.setOnClickListener {
            // Si c'est déjà l'élément sélectionné, ne rien faire
            if (currentSelectedNav == navItem) return@setOnClickListener

            // Désélectionner l'élément précédent
            currentIndicator?.visibility = View.INVISIBLE

            // Sélectionner le nouvel élément
            indicator.visibility = View.VISIBLE
            animateIndicator(indicator)
            currentSelectedNav = navItem
            currentIndicator = indicator

            // Exécuter l'action associée à cet élément
            action()
        }
    }

    /**
     * Applique une animation de type "scale" à l’indicateur sélectionné.
     *
     * @param indicator Vue représentant l’indicateur actif
     */
    private fun animateIndicator(indicator: View) {
        // Charger l'animation
        val scaleAnimation = AnimationUtils.loadAnimation(context, R.anim.indicator_scale)

        // Appliquer l'animation à l'indicateur
        indicator.startAnimation(scaleAnimation)
    }

    /**
     * Remplace dynamiquement le fragment affiché dans le conteneur central.
     *
     * @param fragment Fragment à afficher dans `batiment_container`
     */
    private fun loadFragment(fragment: Fragment) {
        (requireActivity() as AppCompatActivity).supportFragmentManager.beginTransaction()
            .replace(R.id.batiment_container, fragment)
            .commit()
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\NordBatimentFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment NordBatimentFragment : Affiche les bâtiments situés sur le Campus Nord.
 *
 * Description :
 * Ce fragment permet de visualiser dynamiquement les bâtiments du **campus nord**,
 * en se basant sur la localisation actuelle de l’utilisateur.
 * Il calcule les distances entre l’utilisateur et les bâtiments, les affiche dans
 * une `RecyclerView` avec un effet de chargement shimmer, et permet un filtrage
 * en temps réel via la barre de recherche.
 *
 * Composants principaux :
 * - `BatimentUtils` : outil central de récupération, filtrage et affichage
 * - `BatimentFragmentAdapter` : adaptateur de liste pour les bâtiments
 * - `FragmentModel` : encapsule les métadonnées de fragment (vue, contexte, type)
 *
 * Bibliothèques utilisées :
 * - Google Play Services (`FusedLocationProviderClient`) : pour la géolocalisation
 * - OSMDroid : pour manipuler les coordonnées géographiques
 * - Facebook Shimmer : pour l’effet de chargement fluide
 *
 * @see BatimentUtils pour la logique métier de mise à jour
 * @see SearchBarFragment pour le support du filtrage textuel en direct
 */
class NordBatimentFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batiments: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter
    private lateinit var batimentService: BatimentService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerNordBatiments: ShimmerFrameLayout
    private lateinit var recyclerNordBatiments: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée et retourne la vue du fragment, initialise les composants UI,
     * démarre l’effet shimmer et déclenche la récupération de la localisation.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_nord_batiment, container, false)

        shimmerNordBatiments = view.findViewById(R.id.shimmerNordBatiments)
        recyclerNordBatiments = view.findViewById(R.id.recyclerNordBatiments)
        shimmerNordBatiments.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batiments = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batiments)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerNordBatiments,
            "nord"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la localisation actuelle de l'utilisateur pour filtrer les bâtiments.
     * Utilise `BatimentUtils.updateBatiments` avec le paramètre de situation "nord".
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerNordBatiments.stopShimmer()
                shimmerNordBatiments.visibility = View.GONE
                recyclerNordBatiments.visibility = View.VISIBLE
            }
            BatimentUtils.updateBatiments(
                userGeoPoint,
                batiments,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des bâtiments selon le texte de recherche saisi.
     *
     * @param query Le mot-clé saisi dans la barre de recherche
     */
    override fun onSearch(query: String) {
        filteredList =
            batiments.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\batiment\SudBatimentFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.batiment

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment SudBatimentFragment : Affiche les bâtiments du campus sud
 *
 * Description :
 * Ce fragment est dédié à l'affichage des bâtiments situés sur le **campus sud** de l'université.
 * Il récupère la localisation de l'utilisateur, calcule la distance jusqu'à chaque bâtiment
 * et met à jour dynamiquement une `RecyclerView` avec un indicateur de chargement (shimmer).
 *
 * Une recherche en temps réel permet de filtrer les résultats en fonction du nom du bâtiment.
 *
 * Composants principaux :
 * - `BatimentUtils` : Gère la récupération, le filtrage et la mise à jour des bâtiments
 * - `BatimentFragmentAdapter` : Affiche les bâtiments dans une liste verticale
 * - `FragmentModel` : Fournit le contexte et les paramètres de configuration
 *
 * Bibliothèques utilisées :
 * - **OSMDroid** pour la gestion des coordonnées géographiques
 * - **Google Play Services** (`FusedLocationProviderClient`) pour la géolocalisation
 * - **Facebook Shimmer** pour l'effet de chargement pendant l'attente des données
 *
 * @see BatimentUtils
 * @see SearchBarFragment
 */
class SudBatimentFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batiments: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter
    private lateinit var batimentService: BatimentService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerSudBatiments: ShimmerFrameLayout
    private lateinit var recyclerSudBatiments: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise la vue du fragment et déclenche la localisation pour charger les données.
     *
     * @return La vue du fragment sud contenant la liste des bâtiments filtrés.
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_sud_batiment, container, false)

        shimmerSudBatiments = view.findViewById(R.id.shimmerSudBatiments)
        recyclerSudBatiments = view.findViewById(R.id.recyclerSudBatiments)
        shimmerSudBatiments.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batiments = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batiments)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerSudBatiments,
            "sud"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la position actuelle de l'utilisateur puis met à jour la liste des bâtiments du campus sud.
     * Affiche ensuite la `RecyclerView` et cache le shimmer une fois les données prêtes.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerSudBatiments.stopShimmer()
                shimmerSudBatiments.visibility = View.GONE
                recyclerSudBatiments.visibility = View.VISIBLE
            }

            BatimentUtils.updateBatiments(
                userGeoPoint,
                batiments,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre les bâtiments affichés selon le mot-clé saisi dans la barre de recherche.
     * @param query Texte de recherche saisi par l'utilisateur
     */
    override fun onSearch(query: String) {
        filteredList =
            batiments.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\HomeFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentAdapter
import tg.univlome.epl.adapter.InfraAdapter
import tg.univlome.epl.adapter.SalleAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.ui.LogoFragment
import tg.univlome.epl.utils.HomeBatimentUtils
import tg.univlome.epl.utils.HomeInfraUtils
import tg.univlome.epl.utils.HomeSalleUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment HomeFragment : Fragment d’accueil affichant les sections principales
 * de l'application de géolocalisation du campus universitaire.
 *
 * Description :
 * Ce fragment constitue l’écran d’accueil de l’application. Il permet d’afficher
 * les différentes entités présentes sur le campus :
 *  - Bâtiments d’enseignement
 *  - Bâtiments administratifs
 *  - Infrastructures
 *  - Salles
 *
 * Il utilise des animations Shimmer pour améliorer l’expérience utilisateur durant le chargement.
 * Les données sont récupérées depuis Firestore via des services dédiés, et filtrées selon leur type.
 * La position de l’utilisateur est utilisée pour calculer les distances relatives à chaque entité.
 *
 * Composants principaux :
 *  - `RecyclerView` pour chaque section (enseignement, administratif, infrastructures, salles)
 *  - `ShimmerFrameLayout` pour les effets de chargement
 *  - `HomeFragmentModel` pour encapsuler les métadonnées liées à chaque section
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour la géolocalisation
 *  - Google Location Services pour récupérer la position de l'utilisateur
 *  - Facebook Shimmer pour les animations de chargement
 *  - AndroidX Fragment, RecyclerView, Lifecycle
 *
 * @see HomeBatimentUtils, HomeInfraUtils, HomeSalleUtils pour le traitement des données
 * @see HomeFragmentModel pour le modèle utilisé dans chaque section
 */
class HomeFragment : Fragment(), LogoFragment.LogoListener {

    private lateinit var batimentsEns: MutableList<Batiment>
    private lateinit var batimentsEnsFilteredList: MutableList<Batiment>
    private lateinit var batimentsEnsAdapter: BatimentAdapter

    private lateinit var batimentsAdmin: MutableList<Batiment>
    private lateinit var batimentsAdminFilteredList: MutableList<Batiment>
    private lateinit var batimentsAdminAdapter: BatimentAdapter

    private lateinit var infras: MutableList<Infrastructure>
    private lateinit var infrasFilteredList: MutableList<Infrastructure>
    private lateinit var infrasAdapter: InfraAdapter

    private lateinit var salles: MutableList<Salle>
    private lateinit var sallesFilteredList: MutableList<Salle>
    private lateinit var sallesAdapter: SalleAdapter

    private lateinit var batsEnsHomeFragmentModel: HomeFragmentModel
    private lateinit var batsAdminHomeFragmentModel: HomeFragmentModel
    private lateinit var sallesHomeFragmentModel: HomeFragmentModel
    private lateinit var infrasHomeFragmentModel: HomeFragmentModel

    // Shimmer FrameLayouts
    private lateinit var shimmerBatimentsEns: ShimmerFrameLayout
    private lateinit var shimmerBatimentsAdmin: ShimmerFrameLayout
    private lateinit var shimmerSalles: ShimmerFrameLayout
    private lateinit var shimmerInfra: ShimmerFrameLayout

    // RecyclerViews
    private lateinit var recyclerBatimentsEns: RecyclerView
    private lateinit var recyclerBatimentsAdmin: RecyclerView
    private lateinit var recyclerSalles: RecyclerView
    private lateinit var recyclerInfra: RecyclerView

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    private var rootView: View? = null

    /**
     * Initialise les vues du fragment et déclenche le chargement des données.
     * Affiche les effets Shimmer durant le chargement.
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        rootView = inflater.inflate(R.layout.fragment_home, container, false)

        // Initialiser les shimmer layouts et recyclerviews
        initializeViews(rootView!!)

        // Montrer les shimmer et cacher les recyclerviews
        showShimmer()

        // Charger les données
        loadData(rootView!!)

        return rootView
    }

    /**
     * Initialise tous les éléments de l’interface graphique :
     * les animations shimmer et les `RecyclerView`.
     *
     * @param view Vue racine du fragment
     */
    private fun initializeViews(view: View) {
        // Initialiser les shimmer layouts
        shimmerBatimentsEns = view.findViewById(R.id.shimmerBatimentsEnsContainer)
        shimmerBatimentsAdmin = view.findViewById(R.id.shimmerBatimentsAdminContainer)
        shimmerSalles = view.findViewById(R.id.shimmerSalleContainer)
        shimmerInfra = view.findViewById(R.id.shimmerInfraContainer)

        // Initialiser les recyclerviews
        recyclerBatimentsEns = view.findViewById(R.id.recyclerBatiments)
        recyclerBatimentsAdmin = view.findViewById(R.id.recyclerBatimentsAdmin)
        recyclerSalles = view.findViewById(R.id.recyclerSalles)
        recyclerInfra = view.findViewById(R.id.recyclerInfra)
    }

    /**
     * Active les animations Shimmer sur toutes les sections de contenu.
     */
    private fun showShimmer() {
        // Démarrer les animations shimmer
        shimmerBatimentsEns.startShimmer()
        shimmerBatimentsAdmin.startShimmer()
        shimmerSalles.startShimmer()
        shimmerInfra.startShimmer()
    }

    /**
     * Désactive les animations Shimmer et affiche les `RecyclerView` avec les données chargées.
     */
    private fun hideShimmer() {
        // Arrêter les animations shimmer
        shimmerBatimentsEns.stopShimmer()
        shimmerBatimentsAdmin.stopShimmer()
        shimmerSalles.stopShimmer()
        shimmerInfra.stopShimmer()

        // Cacher les shimmer layouts
        shimmerBatimentsEns.visibility = View.GONE
        shimmerBatimentsAdmin.visibility = View.GONE
        shimmerSalles.visibility = View.GONE
        shimmerInfra.visibility = View.GONE

        // Montrer les recyclerviews
        recyclerBatimentsEns.visibility = View.VISIBLE
        recyclerBatimentsAdmin.visibility = View.VISIBLE
        recyclerSalles.visibility = View.VISIBLE
        recyclerInfra.visibility = View.VISIBLE
    }

    /**
     * Initialise les listes, adaptateurs et modèles pour toutes les sections.
     * Déclenche la récupération de la position utilisateur.
     *
     * @param view Vue contenant les composants d’interface
     */
    fun loadData(view: View) {
        val fragmentManager = requireActivity().supportFragmentManager

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentsEns = mutableListOf()
        batimentsEnsFilteredList = mutableListOf()
        batimentsEnsAdapter =
            BatimentAdapter(batimentsEns, fragmentManager, ViewAllBatEnsFragment())

        batimentsAdmin = mutableListOf()
        batimentsAdminFilteredList = mutableListOf()
        batimentsAdminAdapter =
            BatimentAdapter(batimentsAdmin, fragmentManager, ViewAllBatAdminFragment())

        infras = mutableListOf()
        infrasFilteredList = mutableListOf()
        infrasAdapter = InfraAdapter(infras, fragmentManager, ViewAllInfraFragment())

        salles = mutableListOf()
        sallesFilteredList = mutableListOf()
        sallesAdapter = SalleAdapter(salles, fragmentManager, ViewAllSalleFragment())

        batsEnsHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerBatiments,
            fragmentManager,
            ViewAllBatEnsFragment(),
            "enseignement"
        )
        batsAdminHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerBatimentsAdmin,
            fragmentManager,
            ViewAllBatAdminFragment(),
            "administratif"
        )
        sallesHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerSalles,
            fragmentManager,
            ViewAllSalleFragment()
        )
        infrasHomeFragmentModel = HomeFragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerInfra,
            fragmentManager,
            ViewAllInfraFragment()
        )

        getUserLocation()
    }

    /**
     * Recharge manuellement toutes les données, utile après une permission ou mise à jour.
     * Affiche à nouveau les effets de chargement (Shimmer).
     */
    fun rechargerDonnees() {
        // Afficher à nouveau les shimmer pendant le rechargement
        rootView?.let {
            showShimmer()
            loadData(it)
        }
    }

    /**
     * Récupère la position géographique de l'utilisateur et déclenche le chargement
     * des données pour les quatre sections principales.
     *
     * Si la permission n'est pas encore accordée, elle est demandée à l’utilisateur.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            /*val userGeoPoint = if (location != null) {
                // Sauvegarde la localisation obtenue
                MapsUtils.saveUserLocation(requireContext(), GeoPoint(location.latitude, location.longitude))
                GeoPoint(location.latitude, location.longitude)
            } else {
                // 🔄 Récupère la dernière position sauvegardée ou utilise une valeur par défaut
                val savedLocation = MapsUtils.loadUserLocation(requireContext())
                if (savedLocation.latitude != 0.0 || savedLocation.longitude != 0.0) {
                    savedLocation
                } else {
                    // Valeur par défaut (ex : Université de Lomé)
                    GeoPoint(6.1707, 1.2310)
                }
            }*/

            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)

            // Créer un compteur pour suivre les chargements terminés
            var loadedSections = 0
            val totalSections = 4 // 4 sections à charger

            val onDataLoadedCallback = {
                loadedSections++
                if (loadedSections >= totalSections) {
                    hideShimmer()
                }
            }

            // Modification pour notifier quand les données sont chargées
            HomeBatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsEns,
                batimentsEnsFilteredList,
                batimentsEnsAdapter,
                batsEnsHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }

            HomeBatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsAdmin,
                batimentsAdminFilteredList,
                batimentsAdminAdapter,
                batsAdminHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }

            HomeInfraUtils.updateInfrastructures(
                userGeoPoint,
                infras,
                infrasFilteredList,
                infrasAdapter,
                infrasHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }

            HomeSalleUtils.updateSalles(
                userGeoPoint,
                salles,
                sallesFilteredList,
                sallesAdapter,
                sallesHomeFragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Cache la barre de recherche si l’utilisateur quitte ce fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    override fun onResume() {
        super.onResume()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\SalleActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.Intent
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.os.Bundle
import android.view.View
import android.view.ViewGroup
import android.widget.FrameLayout
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import androidx.viewpager2.widget.ViewPager2
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import com.google.android.material.tabs.TabLayout
import com.google.android.material.tabs.TabLayoutMediator
import org.osmdroid.config.Configuration
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import tg.univlome.epl.R
import tg.univlome.epl.adapter.ImageAdapter
import tg.univlome.epl.databinding.ActivitySalleBinding
import tg.univlome.epl.models.Salle
import tg.univlome.epl.ui.maps.MapsActivity
import tg.univlome.epl.utils.MapsUtils

/**
 * Activité SalleActivity : Activité de détail d’une salle
 *
 * Description :
 * Cette activité permet d'afficher les informations complètes d'une salle universitaire :
 *  - Nom, situation géographique, description et distance par rapport à l’utilisateur
 *  - Images supplémentaires affichées dans un carrousel avec indicateurs personnalisés
 *  - Carte miniature (`miniMap`) indiquant la position de la salle et, si possible, celle de l’utilisateur
 *  - Un bouton "Aller" permettant d’ouvrir la carte principale (`MapsActivity`) avec l’itinéraire
 *
 * Elle utilise les bibliothèques `Glide` pour le chargement des images, `OSMDroid` pour la carte
 * et `FusedLocationProviderClient` pour la récupération de la position actuelle.
 *
 * Composants UI :
 *  - `ActivitySalleBinding` : ViewBinding pour accéder aux éléments d’interface
 *  - `ViewPager2` + `TabLayout` : affichage des images avec points personnalisés
 *  - `MapView` : carte statique pour visualisation de l’itinéraire
 *
 * Composants techniques :
 *  - `Glide` pour le chargement des images
 *  - `MapsUtils` pour configurer la carte miniature et enregistrer la destination
 *
 * Permissions requises :
 *  - `ACCESS_FINE_LOCATION` : localisation précise
 *  - `ACCESS_COARSE_LOCATION` : localisation approximative
 *
 * @see MapsUtils.setMiniMap pour l'affichage de la carte
 * @see MapsActivity pour la navigation détaillée
 * @see ImageAdapter pour le carrousel d’images
 */
class SalleActivity : AppCompatActivity() {

    lateinit var ui: ActivitySalleBinding
    private lateinit var miniMap: MapView
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Méthode principale appelée à la création de l'activité.
     * Initialise l’interface utilisateur, récupère les données de la salle,
     * configure les images, la carte miniature, les actions, et applique les autorisations.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        ui = ActivitySalleBinding.inflate(layoutInflater)
        setContentView(ui.root)

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)
        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        val salle = intent.getSerializableExtra("salle") as? Salle

        val images = salle?.images ?: emptyList()

        if (images.size <= 1) {
            ui.imageContainer.visibility = View.GONE
        } else {
            ui.imageContainer.visibility = View.VISIBLE
            val viewPager = ui.imagePager
            val tabLayout = ui.imageIndicator

            // Déplacer la première image à la fin de la liste
            val mainImage = salle?.image
            val reorderedImages = (images.filter { it != mainImage }) + mainImage

            viewPager.adapter = ImageAdapter(reorderedImages as List<String>)

            TabLayoutMediator(tabLayout, viewPager) { _, _ -> }.attach()

            for (i in 0 until tabLayout.tabCount) {
                val tabView = (tabLayout.getChildAt(0) as ViewGroup).getChildAt(i)
                val params = tabView.layoutParams as ViewGroup.MarginLayoutParams

                // Définition de la taille des points
                params.width = resources.getDimensionPixelSize(R.dimen.custom_dot_width)
                params.height = resources.getDimensionPixelSize(R.dimen.custom_dot_height)

                // Définition des marges entre les points
                params.setMargins(
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0,
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0
                )

                tabView.layoutParams = params
            }
        }

        if (salle != null) {
            ui.txtNomSalle.text = salle.nom
            ui.situationSalle.text = salle.situation
            ui.txtDistance.text = salle.distance
            ui.desc.text = salle.description
            if (!salle.image.isNullOrEmpty()) {
                Glide.with(this)
                    .asBitmap()
                    .load(salle.image)
                    .into(object : CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: Transition<in Bitmap>?
                        ) {
                            val drawable =
                                BitmapDrawable(resources, resource)
                            ui.imgSalle.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                ui.imgSalle.setImageResource(salle.icon)
            }
            if (!salle.latitude.isNullOrBlank() && !salle.longitude.isNullOrBlank()) {
                val latitude = salle.latitude.toDouble()
                val longitude = salle.longitude.toDouble()

                ui.aller.setOnClickListener {
                    MapsUtils.saveDestination(this, GeoPoint(latitude, longitude))
                    val intent = Intent(this, MapsActivity::class.java)
                    ui.aller.context.startActivity(intent)
                }

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    != PackageManager.PERMISSION_GRANTED
                ) {

                    requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
                    return
                }

                miniMap = ui.miniMap

                // Fallback si la localisation n'est pas disponible
                val destination = GeoPoint(latitude, longitude)
                var userLocation: GeoPoint? = null

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    == PackageManager.PERMISSION_GRANTED
                ) {

                    fusedLocationClient.lastLocation.addOnSuccessListener { location ->
                        location?.let {
                            userLocation = GeoPoint(it.latitude, it.longitude)
                            setupMiniMap(userLocation!!, destination)
                        } ?: run {
                            // Si la localisation n'est pas disponible, utiliser seulement la destination
                            setupMiniMap(destination, destination)
                        }
                    }.addOnFailureListener {
                        // En cas d'échec, utiliser seulement la destination
                        setupMiniMap(destination, destination)
                    }
                } else {
                    // Sans permission, utiliser seulement la destination
                    setupMiniMap(destination, destination)
                }
            } else {
                // Affiche un message ou fais une action par défaut
                ui.aller.visibility = View.GONE
                ui.miniMapLayout.visibility = View.GONE
            }

        }

        ui.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }
    }

    /**
     * Configure une carte miniature (`miniMap`) pour afficher la position de la salle
     * et celle de l’utilisateur, si disponible.
     *
     * @param start Point de départ (position de l’utilisateur)
     * @param end Point de destination (salle)
     *
     * @requiresPermission Manifest.permission.ACCESS_FINE_LOCATION
     * @requiresPermission Manifest.permission.ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun setupMiniMap(start: GeoPoint, end: GeoPoint) {
        // Postpone pour s'assurer que la vue est bien layoutée
        ui.miniMapLayout.visibility = View.VISIBLE
        ui.miniMap.post {
            MapsUtils.setMiniMap(miniMap, start, end, this, this, resources)
            // Forcer un recalcul des dimensions
            miniMap.invalidate()
            miniMap.requestLayout()
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllBatAdminFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment ViewAllBatAdminFragment : Affiche tous les bâtiments à usage administratif
 *
 * Description :
 * Ce fragment est destiné à afficher l’ensemble des bâtiments classés comme *administratifs*
 * sur le campus universitaire. Il exploite :
 *  - la localisation de l’utilisateur pour calculer les distances
 *  - une `RecyclerView` pour afficher la liste complète
 *  - une `SearchBar` intégrée pour filtrer dynamiquement par nom
 *
 * Les données sont récupérées depuis un service distant (`BatimentService`) et
 * traitées via l’objet `BatimentUtils`, qui applique les règles de filtrage selon le type
 * et la situation géographique définis dans le `FragmentModel`.
 *
 * Composants principaux :
 *  - `RecyclerView` : liste scrollable des bâtiments
 *  - `BatimentFragmentAdapter` : adaptateur d’affichage
 *  - `FusedLocationProviderClient` : pour la récupération de la position GPS de l'utilisateur
 *  - `FragmentModel` : encapsule le contexte et les métadonnées nécessaires à l’affichage
 *
 * Bibliothèques utilisées :
 *  - Google Location Services (FusedLocationProviderClient)
 *  - OSMDroid pour la gestion des coordonnées géographiques
 *
 * @see BatimentUtils pour le traitement logique et les calculs de distances
 * @see BatimentFragmentAdapter pour l’affichage des éléments dans la liste
 * @see FragmentModel pour les métadonnées du fragment
 */
class ViewAllBatAdminFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batimentsAdmin: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter

    private lateinit var batimentService: BatimentService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Crée et initialise la vue du fragment, configure la `RecyclerView`, instancie le modèle
     * et lance la récupération de la localisation de l'utilisateur.
     *
     * @return Vue complète initialisée
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_bat_admin, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batimentsAdmin = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batimentsAdmin)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllBatimentsAdmin
        )
        fragmentModel.type = "administratif"
        getUserLocation()

        return view
    }

    /**
     * Récupère la localisation actuelle de l'utilisateur (si permission accordée) et
     * déclenche la mise à jour de la liste des bâtiments administratifs via `BatimentUtils`.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            BatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsAdmin,
                filteredList,
                adapter,
                fragmentModel
            )
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des bâtiments administratifs en fonction du
     * nom saisi par l’utilisateur dans la barre de recherche.
     *
     * @param query Texte recherché
     */
    override fun onSearch(query: String) {
        filteredList =
            batimentsAdmin.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllBatEnsFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.BatimentUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment ViewAllBatEnsFragment : Affiche la liste complète des bâtiments d’enseignement
 *
 * Description :
 * Ce fragment permet la visualisation de tous les bâtiments liés à l’enseignement
 * sur le campus universitaire. Il récupère les données depuis `BatimentService` et
 * les affiche à l’aide d’un `RecyclerView` géré par `BatimentFragmentAdapter`.
 *
 * Il utilise la géolocalisation de l’utilisateur pour calculer la distance avec
 * chaque bâtiment via `MapsUtils`, et permet une recherche dynamique sur le nom
 * des bâtiments grâce à `SearchBarFragment`.
 *
 * Composants principaux :
 * - `RecyclerView` : affiche la liste complète des bâtiments d’enseignement
 * - `FusedLocationProviderClient` : pour localiser l’utilisateur
 * - `BatimentFragmentAdapter` : adaptateur d’affichage des bâtiments
 * - `FragmentModel` : modèle contenant les informations du fragment
 * - `SearchBarFragment` : barre de recherche dynamique
 *
 * Bibliothèques utilisées :
 * - Google Play Services pour la localisation
 * - OSMDroid pour les coordonnées
 *
 * @see BatimentUtils pour le traitement des données de bâtiment
 * @see MapsUtils pour le calcul des distances géographiques
 * @see SearchBarFragment pour la recherche utilisateur
 */
class ViewAllBatEnsFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var batimentsEns: MutableList<Batiment>
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter

    private lateinit var batimentService: BatimentService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Initialise la vue du fragment, configure la localisation, le modèle de fragment
     * et déclenche la récupération des données de bâtiments d’enseignement.
     *
     * @return Vue construite pour le fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_bat_ens, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        batimentService = BatimentService(requireContext())
        batimentsEns = mutableListOf()
        filteredList = mutableListOf()
        adapter = BatimentFragmentAdapter(batimentsEns)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllBatimentsEns
        )
        fragmentModel.type = "enseignement"
        getUserLocation()

        return view
    }

    /**
     * Récupère la localisation actuelle de l’utilisateur pour permettre
     * le calcul de la distance entre l’utilisateur et chaque bâtiment.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            BatimentUtils.updateBatiments(
                userGeoPoint,
                batimentsEns,
                filteredList,
                adapter,
                fragmentModel
            )
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des bâtiments affichés selon le texte
     * saisi par l’utilisateur dans la barre de recherche.
     *
     * @param query Texte recherché
     */
    override fun onSearch(query: String) {
        filteredList =
            batimentsEns.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment ViewAllInfraFragment : Affiche la liste complète des infrastructures
 *
 * Description :
 * Ce fragment permet d’afficher toutes les infrastructures présentes sur le campus
 * universitaire. Il récupère les données via `InfrastructureService` et utilise
 * `InfraFragmentAdapter` pour les présenter sous forme de liste.
 *
 * Il calcule dynamiquement la distance entre l’utilisateur et chaque infrastructure,
 * et permet la recherche en temps réel sur le nom des infrastructures.
 *
 * Composants principaux :
 * - RecyclerView : affichage de la liste des infrastructures
 * - FusedLocationProviderClient : localisation de l’utilisateur
 * - InfraFragmentAdapter : adaptateur des infrastructures
 * - FragmentModel : modèle de configuration du fragment
 * - SearchBarFragment : interface de recherche utilisateur
 *
 * Bibliothèques utilisées :
 * - Google Play Services : pour la géolocalisation
 * - OSMDroid : gestion des coordonnées géographiques
 *
 * @see InfraUtils pour les fonctions utilitaires liées aux infrastructures
 * @see SearchBarFragment pour la recherche interactive
 */
class ViewAllInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infras: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter

    private lateinit var infraService: InfrastructureService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Initialise la vue du fragment et configure les composants nécessaires,
     * y compris la localisation, l’adaptateur et le modèle de fragment.
     *
     * @return Vue racine du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_infra, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infras = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infras)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllInfraHome
        )
        getUserLocation()

        return view
    }

    /**
     * Récupère la position actuelle de l'utilisateur et met à jour la liste
     * des infrastructures avec la distance calculée.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infras,
                filteredList,
                adapter,
                fragmentModel
            )
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Met à jour dynamiquement la liste affichée en fonction du texte saisi.
     *
     * @param query Texte de recherche fourni par l'utilisateur
     */
    override fun onSearch(query: String) {
        filteredList = infras.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\home\ViewAllSalleFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.home

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.SalleViewAllAdapter
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.MapsUtils
import tg.univlome.epl.utils.SalleUtils

/**
 * Fragment ViewAllSalleFragment : Affiche la liste complète des salles
 *
 * Description :
 * Ce fragment permet d'afficher toutes les salles présentes sur le campus universitaire,
 * qu'elles soient d'enseignement, d'administration ou polyvalentes. Les données sont
 * récupérées depuis `SalleUtils`, enrichies par la distance depuis l'utilisateur, et
 * affichées grâce à un `SalleViewAllAdapter`.
 *
 * Il offre également une fonctionnalité de recherche en temps réel sur le nom des salles.
 *
 * Composants principaux :
 * - SalleUtils : utilitaire pour le chargement et la mise à jour des salles
 * - SalleViewAllAdapter : adaptateur pour l'affichage des salles dans une RecyclerView
 * - FragmentModel : modèle de configuration du fragment
 * - SearchBarFragment : barre de recherche dynamique
 *
 * Bibliothèques utilisées :
 * - Google Play Services : récupération de la position GPS
 * - OSMDroid : manipulation de coordonnées géographiques
 *
 * @see SalleUtils pour la gestion des données de salle
 * @see SearchBarFragment pour les fonctionnalités de recherche utilisateur
 */
class ViewAllSalleFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var salles: MutableList<Salle>
    private lateinit var filteredList: MutableList<Salle>
    private lateinit var adapter: SalleViewAllAdapter

    private lateinit var infraService: InfrastructureService

    private lateinit var fragmentModel: FragmentModel

    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Initialise la vue du fragment, configure les composants et déclenche
     * la récupération de la localisation de l’utilisateur.
     *
     * @return Vue racine du fragment
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_view_all_salle, container, false)

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        salles = mutableListOf()
        filteredList = mutableListOf()
        adapter = SalleViewAllAdapter(salles)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllSalle
        )
        getUserLocation()

        return view
    }

    /**
     * Récupère la position actuelle de l’utilisateur et met à jour la liste des salles
     * avec les distances correspondantes.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            SalleUtils.updateSalles(userGeoPoint, salles, filteredList, adapter, fragmentModel)
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre dynamiquement la liste des salles selon la recherche utilisateur.
     *
     * @param query Texte de recherche fourni par l'utilisateur
     */
    override fun onSearch(query: String) {
        filteredList = salles.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\AllInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment AllInfraFragment : Affiche toutes les infrastructures sans filtrage de situation
 *
 * Description :
 * Ce fragment est chargé d’afficher la liste complète des infrastructures disponibles
 * sur le campus universitaire, quelle que soit leur situation géographique (nord ou sud).
 * Il utilise les services de géolocalisation de l’utilisateur pour afficher la distance
 * entre lui et chaque infrastructure.
 *
 * Les données sont récupérées depuis un service distant via `InfrastructureService`,
 * affichées dans une `RecyclerView`, et mises en forme avec un `Shimmer` de chargement.
 * Un champ de recherche permet un filtrage dynamique par nom d’infrastructure.
 *
 * Composants principaux :
 *  - `ShimmerFrameLayout` : animation de chargement en attendant les données
 *  - `RecyclerView` : affichage de la liste des infrastructures
 *  - `FusedLocationProviderClient` : localisation utilisateur
 *  - `InfraUtils` : traitement des données, distances, filtrage
 *
 * Bibliothèques utilisées :
 *  - Facebook Shimmer pour les effets de chargement
 *  - OSMDroid pour la manipulation des coordonnées
 *  - Google Location Services pour la localisation utilisateur
 *
 * @see InfraUtils pour la mise à jour et la logique métier
 * @see InfraFragmentAdapter pour l’affichage des infrastructures
 * @see SearchBarFragment pour la fonctionnalité de recherche dynamique
 */
class AllInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infrasAll: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter
    private lateinit var infraService: InfrastructureService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerAllInfra: ShimmerFrameLayout
    private lateinit var recyclerAllInfra: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise la vue du fragment, configure les composants UI,
     * instancie les listes et adaptateurs, puis déclenche la géolocalisation.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_all_infra, container, false)

        shimmerAllInfra = view.findViewById(R.id.shimmerAllInfra)
        recyclerAllInfra = view.findViewById(R.id.recyclerAllInfra)
        shimmerAllInfra.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infrasAll = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infrasAll)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerAllInfra
        )
        getUserLocation()

        return view
    }

    /**
     * Récupère la position actuelle de l’utilisateur (avec permission),
     * puis appelle `InfraUtils.updateInfrastructures()` pour charger et filtrer les données.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerAllInfra.stopShimmer()
                shimmerAllInfra.visibility = View.GONE
                recyclerAllInfra.visibility = View.VISIBLE
            }

            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infrasAll,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Effectue une recherche en temps réel dans la liste des infrastructures
     * à partir du nom saisi par l’utilisateur.
     *
     * @param query Chaîne entrée par l’utilisateur dans la barre de recherche
     */
    override fun onSearch(query: String) {
        filteredList =
            infrasAll.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\InfraActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.Intent
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.Drawable
import android.os.Bundle
import android.view.View
import android.view.ViewGroup
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import com.bumptech.glide.Glide
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import com.google.android.material.tabs.TabLayoutMediator
import org.osmdroid.config.Configuration
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import tg.univlome.epl.R
import tg.univlome.epl.adapter.ImageAdapter
import tg.univlome.epl.databinding.ActivityInfraBinding
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.ui.maps.MapsActivity
import tg.univlome.epl.utils.MapsUtils

/**
 * Activité InfraActivity : Activité de visualisation d’une infrastructure
 *
 * Description :
 * Cette activité permet d’afficher les détails complets d’une infrastructure sélectionnée.
 * Elle fournit à l’utilisateur :
 *  - Une interface descriptive contenant le nom, la situation, la distance et la description
 *  - Un affichage d’images multiples dans un carrousel avec des points d’indicateur personnalisés
 *  - Une carte miniature (`miniMap`) représentant la position de l'infrastructure
 *  - Un bouton de navigation permettant de lancer l’itinéraire dans `MapsActivity`
 *
 * Cette activité exploite l’API de localisation (`FusedLocationProviderClient`) pour détecter
 * la position de l’utilisateur, et utilise la bibliothèque OSMDroid pour afficher une carte embarquée.
 *
 * Composants principaux :
 *  - `ImageAdapter` : pour l’affichage des images de l’infrastructure
 *  - `MapsUtils` : pour la configuration de la carte miniature
 *  - `MapsActivity` : pour la navigation complète entre utilisateur et destination
 *
 * Bibliothèques utilisées :
 *  - OSMDroid (cartographie)
 *  - Glide (chargement d’images)
 *  - Google Location Services (géolocalisation)
 *  - Material Components (UI : TabLayout)
 *
 * Permissions requises :
 *  - `ACCESS_FINE_LOCATION`
 *  - `ACCESS_COARSE_LOCATION`
 *
 * @see MapsUtils.setMiniMap pour l'affichage de la carte miniature
 * @see MapsActivity pour la carte principale avec itinéraire
 * @see ImageAdapter pour l’affichage dynamique des images
 */
class InfraActivity : AppCompatActivity() {

    lateinit var ui: ActivityInfraBinding
    private lateinit var miniMap: MapView
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    /**
     * Point d’entrée de l’activité. Récupère les données de l’infrastructure envoyées via l’intent,
     * initialise l’interface graphique, gère le carrousel d’images, la carte miniature
     * et le bouton de navigation.
     *
     * Si les données de géolocalisation sont disponibles et les permissions accordées,
     * une mini carte est affichée avec itinéraire. Sinon, seule la destination est affichée.
     */
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        ui = ActivityInfraBinding.inflate(layoutInflater)
        setContentView(ui.root)

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)
        window.navigationBarColor = ContextCompat.getColor(this, R.color.white)

        val infrastructure = intent.getSerializableExtra("infrastructure") as? Infrastructure

        // Mettre à jour l'interface utilisateur avec les données reçues

        val images = infrastructure?.images ?: emptyList()

        if (images.size <= 1) {
            ui.imageContainer.visibility = View.GONE
        } else {
            ui.imageContainer.visibility = View.VISIBLE
            val viewPager = ui.imagePager
            val tabLayout = ui.imageIndicator

            // Déplacer la première image à la fin de la liste
            val mainImage = infrastructure?.image
            val reorderedImages = (images.filter { it != mainImage }) + mainImage

            viewPager.adapter = ImageAdapter(reorderedImages as List<String>)

            TabLayoutMediator(tabLayout, viewPager) { _, _ -> }.attach()

            for (i in 0 until tabLayout.tabCount) {
                val tabView = (tabLayout.getChildAt(0) as ViewGroup).getChildAt(i)
                val params = tabView.layoutParams as ViewGroup.MarginLayoutParams

                // Définition de la taille des points
                params.width = resources.getDimensionPixelSize(R.dimen.custom_dot_width)
                params.height = resources.getDimensionPixelSize(R.dimen.custom_dot_height)

                // Définition des marges entre les points
                params.setMargins(
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0,
                    resources.getDimensionPixelSize(R.dimen.custom_dot_margin_horizontal),
                    0
                )

                tabView.layoutParams = params
            }
        }

        if (infrastructure != null) {
            ui.txtNomInfra.text = infrastructure.nom
            ui.situationInfra.text = infrastructure.situation
            ui.txtDistance.text = infrastructure.distance
            ui.desc.text = infrastructure.description
            if (!infrastructure.image.isNullOrEmpty()) {
                Glide.with(this)
                    .asBitmap()
                    .load(infrastructure.image)
                    .into(object : com.bumptech.glide.request.target.CustomTarget<Bitmap>() {
                        override fun onResourceReady(
                            resource: Bitmap,
                            transition: com.bumptech.glide.request.transition.Transition<in Bitmap>?
                        ) {
                            val drawable =
                                android.graphics.drawable.BitmapDrawable(resources, resource)
                            ui.imgInfra.setImageDrawable(drawable)
                        }

                        override fun onLoadCleared(placeholder: Drawable?) {}
                    })
            } else {
                ui.imgInfra.setImageResource(infrastructure.icon)
            }
            if (!infrastructure.latitude.isNullOrBlank() && !infrastructure.longitude.isNullOrBlank()) {
                val latitude = infrastructure.latitude.toDouble()
                val longitude = infrastructure.longitude.toDouble()

                ui.aller.setOnClickListener {
                    MapsUtils.saveDestination(this, GeoPoint(latitude, longitude))
                    val intent = Intent(this, MapsActivity::class.java)
                    ui.aller.context.startActivity(intent)
                }

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    != PackageManager.PERMISSION_GRANTED
                ) {

                    requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
                    return
                }

                miniMap = ui.miniMap

                // Fallback si la localisation n'est pas disponible
                val destination = GeoPoint(latitude, longitude)
                var userLocation: GeoPoint? = null

                if (ActivityCompat.checkSelfPermission(
                        this,
                        Manifest.permission.ACCESS_FINE_LOCATION
                    )
                    == PackageManager.PERMISSION_GRANTED
                ) {

                    fusedLocationClient.lastLocation.addOnSuccessListener { location ->
                        location?.let {
                            userLocation = GeoPoint(it.latitude, it.longitude)
                            setupMiniMap(userLocation!!, destination)
                        } ?: run {
                            // Si la localisation n'est pas disponible, utiliser seulement la destination
                            setupMiniMap(destination, destination)
                        }
                    }.addOnFailureListener {
                        // En cas d'échec, utiliser seulement la destination
                        setupMiniMap(destination, destination)
                    }
                } else {
                    // Sans permission, utiliser seulement la destination
                    setupMiniMap(destination, destination)
                }
            } else {
                // Affiche un message ou fais une action par défaut
                ui.aller.visibility = View.GONE
                ui.miniMapLayout.visibility = View.GONE
            }

        }

        ui.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }
    }

    /**
     * Configure la carte miniature (`miniMap`) en affichant l’itinéraire entre la position actuelle
     * de l’utilisateur et l’infrastructure.
     *
     * @param start Position de départ (utilisateur ou fallback)
     * @param end Position de destination (infrastructure)
     *
     * @requiresPermission Manifest.permission.ACCESS_FINE_LOCATION
     * @requiresPermission Manifest.permission.ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun setupMiniMap(start: GeoPoint, end: GeoPoint) {
        // Postpone pour s'assurer que la vue est bien layoutée
        ui.miniMapLayout.visibility = View.VISIBLE
        ui.miniMap.post {
            MapsUtils.setMiniMap(miniMap, start, end, this, this, resources)
            // Forcer un recalcul des dimensions
            miniMap.invalidate()
            miniMap.requestLayout()
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\InfraFragment.kt 
=============================================== 
package tg.univlome.epl.ui.infrastructure

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.AnimationUtils
import android.widget.LinearLayout
import androidx.appcompat.app.AppCompatActivity
import androidx.fragment.app.Fragment
import tg.univlome.epl.R

/**
 * Fragment InfraFragment : Fragment de navigation des infrastructures du campus
 *
 * Description :
 * Ce fragment permet à l’utilisateur de filtrer les infrastructures universitaires
 * selon leur position géographique :
 *  - Toutes les infrastructures
 *  - Infrastructures situées au Campus Nord
 *  - Infrastructures situées au Campus Sud
 *
 * Chaque filtre déclenche dynamiquement l’affichage d’un sous-fragment correspondant
 * (ex : `AllInfraFragment`, `NordInfraFragment`, `SudInfraFragment`) dans le conteneur central.
 * La navigation est enrichie par un indicateur visuel animé qui signale l’élément actif.
 *
 * Composants principaux :
 *  - `LinearLayout` pour les onglets de navigation (nav_all, nav_nord, nav_sud)
 *  - `View` servant d’indicateur actif pour chaque onglet
 *  - `Fragment` chargé dynamiquement dans `infra_container`
 *  - Animation `scale` appliquée à l’indicateur actif
 *
 * Bibliothèques utilisées :
 *  - AndroidX Fragment
 *  - Android AnimationUtils (animation personnalisée de l’indicateur)
 *
 * @see AllInfraFragment pour l’affichage global
 * @see NordInfraFragment pour les infrastructures du campus nord
 * @see SudInfraFragment pour les infrastructures du campus sud
 */
class InfraFragment : Fragment() {

    private var currentSelectedNav: View? = null
    private var currentIndicator: View? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée et retourne la vue racine du fragment à partir du fichier `fragment_infra.xml`.
     *
     * @return Vue contenant les boutons de navigation et le conteneur dynamique
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_infra, container, false)
    }

    /**
     * Initialise les éléments de navigation par défaut et configure les écouteurs
     * pour les sections "Tout", "Nord" et "Sud".
     */
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        // Par défaut, "Tout" est sélectionné
        val allNav = view.findViewById<LinearLayout>(R.id.nav_all)
        val allIndicator = view.findViewById<View>(R.id.indicator_all)
        currentSelectedNav = allNav
        currentIndicator = allIndicator
        loadFragment(AllInfraFragment())

        // Configurer les listeners pour chaque élément de navigation
        setupNavItem(view, R.id.nav_all, R.id.indicator_all) {
            loadFragment(AllInfraFragment())
        }

        setupNavItem(view, R.id.nav_nord, R.id.indicator_nord) {
            loadFragment(NordInfraFragment())
        }

        setupNavItem(view, R.id.nav_sud, R.id.indicator_sud) {
            loadFragment(SudInfraFragment())
        }
    }

    /**
     * Initialise un élément de navigation cliquable avec son indicateur et son action associée.
     *
     * @param view Vue racine du fragment
     * @param navItemId ID du bouton de navigation
     * @param indicatorId ID de l’indicateur visuel
     * @param action Action à exécuter lors du clic (chargement du fragment correspondant)
     */
    private fun setupNavItem(view: View, navItemId: Int, indicatorId: Int, action: () -> Unit) {
        val navItem = view.findViewById<LinearLayout>(navItemId)
        val indicator = view.findViewById<View>(indicatorId)

        navItem.setOnClickListener {
            // Si c'est déjà l'élément sélectionné, ne rien faire
            if (currentSelectedNav == navItem) return@setOnClickListener

            // Désélectionner l'élément précédent
            currentIndicator?.visibility = View.INVISIBLE

            // Sélectionner le nouvel élément
            indicator.visibility = View.VISIBLE
            animateIndicator(indicator)
            currentSelectedNav = navItem
            currentIndicator = indicator

            // Exécuter l'action associée à cet élément
            action()
        }
    }

    /**
     * Lance une animation de type "scale" sur l’indicateur sélectionné
     * pour améliorer la perception visuelle de la navigation.
     *
     * @param indicator Indicateur à animer
     */
    private fun animateIndicator(indicator: View) {
        // Charger l'animation
        val scaleAnimation = AnimationUtils.loadAnimation(context, R.anim.indicator_scale)

        // Appliquer l'animation à l'indicateur
        indicator.startAnimation(scaleAnimation)
    }

    /**
     * Remplace dynamiquement le contenu du conteneur `infra_container` par le fragment fourni.
     *
     * @param fragment Fragment à charger dynamiquement dans l’interface
     */
    private fun loadFragment(fragment: Fragment) {
        (requireActivity() as AppCompatActivity).supportFragmentManager.beginTransaction()
            .replace(R.id.infra_container, fragment)
            .commit()
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\NordInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment NordInfraFragment : Affiche les infrastructures situées au nord du campus
 *
 * Description :
 * Ce fragment permet d’afficher dynamiquement toutes les infrastructures localisées
 * sur le campus nord. Les données sont chargées à partir de `InfraUtils`, enrichies
 * avec la distance depuis la localisation actuelle de l’utilisateur et affichées
 * à l’aide d’un `InfraFragmentAdapter`.
 *
 * Il inclut également une barre de recherche permettant un filtrage en temps réel.
 * Un effet Shimmer est utilisé durant le chargement pour améliorer l’expérience utilisateur.
 *
 * Composants principaux :
 * - InfraUtils : utilitaire de chargement et filtrage des infrastructures
 * - InfraFragmentAdapter : adaptateur pour l’affichage dans la RecyclerView
 * - FragmentModel : modèle d’interaction entre la vue, le contexte et le cycle de vie
 *
 * Bibliothèques utilisées :
 * - Google Play Services : récupération de la géolocalisation
 * - OSMDroid : manipulation de coordonnées GPS
 * - Facebook Shimmer : effet de chargement visuel
 *
 * @see InfraUtils pour la logique métier et la mise à jour des données
 * @see SearchBarFragment pour la gestion de la recherche utilisateur
 */
class NordInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infrasNord: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter
    private lateinit var infraService: InfrastructureService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerNordInfra: ShimmerFrameLayout
    private lateinit var recyclerNordInfra: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Initialise et retourne la vue du fragment,
     * prépare les composants et déclenche la localisation utilisateur.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_nord_infra, container, false)

        shimmerNordInfra = view.findViewById(R.id.shimmerNordInfra)
        recyclerNordInfra = view.findViewById(R.id.recyclerNordInfra)
        shimmerNordInfra.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infrasNord = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infrasNord)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerNordInfra,
            "nord"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la géolocalisation de l’utilisateur et appelle
     * InfraUtils pour charger les infrastructures du campus nord.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerNordInfra.stopShimmer()
                shimmerNordInfra.visibility = View.GONE
                recyclerNordInfra.visibility = View.VISIBLE
            }

            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infrasNord,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Met à jour dynamiquement la liste affichée selon le texte saisi dans la barre de recherche.
     *
     * @param query Chaîne de caractères à rechercher dans les noms d'infrastructures
     */
    override fun onSearch(query: String) {
        filteredList =
            infrasNord.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\infrastructure\SudInfraFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.infrastructure

import android.Manifest
import android.content.pm.PackageManager
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.recyclerview.widget.RecyclerView
import com.facebook.shimmer.ShimmerFrameLayout
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.InfraUtils
import tg.univlome.epl.utils.MapsUtils

/**
 * Fragment SudInfraFragment : Affiche les infrastructures du campus sud
 *
 * Description :
 * Ce fragment permet de lister dynamiquement toutes les infrastructures situées sur
 * le **campus sud**. Il s’appuie sur les services de géolocalisation pour calculer
 * la distance entre l’utilisateur et chaque infrastructure, et affiche les résultats
 * dans une `RecyclerView` accompagnée d’un effet Shimmer pendant le chargement.
 *
 * Il intègre également une barre de recherche via `SearchBarFragment` pour permettre
 * un filtrage en temps réel.
 *
 * Composants principaux :
 * - `InfraUtils` : Fournit les méthodes de récupération, filtrage et mise à jour des données
 * - `InfraFragmentAdapter` : Adaptateur pour l’affichage des infrastructures
 * - `FragmentModel` : Modèle contenant le contexte, la vue, l’activité, etc.
 *
 * Bibliothèques utilisées :
 * - Google Play Services (`FusedLocationProviderClient`) : géolocalisation de l’utilisateur
 * - OSMDroid : manipulation des coordonnées géographiques
 * - Facebook Shimmer : effet de chargement visuel avant l’affichage des données
 *
 * @see InfraUtils pour le traitement des infrastructures
 * @see SearchBarFragment pour la gestion de la recherche dynamique
 */
class SudInfraFragment : Fragment(), SearchBarFragment.SearchListener {

    private lateinit var infrasSud: MutableList<Infrastructure>
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter
    private lateinit var infraService: InfrastructureService
    private lateinit var fragmentModel: FragmentModel
    private lateinit var fusedLocationClient: FusedLocationProviderClient
    private lateinit var shimmerSudInfra: ShimmerFrameLayout
    private lateinit var recyclerSudInfra: RecyclerView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    /**
     * Crée et retourne la vue du fragment.
     * Initialise les composants visuels et déclenche la récupération de la position utilisateur.
     *
     * @return Vue complète du fragment initialisé
     */
    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        val view = inflater.inflate(R.layout.fragment_sud_infra, container, false)

        shimmerSudInfra = view.findViewById(R.id.shimmerSudInfra)
        recyclerSudInfra = view.findViewById(R.id.recyclerSudInfra)
        shimmerSudInfra.startShimmer()

        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireActivity())

        infraService = InfrastructureService(requireContext())
        infrasSud = mutableListOf()
        filteredList = mutableListOf()
        adapter = InfraFragmentAdapter(infrasSud)

        fragmentModel = FragmentModel(
            view,
            requireContext(),
            requireActivity(),
            viewLifecycleOwner,
            R.id.recyclerSudInfra,
            "sud"
        )
        getUserLocation()
        return view
    }

    /**
     * Récupère la localisation de l'utilisateur.
     * Appelle `InfraUtils.updateInfrastructures` pour charger les données du campus sud.
     */
    private fun getUserLocation() {
        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            != PackageManager.PERMISSION_GRANTED
        ) {

            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
            return
        }

        fusedLocationClient.lastLocation.addOnSuccessListener { location ->
            //val userGeoPoint = MapsUtils.fusedLocationClient(location, requireContext())
            val contextSafe = context ?: return@addOnSuccessListener
            val userGeoPoint = MapsUtils.fusedLocationClient(location, contextSafe)
            val onDataLoadedCallback = {
                shimmerSudInfra.stopShimmer()
                shimmerSudInfra.visibility = View.GONE
                recyclerSudInfra.visibility = View.VISIBLE
            }

            InfraUtils.updateInfrastructures(
                userGeoPoint,
                infrasSud,
                filteredList,
                adapter,
                fragmentModel
            ) {
                onDataLoadedCallback()
            }
        }
    }

    /**
     * Affiche la barre de recherche intégrée lorsque ce fragment est actif.
     */
    override fun onResume() {
        super.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    /**
     * Cache la barre de recherche lorsque l’utilisateur quitte le fragment.
     */
    override fun onPause() {
        super.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    /**
     * Filtre les infrastructures affichées selon une recherche textuelle.
     *
     * @param query Texte à rechercher
     */
    override fun onSearch(query: String) {
        filteredList =
            infrasSud.filter { it.nom.contains(query, ignoreCase = true) }.toMutableList()
        adapter.updateList(filteredList)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\maps\MapsActivity.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.maps

import android.Manifest
import android.annotation.SuppressLint
import android.content.Context
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.location.Location
import android.location.LocationListener
import android.location.LocationManager
import android.os.Bundle
import android.os.Handler
import android.os.Looper
import android.util.Log
import android.view.View
import android.widget.Toast
import androidx.annotation.RequiresPermission
import androidx.appcompat.app.AppCompatActivity
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.config.Configuration
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Polyline
import org.osmdroid.views.overlay.ScaleBarOverlay
import org.osmdroid.views.overlay.compass.CompassOverlay
import org.osmdroid.views.overlay.mylocation.MyLocationNewOverlay
import tg.univlome.epl.R
import tg.univlome.epl.databinding.ActivityMapsBinding
import tg.univlome.epl.models.Lieu
import tg.univlome.epl.models.Salle
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.utils.MapsUtils
import java.io.IOException

class MapsActivity : AppCompatActivity(), LocationListener {

    private lateinit var binding: ActivityMapsBinding

    private lateinit var mapView: MapView
    private lateinit var locationOverlay: MyLocationNewOverlay
    private val client = OkHttpClient()

    private lateinit var batimentService: BatimentService
    private lateinit var infrastructureService: InfrastructureService
    private lateinit var salleService: SalleService

    private lateinit var locationManager: LocationManager
    private var currentPolyline: Polyline? = null
    private var lastLocation: Location? = null

    // Déclaration des variables globales
    private var userLocation: GeoPoint? = null
    private var destination: GeoPoint? = null

    private val markerList = mutableListOf<Marker>()
    private var currentUserMarker: Marker? = null
    private var currentDestinationMarker: Marker? = null
    private var preDestinationIcon: Drawable? = null
    private var isNightMode = false
    private var isOtherMarkersHidden = true
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMapsBinding.inflate(layoutInflater)
        setContentView(binding.root)

        loadMapData()
    }

    private fun loadMapData() {
        // Initialiser mapView en premier
        mapView = binding.mapView

        Configuration.getInstance().load(this, getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = packageName

        destination = MapsUtils.loadDestination(this)

        // Initialisation du service Firebase
        batimentService = BatimentService(this)
        infrastructureService = InfrastructureService(this)
        //salleService = SalleService()
        salleService = SalleService(this)

        //mapView = binding.mapView
        mapView.setTileSource(TileSourceFactory.MAPNIK)
        mapView.setMultiTouchControls(true)

        val prefs = getSharedPreferences("map_state", 0)
        val latitude = prefs.getString("latitude", "6.1375")!!.toDouble()
        val longitude = prefs.getString("longitude", "1.2123")!!.toDouble()
        val zoom = prefs.getFloat("zoom", 17.0f)
        isNightMode = prefs.getBoolean("isNightMode", false)

        val savedPoint = GeoPoint(latitude, longitude)
        mapView.controller.setZoom(zoom.toDouble())
        mapView.controller.setCenter(savedPoint)

        // Ajouter une boussole
        val compassOverlay = CompassOverlay(this, mapView)
        compassOverlay.enableCompass()
        mapView.overlays.add(compassOverlay)

        // Ajouter une barre d'échelle
        val scaleBarOverlay = ScaleBarOverlay(mapView)
        scaleBarOverlay.setScaleBarOffset(130, 20) // Ajuster la position sur l'écran
        mapView.overlays.add(scaleBarOverlay)

        // Charger les données depuis Firebase et les afficher sur la carte
        loadLieux()

        if (ActivityCompat.checkSelfPermission(
                this,
                Manifest.permission.ACCESS_FINE_LOCATION
            ) != PackageManager.PERMISSION_GRANTED
        ) {
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1)
        } else {
            binding.root.post {
                initLocationOverlay()
                initLocationTracking()
            }
        }

        binding.focusLocation.setOnClickListener {
            userLocation?.let {
                mapView.controller.animateTo(it)
            } ?: Toast.makeText(this, "Position actuelle inconnue", Toast.LENGTH_SHORT).show()
        }

        binding.focusDestination.setOnClickListener {
            if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                destination?.let {
                    mapView.controller.animateTo(it)
                } ?: Toast.makeText(this, "Destination inconnue", Toast.LENGTH_SHORT).show()
            } else {
                Toast.makeText(this, "Destination inconnue", Toast.LENGTH_SHORT).show()
            }
        }

        binding.themeIcon.setOnClickListener {
            isNightMode = !isNightMode
            mapView.setTileSource(
                if (isNightMode) TileSourceFactory.WIKIMEDIA else TileSourceFactory.MAPNIK
            )
            mapView.invalidate()
        }

        binding.hide.setOnClickListener {
            if (isOtherMarkersHidden) {
                reloadOtherMarker()
            } else {
                hideOtherMarkers()
            }
        }

        binding.recharger.setOnClickListener {
            reloadPreDestinationIcon()
            destination = null
            MapsUtils.clearDestination(this)
            currentPolyline?.let { mapView.overlays.remove(it) }
            currentPolyline = null
            mapView.controller.setCenter(userLocation ?: GeoPoint(6.1375, 1.2123))
            mapView.invalidate()
            loadLieux()
        }

        binding.btnRetour.setOnClickListener {
            onBackPressedDispatcher.onBackPressed()
        }

    }

    @SuppressLint("MissingPermission")
    private fun initLocationTracking() {
        locationManager = getSystemService(LocationManager::class.java)
        val isLocationEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)
        if (!isLocationEnabled) {
            Toast.makeText(this, "Veuillez activer la localisation", Toast.LENGTH_SHORT).show()
        } else {
            locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 3000, 10f, this)
        }
    }

    override fun onLocationChanged(location: Location) {
        runOnUiThread {
            try {
                userLocation = GeoPoint(location.latitude, location.longitude)
                addMarkerUserLocation()

                if (userLocation != null && (lastLocation == null || location.distanceTo(
                        lastLocation!!
                    ) > 3)
                ) {
                    lastLocation = location
                    if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                        if (markerList.isNotEmpty()) {
                            updateRoute(userLocation!!, destination!!)
                        }
                    }
                }
            } catch (e: Exception) {
                Log.e("MapsActivity", "Erreur dans onLocationChanged", e)
            }
        }
    }

    private fun loadLieux() {
        removeAllMarkers()

        // Charger les bâtiments
        batimentService.getBatiments().observe(this) { batiments ->
            if (batiments != null) {
                for (batiment in batiments) {
                    ajouterLieuSurCarte(batiment)
                }
            }
        }

        // Charger les infrastructures
        infrastructureService.getInfrastructures().observe(this) { infrastructures ->
            if (infrastructures != null) {
                for (infrastructure in infrastructures) {
                    ajouterLieuSurCarte(infrastructure)
                }
            }
        }

        // Charger les salles
        salleService.getSalles().observe(this) { salles ->
            if (salles != null) {
                for (salle in salles) {
                    ajouterLieuSurCarte(salle)
                }
            }
        }
    }

    private fun ajouterLieuSurCarte(lieu: Lieu) {
        if (lieu.latitude.isNotEmpty() && lieu.longitude.isNotEmpty()) {
            try {
                val lat = lieu.latitude.toDouble()
                val lon = lieu.longitude.toDouble()
                val position = GeoPoint(lat, lon)

                // Déterminer l'image à afficher selon le type de lieu
                val icon = when (lieu) {
                    is tg.univlome.epl.models.Batiment -> R.drawable.batiment_nav_icon
                    is tg.univlome.epl.models.Infrastructure -> R.drawable.infra_nav_icon
                    is Salle -> R.drawable.salle_nav_icon
                    else -> R.drawable.default_marker
                }

                //addMarker(position, lieu.nom, icon, lieu.image)
                // CACHER LES MARQUEURS A CE NIVEAU
                var marker = addMarker(position, lieu.nom, icon, lieu.image)
                if (marker!!.position != userLocation && marker!!.position != destination) {
                    mapView.overlays.remove(marker)
                }
            } catch (e: NumberFormatException) {
                Log.e("MapsActivity", "Coordonnées invalides pour ${lieu.nom}")
            }
        }
    }

    private fun initLocationOverlay() {
        binding.locationProgressBar.visibility = View.VISIBLE
        fusedLocationClient = LocationServices.getFusedLocationProviderClient(this)

        // Vérification de la permission
        if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION)
            == PackageManager.PERMISSION_GRANTED
        ) {

            // Essai rapide via FusedLocationProviderClient
            fusedLocationClient.lastLocation
                .addOnSuccessListener { location ->
                    if (location != null) {
                        val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                        userLocation = userGeoPoint

                        mapView.controller.setCenter(userLocation)
                        addMarkerUserLocation()

                        destination = MapsUtils.loadDestination(this)
                        if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                            updateRoute(userLocation!!, destination!!)
                        }

                        binding.locationProgressBar.visibility = View.GONE

                    } else {
                        // Fallback GPS si lastLocation est null
                        startGPSLocation()
                    }
                }
                .addOnFailureListener { e ->
                    Toast.makeText(this, "Erreur de localisation : ${e.message}", Toast.LENGTH_LONG)
                        .show()
                    binding.locationProgressBar.visibility = View.GONE
                }

        } else {
            // Demande de permission si elle n'est pas accordée
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
        }
    }

    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun startGPSLocation() {
        val locationManager = this.getSystemService(LOCATION_SERVICE) as LocationManager
        val provider = LocationManager.GPS_PROVIDER

        locationManager.requestSingleUpdate(provider, object : LocationListener {
            override fun onLocationChanged(location: Location) {
                val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                userLocation = userGeoPoint

                mapView.controller.setCenter(userLocation)
                addMarkerUserLocation()

                destination = MapsUtils.loadDestination(this@MapsActivity)
                if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                    updateRoute(userLocation!!, destination!!)
                }

                binding.locationProgressBar.visibility = View.GONE
            }

            @Deprecated("Deprecated in Java")
            override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) {
            }

            override fun onProviderEnabled(provider: String) {}
            override fun onProviderDisabled(provider: String) {}
        }, null)
    }

    private fun updateRoute(userLocation: GeoPoint, userDestination: GeoPoint) {
        addMarkerUserLocation(userLocation)

        if (userDestination == null || userDestination == GeoPoint(0.0, 0.0)) {
            Log.e("MapsActivity", "Destination is null or {0,0}, cannot update route")
            return
        }

        currentPolyline?.let { mapView.overlays.remove(it) }

        updateDestination(userDestination)
        getRoute(userLocation, userDestination)
    }

    private fun addMarker(
        position: GeoPoint,
        title: String,
        icon: Int = R.drawable.default_marker,
        imageUrl: String? = null
    ): Marker? {
        if (mapView == null) {
            Log.w(
                "MapsActivity",
                "mapView n'est pas encore initialisé. Nouvelle tentative dans 200 ms..."
            )
            Handler(Looper.getMainLooper()).postDelayed({
                addMarker(position, title, icon, imageUrl)
            }, 200)
            return null
        }

        var oldMarker: Marker? = null

        for (marker in markerList) {
            if (marker.position == position && marker.title == title) {
                oldMarker = marker
                mapView.overlays.remove(oldMarker)
            }
        }
        if (oldMarker != null) {
            markerList.remove(oldMarker)
        }

        if (mapView == null) {
            Log.e("MapsActivity", "MapView est nul. Impossible d'ajouter un marqueur.")
            return null
        }

        Log.d("MapsActivity", "Ajout du marqueur: $title à $position")
        val marker = Marker(mapView)
        marker.position = position
        marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
        marker.title = title

        if (!imageUrl.isNullOrEmpty()) {
            Glide.with(this)
                .asBitmap()
                .load(imageUrl)
                .into(object : CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: Transition<in Bitmap>?
                    ) {
                        val drawable = BitmapDrawable(resources, resource)
                        marker.image = drawable
                        mapView.invalidate()
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        }

        val resizedDrawable = MapsUtils.resizeIcon(icon, resources)
        marker.icon = resizedDrawable

        mapView.overlays.add(marker)
        mapView.invalidate()

        markerList.add(marker)
        return marker
    }

    private fun removeAllMarkers() {
        for (marker in markerList) {
            mapView.overlays.remove(marker)
        }
        markerList.clear()
        mapView.invalidate()
    }

    private fun hideOtherMarkers() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.remove(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = true
        binding.hide.setImageResource(R.drawable.no_hide)
    }

    private fun reloadOtherMarker() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.add(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = false
        binding.hide.setImageResource(R.drawable.hide)
    }

    private fun getRoute(start: GeoPoint, end: GeoPoint) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                Log.e(
                    "MapsActivity",
                    "Erreur lors de la récupération de l'itinéraire : ${e.message}"
                )
                runOnUiThread {
                    Toast.makeText(
                        this@MapsActivity,
                        "Impossible de récupérer l'itinéraire",
                        Toast.LENGTH_LONG
                    ).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                if (response.isSuccessful) {
                    response.body?.string()?.let { jsonString ->
                        try {
                            val jsonObject = JSONObject(jsonString)
                            val features = jsonObject.getJSONArray("features")
                            if (features.length() > 0) {
                                val geometry = features.getJSONObject(0).getJSONObject("geometry")
                                val coordinates = geometry.getJSONArray("coordinates")

                                val geoPoints = mutableListOf<GeoPoint>()
                                for (i in 0 until coordinates.length()) {
                                    val coord = coordinates.getJSONArray(i)
                                    val lon = coord.getDouble(0)
                                    val lat = coord.getDouble(1)
                                    geoPoints.add(GeoPoint(lat, lon))
                                }

                                runOnUiThread {
                                    currentPolyline = Polyline()
                                    currentPolyline!!.setPoints(geoPoints)
                                    currentPolyline!!.outlinePaint.color =
                                        resources.getColor(R.color.mainColor, null)
                                    currentPolyline!!.outlinePaint.strokeWidth = 5f

                                    mapView.overlays.add(currentPolyline)
                                    mapView.invalidate()
                                }
                            }
                        } catch (e: JSONException) {
                            Log.e("MapsActivity", "Erreur JSON: ${e.message}")
                        }
                    }
                } else {
                    Log.e("MapsActivity", "Erreur dans la réponse de l'API de routage")
                }
            }
        })
    }

    private fun addMarkerUserLocation(userLocation: GeoPoint? = this.userLocation) {
        if (mapView == null || userLocation == null) {
            Log.w("MapsActivity", "Conditions non remplies pour ajouter le marqueur de position")
            return
        }

        currentUserMarker?.let {
            mapView.overlays.remove(it)
            markerList.remove(it)
        }

        currentUserMarker =
            addMarker(userLocation, "Ma position actuelle", R.drawable.maps_and_flags)
    }

    private fun updateDestination(destination: GeoPoint) {
        var find = false
        reloadPreDestinationIcon()
        if (markerList.isNotEmpty()) {
            for (marker in markerList) {
                if (marker.position == destination) {
                    find = true
                    preDestinationIcon = marker.icon
                    marker.icon = MapsUtils.resizeIcon(R.drawable.destination, resources)
                    currentDestinationMarker = marker
                    mapView.invalidate()
                    break
                }
            }
        }
    }

    private fun reloadPreDestinationIcon() {
        currentDestinationMarker?.icon = preDestinationIcon
        mapView.invalidate()
    }

    override fun onResume() {
        super.onResume()
        mapView.onResume()
    }

    override fun onPause() {
        super.onPause()
        try {
            locationManager.removeUpdates(this)
        } catch (e: Exception) {
            Log.w("MapsActivity", "Erreur lors de l'arrêt des mises à jour de localisation", e)
        }

        val prefs = getSharedPreferences("map_state", 0)
        val editor = prefs.edit()

        val mapCenter = mapView.mapCenter as GeoPoint
        val zoomLevel = mapView.zoomLevelDouble

        editor.putString("latitude", mapCenter.latitude.toString())
        editor.putString("longitude", mapCenter.longitude.toString())
        editor.putFloat("zoom", zoomLevel.toFloat())
        editor.putBoolean("isNightMode", isNightMode)

        editor.apply()
        mapView.onPause()
    }

    override fun onDestroy() {
        super.onDestroy()
        removeAllMarkers()
    }

    override fun onRequestPermissionsResult(
        requestCode: Int,
        permissions: Array<out String>,
        grantResults: IntArray
    ) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults)
        if (requestCode == 1) {
            if (grantResults.isNotEmpty() && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                initLocationOverlay()
                initLocationTracking()
            } else {
                Toast.makeText(this, "Permission de localisation refusée.", Toast.LENGTH_LONG)
                    .show()
            }
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\maps\MapsFragment.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.maps

import android.Manifest
import android.annotation.SuppressLint
import android.content.Context
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.location.Location
import android.location.LocationListener
import android.location.LocationManager
import android.os.Bundle
import android.os.Handler
import android.os.Looper
import android.util.Log
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.view.animation.DecelerateInterpolator
import android.widget.Toast
import androidx.annotation.RequiresPermission
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import androidx.fragment.app.Fragment
import androidx.lifecycle.Observer
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import com.google.android.gms.location.FusedLocationProviderClient
import com.google.android.gms.location.LocationServices
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.config.Configuration
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Polyline
import org.osmdroid.views.overlay.ScaleBarOverlay
import org.osmdroid.views.overlay.compass.CompassOverlay
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.databinding.FragmentMapsBinding
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.Lieu
import tg.univlome.epl.models.Salle
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.SearchBarFragment
import tg.univlome.epl.utils.MapsUtils
import java.io.IOException

class MapsFragment : Fragment(), SearchBarFragment.SearchListener, LocationListener {
    private var _binding: FragmentMapsBinding? = null
    private val binding get() = _binding!!

    private lateinit var mapView: MapView
    private val client = OkHttpClient()

    private lateinit var batimentService: BatimentService
    private lateinit var infrastructureService: InfrastructureService
    private lateinit var salleService: SalleService

    private lateinit var locationManager: LocationManager
    private var currentPolyline: Polyline? = null
    private var lastLocation: Location? = null

    // Déclaration des variables globales
    private var userLocation: GeoPoint? = null
    private var destination: GeoPoint? = null

    private val markerList = mutableListOf<Marker>()
    private var currentUserMarker: Marker? = null
    private var currentDestinationMarker: Marker? = null
    private var preDestinationIcon: Drawable? = null
    private var isNightMode = false
    private var isOtherMarkersHidden = false
    private val tousLesLieux = mutableListOf<Lieu>()
    private lateinit var fusedLocationClient: FusedLocationProviderClient

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        _binding = FragmentMapsBinding.inflate(inflater, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        loadMapData(view)
    }

    private fun loadMapData(view: View) {
        // Initialiser mapView en premier
        mapView = binding.mapView

        Configuration.getInstance()
            .load(requireContext(), requireActivity().getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = requireActivity().packageName

        if (isAdded && isVisible && context != null && activity != null) { // Ajout de vérifs
            activity?.runOnUiThread {
                context?.let { ctx ->
                    destination = MapsUtils.loadDestination(requireContext())
                }
            }
        }

        // Initialisation du service Firebase
        batimentService = BatimentService(requireContext())
        infrastructureService = InfrastructureService(requireContext())
        salleService = SalleService(requireContext())

        mapView.setTileSource(TileSourceFactory.MAPNIK)
        mapView.setMultiTouchControls(true)

        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val latitude = prefs.getString("latitude", "6.1375")!!.toDouble()
        val longitude = prefs.getString("longitude", "1.2123")!!.toDouble()
        val zoom = prefs.getFloat("zoom", 17.0f)
        isNightMode = prefs.getBoolean("isNightMode", false)

        val savedPoint = GeoPoint(latitude, longitude)
        mapView.controller.setZoom(zoom.toDouble())
        mapView.controller.setCenter(savedPoint)

        // Ajouter une boussole
        val compassOverlay = CompassOverlay(requireActivity(), mapView)
        compassOverlay.enableCompass()
        mapView.overlays.add(compassOverlay)

        // Ajouter une barre d'échelle
        val scaleBarOverlay = ScaleBarOverlay(mapView)
        scaleBarOverlay.setScaleBarOffset(130, 20) // Ajuster la position sur l'écran
        mapView.overlays.add(scaleBarOverlay)

        // Charger les données depuis Firebase et les afficher sur la carte
        loadLieux()

        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            ) != PackageManager.PERMISSION_GRANTED
        ) {
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1)
        } else {
            view.post {
                initLocationOverlay()
                initLocationTracking()
            }
        }

        binding.focusLocation.setOnClickListener {
            userLocation?.let {
                mapView.controller.animateTo(it)
            } ?: Toast.makeText(requireContext(), "Position actuelle inconnue", Toast.LENGTH_SHORT)
                .show()
        }

        binding.focusDestination.setOnClickListener {
            if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                destination?.let {
                    mapView.controller.animateTo(it)
                } ?: Toast.makeText(requireContext(), "Destination inconnue", Toast.LENGTH_SHORT)
                    .show()
            } else {
                Toast.makeText(requireContext(), "Destination inconnue", Toast.LENGTH_SHORT).show()
            }
        }

        binding.themeIcon.setOnClickListener {
            isNightMode = !isNightMode
            mapView.setTileSource(
                if (isNightMode) TileSourceFactory.WIKIMEDIA else TileSourceFactory.MAPNIK
            )
            mapView.invalidate()
        }

        binding.hide.setOnClickListener {
            if (isOtherMarkersHidden) {
                reloadOtherMarker()
            } else {
                hideOtherMarkers()
            }
        }

        binding.recharger.setOnClickListener {
            reloadPreDestinationIcon()
            destination = null
            MapsUtils.clearDestination(requireContext())
            hideDestinationLayout()
            removeAllMarkers()
            reloadOtherMarker()
            currentPolyline?.let { mapView.overlays.remove(it) }
            currentPolyline = null
            mapView.controller.setCenter(userLocation ?: GeoPoint(6.1375, 1.2123))
            mapView.invalidate()
            binding.destinationText.text = ""
            loadLieux()
        }
    }

    @SuppressLint("MissingPermission")
    private fun initLocationTracking() {
        if (isAdded) {
            locationManager = requireActivity().getSystemService(LocationManager::class.java)
            val isLocationEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)
            if (!isLocationEnabled) {
                Toast.makeText(
                    requireContext(),
                    "Veuillez activer la localisation",
                    Toast.LENGTH_SHORT
                ).show()
            } else {
                locationManager.requestLocationUpdates(
                    LocationManager.GPS_PROVIDER,
                    3000,
                    10f,
                    this
                ) // Maj toutes les 3 sec, 10m de différence
            }
        }
    }

    override fun onLocationChanged(location: Location) {

        // Vérification si MapView est bien initialisé
        if (!isAdded || mapView == null) {
            Log.w("MapsFragment", "Fragment non attaché ou MapView null, ignore la mise à jour")
            return
        }

        activity?.runOnUiThread {
            try {
                userLocation = GeoPoint(location.latitude, location.longitude)
                addMarkerUserLocation()

                if (userLocation != null && (lastLocation == null || location.distanceTo(
                        lastLocation!!
                    ) > 3)
                ) {
                    lastLocation = location
                    if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                        if (markerList.isNotEmpty()) {
                            updateRoute(userLocation!!, destination!!)
                        }
                    }
                }
            } catch (e: Exception) {
                Log.e("MapsFragment", "Erreur dans onLocationChanged", e)
            }
        }
    }

    private fun loadLieux() {
        removeAllMarkers()
        tousLesLieux.clear()

        batimentService.getBatiments().observe(viewLifecycleOwner, Observer { batiments ->
            batiments?.let { tousLesLieux.addAll(it) }
            filtrerLieux("") // Affiche tout au départ
        })

        infrastructureService.getInfrastructures()
            .observe(viewLifecycleOwner, Observer { infrastructures ->
                infrastructures?.let { tousLesLieux.addAll(it) }
                filtrerLieux("")
            })

        salleService.getSalles().observe(viewLifecycleOwner, Observer { salles ->
            salles?.let { tousLesLieux.addAll(it) }
            filtrerLieux("")
        })
    }

    fun filtrerLieux(query: String) {
        removeAllMarkers()

        val recherche = query.lowercase().trim()

        val lieuxFiltres = if (recherche.isEmpty()) {
            tousLesLieux
        } else {
            tousLesLieux.filter { lieu ->
                lieu.nom.lowercase().contains(recherche)
            }
        }

        for (lieu in lieuxFiltres) {
            ajouterLieuSurCarte(lieu)
        }

        if (userLocation != null) {
            addMarkerUserLocation()
        }
    }

    // Nouvelle méthode pour ajouter un lieu sur la carte
    private fun ajouterLieuSurCarte(lieu: Lieu) {
        if (lieu.latitude.isNotEmpty() && lieu.longitude.isNotEmpty()) {
            try {
                val lat = lieu.latitude.toDouble()
                val lon = lieu.longitude.toDouble()
                val position = GeoPoint(lat, lon)

                // Déterminer l'image à afficher selon le type de lieu
                val icon = when (lieu) {
                    is Batiment -> R.drawable.batiment_nav_icon
                    is Infrastructure -> R.drawable.infra_nav_icon
                    is Salle -> R.drawable.salle_nav_icon
                    else -> R.drawable.default_marker
                }

                addMarker(position, lieu.nom, icon, lieu.image)  // Store the marker in the list
            } catch (e: NumberFormatException) {
                Log.e("MapsFragment", "Coordonnées invalides pour ${lieu.nom}")
            }
        }
    }

    private fun initLocationOverlay() {
        binding.locationProgressBar.visibility = View.VISIBLE
        fusedLocationClient = LocationServices.getFusedLocationProviderClient(requireContext())

        // Vérification de la permission
        if (ContextCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            )
            == PackageManager.PERMISSION_GRANTED
        ) {

            // Essai rapide via FusedLocationProviderClient
            fusedLocationClient.lastLocation
                .addOnSuccessListener { location ->
                    if (location != null) {
                        val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                        userLocation = userGeoPoint

                        mapView.controller.setCenter(userLocation)
                        addMarkerUserLocation()

                        destination = MapsUtils.loadDestination(requireContext())
                        if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                            updateRoute(userLocation!!, destination!!)
                        }

                        binding.locationProgressBar.visibility = View.GONE

                    } else {
                        // Fallback GPS si lastLocation est null
                        startGPSLocation()
                    }
                }
                .addOnFailureListener { e ->
                    Toast.makeText(
                        requireContext(),
                        "Erreur de localisation : ${e.message}",
                        Toast.LENGTH_LONG
                    ).show()
                    binding.locationProgressBar.visibility = View.GONE
                }

        } else {
            // Demande de permission si elle n'est pas accordée
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1001)
        }
    }

    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    private fun startGPSLocation() {
        val locationManager =
            requireActivity().getSystemService(Context.LOCATION_SERVICE) as LocationManager
        val provider = LocationManager.GPS_PROVIDER

        locationManager.requestSingleUpdate(provider, object : LocationListener {
            override fun onLocationChanged(location: Location) {
                val userGeoPoint = GeoPoint(location.latitude, location.longitude)
                userLocation = userGeoPoint

                mapView.controller.setCenter(userLocation)
                addMarkerUserLocation()

                destination = MapsUtils.loadDestination(requireContext())
                if (destination != null && destination != GeoPoint(0.0, 0.0)) {
                    updateRoute(userLocation!!, destination!!)
                }

                binding.locationProgressBar.visibility = View.GONE
            }

            @Deprecated("Deprecated in Java")
            override fun onStatusChanged(provider: String?, status: Int, extras: Bundle?) {
            }

            override fun onProviderEnabled(provider: String) {}
            override fun onProviderDisabled(provider: String) {}
        }, null)
    }

    private fun updateRoute(userLocation: GeoPoint, userDestination: GeoPoint) {

        addMarkerUserLocation(userLocation!!)

        if (userDestination == null || userDestination == GeoPoint(0.0, 0.0)) {
            Log.e("MapsFragment", "Destination is null or {0,0} , cannot update route")
            return
        }

        // Vérifier currentPolyline
        currentPolyline?.let { mapView.overlays.remove(it) }

        updateDestination(userDestination!!)
        // Récupérer le nouvel itinéraire
        getRoute(userLocation, userDestination)
    }

    private fun addMarker(
        position: GeoPoint,
        title: String,
        icon: Int = R.drawable.default_marker,
        imageUrl: String? = null
    ): Marker? {

        if (!isAdded || mapView == null) {
            Log.w(
                "MapsFragment",
                "Fragment non attaché ou MapView null, impossible d'ajouter le marqueur"
            )
            return null
        }

        if (mapView == null) {
            Log.w(
                "MapsFragment",
                "mapView n'est pas encore initialisé. Nouvelle tentative dans 200 ms..."
            )
            Handler(Looper.getMainLooper()).postDelayed({
                addMarker(position, title, icon, imageUrl)
            }, 200)
            return null
        }

        var oldMarker: Marker? = null

        for (marker in markerList) {
            if (marker.position == position && marker.title == title) {
                oldMarker = marker
                mapView.overlays.remove(oldMarker)
            }
        }
        if (oldMarker != null) {
            markerList.remove(oldMarker)
        }

        if (mapView == null) {
            Log.e("MapsFragment", "MapView est nul. Impossible d'ajouter un marqueur.")
            return null
        }
        Log.d("MapsFragment", "Ajout du marqueur: $title à $position")
        val marker = Marker(mapView)
        marker.position = position
        marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
        marker.title = title
        if (!imageUrl.isNullOrEmpty()) {
            Glide.with(this)
                .asBitmap()
                .load(imageUrl)
                .into(object : CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: Transition<in Bitmap>?
                    ) {
                        if (isAdded) {
                            val drawable = BitmapDrawable(resources, resource)
                            marker.image = drawable
                            mapView.invalidate() // Rafraîchir la carte après chargement
                        }
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        }

        val resizedDrawable = MapsUtils.resizeIcon(icon, resources)

        marker.icon = resizedDrawable
        marker.setOnMarkerClickListener { clickedMarker, _ ->
            if (clickedMarker.title != binding.destinationText.text && clickedMarker.position != userLocation && clickedMarker.position != destination) {
                binding.destinationText.text = clickedMarker.title
                //binding.destinationLayout.visibility = View.VISIBLE
                showDestinationLayout()
                clickedMarker.showInfoWindow()
                binding.valider.setOnClickListener {
                    destination = clickedMarker.position
                    MapsUtils.saveDestination(requireContext(), destination!!)
                    updateRoute(userLocation!!, destination!!)
                    hideOtherMarkers()
                }
                binding.annuler.setOnClickListener {
                    hideDestinationLayout()
                }
            } else {
                clickedMarker.showInfoWindow()
            }
            true
        }

        mapView.overlays.add(marker)
        mapView.invalidate()

        markerList.add(marker)
        return marker
    }

    fun showDestinationLayout() {
        if (binding.destinationLayout.visibility != View.VISIBLE) {
            binding.destinationLayout.apply {
                visibility = View.VISIBLE
                translationX = -width.toFloat()  // commence hors de l'écran à gauche
                animate()
                    .translationX(0f)  // revient à sa position normale
                    .setDuration(300)
                    .setInterpolator(DecelerateInterpolator())
                    .start()
            }
        }
    }

    fun hideDestinationLayout() {
        if (binding.destinationLayout.visibility != View.INVISIBLE) {
            binding.destinationLayout.apply {
                translationX = width.toFloat()
                animate()
                    .setDuration(300)
                    .setInterpolator(DecelerateInterpolator())
                    .start()
            }
            binding.destinationLayout.visibility = View.INVISIBLE
        }
    }

    private fun removeAllMarkers() {
        for (marker in markerList) {
            mapView.overlays.remove(marker)
        }
        markerList.clear()  // Optionally, clear the list after removal
        mapView.invalidate()  // Refresh the map
    }

    private fun hideOtherMarkers() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.remove(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = true
        binding.hide.setImageResource(R.drawable.no_hide)
    }

    private fun reloadOtherMarker() {
        for (marker in markerList) {
            if (marker.position != userLocation && marker.position != destination) {
                mapView.overlays.add(marker)
            }
        }
        mapView.invalidate()  // Refresh the map
        isOtherMarkersHidden = false
        binding.hide.setImageResource(R.drawable.hide)
    }

    private fun getRoute(start: GeoPoint, end: GeoPoint) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                Log.e(
                    "MapsFragment",
                    "Erreur lors de la récupération de l'itinéraire : ${e.message}"
                )
                requireActivity().runOnUiThread {
                    Toast.makeText(
                        requireContext(),
                        "Impossible de récupérer l'itinéraire",
                        Toast.LENGTH_LONG
                    ).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                if (response.isSuccessful) {
                    response.body?.string()?.let { jsonString ->
                        try {
                            val jsonObject = JSONObject(jsonString)
                            val features = jsonObject.getJSONArray("features")
                            if (features.length() > 0) {
                                val geometry = features.getJSONObject(0).getJSONObject("geometry")
                                val coordinates = geometry.getJSONArray("coordinates")

                                val geoPoints = mutableListOf<GeoPoint>()
                                for (i in 0 until coordinates.length()) {
                                    val coord = coordinates.getJSONArray(i)
                                    val lon = coord.getDouble(0)
                                    val lat = coord.getDouble(1)
                                    geoPoints.add(GeoPoint(lat, lon))
                                }

                                if (isAdded) {
                                    requireActivity().runOnUiThread {
                                        currentPolyline = Polyline()
                                        currentPolyline!!.setPoints(geoPoints)
                                        currentPolyline!!.outlinePaint.color =
                                            resources.getColor(R.color.mainColor, null)
                                        currentPolyline!!.outlinePaint.strokeWidth = 5f

                                        mapView.overlays.add(currentPolyline)
                                        mapView.invalidate()
                                    }
                                }
                            }
                        } catch (e: JSONException) {
                            Log.e("MapsFragment", "Erreur JSON: ${e.message}")
                        }
                    }
                } else {
                    Log.e("MapsFragment", "Erreur dans la réponse de l'API de routage")
                }
            }
        })
    }

    private fun addMarkerUserLocation(userLocation: GeoPoint? = this.userLocation) {
        if (!isAdded || mapView == null || userLocation == null) {
            Log.w("MapsFragment", "Conditions non remplies pour ajouter le marqueur de position")
            return
        }

        // Supprimer l'ancien marqueur s'il existe
        currentUserMarker?.let {
            mapView.overlays.remove(it)
            markerList.remove(it)
        }

        currentUserMarker =
            addMarker(userLocation!!, "Ma position actuelle", R.drawable.maps_and_flags)
    }

    private fun updateDestination(destination: GeoPoint) {
        var find = false
        reloadPreDestinationIcon()
        if (markerList.isNotEmpty()) {
            for (marker in markerList) {
                if (marker.position == destination) {
                    find = true
                    preDestinationIcon = marker.icon
                    marker.icon = MapsUtils.resizeIcon(R.drawable.destination, resources)
                    currentDestinationMarker = marker
                    mapView.invalidate()
                    break
                }
            }
        }
    }

    private fun reloadPreDestinationIcon() {
        currentDestinationMarker?.icon = preDestinationIcon
        mapView.invalidate()
    }


    override fun onResume() {
        super.onResume()
        mapView.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
        (activity as MainActivity).showLogo(null)
    }

    override fun onPause() {
        super.onPause()
        try {
            locationManager.removeUpdates(this)
        } catch (e: Exception) {
            Log.w("MapsFragment", "Erreur lors de l'arrêt des mises à jour de localisation", e)
        }

        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val editor = prefs.edit()

        val mapCenter = mapView.mapCenter as GeoPoint
        val zoomLevel = mapView.zoomLevelDouble

        editor.putString("latitude", mapCenter.latitude.toString())
        editor.putString("longitude", mapCenter.longitude.toString())
        editor.putFloat("zoom", zoomLevel.toFloat())
        editor.putBoolean("isNightMode", isNightMode)

        editor.apply()
        mapView.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    override fun onDestroyView() {
        super.onDestroyView()
        removeAllMarkers()  // Supprime tous les marqueurs
        _binding = null
    }

    override fun onSearch(query: String) {
        filtrerLieux(query)
    }

    @Deprecated("Deprecated in Java")
    override fun onRequestPermissionsResult(
        requestCode: Int,
        permissions: Array<out String>,
        grantResults: IntArray
    ) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults)
        if (requestCode == 1) {
            if (grantResults.isNotEmpty() && grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                initLocationOverlay()
                initLocationTracking()
            } else {
                Toast.makeText(
                    requireContext(),
                    "Permission de localisation refusée.",
                    Toast.LENGTH_LONG
                ).show()
            }
        }
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\ui\maps\MapsFragmentOld.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.ui.maps

import android.Manifest
import android.annotation.SuppressLint
import android.content.pm.PackageManager
import android.graphics.Bitmap
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.location.Location
import android.location.LocationListener
import android.location.LocationManager
import android.os.Bundle
import android.util.Log
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.Toast
import androidx.core.app.ActivityCompat
import androidx.fragment.app.Fragment
import androidx.lifecycle.Observer
import com.bumptech.glide.Glide
import com.bumptech.glide.request.target.CustomTarget
import com.bumptech.glide.request.transition.Transition
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.config.Configuration
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Polyline
import org.osmdroid.views.overlay.ScaleBarOverlay
import org.osmdroid.views.overlay.compass.CompassOverlay
import org.osmdroid.views.overlay.mylocation.MyLocationNewOverlay
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.databinding.FragmentMapsBinding
import tg.univlome.epl.models.Lieu
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.SearchBarFragment
import java.io.IOException

class MapsFragmentOld : Fragment(), SearchBarFragment.SearchListener, LocationListener {

    private var _binding: FragmentMapsBinding? = null
    private val binding get() = _binding!!

    private lateinit var mapView: MapView
    private lateinit var locationOverlay: MyLocationNewOverlay
    private val client = OkHttpClient()

    private lateinit var batimentService: BatimentService
    private lateinit var infrastructureService: InfrastructureService
    private lateinit var salleService: SalleService

    private lateinit var locationManager: LocationManager
    private var currentPolyline: Polyline? = null
    private var lastLocation: Location? = null

    // Déclaration des variables globales
    private var userLocation: GeoPoint? = null
    private var destination: GeoPoint? = null

    private val markerList = mutableListOf<Marker>()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
    }

    override fun onCreateView(
        inflater: LayoutInflater, container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View? {
        _binding = FragmentMapsBinding.inflate(inflater, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        Configuration.getInstance()
            .load(requireContext(), requireActivity().getSharedPreferences("osmdroid", 0))
        Configuration.getInstance().userAgentValue = requireActivity().packageName

        // Initialisation du service Firebase
        batimentService = BatimentService(requireContext())
        infrastructureService = InfrastructureService(requireContext())
        //salleService = SalleService()
        salleService = SalleService(requireContext())

        mapView = binding.mapView
        mapView.setTileSource(TileSourceFactory.MAPNIK)
        mapView.setMultiTouchControls(true)

        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val latitude = prefs.getString("latitude", "6.1375")!!.toDouble()
        val longitude = prefs.getString("longitude", "1.2123")!!.toDouble()
        val zoom = prefs.getFloat("zoom", 17.0f)

        val savedPoint = GeoPoint(latitude, longitude)
        mapView.controller.setZoom(zoom.toDouble())
        mapView.controller.setCenter(savedPoint)

        // Ajouter une boussole
        val compassOverlay = CompassOverlay(requireActivity(), mapView)
        compassOverlay.enableCompass()
        mapView.overlays.add(compassOverlay)

        // Ajouter une barre d'échelle
        val scaleBarOverlay = ScaleBarOverlay(mapView)
        scaleBarOverlay.setScaleBarOffset(130, 20) // Ajuster la position sur l'écran
        mapView.overlays.add(scaleBarOverlay)

        // Charger les données depuis Firebase et les afficher sur la carte
        loadLieux()

        if (ActivityCompat.checkSelfPermission(
                requireContext(),
                Manifest.permission.ACCESS_FINE_LOCATION
            ) != PackageManager.PERMISSION_GRANTED
        ) {
            requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), 1)
        } else {
            view.post {
                initLocationOverlay()
                initLocationTracking()
            }
        }


        arguments?.let {
            val lat = it.getDouble("latitude", 0.0)
            val lon = it.getDouble("longitude", 0.0)
            if (lat != 0.0 && lon != 0.0) {
                destination = GeoPoint(lat, lon)
                Log.e("MapsFragment", "Destination changée: $destination")
            }
        }

    }

    @SuppressLint("MissingPermission")
    private fun initLocationTracking() {
        if (isAdded) {
            locationManager = requireActivity().getSystemService(LocationManager::class.java)
            locationManager.requestLocationUpdates(
                LocationManager.GPS_PROVIDER,
                3000,
                10f,
                this
            ) // Maj toutes les 3 sec, 10m de différence
        }
    }

    override fun onLocationChanged(location: Location) {
        userLocation = GeoPoint(location.latitude, location.longitude)

        if (userLocation != null && (lastLocation == null || location.distanceTo(lastLocation!!) > 3)) {
            lastLocation = location
            updateRoute(userLocation!!, destination!!)
        }
    }

    private fun loadLieux() {

        // Charger les bâtiments
        batimentService.getBatiments().observe(viewLifecycleOwner, Observer { batiments ->
            if (batiments != null) {
                for (batiment in batiments) {
                    ajouterLieuSurCarte(batiment)
                }
            }
        })

        // Charger les infrastructures
        infrastructureService.getInfrastructures()
            .observe(viewLifecycleOwner, Observer { infrastructures ->
                if (infrastructures != null) {
                    for (infrastructure in infrastructures) {
                        ajouterLieuSurCarte(infrastructure)
                    }
                }
            })

        // Charger les salles
        salleService.getSalles().observe(viewLifecycleOwner, Observer { salles ->
            if (salles != null) {
                for (salle in salles) {
                    ajouterLieuSurCarte(salle)
                }
            }
        })
    }

    // Nouvelle méthode pour ajouter un lieu sur la carte
    private fun ajouterLieuSurCarte(lieu: Lieu) {
        if (lieu.latitude.isNotEmpty() && lieu.longitude.isNotEmpty()) {
            try {
                val lat = lieu.latitude.toDouble()
                val lon = lieu.longitude.toDouble()
                val position = GeoPoint(lat, lon)
                markerList.add(
                    addMarker(
                        position,
                        lieu.nom,
                        lieu.image
                    )
                )  // Store the marker in the list
            } catch (e: NumberFormatException) {
                Log.e("MapsFragment", "Coordonnées invalides pour ${lieu.nom}")
            }
        }
    }

    private fun initLocationOverlay() {
        locationOverlay = MyLocationNewOverlay(mapView)
        locationOverlay.enableMyLocation()
        locationOverlay.enableFollowLocation() // Pour suivre la position en temps réel
        mapView.overlays.add(locationOverlay)

        locationOverlay.runOnFirstFix {
            userLocation = locationOverlay.myLocation
            if (isAdded) {
                requireActivity().runOnUiThread {
                    if (userLocation != null) {
                        mapView.controller.setCenter(userLocation)

                        // Définition de la destination
                        if (destination == null) {
                            destination =
                                GeoPoint(userLocation!!.latitude + 0.009, userLocation!!.longitude)
                        } else {
                            updateRoute(userLocation!!, destination!!)
                        }

                        // getRoute(userLocation!!, destination!!)
                    } else {
                        Toast.makeText(
                            requireContext(),
                            "Localisation non trouvée !",
                            Toast.LENGTH_LONG
                        ).show()
                    }
                }
            }
        }
        mapView.overlays.add(locationOverlay)
    }

    private fun updateRoute(userLocation: GeoPoint, userDestination: GeoPoint) {

        addMarker(userLocation!!, "Ma position actuelle")
        addMarker(userDestination!!, "Ma destination")

        //val destination = GeoPoint(userLocation.latitude + 0.009, userLocation.longitude) // Ex. Destination fixe

        //if (destination == null) {
        if (userDestination == null) {
            Log.e("MapsFragment", "Destination is null, cannot update route")
            return
        }

        // Vérifier currentPolyline
        currentPolyline?.let { mapView.overlays.remove(it) }

        // Récupérer le nouvel itinéraire
        //getRoute(userLocation, destination!!)
        getRoute(userLocation, userDestination!!)
    }

    private fun addMarker(position: GeoPoint, title: String, imageUrl: String? = null): Marker {
        var oldMarker = Marker(mapView)
        for (marker in markerList) {
            if (marker.position == position && marker.title == title) {
                oldMarker = marker
                mapView.overlays.remove(oldMarker)
                //return marker
            }
        }
        markerList.remove(oldMarker)

        Log.d("MapsFragment", "Ajout du marqueur: $title à $position")
        val marker = Marker(mapView)
        marker.position = position
        marker.setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
        marker.title = title
        if (!imageUrl.isNullOrEmpty()) {
            Glide.with(this)
                .asBitmap()
                .load(imageUrl)
                .into(object : CustomTarget<Bitmap>() {
                    override fun onResourceReady(
                        resource: Bitmap,
                        transition: Transition<in Bitmap>?
                    ) {
                        val drawable = BitmapDrawable(resources, resource)
                        marker.image = drawable
                        mapView.invalidate() // Rafraîchir la carte après chargement
                    }

                    override fun onLoadCleared(placeholder: Drawable?) {}
                })
        }

        val drawable = resources.getDrawable(R.drawable.default_marker, null)
        val bitmap = (drawable as BitmapDrawable).bitmap

        // Redimensionner l'image
        val scaledBitmap =
            Bitmap.createScaledBitmap(bitmap, 40, 40, false) // Modifier la taille selon le besoin
        val resizedDrawable = BitmapDrawable(resources, scaledBitmap)

        marker.icon = resizedDrawable

        mapView.overlays.add(marker)
        mapView.invalidate()
        return marker
    }

    private fun removeAllMarkers() {
        for (marker in markerList) {
            mapView.overlays.remove(marker)
        }
        markerList.clear()  // Optionally, clear the list after removal
        mapView.invalidate()  // Refresh the map
    }

    private fun getRoute(start: GeoPoint, end: GeoPoint) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                requireActivity().runOnUiThread {
                    Toast.makeText(requireContext(), "Erreur réseau !", Toast.LENGTH_LONG).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                response.body?.string()?.let { jsonResponse ->
                    try {
                        val jsonObject = JSONObject(jsonResponse)
                        if (jsonObject.has("features")) {
                            val features = jsonObject.getJSONArray("features")
                            val geometry = features.getJSONObject(0).getJSONObject("geometry")
                            val coordinates = geometry.getJSONArray("coordinates")

                            val polyline = Polyline()
                            if (isAdded) {
                                //polyline.color = resources.getColor(android.R.color.holo_blue_dark, null)
                                polyline.color = resources.getColor(R.color.mainColor, null)
                            }

                            for (i in 0 until coordinates.length()) {
                                val coord = coordinates.getJSONArray(i)
                                val lon = coord.getDouble(0)
                                val lat = coord.getDouble(1)
                                polyline.addPoint(GeoPoint(lat, lon))
                            }

                            if (isAdded) {
                                requireActivity().runOnUiThread {
                                    currentPolyline?.let { mapView.overlays.remove(it) }
                                    currentPolyline = polyline
                                    mapView.overlays.add(polyline)
                                    mapView.invalidate()
                                }
                            }
                        } else {
                            Log.e("API_ERROR", "La clé 'features' est absente de la réponse JSON")
                        }
                    } catch (e: JSONException) {
                        Log.e("JSON_ERROR", "Erreur lors du parsing JSON: ${e.message}")
                    }
                } ?: Log.e("API_ERROR", "Réponse vide de l'API")
            }
        })
    }

    private fun filterMarkers(query: String?) {
        removeAllMarkers()

        if (query.isNullOrEmpty()) {
            loadLieux()
            return
        }

        val lowerCaseQuery = query.lowercase()

        batimentService.getBatiments().observe(viewLifecycleOwner, Observer { batiments ->
            if (batiments != null) {
                val batiments = batiments.filter { batiment ->
                    val name = batiment.nom?.lowercase() ?: ""
                    return@filter name.contains(lowerCaseQuery) || isSubsequence(
                        lowerCaseQuery,
                        name
                    )
                }
                for (batiment in batiments) {
                    ajouterLieuSurCarte(batiment)
                }
            }
        })

        infrastructureService.getInfrastructures()
            .observe(viewLifecycleOwner, Observer { infrastructures ->
                if (infrastructures != null) {
                    val infrastructures = infrastructures.filter { infrastructure ->
                        val name = infrastructure.nom?.lowercase() ?: ""
                        return@filter name.contains(lowerCaseQuery) || isSubsequence(
                            lowerCaseQuery,
                            name
                        )
                    }
                    for (infrastructure in infrastructures) {
                        ajouterLieuSurCarte(infrastructure)
                    }
                }
            })

        salleService.getSalles().observe(viewLifecycleOwner, Observer { salles ->
            if (salles != null) {
                val salles = salles.filter { salle ->
                    val name = salle.nom?.lowercase() ?: ""
                    return@filter name.contains(lowerCaseQuery) || isSubsequence(
                        lowerCaseQuery,
                        name
                    )
                }
                for (salle in salles) {
                    ajouterLieuSurCarte(salle)
                }
            }
        })

        removeAllMarkers()
        mapView.invalidate()
    }

    private fun isSubsequence(sub: String, word: String): Boolean {
        var i = 0
        var j = 0
        while (i < sub.length && j < word.length) {
            if (sub[i] == word[j]) i++
            j++
        }
        return i == sub.length
    }

    override fun onResume() {
        super.onResume()
        mapView.onResume()
        (activity as MainActivity).showSearchBarFragment(this)
    }

    override fun onPause() {
        super.onPause()
        val prefs = requireActivity().getSharedPreferences("map_state", 0)
        val editor = prefs.edit()

        val mapCenter = mapView.mapCenter as GeoPoint
        val zoomLevel = mapView.zoomLevelDouble

        editor.putString("latitude", mapCenter.latitude.toString())
        editor.putString("longitude", mapCenter.longitude.toString())
        editor.putFloat("zoom", zoomLevel.toFloat())

        editor.apply()
        mapView.onPause()
        (activity as MainActivity).showSearchBarFragment(null) // Cacher la barre si on quitte
    }

    override fun onDestroyView() {
        super.onDestroyView()
        _binding = null
    }

    override fun onSearch(query: String) {
        filterMarkers(query)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\BatimentUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.content.Context
import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.MainActivity
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentFragmentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet BatimentUtils : Fournit des fonctions utilitaires pour la gestion
 * des bâtiments sur le campus universitaire.
 *
 * Description :
 * Cet objet centralise les opérations relatives aux bâtiments :
 *  - Chargement dynamique des bâtiments à partir du service distant (Firestore)
 *  - Filtrage selon la situation géographique (sud, nord, etc.) ou le type (enseignement, administratif...)
 *  - Calcul de la distance entre l'utilisateur et chaque bâtiment
 *  - Ouverture d'une carte localisant un bâtiment spécifique
 *  - Sauvegarde et chargement local de la liste des bâtiments (JSON via SharedPreferences)
 *
 * Composants principaux :
 *  - BatimentService : service de récupération des données depuis Firestore
 *  - BatimentFragmentAdapter : adaptateur RecyclerView pour afficher les bâtiments
 *  - MapsFragment : fragment de carte pour localiser un bâtiment
 *  - FragmentModel : modèle encapsulant le contexte de fragment (UI + logique)
 *
 * Bibliothèques utilisées :
 *  - Gson pour la sérialisation JSON
 *  - OSMDroid pour la manipulation de coordonnées géographiques
 *
 * @see BatimentService pour la gestion distante des bâtiments
 * @see MapsFragment pour la carte centrée sur un bâtiment
 */
object BatimentUtils {

    private lateinit var batimentService: BatimentService
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var batiments: MutableList<Batiment>
    private lateinit var adapter: BatimentFragmentAdapter

    /**
     * Ouvre un fragment de carte (MapsFragment) centré sur la position du bâtiment donné.
     *
     * @param batiment Bâtiment à localiser sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(batiment: Batiment, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", batiment.latitude.toDouble())
        bundle.putDouble("longitude", batiment.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Ouvre le fragment de carte depuis une activité en sauvegardant la destination.
     *
     * @param batiment Bâtiment cible à localiser.
     * @param activity Activité actuelle (doit hériter de MainActivity).
     * @param fragmentContext Contexte utilisé pour accéder aux préférences partagées.
     */
    fun ouvrirMapsFragment(
        batiment: Batiment,
        activity: FragmentActivity,
        fragmentContext: Context
    ) {
        MapsUtils.saveDestination(
            fragmentContext,
            GeoPoint(batiment.latitude.toDouble(), batiment.longitude.toDouble())
        )
        (activity as? MainActivity)?.loadMapsFragment()
    }

    /**
     * Met à jour dynamiquement la liste des bâtiments avec la distance depuis l’utilisateur,
     * applique des filtres par type ou situation (sud, nord, etc.), et recharge la RecyclerView.
     *
     * @param userLocation Position géographique actuelle de l'utilisateur.
     * @param batiments Liste cible à remplir avec les bâtiments chargés.
     * @param filteredList Liste utilisée pour stocker les bâtiments filtrés.
     * @param adapter Adaptateur lié à la RecyclerView pour l'affichage.
     * @param fragmentModel Modèle contenant la vue, le contexte et les métadonnées du fragment.
     * @param onDataLoaded Callback optionnel à exécuter après chargement.
     */
    fun updateBatiments(
        userLocation: GeoPoint,
        batiments: MutableList<Batiment>,
        filteredList: MutableList<Batiment>,
        adapter: BatimentFragmentAdapter,
        fragmentModel: FragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        batimentService = BatimentService(fragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.batiments = batiments
        this.adapter = adapter

        Log.d("BatimentUtils", "updateBatiments appelée avec : $userLocation")
        // Charger les bâtiments
        batimentService.getBatiments().observe(fragmentModel.viewLifecycleOwner, Observer { bats ->
            if (bats != null) {
                for (batiment in bats) {
                    try {
                        val batimentLocation =
                            GeoPoint(batiment.latitude.toDouble(), batiment.longitude.toDouble())
                        val distance = MapsUtils.calculateDistance(userLocation, batimentLocation)
                        Log.d(
                            "BatimentUtils",
                            "Distance calculée pour ${batiment.nom}: $distance mètres"
                        )

                        // Conversion en km si la distance dépasse 1000 m
                        val formattedDistance = if (distance >= 1000) {
                            String.format("%.2f km", distance / 1000)
                        } else {
                            String.format("%.2f m", distance)
                        }

                        batiment.distance = formattedDistance

                        Log.d(
                            "BatimentUtils",
                            "Distance mise à jour pour ${batiment.nom}: ${batiment.distance}"
                        )

                    } catch (e: Exception) {
                        Log.e(
                            "BatimentUtils",
                            "Erreur lors de la mise à jour de la distance pour ${batiment.nom}",
                            e
                        )
                    }
                    when (fragmentModel.situation) {
                        "" -> {
                            if (fragmentModel.type != "" && batiment.type.lowercase() == fragmentModel.type.lowercase()) {
                                batiments.add(batiment)
                            } else if (fragmentModel.type == "") {
                                batiments.add(batiment)
                            }
                        }

                        "sud" -> {
                            if (batiment.situation == "Campus sud") {
                                batiments.add(batiment)
                            }
                        }

                        "nord" -> {
                            if (batiment.situation == "Campus nord") {
                                batiments.add(batiment)
                            }
                        }
                    }
                }
            }
            this.filteredList = batiments.toMutableList()

            this.adapter = BatimentFragmentAdapter(batiments)

            val recyclerBatiments =
                fragmentModel.view?.findViewById<RecyclerView>(fragmentModel.recyclerViewId)
            recyclerBatiments?.layoutManager =
                LinearLayoutManager(
                    fragmentModel.fragmentContext,
                    LinearLayoutManager.VERTICAL,
                    false
                )
            recyclerBatiments?.adapter = adapter
        })
        onDataLoaded()
    }

    /**
     * Sauvegarde la liste des bâtiments localement dans les préférences partagées (JSON).
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @param batiments Liste des bâtiments à sauvegarder.
     */
    fun saveBatiments(context: Context, batiments: MutableList<Batiment>) {
        val sharedPreferences = context.getSharedPreferences("BatimentsPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(batiments)
        editor.putString("batiment", json)
        editor.apply()
    }

    /**
     * Charge les bâtiments précédemment sauvegardés depuis les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @return Liste des bâtiments sauvegardés ou null si aucune donnée.
     */
    fun loadBatiments(context: Context): MutableList<Batiment>? {
        val sharedPreferences = context.getSharedPreferences("BatimentsPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("batiment", null)
        val type = object : TypeToken<MutableList<Batiment>>() {}.type
        return gson.fromJson(json, type)
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\HomeBatimentUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.BatimentAdapter
import tg.univlome.epl.models.Batiment
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.services.BatimentService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet HomeBatimentUtils : Fournit des fonctions utilitaires spécifiques à l'affichage
 * des bâtiments sur l'écran d'accueil de l'application.
 *
 * Description :
 * Cet objet permet de :
 *  - Charger dynamiquement la liste des bâtiments filtrés par type (enseignement, administratif, etc.)
 *  - Calculer et afficher la distance entre chaque bâtiment et l'utilisateur
 *  - Afficher les bâtiments sous forme de liste horizontale dans un `RecyclerView`
 *  - Ouvrir une carte localisant un bâtiment sélectionné
 *
 * Il est utilisé principalement par le `HomeFragment` via un modèle `HomeFragmentModel` qui encapsule
 * le contexte et les vues nécessaires.
 *
 * Composants principaux :
 *  - BatimentService : service de récupération des données Firestore
 *  - BatimentAdapter : adaptateur RecyclerView pour afficher les bâtiments sur l’écran d’accueil
 *  - MapsFragment : fragment de carte pour visualiser la localisation d’un bâtiment
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour la manipulation de géopoints
 *  - Gson (via MapsUtils si extension)
 *  - AndroidX Fragment/RecyclerView
 *
 * @see BatimentService pour l'accès aux données des bâtiments
 * @see MapsFragment pour la localisation sur carte
 */
object HomeBatimentUtils {

    private lateinit var batimentService: BatimentService
    private lateinit var filteredList: MutableList<Batiment>
    private lateinit var batiments: MutableList<Batiment>
    private lateinit var adapter: BatimentAdapter

    /**
     * Ouvre un `MapsFragment` centré sur la position du bâtiment sélectionné.
     *
     * @param batiment Bâtiment à localiser sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(batiment: Batiment, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", batiment.latitude.toDouble())
        bundle.putDouble("longitude", batiment.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour la liste des bâtiments affichés sur l'écran d'accueil :
     *  - Applique un filtre par type (défini dans `HomeFragmentModel`)
     *  - Calcule la distance entre chaque bâtiment et l'utilisateur
     *  - Met à jour le `RecyclerView` horizontal avec l'adaptateur
     *
     * @param userLocation Position géographique actuelle de l'utilisateur.
     * @param batiments Liste cible contenant les bâtiments chargés.
     * @param filteredList Liste filtrée utilisée pour l'affichage.
     * @param adapter Adaptateur initial (sera remplacé).
     * @param homeFragmentModel Modèle encapsulant le contexte et les vues de HomeFragment.
     * @param onDataLoaded Callback optionnel exécuté après le chargement.
     */
    fun updateBatiments(
        userLocation: GeoPoint,
        batiments: MutableList<Batiment>,
        filteredList: MutableList<Batiment>,
        adapter: BatimentAdapter,
        homeFragmentModel: HomeFragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        batimentService = BatimentService(homeFragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.batiments = batiments
        this.adapter = adapter

        Log.d("HomeBatimentUtils", "updateBatiments appelée avec : $userLocation")
        // Charger les bâtiments
        batimentService.getBatiments()
            .observe(homeFragmentModel.viewLifecycleOwner, Observer { bats ->
                if (bats != null) {
                    for (batiment in bats) {
                        if (batiment.type.lowercase() == homeFragmentModel.type.lowercase()) {
                            try {
                                val batimentLocation = GeoPoint(
                                    batiment.latitude.toDouble(),
                                    batiment.longitude.toDouble()
                                )
                                val distance =
                                    MapsUtils.calculateDistance(userLocation, batimentLocation)
                                Log.d(
                                    "HomeBatimentUtils",
                                    "Distance calculée pour ${batiment.nom}: $distance mètres"
                                )

                                // Conversion en km si la distance dépasse 1000 m
                                val formattedDistance = if (distance >= 1000) {
                                    String.format("%.2f km", distance / 1000)
                                } else {
                                    String.format("%.2f m", distance)
                                }

                                batiment.distance = formattedDistance

                                Log.d(
                                    "HomeBatimentUtils",
                                    "Distance mise à jour pour ${batiment.nom}: ${batiment.distance}"
                                )

                            } catch (e: Exception) {
                                Log.e(
                                    "HomeBatimentUtils",
                                    "Erreur lors de la mise à jour de la distance pour ${batiment.nom}",
                                    e
                                )
                            }
                            batiments.add(batiment)
                        }
                    }
                }
                this.filteredList = batiments.toMutableList()

                this.adapter = BatimentAdapter(
                    batiments,
                    homeFragmentModel.fragmentManager,
                    homeFragmentModel.newFragment
                )

                val recyclerBatiments =
                    homeFragmentModel.view?.findViewById<RecyclerView>(homeFragmentModel.recyclerViewId)
                recyclerBatiments?.layoutManager =
                    LinearLayoutManager(
                        homeFragmentModel.fragmentContext,
                        LinearLayoutManager.HORIZONTAL,
                        false
                    )
                recyclerBatiments?.adapter = adapter
            })
        onDataLoaded()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\HomeInfraUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet HomeInfraUtils : Fournit des utilitaires pour la gestion des infrastructures
 * sur l’écran d’accueil de l’application.
 *
 * Description :
 * Cet objet permet d'afficher dynamiquement les infrastructures filtrées par type
 * ou situation géographique dans un `RecyclerView` horizontal sur la page d'accueil.
 * Il calcule également la distance entre l'utilisateur et chaque infrastructure,
 * et permet d'ouvrir une carte localisant l'infrastructure sélectionnée.
 *
 * Composants principaux :
 *  - InfrastructureService : service de récupération des infrastructures depuis Firestore
 *  - InfraAdapter : adaptateur pour afficher les infrastructures horizontalement
 *  - MapsFragment : fragment de carte centré sur une infrastructure
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour les coordonnées géographiques
 *  - AndroidX RecyclerView et Fragment
 *
 * @see InfrastructureService pour la gestion des données
 * @see MapsFragment pour l'affichage de la carte
 */
object HomeInfraUtils {

    private lateinit var infrastructureService: InfrastructureService
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var infrastructures: MutableList<Infrastructure>
    private lateinit var adapter: InfraAdapter

    /**
     * Ouvre un fragment de carte centré sur la position de l’infrastructure sélectionnée.
     *
     * @param infrastructure Infrastructure à afficher sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(infrastructure: Infrastructure, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", infrastructure.latitude.toDouble())
        bundle.putDouble("longitude", infrastructure.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour dynamiquement la liste des infrastructures à afficher sur l’écran d’accueil :
     *  - Récupère les données depuis Firestore
     *  - Calcule la distance entre l’utilisateur et chaque infrastructure
     *  - Met à jour la RecyclerView avec les éléments chargés
     *
     * @param userLocation Position géographique actuelle de l'utilisateur.
     * @param infrastructures Liste à remplir avec les infrastructures récupérées.
     * @param filteredList Liste utilisée pour l’affichage après filtrage.
     * @param adapter Adaptateur pour la RecyclerView (sera remplacé après chargement).
     * @param homeFragmentModel Modèle contenant le contexte et les vues du fragment appelant.
     * @param onDataLoaded Callback optionnel exécuté après chargement.
     */
    fun updateInfrastructures(
        userLocation: GeoPoint,
        infrastructures: MutableList<Infrastructure>,
        filteredList: MutableList<Infrastructure>,
        adapter: InfraAdapter,
        homeFragmentModel: HomeFragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        infrastructureService = InfrastructureService(homeFragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.infrastructures = infrastructures
        this.adapter = adapter

        Log.d("HomeInfraUtils", "updateInfrastructures appelée avec : $userLocation")
        // Charger les bâtiments
        infrastructureService.getInfrastructures()
            .observe(homeFragmentModel.viewLifecycleOwner, Observer { infras ->
                if (infras != null) {
                    for (infrastructure in infras) {
                        try {
                            val infrastructureLocation = GeoPoint(
                                infrastructure.latitude.toDouble(),
                                infrastructure.longitude.toDouble()
                            )
                            val distance =
                                MapsUtils.calculateDistance(userLocation, infrastructureLocation)
                            Log.d(
                                "HomeInfraUtils",
                                "Distance calculée pour ${infrastructure.nom}: $distance mètres"
                            )

                            // Conversion en km si la distance dépasse 1000 m
                            val formattedDistance = if (distance >= 1000) {
                                String.format("%.2f km", distance / 1000)
                            } else {
                                String.format("%.2f m", distance)
                            }

                            infrastructure.distance = formattedDistance

                            Log.d(
                                "HomeInfraUtils",
                                "Distance mise à jour pour ${infrastructure.nom}: ${infrastructure.distance}"
                            )

                        } catch (e: Exception) {
                            Log.e(
                                "HomeInfraUtils",
                                "Erreur lors de la mise à jour de la distance pour ${infrastructure.nom}",
                                e
                            )
                        }
                        infrastructures.add(infrastructure)
                    }
                }
                // Mise à jour de l’affichage
                this.filteredList = infrastructures.toMutableList()

                this.adapter = InfraAdapter(
                    infrastructures,
                    homeFragmentModel.fragmentManager,
                    homeFragmentModel.newFragment
                )

                val recyclerBatiments =
                    homeFragmentModel.view?.findViewById<RecyclerView>(homeFragmentModel.recyclerViewId)
                recyclerBatiments?.layoutManager =
                    LinearLayoutManager(
                        homeFragmentModel.fragmentContext,
                        LinearLayoutManager.HORIZONTAL,
                        false
                    )
                recyclerBatiments?.adapter = adapter
            })
        onDataLoaded()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\HomeSalleUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.SalleAdapter
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.HomeFragmentModel
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet HomeSalleUtils : Fournit des utilitaires pour la gestion et l’affichage
 * des salles sur l’écran d’accueil de l’application.
 *
 * Description :
 * Cet objet permet d’afficher dynamiquement les salles dans un `RecyclerView` horizontal,
 * en calculant la distance entre chaque salle et la position actuelle de l’utilisateur.
 * Il offre également la possibilité d’ouvrir une carte localisant une salle sélectionnée.
 *
 * Composants principaux :
 *  - SalleService : service de récupération des données des salles via Firestore
 *  - SalleAdapter : adaptateur utilisé pour afficher les salles dans un `RecyclerView`
 *  - MapsFragment : fragment de carte centré sur une salle
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour la manipulation géographique
 *  - AndroidX Lifecycle, RecyclerView, Fragment
 *
 * @see SalleService pour la gestion des données Firestore
 * @see MapsFragment pour la localisation sur carte
 */
object HomeSalleUtils {

    private lateinit var salleService: SalleService
    private lateinit var filteredList: MutableList<Salle>
    private lateinit var salles: MutableList<Salle>
    private lateinit var adapter: SalleAdapter

    /**
     * Ouvre un fragment de carte (`MapsFragment`) centré sur la position
     * d’une salle donnée.
     *
     * @param salle Salle à localiser sur la carte.
     * @param fragmentActivity Activité hôte dans laquelle afficher le fragment.
     */
    fun ouvrirMapsFragment(salle: Salle, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", salle.latitude.toDouble())
        bundle.putDouble("longitude", salle.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour la liste des salles affichées sur l’écran d’accueil :
     *  - Charge les données depuis Firestore via `SalleService`
     *  - Calcule la distance entre l'utilisateur et chaque salle
     *  - Met à jour dynamiquement l'adaptateur et le `RecyclerView`
     *
     * @param userLocation Position actuelle de l'utilisateur.
     * @param salles Liste à remplir avec les salles récupérées.
     * @param filteredList Liste utilisée pour l’affichage après filtrage.
     * @param adapter Adaptateur RecyclerView (sera remplacé).
     * @param homeFragmentModel Modèle contenant les informations de vue et de contexte.
     * @param onDataLoaded Callback exécuté après chargement des données (optionnel).
     */
    fun updateSalles(
        userLocation: GeoPoint,
        salles: MutableList<Salle>,
        filteredList: MutableList<Salle>,
        adapter: SalleAdapter,
        homeFragmentModel: HomeFragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        salleService = SalleService(homeFragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.salles = salles
        this.adapter = adapter

        Log.d("HomeSalleUtils", "updateSalles appelée avec : $userLocation")
        // Charger les bâtiments
        salleService.getSalles().observe(homeFragmentModel.viewLifecycleOwner, Observer { sals ->
            if (sals != null) {
                for (salle in sals) {
                    try {
                        val salleLocation =
                            GeoPoint(salle.latitude.toDouble(), salle.longitude.toDouble())
                        val distance = MapsUtils.calculateDistance(userLocation, salleLocation)
                        Log.d(
                            "HomeSalleUtils",
                            "Distance calculée pour ${salle.nom}: $distance mètres"
                        )

                        // Conversion en km si la distance dépasse 1000 m
                        val formattedDistance = if (distance >= 1000) {
                            String.format("%.2f km", distance / 1000)
                        } else {
                            String.format("%.2f m", distance)
                        }

                        salle.distance = formattedDistance

                        Log.d(
                            "HomeSalleUtils",
                            "Distance mise à jour pour ${salle.nom}: ${salle.distance}"
                        )

                    } catch (e: Exception) {
                        Log.e(
                            "HomeSalleUtils",
                            "Erreur lors de la mise à jour de la distance pour ${salle.nom}",
                            e
                        )
                    }
                    salles.add(salle)
                }
            }
            // Mise à jour de l’adaptateur et du RecyclerView
            this.filteredList = salles.toMutableList()

            this.adapter = SalleAdapter(
                salles,
                homeFragmentModel.fragmentManager,
                homeFragmentModel.newFragment
            )

            val recyclerBatiments =
                homeFragmentModel.view?.findViewById<RecyclerView>(homeFragmentModel.recyclerViewId)
            recyclerBatiments?.layoutManager =
                LinearLayoutManager(
                    homeFragmentModel.fragmentContext,
                    LinearLayoutManager.HORIZONTAL,
                    false
                )
            recyclerBatiments?.adapter = adapter
        })
        onDataLoaded()
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\InfraUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.content.Context
import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.InfraFragmentAdapter
import tg.univlome.epl.models.Infrastructure
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.InfrastructureService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet InfraUtils : Fournit des fonctions utilitaires pour la gestion
 * des infrastructures sur le campus universitaire.
 *
 * Description :
 * Cet objet permet d'interagir avec les infrastructures en facilitant :
 *  - Le chargement dynamique des infrastructures à partir d'un service distant
 *  - Le filtrage selon leur situation géographique (Campus sud, nord, etc.)
 *  - L'affichage de la distance par rapport à l'utilisateur
 *  - L'ouverture d'une carte localisant une infrastructure
 *  - La sauvegarde et le chargement local des infrastructures via SharedPreferences
 *
 * Composants principaux :
 *  - InfrastructureService : service de récupération des données
 *  - InfraFragmentAdapter : adaptateur RecyclerView pour afficher les infrastructures
 *  - MapsFragment : fragment de carte utilisé pour localiser une infrastructure
 *
 * Bibliothèques utilisées :
 *  - Gson pour la sérialisation JSON
 *  - OSMDroid pour la manipulation des points géographiques
 *
 * @see InfrastructureService pour l'accès aux données des infrastructures
 * @see MapsFragment pour l'affichage de la carte d'une infrastructure
 */
object InfraUtils {

    private lateinit var infraService: InfrastructureService
    private lateinit var filteredList: MutableList<Infrastructure>
    private lateinit var infras: MutableList<Infrastructure>
    private lateinit var adapter: InfraFragmentAdapter

    /**
     * Ouvre le fragment de carte (MapsFragment) centré sur la position d'une infrastructure donnée.
     *
     * @param infrastructure Infrastructure dont la position est à afficher.
     * @param fragmentActivity L’activité hôte dans laquelle charger le fragment.
     */
    fun ouvrirMapsFragment(infrastructure: Infrastructure, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", infrastructure.latitude.toDouble())
        bundle.putDouble("longitude", infrastructure.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour dynamiquement la liste des infrastructures avec la distance depuis l’utilisateur,
     * filtre selon la situation (sud, nord...), et recharge la RecyclerView avec l’adaptateur.
     *
     * @param userLocation Position géographique actuelle de l’utilisateur.
     * @param infrastructures Liste cible à remplir avec les infrastructures chargées.
     * @param filteredList Liste utilisée pour afficher les éléments filtrés.
     * @param adapter Adaptateur lié à la RecyclerView à mettre à jour.
     * @param fragmentModel Modèle contenant le contexte, la vue et les infos du fragment appelant.
     * @param onDataLoaded Callback optionnel exécuté après le chargement.
     */
    fun updateInfrastructures(
        userLocation: GeoPoint,
        infrastructures: MutableList<Infrastructure>,
        filteredList: MutableList<Infrastructure>,
        adapter: InfraFragmentAdapter,
        fragmentModel: FragmentModel,
        onDataLoaded: () -> Unit = {}
    ) {
        infraService = InfrastructureService(fragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.infras = infrastructures
        this.adapter = adapter

        Log.d("InfraUtils", "updateInfrastructures appelée avec : $userLocation")

        // Récupération des infrastructures depuis le service
        infraService.getInfrastructures()
            .observe(fragmentModel.viewLifecycleOwner, Observer { infras ->
                if (infras != null) {
                    for (infrastructure in infras) {
                        try {
                            val infrastructureLocation = GeoPoint(
                                infrastructure.latitude.toDouble(),
                                infrastructure.longitude.toDouble()
                            )
                            val distance =
                                MapsUtils.calculateDistance(userLocation, infrastructureLocation)
                            Log.d(
                                "InfraUtils",
                                "Distance calculée pour ${infrastructure.nom}: $distance mètres"
                            )

                            // Conversion en km si la distance dépasse 1000 m
                            val formattedDistance = if (distance >= 1000) {
                                String.format("%.2f km", distance / 1000)
                            } else {
                                String.format("%.2f m", distance)
                            }

                            infrastructure.distance = formattedDistance

                            Log.d(
                                "InfraUtils",
                                "Distance mise à jour pour ${infrastructure.nom}: ${infrastructure.distance}"
                            )

                        } catch (e: Exception) {
                            Log.e(
                                "InfraUtils",
                                "Erreur lors de la mise à jour de la distance pour ${infrastructure.nom}",
                                e
                            )
                        }
                        // Filtrage selon la situation géographique
                        when (fragmentModel.situation) {
                            "" -> {
                                infrastructures.add(infrastructure)
                            }

                            "sud" -> {
                                if (infrastructure.situation == "Campus sud") {
                                    infrastructures.add(infrastructure)
                                }
                            }

                            "nord" -> {
                                if (infrastructure.situation == "Campus nord") {
                                    infrastructures.add(infrastructure)
                                }
                            }
                        }
                    }
                }

                // Mise à jour de la liste filtrée et de l'adaptateur
                this.filteredList = infrastructures.toMutableList()
                this.adapter = InfraFragmentAdapter(infrastructures)

                val recyclerBatiments =
                    fragmentModel.view?.findViewById<RecyclerView>(fragmentModel.recyclerViewId)
                recyclerBatiments?.layoutManager =
                    LinearLayoutManager(
                        fragmentModel.fragmentContext,
                        LinearLayoutManager.VERTICAL,
                        false
                    )
                recyclerBatiments?.adapter = adapter
            })
        onDataLoaded()
    }

    /**
     * Sauvegarde la liste des infrastructures localement dans les préférences partagées (JSON).
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @param infras Liste des infrastructures à sauvegarder.
     */
    fun saveInfras(context: Context, infras: MutableList<Infrastructure>) {
        val sharedPreferences = context.getSharedPreferences("InfrasPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(infras)
        editor.putString("infrastructure", json)
        editor.apply()
    }

    /**
     * Charge les infrastructures précédemment sauvegardées depuis les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @return Liste des infrastructures sauvegardées ou null si aucune donnée trouvée.
     */
    fun loadInfras(context: Context): MutableList<Infrastructure>? {
        val sharedPreferences = context.getSharedPreferences("InfrasPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("infrastructure", null)
        val type = object : TypeToken<MutableList<Infrastructure>>() {}.type
        return gson.fromJson(json, type)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\MapsUtils.kt 
=============================================== 
@file:Suppress("DEPRECATION")

package tg.univlome.epl.utils

import android.Manifest
import android.app.Activity
import android.content.Context
import android.content.res.Resources
import android.graphics.Bitmap
import android.graphics.Canvas
import android.graphics.drawable.BitmapDrawable
import android.util.Log
import android.view.MotionEvent
import android.widget.Toast
import androidx.annotation.RequiresPermission
import androidx.core.content.ContextCompat
import androidx.core.content.res.ResourcesCompat
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import okhttp3.Call
import okhttp3.Callback
import okhttp3.OkHttpClient
import okhttp3.Request
import okhttp3.Response
import org.json.JSONException
import org.json.JSONObject
import org.osmdroid.tileprovider.tilesource.TileSourceFactory
import org.osmdroid.util.BoundingBox
import org.osmdroid.util.GeoPoint
import org.osmdroid.views.MapView
import org.osmdroid.views.overlay.Marker
import org.osmdroid.views.overlay.Overlay
import org.osmdroid.views.overlay.Polyline
import tg.univlome.epl.R
import java.io.IOException

/**
 * Objet MapsUtils : Fournit des utilitaires liés à la carte et à la géolocalisation,
 * utilisés pour la manipulation de données sur les cartes OpenStreetMap avec OSMDroid.
 *
 * Description :
 * Cet objet contient un ensemble de fonctions utilitaires pour gérer les cartes,
 * la géolocalisation, les marqueurs, et l’itinéraire entre deux points. Elle permet
 * également la sauvegarde et la récupération des données de géolocalisation via
 * les préférences partagées de l’application Android.
 * Elle est utilisée dans le contexte d'une application de visualisation et navigation
 * vers des bâtiments à l'aide d'une carte embarquée.
 *
 * Composants principaux :
 *  - Calcul de distance entre deux points géographiques
 *  - Sauvegarde/chargement des positions utilisateur et destination
 *  - Gestion et affichage des marqueurs
 *  - Affichage de l’itinéraire sur carte (OpenRouteService)
 *  - Configuration d'une carte miniature (miniMap)
 *
 * Bibliothèques utilisées :
 * - OSMDroid pour l’affichage et la manipulation de la carte
 * - OpenRouteService pour le calcul d’itinéraires
 *
 * @see MapsActivity pour l'utilisation principale de cette classe
 */
object MapsUtils {

    private val client = OkHttpClient()
    private val iconCache = mutableMapOf<Int, BitmapDrawable>()

    /**
     * Calcule la distance en mètres entre deux points géographiques.
     *
     * @param start Le point de départ.
     * @param end Le point d’arrivée.
     * @return Distance en mètres.
     */
    fun calculateDistance(start: GeoPoint, end: GeoPoint): Double {
        val results = FloatArray(1)
        android.location.Location.distanceBetween(
            start.latitude, start.longitude,
            end.latitude, end.longitude,
            results
        )
        return results[0].toDouble() // Retourne la distance en mètres
    }

    fun fusedLocationClient(location: android.location.Location?, context: Context): GeoPoint {
        return if (location != null) {
            // Sauvegarde la localisation obtenue
            MapsUtils.saveUserLocation(context, GeoPoint(location.latitude, location.longitude))
            GeoPoint(location.latitude, location.longitude)
        } else {
            // 🔄 Récupère la dernière position sauvegardée ou utilise une valeur par défaut
            val savedLocation = MapsUtils.loadUserLocation(context)
            if (savedLocation.latitude != 0.0 || savedLocation.longitude != 0.0) {
                savedLocation
            } else {
                // Valeur par défaut (ex : Université de Lomé)
                GeoPoint(6.1707, 1.2310)
            }
        }
    }

    /**
     * Sauvegarde la position de l’utilisateur dans les préférences partagées.
     *
     * @param context Contexte de l’application.
     * @param location Localisation à sauvegarder.
     */
    fun saveUserLocation(context: Context, location: GeoPoint) {
        val sharedPreferences =
            context.getSharedPreferences("UserLocationPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(location)
        editor.putString("userLocation", json)
        editor.apply()
    }

    /**
     * Charge la position de l’utilisateur depuis les préférences partagées.
     *
     * @param context Contexte de l’application.
     * @return La position sauvegardée, ou (0.0, 0.0) par défaut.
     */
    fun loadUserLocation(context: Context): GeoPoint {
        val sharedPreferences =
            context.getSharedPreferences("UserLocationPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("userLocation", null)
        val type = object : TypeToken<GeoPoint>() {}.type
        return gson.fromJson(json, type) ?: GeoPoint(0.0, 0.0)
    }

    /**
     * Sauvegarde une nouvelle destination dans les préférences.
     *
     * @param context Contexte de l’application.
     * @param destination Destination à sauvegarder.
     */
    fun saveDestination(context: Context, destination: GeoPoint) {
        val sharedPreferences =
            context.getSharedPreferences("DestinationPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(destination)
        editor.putString("destination", json)
        editor.apply()
    }


    /**
     * Récupère la dernière destination sauvegardée depuis les préférences.
     *
     * @param context Contexte de l’application.
     * @return Destination sauvegardée ou (0.0, 0.0) si aucune.
     */
    fun loadDestination(context: Context): GeoPoint {
        val sharedPreferences =
            context.getSharedPreferences("DestinationPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("destination", null)
        val type = object : TypeToken<GeoPoint>() {}.type
        return gson.fromJson(json, type) ?: GeoPoint(0.0, 0.0)
    }

    /**
     * Supprime la destination sauvegardée.
     *
     * @param context Contexte de l’application.
     */
    fun clearDestination(context: Context) {
        val sharedPreferences =
            context.getSharedPreferences("DestinationPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        editor.remove("destination")
        editor.apply()
    }

    /**
     * Sauvegarde la liste des marqueurs récupérés depuis la map dans les préférences.
     *
     * @param context Contexte de l’application.
     * @param markerList Liste des marqueurs à sauvegarder.
     */
    fun saveMarkerList(context: Context, markerList: MutableList<Marker>) {
        val sharedPreferences =
            context.getSharedPreferences("MarkerListPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(markerList)
        editor.putString("markerList", json)
        editor.apply()
    }

    /**
     * Récupère la liste des marqueurs depuis les préférences.
     *
     * @param context Contexte de l’application.
     * @return Liste de marqueurs sauvegardés ou une liste vide.
     */
    fun loadMarkerList(context: Context): MutableList<Marker> {
        val sharedPreferences =
            context.getSharedPreferences("MarkerListPrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("markerList", null)
        val type = object : TypeToken<MutableList<Marker>>() {}.type
        return gson.fromJson(json, type) ?: mutableListOf()
    }

    /**
     * Supprime la liste des marqueurs sauvegardés.
     *
     * @param context Contexte de l’application.
     */
    fun clearMarkerList(context: Context) {
        val sharedPreferences =
            context.getSharedPreferences("MarkerListPrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        editor.remove("markerList")
        editor.apply()
    }

    /**
     * Redimensionne une icône pour l'affichage sur la carte et la met en cache pour les chargements
     * ultérieurs.
     *
     * @param icon ID de la ressource drawable.
     * @param resources Accès aux ressources.
     * @return Drawable redimensionné ou `null` si non disponible.
     */
    fun resizeIcon(
        icon: Int = R.drawable.default_marker,
        resources: Resources,
        tintColor: Int = android.graphics.Color.BLACK
    ): BitmapDrawable? {
        return iconCache[icon] ?: run {
            val drawable = ResourcesCompat.getDrawable(resources, icon, null) ?: return null

            // Nettoie toute teinte existante
            drawable.setTintList(null)
            drawable.clearColorFilter()

            // Applique la teinte noire
            drawable.setTint(tintColor)

            val bitmap = Bitmap.createBitmap(
                drawable.intrinsicWidth,
                drawable.intrinsicHeight,
                Bitmap.Config.ARGB_8888
            )
            val canvas = Canvas(bitmap)
            drawable.setBounds(0, 0, canvas.width, canvas.height)
            drawable.draw(canvas)

            val scaledBitmap = Bitmap.createScaledBitmap(bitmap, 75, 75, false)
            val scaledDrawable = BitmapDrawable(resources, scaledBitmap)
            iconCache[icon] = scaledDrawable
            scaledDrawable
        }
    }

    /**
     * Configure une carte miniature statique montrant la position de l'utilisateur et sa destination.
     * Affiche les marqueurs de départ et d’arrivée ainsi que l’itinéraire calculé.
     *
     * @param miniMap Vue MapView à configurer.
     * @param userLocation Position de l'utilisateur (par défaut (0,0)).
     * @param destination Position de destination (par défaut (0,0)).
     * @param context Contexte de l’application.
     * @param activity Activité appelante.
     * @param resources Accès aux ressources.
     *
     * @permission ACCESS_FINE_LOCATION
     * @permission ACCESS_COARSE_LOCATION
     */
    @RequiresPermission(allOf = [Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION])
    fun setMiniMap(
        miniMap: MapView,
        userLocation: GeoPoint = GeoPoint(0, 0),
        destination: GeoPoint = GeoPoint(0, 0),
        context: Context,
        activity: Activity,
        resources: Resources
    ) {
        var start = userLocation
        var end = destination
        // Si la localisation utilisateur n'est pas valide, utiliser la destination comme point de départ
        if (start.latitude == 0.0 && start.longitude == 0.0) {
            start = end
        }
        miniMap.setTileSource(TileSourceFactory.MAPNIK)
        miniMap.setMultiTouchControls(false)
        // Rendre la carte totalement statique
        miniMap.setBuiltInZoomControls(false) // désactiver les boutons zoom
        miniMap.isTilesScaledToDpi = false

        val latPadding = 0.001
        val lonPadding = 0.001
        val boundingBox = BoundingBox(
            maxOf(start.latitude, end.latitude) + latPadding,
            maxOf(start.longitude, end.longitude) + lonPadding,
            minOf(start.latitude, end.latitude) - latPadding,
            minOf(start.longitude, end.longitude) - lonPadding
        )

        // Ajuster la vue pour montrer les deux points
        miniMap.post {
            miniMap.zoomToBoundingBox(boundingBox, false, 50, 14.0, 14.0.toLong())


            // Marqueur de départ
            val startMarker = Marker(miniMap).apply {
                position = start
                setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
                icon = resizeIcon(R.drawable.maps_and_flags, resources)
            }

            // Marqueur de destination
            val endMarker = Marker(miniMap).apply {
                position = end
                setAnchor(Marker.ANCHOR_CENTER, Marker.ANCHOR_BOTTOM)
                icon = resizeIcon(R.drawable.destination, resources)
            }

            miniMap.overlays.clear()
            miniMap.overlays.add(startMarker)
            miniMap.overlays.add(endMarker)

            // Désactiver le toucher utilisateur
            miniMap.isFocusable = false
            miniMap.isEnabled = false

            // Bloquer tous les gestes de l'utilisateur
            val touchInterceptor = object : Overlay() {
                override fun onTouchEvent(event: MotionEvent?, mapView: MapView?): Boolean {
                    return true // bloque tous les touch events
                }
            }
            miniMap.overlays.add(touchInterceptor)

            // Obtenir l'itinéraire
            getRoute(start, end, activity, miniMap)

            miniMap.invalidate()
        }
    }

    /**
     * Récupère et trace l’itinéraire entre deux points en utilisant l’API OpenRouteService.
     *
     * @param start Point de départ.
     * @param end Point d’arrivée.
     * @param activity Activité pour l’exécution sur le thread principal.
     * @param mapView Carte à mettre à jour.
     */
    private fun getRoute(start: GeoPoint, end: GeoPoint, activity: Activity, mapView: MapView) {
        val apiKey = "5b3ce3597851110001cf62480894b05967b24b268cf8fa5b6a5166f7"
        val url =
            "https://api.openrouteservice.org/v2/directions/driving-car?api_key=$apiKey&start=${start.longitude},${start.latitude}&end=${end.longitude},${end.latitude}"

        val request = Request.Builder().url(url).build()

        client.newCall(request).enqueue(object : Callback {
            override fun onFailure(call: Call, e: IOException) {
                Log.e(
                    "MapsActivity",
                    "Erreur lors de la récupération de l'itinéraire : ${e.message}"
                )
                activity.runOnUiThread {
                    Toast.makeText(
                        activity,
                        "Impossible de récupérer l'itinéraire",
                        Toast.LENGTH_LONG
                    ).show()
                }
            }

            override fun onResponse(call: Call, response: Response) {
                if (response.isSuccessful) {
                    response.body?.string()?.let { jsonString ->
                        try {
                            val jsonObject = JSONObject(jsonString)
                            val features = jsonObject.getJSONArray("features")
                            if (features.length() > 0) {
                                val geometry = features.getJSONObject(0).getJSONObject("geometry")
                                val coordinates = geometry.getJSONArray("coordinates")

                                val geoPoints = mutableListOf<GeoPoint>()
                                for (i in 0 until coordinates.length()) {
                                    val coord = coordinates.getJSONArray(i)
                                    val lon = coord.getDouble(0)
                                    val lat = coord.getDouble(1)
                                    geoPoints.add(GeoPoint(lat, lon))
                                }

                                activity.runOnUiThread {
                                    var currentPolyline = Polyline()
                                    currentPolyline!!.setPoints(geoPoints)
                                    currentPolyline!!.outlinePaint.color =
                                        ContextCompat.getColor(activity, R.color.mainColor)
                                    currentPolyline!!.outlinePaint.strokeWidth = 5f

                                    mapView.overlays.add(currentPolyline)
                                    mapView.invalidate()
                                }
                            }
                        } catch (e: JSONException) {
                            Log.e("MapsUtils", "Erreur JSON: ${e.message}")
                        }
                    }
                } else {
                    Log.e("MapsUtils", "Erreur dans la réponse de l'API de routage")
                }
            }
        })
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\OthersUtils.kt 
=============================================== 
package tg.univlome.epl.utils

/**
 * Objet OthersUtils : Contient des fonctions utilitaires générales utilisées dans l'application.
 *
 * Description :
 * Cet objet regroupe des méthodes d'utilité courante ne relevant pas directement
 * d’un domaine spécifique comme les bâtiments ou les infrastructures.
 * Il est destiné à accueillir des fonctions de conversion, de formatage, ou d'aide au calcul.
 *
 * Fonctionnalité actuelle :
 *  - Conversion d’une distance exprimée en mètres vers un format lisible (mètres ou kilomètres)
 *
 * Ce type d’objet permet de centraliser les fonctions utilitaires partagées
 * par plusieurs composants de l’application.
 */
object OthersUtils {

    /**
     * Convertit une distance en mètres vers une représentation lisible :
     * - en mètres (m) si la valeur est inférieure à 1000
     * - en kilomètres (km) avec deux décimales sinon
     *
     * @param distance Distance en mètres à convertir.
     * @return Une chaîne formatée avec l’unité appropriée (par ex. "850.00 m" ou "1.25 km").
     */
    fun convertDistance(distance: Double): String {
        // Conversion en km si la distance dépasse 1000 m
        val formattedDistance = if (distance >= 1000) {
            String.format("%.2f km", distance / 1000)
        } else {
            String.format("%.2f m", distance)
        }
        return formattedDistance
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\java\tg\univlome\epl\utils\SalleUtils.kt 
=============================================== 
package tg.univlome.epl.utils

import android.content.Context
import android.os.Bundle
import android.util.Log
import androidx.fragment.app.FragmentActivity
import androidx.lifecycle.Observer
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import org.osmdroid.util.GeoPoint
import tg.univlome.epl.R
import tg.univlome.epl.adapter.SalleViewAllAdapter
import tg.univlome.epl.models.Salle
import tg.univlome.epl.models.modelsfragments.FragmentModel
import tg.univlome.epl.services.SalleService
import tg.univlome.epl.ui.maps.MapsFragment

/**
 * Objet SalleUtils : Fournit des fonctions utilitaires pour la gestion complète
 * des salles de cours ou de réunion sur le campus universitaire.
 *
 * Description :
 * Cet objet permet de :
 *  - Charger dynamiquement les salles depuis Firestore
 *  - Filtrer les salles par situation géographique (sud, nord, etc.)
 *  - Calculer la distance entre l'utilisateur et chaque salle
 *  - Afficher dynamiquement les salles dans un `RecyclerView`
 *  - Ouvrir une carte localisant une salle
 *  - Sauvegarder et charger localement les salles via `SharedPreferences`
 *
 * Composants principaux :
 *  - SalleService : service Firestore pour la récupération des données
 *  - SalleViewAllAdapter : adaptateur utilisé pour l’affichage de toutes les salles
 *  - MapsFragment : fragment de carte pour la localisation
 *
 * Bibliothèques utilisées :
 *  - OSMDroid pour les géopoints
 *  - Gson pour la sérialisation JSON
 *  - AndroidX Fragment, RecyclerView, Lifecycle
 *
 * @see SalleService pour les opérations de récupération de données
 * @see MapsFragment pour la visualisation géographique
 */
object SalleUtils {

    private lateinit var salleService: SalleService
    private lateinit var filteredList: MutableList<Salle>
    private lateinit var salles: MutableList<Salle>
    private lateinit var adapter: SalleViewAllAdapter

    /**
     * Ouvre un `MapsFragment` centré sur la salle sélectionnée.
     *
     * @param salle Salle à afficher sur la carte.
     * @param fragmentActivity Activité dans laquelle le fragment sera affiché.
     */
    fun ouvrirMapsFragment(salle: Salle, fragmentActivity: FragmentActivity) {
        val fragment = MapsFragment()
        val bundle = Bundle()
        bundle.putDouble("latitude", salle.latitude.toDouble())
        bundle.putDouble("longitude", salle.longitude.toDouble())
        fragment.arguments = bundle

        fragmentActivity.supportFragmentManager.beginTransaction()
            .replace(R.id.container, fragment)
            .addToBackStack(null)
            .commit()
    }

    /**
     * Met à jour dynamiquement la liste des salles :
     *  - Calcule la distance avec l'utilisateur
     *  - Applique un filtrage géographique (nord, sud, ou tous)
     *  - Recharge la RecyclerView avec les nouvelles données
     *
     * @param userLocation Position actuelle de l'utilisateur.
     * @param salles Liste à remplir avec les salles récupérées.
     * @param filteredList Liste utilisée pour le rendu visuel.
     * @param adapter Adaptateur initial de la RecyclerView.
     * @param fragmentModel Modèle encapsulant les éléments de contexte et de vue.
     */
    fun updateSalles(
        userLocation: GeoPoint,
        salles: MutableList<Salle>,
        filteredList: MutableList<Salle>,
        adapter: SalleViewAllAdapter,
        fragmentModel: FragmentModel
    ) {
        salleService = SalleService(fragmentModel.fragmentContext)
        this.filteredList = filteredList
        this.salles = salles
        this.adapter = adapter

        Log.d("SalleUtils", "updateSalles appelée avec : $userLocation")
        // Charger les salles
        salleService.getSalles().observe(fragmentModel.viewLifecycleOwner, Observer { sals ->
            if (sals != null) {
                for (salle in sals) {
                    try {
                        val salleLocation =
                            GeoPoint(salle.latitude.toDouble(), salle.longitude.toDouble())
                        val distance = MapsUtils.calculateDistance(userLocation, salleLocation)
                        Log.d("SalleUtils", "Distance calculée pour ${salle.nom}: $distance mètres")

                        // Conversion en km si la distance dépasse 1000 m
                        val formattedDistance = if (distance >= 1000) {
                            String.format("%.2f km", distance / 1000)
                        } else {
                            String.format("%.2f m", distance)
                        }

                        salle.distance = formattedDistance

                        Log.d(
                            "SalleUtils",
                            "Distance mise à jour pour ${salle.nom}: ${salle.distance}"
                        )

                    } catch (e: Exception) {
                        Log.e(
                            "SalleUtils",
                            "Erreur lors de la mise à jour de la distance pour ${salle.nom}",
                            e
                        )
                    }
                    when (fragmentModel.situation) {
                        "" -> {
                            salles.add(salle)
                        }

                        "sud" -> {
                            if (salle.situation == "Campus sud") {
                                salles.add(salle)
                            }
                        }

                        "nord" -> {
                            if (salle.situation == "Campus nord") {
                                salles.add(salle)
                            }
                        }
                    }
                }
            }
            this.filteredList = salles.toMutableList()

            this.adapter = SalleViewAllAdapter(salles)

            val recyclerBatiments =
                fragmentModel.view?.findViewById<RecyclerView>(fragmentModel.recyclerViewId)
            recyclerBatiments?.layoutManager =
                LinearLayoutManager(
                    fragmentModel.fragmentContext,
                    LinearLayoutManager.VERTICAL,
                    false
                )
            recyclerBatiments?.adapter = adapter
        })
    }

    /**
     * Sauvegarde la liste des salles localement dans les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @param salles Liste des salles à sauvegarder.
     */
    fun saveSalles(context: Context, salles: MutableList<Salle>) {
        val sharedPreferences = context.getSharedPreferences("SallePrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        val gson = Gson()
        val json = gson.toJson(salles)
        editor.putString("salle", json)
        editor.apply()
    }

    /**
     * Charge les salles sauvegardées précédemment depuis les préférences partagées.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     * @return Liste des salles sauvegardées, ou null si aucune donnée.
     */
    fun loadSalles(context: Context): MutableList<Salle>? {
        val sharedPreferences = context.getSharedPreferences("SallePrefs", Context.MODE_PRIVATE)
        val gson = Gson()
        val json = sharedPreferences.getString("salle", null)
        val type = object : TypeToken<MutableList<Salle>>() {}.type
        return gson.fromJson(json, type)
    }

    /**
     * Supprime la liste des salles sauvegardée localement.
     *
     * @param context Contexte utilisé pour accéder aux préférences.
     */
    fun clearSalles(context: Context) {
        val sharedPreferences = context.getSharedPreferences("SallePrefs", Context.MODE_PRIVATE)
        val editor = sharedPreferences.edit()
        editor.remove("salle")
        editor.apply()
    }

} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\test\java\tg\univlome\epl\ExampleUnitTest.kt 
=============================================== 
package tg.univlome.epl

import org.junit.Assert.assertEquals
import org.junit.Test

/**
 * Example local unit test, which will execute on the development machine (host).
 *
 * See [testing documentation](http://d.android.com/tools/testing).
 */
class ExampleUnitTest {
    @Test
    fun addition_isCorrect() {
        assertEquals(4, 2 + 2)
    }
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\build.gradle.kts 
=============================================== 
// Top-level build file where you can add configuration options common to all sub-projects/modules.
plugins {
    alias(libs.plugins.android.application) apply false
    alias(libs.plugins.kotlin.android) apply false
    id("com.google.gms.google-services") version "4.4.2" apply false
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\settings.gradle.kts 
=============================================== 
pluginManagement {
    repositories {
        google {
            content {
                includeGroupByRegex("com\\.android.*")
                includeGroupByRegex("com\\.google.*")
                includeGroupByRegex("androidx.*")
            }
        }
        mavenCentral()
        gradlePluginPortal()
    }
}
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
    }
}

rootProject.name = "LocUL"
include(":app")
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\build.gradle.kts 
=============================================== 
plugins {
    alias(libs.plugins.android.application)
    alias(libs.plugins.kotlin.android)
    id("com.google.gms.google-services")
    id("org.jetbrains.dokka") version "1.9.10"
}

android {
    namespace = "tg.univlome.epl"
    compileSdk = 35

    defaultConfig {
        applicationId = "tg.univlome.epl"
        minSdk = 24
        targetSdk = 34
        versionCode = 1
        versionName = "1.0"

        testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            isMinifyEnabled = false
            proguardFiles(
                getDefaultProguardFile("proguard-android-optimize.txt"),
                "proguard-rules.pro"
            )
        }
    }

    buildFeatures {
        viewBinding = true
    }

    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
    }
    kotlinOptions {
        jvmTarget = "11"
    }
}

dependencies {

    implementation(libs.androidx.core.ktx)
    implementation(libs.androidx.appcompat)
    implementation(libs.material)
    implementation(libs.androidx.activity)
    implementation(libs.androidx.constraintlayout)
    implementation(libs.firebase.firestore)
    implementation(libs.androidx.animation.graphics.android)
    testImplementation(libs.junit)
    androidTestImplementation(libs.androidx.junit)
    androidTestImplementation(libs.androidx.espresso.core)

    implementation("com.google.android.material:material:1.9.0")
    implementation("androidx.drawerlayout:drawerlayout:1.2.0")

    implementation(platform("com.google.firebase:firebase-bom:33.10.0"))

    implementation("org.osmdroid:osmdroid-wms:6.1.16") // Optionnel si besoin de WMS
    implementation("org.osmdroid:osmdroid-android:6.1.16")
    implementation("org.osmdroid:osmdroid-mapsforge:6.1.16") // Ajout pour ScaleBarOverlay
    implementation("com.squareup.okhttp3:okhttp:4.9.0")  // Pour les requêtes HTTP (GraphHopper)

    implementation("com.google.android.gms:play-services-location:21.1.0") //exemple
    implementation("com.google.android.gms:play-services-maps:18.2.0") //exemple

    implementation("com.github.bumptech.glide:glide:4.15.1")
    annotationProcessor("com.github.bumptech.glide:compiler:4.15.1")

    // Retrofit
    implementation("com.squareup.retrofit2:retrofit:2.6.0")
    implementation("com.squareup.retrofit2:converter-gson:2.6.0")
    implementation("com.squareup.okhttp3:logging-interceptor:4.5.0")

    // CircleImageView
    implementation("de.hdodenhof:circleimageview:3.1.0")

    implementation("androidx.appcompat:appcompat:1.6.1")
    implementation("androidx.viewpager2:viewpager2:1.0.0")
    implementation("com.airbnb.android:lottie:+")
    implementation("com.facebook.shimmer:shimmer:0.5.0")

    implementation(kotlin("stdlib"))
}

tasks.dokkaHtml.configure {
    @Suppress("DEPRECATION")
    outputDirectory.set(buildDir.resolve("dokka/html"))
}

@Suppress("DEPRECATION")
val dokkaPdf by tasks.registering(Exec::class) {
    dependsOn("dokkaHtml")
    group = "documentation"
    description = "Génère la documentation PDF depuis HTML avec wkhtmltopdf"

    val htmlPath = buildDir.resolve("dokka/html/index.html")
    val outputPdf = buildDir.resolve("dokka/documentation.pdf")

    commandLine("wkhtmltopdf", htmlPath.absolutePath, outputPdf.absolutePath)
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\AndroidManifest.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="com.google.android.gms.permission.AD_ID" />
    <uses-permission android:name="com.google.android.gms.permission.ACTIVITY_RECOGNITION" />

    <application
        android:name=".MyApp"
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:hardwareAccelerated="true"
        android:icon="@mipmap/loc_ul_launcher"
        android:label="@string/app_name"
        android:largeHeap="true"
        android:roundIcon="@mipmap/loc_ul_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.LocUL"
        android:usesCleartextTraffic="true"
        tools:targetApi="31">
        <activity
            android:name=".ui.maps.MapsActivity"
            android:exported="false" />

        <meta-data
            android:name="android.hardware.opengles.aep"
            android:value="false" />
        <meta-data
            android:name="org.osmdroid.config"
            android:value="true" />
        <meta-data
            android:name="android.max_aspect"
            android:value="2.1" />

        <activity
            android:name=".ui.batiment.BatimentActivity"
            android:exported="false" />
        <activity
            android:name=".ui.infrastructure.InfraActivity"
            android:exported="false" />
        <activity
            android:name=".ui.home.SalleActivity"
            android:exported="false" />
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:windowSoftInputMode="adjustNothing">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\anim\indicator_scale.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator="@android:anim/accelerate_decelerate_interpolator">

    <scale
        android:duration="150"
        android:fromXScale="0.0"
        android:fromYScale="1.0"
        android:pivotX="50%"
        android:pivotY="50%"
        android:toXScale="1.0"
        android:toYScale="1.0" />

</set> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\about_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="512"
    android:viewportHeight="512">
    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M256,42.67C138.18,42.67 42.67,138.18 42.67,256C42.67,373.82 138.18,469.33 256,469.33C373.82,469.33 469.33,373.82 469.33,256C469.33,138.18 373.82,42.67 256,42.67ZM256,426.67C161.89,426.67 85.33,350.11 85.33,256C85.33,161.89 161.89,85.33 256,85.33C350.11,85.33 426.67,161.89 426.67,256C426.67,350.11 350.11,426.67 256,426.67ZM282.71,170.67C282.71,186.13 271.45,197.33 256.22,197.33C240.37,197.33 229.38,186.13 229.38,170.37C229.38,155.22 240.66,144 256.22,144C271.45,144 282.71,155.22 282.71,170.67ZM234.71,234.67L277.38,234.67L277.38,362.67L234.71,362.67L234.71,234.67Z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />

</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\activity_img_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners
        android:bottomLeftRadius="10dp"
        android:bottomRightRadius="10dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\background_circulaire.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">

    <solid android:color="#BFFFFFFF" />
    <corners android:radius="13dp" />

</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\background_circulaire_2.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">

    <solid android:color="#F0E9F6" />
    <corners android:radius="13dp" />

</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\back_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M15.707,4.293C16.098,4.683 16.098,5.317 15.707,5.707L9.414,12L15.707,18.293C16.098,18.683 16.098,19.317 15.707,19.707C15.317,20.098 14.683,20.098 14.293,19.707L7.293,12.707C7.105,12.52 7,12.265 7,12C7,11.735 7.105,11.48 7.293,11.293L14.293,4.293C14.683,3.902 15.317,3.902 15.707,4.293Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\back_icon_maps.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/black"
        android:fillType="evenOdd"
        android:pathData="M15.707,4.293C16.098,4.683 16.098,5.317 15.707,5.707L9.414,12L15.707,18.293C16.098,18.683 16.098,19.317 15.707,19.707C15.317,20.098 14.683,20.098 14.293,19.707L7.293,12.707C7.105,12.52 7,12.265 7,12C7,11.735 7.105,11.48 7.293,11.293L14.293,4.293C14.683,3.902 15.317,3.902 15.707,4.293Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\batiment_nav_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="960"
    android:viewportHeight="960">
    <path
        android:fillColor="@color/black"
        android:pathData="M140,806.15v-520h160v-160h360v320h160v360L540,806.15v-160L420,646.15v160L140,806.15ZM180,766.15h120v-120L180,646.15v120ZM180,606.15h120v-120L180,486.15v120ZM180,446.15h120v-120L180,326.15v120ZM340,606.15h120v-120L340,486.15v120ZM340,446.15h120v-120L340,326.15v120ZM340,286.15h120v-120L340,166.15v120ZM500,606.15h120v-120L500,486.15v120ZM500,446.15h120v-120L500,326.15v120ZM500,286.15h120v-120L500,166.15v120ZM660,766.15h120v-120L660,646.15v120ZM660,606.15h120v-120L660,486.15v120Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\bottom_nav_background.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">

    <solid android:color="@color/bottom_nav_default" />

    <corners android:radius="40dp" />

</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\contact_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#00000000"
        android:pathData="M5,12C3.343,12 2,10.657 2,9C2,7.343 3.343,6 5,6C6.657,6 8,7.343 8,9C8,10.657 6.657,12 5,12ZM9,18L9,16C9,13.75 7.213,12 4.964,12L5.018,12C2.769,12 1,13.75 1,16L1,18M12,7L24,7M12,17L22,17M12,12L19,12"
        android:strokeWidth="2"
        android:strokeColor="@color/mainColor" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\dot_selector.xml 
=============================================== 
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_selected="true">
        <shape android:shape="oval">
            <solid android:color="@color/selected_dot_color" />
            <size android:width="8dp" android:height="8dp" />
        </shape>
    </item>
    <item>
        <shape android:shape="oval">
            <solid android:color="@color/unselected_dot_color" />
            <size android:width="8dp" android:height="8dp" />
        </shape>
    </item>
</selector> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\drawer_nav_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners
        android:bottomRightRadius="15dp"
        android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\hamburger_menu.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="35dp"
    android:height="35dp"
    android:viewportWidth="64"
    android:viewportHeight="64">

    <path
        android:fillColor="@color/mainColor"
        android:fillType="nonZero"
        android:pathData="M7.971,43.925l16.031,0l0,5.992l-16.031,0z" />

    <path
        android:fillColor="@color/mainColor"
        android:fillType="nonZero"
        android:pathData="M8.181,29.004l31.821,0l0,5.992l-31.821,0z" />

    <path
        android:fillColor="@color/mainColor"
        android:fillType="nonZero"
        android:pathData="M8.181,14.082l47.821,0l0,5.992l-47.821,0z" />

</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\header_nav_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/mainColor" />
    <corners android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\home_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="960"
    android:viewportHeight="960">
    <path
        android:fillColor="@color/black"
        android:pathData="M230.26,769.74h148.46v-242.56h202.56v242.56h148.46v-374.61L480,206.92 230.26,395.04v374.7ZM180,820v-450l300,-225.77L780,370v450L531.03,820v-242.57L428.97,577.43L428.97,820L180,820ZM480,488.13Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\ic_launcher_background.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path
        android:fillColor="#3DDC84"
        android:pathData="M0,0h108v108h-108z" />
    <path
        android:fillColor="#00000000"
        android:pathData="M9,0L9,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,0L19,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,0L29,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,0L39,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,0L49,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,0L59,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,0L69,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,0L79,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M89,0L89,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M99,0L99,108"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,9L108,9"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,19L108,19"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,29L108,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,39L108,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,49L108,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,59L108,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,69L108,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,79L108,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,89L108,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M0,99L108,99"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,29L89,29"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,39L89,39"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,49L89,49"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,59L89,59"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,69L89,69"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,79L89,79"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M29,19L29,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M39,19L39,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M49,19L49,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M59,19L59,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M69,19L69,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
    <path
        android:fillColor="#00000000"
        android:pathData="M79,19L79,89"
        android:strokeWidth="0.8"
        android:strokeColor="#33FFFFFF" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\ic_launcher_foreground.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:aapt="http://schemas.android.com/aapt"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path android:pathData="M31,63.928c0,0 6.4,-11 12.1,-13.1c7.2,-2.6 26,-1.4 26,-1.4l38.1,38.1L107,108.928l-32,-1L31,63.928z">
        <aapt:attr name="android:fillColor">
            <gradient
                android:endX="85.84757"
                android:endY="92.4963"
                android:startX="42.9492"
                android:startY="49.59793"
                android:type="linear">
                <item
                    android:color="#44000000"
                    android:offset="0.0" />
                <item
                    android:color="#00000000"
                    android:offset="1.0" />
            </gradient>
        </aapt:attr>
    </path>
    <path
        android:fillColor="#FFFFFF"
        android:fillType="nonZero"
        android:pathData="M65.3,45.828l3.8,-6.6c0.2,-0.4 0.1,-0.9 -0.3,-1.1c-0.4,-0.2 -0.9,-0.1 -1.1,0.3l-3.9,6.7c-6.3,-2.8 -13.4,-2.8 -19.7,0l-3.9,-6.7c-0.2,-0.4 -0.7,-0.5 -1.1,-0.3C38.8,38.328 38.7,38.828 38.9,39.228l3.8,6.6C36.2,49.428 31.7,56.028 31,63.928h46C76.3,56.028 71.8,49.428 65.3,45.828zM43.4,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2c-0.3,-0.7 -0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C45.3,56.528 44.5,57.328 43.4,57.328L43.4,57.328zM64.6,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2s-0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C66.5,56.528 65.6,57.328 64.6,57.328L64.6,57.328z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />
</vector> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\img_backgroung.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="#DDDDDD" />
    <corners android:radius="10dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\indicator_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/mainColor" />
    <corners android:radius="2000dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\location_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="960"
    android:viewportHeight="960">
    <path
        android:fillColor="#e8eaed"
        android:pathData="M480.07,474.61q29.85,0 51.04,-21.26 21.2,-21.26 21.2,-51.11 0,-29.85 -21.26,-51.05Q509.79,330 479.93,330q-29.85,0 -51.04,21.26 -21.2,21.26 -21.2,51.12 0,29.85 21.26,51.04 21.26,21.19 51.12,21.19ZM480,780.54q117.38,-105.08 179.65,-201.58 62.27,-96.5 62.27,-169.04 0,-109.38 -69.5,-179.84 -69.5,-70.46 -172.42,-70.46 -102.92,0 -172.42,70.46 -69.5,70.46 -69.5,179.84 0,72.54 62.27,169.04 62.27,96.5 179.65,201.58ZM480,860.38Q329,729.54 253.54,616.85q-75.46,-112.7 -75.46,-206.93 0,-138.46 89.57,-224.19Q357.23,100 480,100t212.35,85.73q89.57,85.73 89.57,224.19 0,94.23 -75.46,206.93Q631,729.54 480,860.38ZM480,402.31Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\maps_destination.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/white" />
    <corners
        android:bottomRightRadius="15dp"
        android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\maps_destination_remove.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="#69545454" />
    <corners
        android:bottomRightRadius="15dp"
        android:topRightRadius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\map_loc.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/white"
        android:fillType="evenOdd"
        android:pathData="M8.25,9C8.25,6.929 9.929,5.25 12,5.25C14.071,5.25 15.75,6.929 15.75,9C15.75,11.071 14.071,12.75 12,12.75C9.929,12.75 8.25,11.071 8.25,9ZM12,6.75C10.757,6.75 9.75,7.757 9.75,9C9.75,10.243 10.757,11.25 12,11.25C13.243,11.25 14.25,10.243 14.25,9C14.25,7.757 13.243,6.75 12,6.75Z" />
    <path
        android:fillColor="@color/white"
        android:fillType="evenOdd"
        android:pathData="M5.456,8.127C5.73,4.806 8.506,2.25 11.838,2.25H12.162C15.495,2.25 18.27,4.806 18.544,8.127C18.69,9.908 18.14,11.675 17.01,13.058L13.415,17.455C12.684,18.349 11.316,18.349 10.585,17.455L6.99,13.058C5.86,11.675 5.31,9.908 5.456,8.127ZM11.838,3.75C9.286,3.75 7.161,5.707 6.951,8.25C6.837,9.643 7.267,11.027 8.152,12.109L11.746,16.505C11.877,16.665 12.123,16.665 12.254,16.505L15.849,12.109C16.733,11.027 17.163,9.643 17.049,8.25C16.839,5.707 14.714,3.75 12.162,3.75H11.838Z" />
    <path
        android:fillColor="@color/white"
        android:pathData="M7.671,16.335C7.856,15.965 7.706,15.514 7.335,15.329C6.965,15.144 6.514,15.294 6.329,15.665L4.329,19.665C4.213,19.897 4.225,20.173 4.362,20.394C4.499,20.615 4.74,20.75 5,20.75H19C19.26,20.75 19.501,20.615 19.638,20.394C19.775,20.173 19.787,19.897 19.671,19.665L17.671,15.665C17.486,15.294 17.035,15.144 16.665,15.329C16.294,15.514 16.144,15.965 16.329,16.335L17.787,19.25H6.214L7.671,16.335Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\mini_map_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners android:radius="10dp" />
    <stroke
        android:width="1dp"
        android:color="@color/bottom_nav_default_item" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\nav_item_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <corners android:radius="25dp" />
    <solid android:color="@color/bottom_nav_default_item" />
</shape> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\rounded_frame.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/bottom_nav_default" />
    <corners android:radius="10dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\round_view_all.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="19"
    android:viewportHeight="19">
    <path
        android:fillColor="@color/bottom_nav_default_item"
        android:pathData="M17.416,9.579A7.917,7.917 0,1 1,9.5 1.662a7.916,7.916 0,0 1,7.916 7.917zM13.256,8.973 L8.446,4.164a0.792,0.792 0,1 0,-1.12 1.12l4.25,4.248 -4.25,4.25a0.792,0.792 0,0 0,1.12 1.119l4.808,-4.809a0.792,0.792 0,0 0,0 -1.12z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\route_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">

    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M18,16C19.657,16 21,17.343 21,19C21,20.657 19.657,22 18,22C16.343,22 15,20.657 15,19C15,17.343 16.343,16 18,16ZM15.5,4C17.985,4 20,6.015 20,8.5C20,10.985 17.985,13 15.5,13L8.5,13C7.119,13 6,14.119 6,15.5C6,16.881 7.119,18 8.5,18L13,18C13.552,18 14,18.448 14,19C14,19.552 13.552,20 13,20L8.5,20C6.015,20 4,17.985 4,15.5C4,13.015 6.015,11 8.5,11L15.5,11C16.881,11 18,9.881 18,8.5C18,7.119 16.881,6 15.5,6L11,6C10.448,6 10,5.552 10,5C10,4.448 10.448,4 11,4L15.5,4ZM18,18C17.448,18 17,18.448 17,19C17,19.552 17.448,20 18,20C18.552,20 19,19.552 19,19C19,18.448 18.552,18 18,18ZM6,2C7.657,2 9,3.343 9,5C9,6.657 7.657,8 6,8C4.343,8 3,6.657 3,5C3,3.343 4.343,2 6,2ZM6,4C5.448,4 5,4.448 5,5C5,5.552 5.448,6 6,6C6.552,6 7,5.552 7,5C7,4.448 6.552,4 6,4Z"
        android:strokeWidth="1"
        android:strokeColor="#00000000" />

</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\search_background.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/white" />
    <stroke
        android:width="1dp"
        android:color="@color/bottom_nav_default_item" />
    <corners android:radius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\search_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#00000000"
        android:pathData="M10,10m-6,0a6,6 0,1 1,12 0a6,6 0,1 1,-12 0"
        android:strokeWidth="2"
        android:strokeColor="@color/white"
        android:strokeLineCap="round"
        android:strokeLineJoin="round" />
    <path
        android:fillColor="#00000000"
        android:pathData="M14.5,14.5L19,19"
        android:strokeWidth="2"
        android:strokeColor="@color/white"
        android:strokeLineCap="round"
        android:strokeLineJoin="round" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\search_icon_bg.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <solid android:color="@color/mainColor" />
    <corners android:radius="15dp" />
</shape>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\settings_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="64"
    android:viewportHeight="64">
    <path
        android:fillColor="#00000000"
        android:pathData="M27.954,14.394C30.232,12.09 33.172,10.555 36.365,10.004C39.558,9.453 42.843,9.913 45.761,11.32L38.099,19.042C37.365,19.784 36.953,20.786 36.953,21.83C36.953,22.874 37.365,23.876 38.099,24.618L39.945,26.479C40.307,26.845 40.738,27.135 41.213,27.334C41.687,27.532 42.197,27.634 42.711,27.634C43.226,27.634 43.736,27.532 44.21,27.334C44.685,27.135 45.116,26.845 45.478,26.479L53.14,18.757C54.697,22.041 55.079,25.761 54.22,29.293C53.361,32.825 51.315,35.954 48.424,38.157C46.142,39.885 43.428,40.95 40.581,41.236C37.733,41.523 34.861,41.019 32.281,39.781L18.418,53.751C18.056,54.117 17.625,54.407 17.151,54.606C16.676,54.804 16.167,54.906 15.652,54.906C15.137,54.906 14.628,54.804 14.153,54.606C13.679,54.407 13.248,54.117 12.886,53.751L11.04,51.89C10.305,51.148 9.893,50.146 9.893,49.102C9.893,48.058 10.305,47.056 11.04,46.314L24.905,32.34C23.508,29.398 23.052,26.097 23.597,22.886C24.143,19.675 25.664,16.71 27.954,14.394V14.394Z"
        android:strokeWidth="4"
        android:strokeColor="@color/mainColor"
        android:strokeLineCap="round"
        android:strokeLineJoin="round" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\share_2_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#00000000"
        android:pathData="M9,11.5C9,12.881 7.881,14 6.5,14C5.119,14 4,12.881 4,11.5C4,10.119 5.119,9 6.5,9C7.881,9 9,10.119 9,11.5Z"
        android:strokeWidth="1.5"
        android:strokeColor="@color/mainColor" />
    <path
        android:fillAlpha="0.5"
        android:fillColor="#00000000"
        android:pathData="M14.321,16.802L9,13.29"
        android:strokeWidth="1.5"
        android:strokeAlpha="0.5"
        android:strokeColor="@color/mainColor"
        android:strokeLineCap="round" />
    <path
        android:fillAlpha="0.5"
        android:fillColor="#00000000"
        android:pathData="M14.421,6.84L9.1,10.351"
        android:strokeWidth="1.5"
        android:strokeAlpha="0.5"
        android:strokeColor="@color/mainColor"
        android:strokeLineCap="round" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,18.5C19,19.881 17.881,21 16.5,21C15.119,21 14,19.881 14,18.5C14,17.119 15.119,16 16.5,16C17.881,16 19,17.119 19,18.5Z"
        android:strokeWidth="1.5"
        android:strokeColor="@color/mainColor" />
    <path
        android:fillColor="#00000000"
        android:pathData="M19,5.5C19,6.881 17.881,8 16.5,8C15.119,8 14,6.881 14,5.5C14,4.119 15.119,3 16.5,3C17.881,3 19,4.119 19,5.5Z"
        android:strokeWidth="1.5"
        android:strokeColor="@color/mainColor" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\share_icon.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="@color/mainColor"
        android:fillType="evenOdd"
        android:pathData="M13.803,5.333C13.803,3.492 15.302,2 17.152,2C19.001,2 20.5,3.492 20.5,5.333C20.5,7.174 19.001,8.667 17.152,8.667C16.218,8.667 15.374,8.286 14.767,7.673L10.132,10.83C10.175,11.042 10.197,11.262 10.197,11.487C10.197,11.932 10.109,12.358 9.95,12.746L15.032,16.086C15.609,15.616 16.347,15.333 17.152,15.333C19.001,15.333 20.5,16.826 20.5,18.667C20.5,20.508 19.001,22 17.152,22C15.302,22 13.803,20.508 13.803,18.667C13.803,18.184 13.906,17.726 14.092,17.311L9.05,13.999C8.462,14.51 7.692,14.821 6.848,14.821C4.999,14.821 3.5,13.328 3.5,11.487C3.5,9.646 4.999,8.154 6.848,8.154C7.912,8.154 8.859,8.647 9.471,9.415L13.964,6.356C13.859,6.034 13.803,5.69 13.803,5.333Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\drawable\view_all.xml 
=============================================== 
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="800dp"
    android:height="800dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:fillColor="#727272"
        android:fillType="evenOdd"
        android:pathData="M8.293,4.293C8.683,3.902 9.317,3.902 9.707,4.293L16.707,11.293C17.098,11.683 17.098,12.317 16.707,12.707L9.707,19.707C9.317,20.098 8.683,20.098 8.293,19.707C7.902,19.317 7.902,18.683 8.293,18.293L14.586,12L8.293,5.707C7.902,5.317 7.902,4.683 8.293,4.293Z" />
</vector>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    android:padding="0dp">

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="250dp"
        android:layout_marginBottom="8dp">

        <ImageView
            android:id="@+id/imgBatiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/activity_img_bg"
            android:clipToOutline="true"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="35dp"
            android:layout_height="35dp"
            android:layout_gravity="start|top"
            android:layout_margin="16dp"
            android:background="@drawable/rounded_frame"
            android:gravity="center">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon" />

        </LinearLayout>
    </FrameLayout>

    <!-- ScrollView pour tout le contenu qui déborde -->
    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:paddingHorizontal="15dp">

            <TextView
                android:id="@+id/txtNomBatiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginEnd="20dp"
                android:layout_marginBottom="30dp"
                android:fontFamily="@font/gotham_black"
                android:text="Ecole Polytechnique de Lomé"
                android:textSize="22sp" />

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical">

                <TextView
                    android:id="@+id/descLabel"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="14dp"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Description"
                    android:textSize="18sp"
                    android:textStyle="bold" />

                <TextView
                    android:id="@+id/desc"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_book"
                    android:lineSpacingExtra="3dp"
                    android:text="Situé au niveau du parking juste derrière AUF, la bibliothèque et I'Auditorium de l'université"
                    android:textSize="16sp"
                    android:textStyle="bold" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dp"
                android:orientation="horizontal">

                <ImageView
                    android:layout_width="30dp"
                    android:layout_height="30dp"
                    android:layout_marginEnd="15dp"
                    android:contentDescription="Icône bâtiment"
                    android:src="@drawable/route_icon" />

                <TextView
                    android:id="@+id/txtDistance"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:layout_marginEnd="20dp"
                    android:fontFamily="@font/gotham_book"
                    android:text="200m"
                    android:textSize="16sp" />

                <TextView
                    android:id="@+id/situationBat"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Campus Nord"
                    android:textSize="16sp" />

            </LinearLayout>

            <FrameLayout
                android:id="@+id/imageContainer"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:visibility="gone">

                <androidx.viewpager2.widget.ViewPager2
                    android:id="@+id/imagePager"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipChildren="false"
                    android:clipToOutline="true"
                    android:clipToPadding="false"
                    android:scaleType="fitXY" />

                <com.google.android.material.tabs.TabLayout
                    android:id="@+id/imageIndicator"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center_horizontal"
                    android:layout_marginBottom="-30dp"
                    android:background="@android:color/transparent"
                    app:tabBackground="@drawable/dot_selector"
                    app:tabIndicatorColor="@android:color/transparent"
                    app:tabIndicatorHeight="0dp"
                    app:tabSelectedTextColor="@color/selected_dot_color"
                    app:tabTextColor="@color/unselected_dot_color" />

            </FrameLayout>

            <LinearLayout
                android:id="@+id/miniMapLayout"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginHorizontal="6dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:padding="1dp"
                android:visibility="gone">

                <!-- res/layout/minimap_layout.xml -->
                <org.osmdroid.views.MapView
                    android:id="@+id/miniMap"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipToOutline="true"
                    android:gravity="center"
                    android:scaleType="fitXY" />

            </LinearLayout>

            <LinearLayout
                android:id="@+id/aller"
                android:layout_width="240dp"
                android:layout_height="50dp"
                android:layout_gravity="center"
                android:layout_margin="25dp"
                android:background="@drawable/search_icon_bg"
                android:clickable="true"
                android:gravity="center">

                <ImageView
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="10dp"
                    android:clipToOutline="true"
                    android:src="@drawable/map_loc" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_book"
                    android:text="Aller à l'endroit"
                    android:textColor="@color/white"
                    android:textSize="15sp" />

            </LinearLayout>


        </LinearLayout>

    </ScrollView>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    android:padding="0dp">

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="250dp"
        android:layout_marginBottom="8dp">

        <ImageView
            android:id="@+id/imgInfra"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/activity_img_bg"
            android:clipToOutline="true"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="35dp"
            android:layout_height="35dp"
            android:layout_gravity="start|top"
            android:layout_margin="16dp"
            android:background="@drawable/rounded_frame"
            android:gravity="center">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon" />

        </LinearLayout>
    </FrameLayout>

    <!-- ScrollView pour tout le contenu qui déborde -->
    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:paddingHorizontal="15dp">

            <TextView
                android:id="@+id/txtNomInfra"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginEnd="20dp"
                android:layout_marginBottom="30dp"
                android:fontFamily="@font/gotham_black"
                android:text="Espace Bella Below"
                android:textSize="22sp" />

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical">

                <TextView
                    android:id="@+id/descLabel"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="14dp"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Description"
                    android:textSize="18sp"
                    android:textStyle="bold" />

                <TextView
                    android:id="@+id/desc"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_book"
                    android:lineSpacingExtra="3dp"
                    android:text="Situé au niveau du parking juste derrière AUF, la bibliothèque et I'Auditorium de l'université"
                    android:textSize="16sp"
                    android:textStyle="bold" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dp"
                android:orientation="horizontal">

                <ImageView
                    android:layout_width="30dp"
                    android:layout_height="30dp"
                    android:layout_marginEnd="15dp"
                    android:contentDescription="Icône bâtiment"
                    android:src="@drawable/route_icon" />

                <TextView
                    android:id="@+id/txtDistance"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:layout_marginEnd="20dp"
                    android:fontFamily="@font/gotham_book"
                    android:text="200m"
                    android:textSize="16sp" />

                <TextView
                    android:id="@+id/situationInfra"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Campus Nord"
                    android:textSize="16sp" />

            </LinearLayout>

            <FrameLayout
                android:id="@+id/imageContainer"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:visibility="gone">

                <androidx.viewpager2.widget.ViewPager2
                    android:id="@+id/imagePager"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipChildren="false"
                    android:clipToOutline="true"
                    android:clipToPadding="false"
                    android:scaleType="fitXY" />

                <com.google.android.material.tabs.TabLayout
                    android:id="@+id/imageIndicator"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center_horizontal"
                    android:layout_marginBottom="-30dp"
                    android:background="@android:color/transparent"
                    app:tabBackground="@drawable/dot_selector"
                    app:tabIndicatorColor="@android:color/transparent"
                    app:tabIndicatorHeight="0dp"
                    app:tabSelectedTextColor="@color/selected_dot_color"
                    app:tabTextColor="@color/unselected_dot_color" />

            </FrameLayout>

            <LinearLayout
                android:id="@+id/miniMapLayout"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginHorizontal="6dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:padding="1dp"
                android:visibility="gone">

                <!-- res/layout/minimap_layout.xml -->
                <org.osmdroid.views.MapView
                    android:id="@+id/miniMap"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipToOutline="true"
                    android:gravity="center"
                    android:scaleType="fitXY" />

            </LinearLayout>

            <LinearLayout
                android:id="@+id/aller"
                android:layout_width="240dp"
                android:layout_height="50dp"
                android:layout_gravity="center"
                android:layout_margin="25dp"
                android:background="@drawable/search_icon_bg"
                android:gravity="center">

                <ImageView
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="10dp"
                    android:clipToOutline="true"
                    android:src="@drawable/map_loc" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_book"
                    android:text="Aller à l'endroit"
                    android:textColor="@color/white"
                    android:textSize="15sp" />

            </LinearLayout>

        </LinearLayout>

    </ScrollView>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_main.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<androidx.drawerlayout.widget.DrawerLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/drawer_layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    tools:context=".MainActivity">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@color/white"
        android:orientation="vertical"
        tools:context=".MainActivity">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal">

            <!-- Toolbar fixe en haut -->
            <com.google.android.material.appbar.AppBarLayout
                android:layout_width="80dp"
                android:layout_height="wrap_content"
                android:background="@color/white">

                <androidx.appcompat.widget.Toolbar
                    android:id="@+id/toolbarHome"
                    android:layout_width="80dp"
                    android:layout_height="?attr/actionBarSize"
                    android:background="@color/white"
                    android:gravity="center"
                    app:navigationIcon="@drawable/hamburger_menu" />

            </com.google.android.material.appbar.AppBarLayout>

            <FrameLayout
                android:id="@+id/search_bar_container"
                android:layout_width="match_parent"
                android:layout_height="?attr/actionBarSize"
                android:layout_gravity="center" />

        </LinearLayout>

        <!-- Conteneur pour afficher les fragments -->
        <FrameLayout
            android:id="@+id/container"
            android:layout_width="match_parent"
            android:layout_height="0dp"
            android:layout_weight="5" />

        <!-- Bottom Navigation -->
        <include layout="@layout/custom_bottom_nav" />

    </LinearLayout>

    <com.google.android.material.navigation.NavigationView
        android:id="@+id/nav_view"
        android:layout_width="290dp"
        android:layout_height="match_parent"
        android:layout_gravity="start"
        android:background="@drawable/drawer_nav_bg"
        android:clipChildren="true"
        app:headerLayout="@layout/nav_header"
        app:itemIconSize="30dp"
        app:itemIconTint="@color/logo_color"
        app:itemTextAppearance="@style/NavigationDrawerText"
        app:itemTextColor="@color/logo_color"
        app:menu="@menu/drawer_menu" />

</androidx.drawerlayout.widget.DrawerLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_maps.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".ui.maps.MapsActivity">

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <org.osmdroid.views.MapView
            android:id="@+id/mapView"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            tools:layout_editor_absoluteX="0dp"
            tools:layout_editor_absoluteY="0dp" />

        <ProgressBar
            android:id="@+id/locationProgressBar"
            style="?android:attr/progressBarStyleLarge"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true"
            android:visibility="gone"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_gravity="start|top"
            android:layout_marginHorizontal="16dp"
            android:layout_marginVertical="75dp"
            android:background="@drawable/background_circulaire_2"
            android:gravity="center"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintTop_toTopOf="parent">

            <ImageView
                android:layout_width="30dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon_maps"
                app:tint="@color/black" />

        </LinearLayout>

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/theme_icon"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:background="@drawable/background_circulaire_2"
            android:padding="2dp"
            android:src="@drawable/theme_icon"
            android:visibility="gone"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_location"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/focus_location"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_destination"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/destination"
            app:layout_constraintBottom_toTopOf="@id/focus_location"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/recharger"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire_2"
            android:padding="7dp"
            android:src="@drawable/recharger"
            android:visibility="gone"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/theme_icon" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/hide"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire_2"
            android:padding="3dp"
            android:src="@drawable/no_hide"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/recharger" />

    </androidx.constraintlayout.widget.ConstraintLayout>

</androidx.constraintlayout.widget.ConstraintLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\activity_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/main"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    android:padding="0dp">

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="250dp"
        android:layout_marginBottom="8dp">

        <ImageView
            android:id="@+id/imgSalle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/activity_img_bg"
            android:clipToOutline="true"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

        <LinearLayout
            android:id="@+id/btnRetour"
            android:layout_width="35dp"
            android:layout_height="35dp"
            android:layout_gravity="start|top"
            android:layout_margin="16dp"
            android:background="@drawable/rounded_frame"
            android:gravity="center">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:scaleType="centerInside"
                android:src="@drawable/back_icon" />

        </LinearLayout>
    </FrameLayout>

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:paddingHorizontal="15dp">

            <TextView
                android:id="@+id/txtNomSalle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginEnd="20dp"
                android:layout_marginBottom="30dp"
                android:fontFamily="@font/gotham_black"
                android:text="Espace Bella Below"
                android:textSize="22sp" />

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical">

                <TextView
                    android:id="@+id/descLabel"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="14dp"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Description"
                    android:textSize="18sp"
                    android:textStyle="bold" />

                <TextView
                    android:id="@+id/desc"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ellipsize="end"
                    android:fontFamily="@font/gotham_book"
                    android:lineSpacingExtra="3dp"
                    android:text="Situé au niveau du parking juste derrière AUF, la bibliothèque et I'Auditorium de l'université"
                    android:textSize="16sp"
                    android:textStyle="bold" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dp"
                android:orientation="horizontal">

                <ImageView
                    android:layout_width="30dp"
                    android:layout_height="30dp"
                    android:layout_marginEnd="15dp"
                    android:contentDescription="Icône bâtiment"
                    android:src="@drawable/route_icon" />

                <TextView
                    android:id="@+id/txtDistance"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:layout_marginEnd="20dp"
                    android:fontFamily="@font/gotham_book"
                    android:text="200m"
                    android:textSize="16sp" />

                <TextView
                    android:id="@+id/situationSalle"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_bold"
                    android:text="Campus Nord"
                    android:textSize="16sp" />

            </LinearLayout>

            <FrameLayout
                android:id="@+id/imageContainer"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg">

                <androidx.viewpager2.widget.ViewPager2
                    android:id="@+id/imagePager"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipChildren="false"
                    android:clipToOutline="true"
                    android:clipToPadding="false"
                    android:scaleType="fitXY" />

                <com.google.android.material.tabs.TabLayout
                    android:id="@+id/imageIndicator"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center_horizontal"
                    android:layout_marginBottom="-30dp"
                    android:background="@android:color/transparent"
                    app:tabBackground="@drawable/dot_selector"
                    app:tabIndicatorColor="@android:color/transparent"
                    app:tabIndicatorHeight="0dp"
                    app:tabSelectedTextColor="@color/selected_dot_color"
                    app:tabTextColor="@color/unselected_dot_color" />

            </FrameLayout>

            <LinearLayout
                android:id="@+id/miniMapLayout"
                android:layout_width="match_parent"
                android:layout_height="210dp"
                android:layout_marginHorizontal="6dp"
                android:layout_marginTop="25dp"
                android:background="@drawable/mini_map_bg"
                android:padding="1dp"
                android:visibility="gone">

                <!-- res/layout/minimap_layout.xml -->
                <org.osmdroid.views.MapView
                    android:id="@+id/miniMap"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:background="@drawable/mini_map_bg"
                    android:clipToOutline="true"
                    android:gravity="center"
                    android:scaleType="fitXY" />

            </LinearLayout>


            <LinearLayout
                android:id="@+id/aller"
                android:layout_width="240dp"
                android:layout_height="50dp"
                android:layout_gravity="center"
                android:layout_margin="25dp"
                android:background="@drawable/search_icon_bg"
                android:gravity="center">

                <ImageView
                    android:layout_width="24dp"
                    android:layout_height="24dp"
                    android:layout_marginEnd="10dp"
                    android:clipToOutline="true"
                    android:src="@drawable/map_loc" />

                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_book"
                    android:text="Aller à l'endroit"
                    android:textColor="@color/white"
                    android:textSize="15sp" />

            </LinearLayout>

        </LinearLayout>

    </ScrollView>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\custom_bottom_nav.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/customBottomNav"
    android:layout_width="match_parent"
    android:layout_height="60dp"
    android:layout_marginStart="8dp"
    android:layout_marginTop="5dp"
    android:layout_marginEnd="8dp"
    android:background="@drawable/bottom_nav_background"
    android:gravity="center"
    android:orientation="horizontal"
    android:padding="10dp">

    <LinearLayout
        android:id="@+id/container_home"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <!-- Item Accueil -->
        <LinearLayout
            android:id="@+id/nav_home"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_home"
                android:layout_width="17dp"
                android:layout_height="22dp"
                android:src="@drawable/home_icon"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_home"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="80dp"
                android:text="@string/accueil"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:id="@+id/container_batiment"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <LinearLayout
            android:id="@+id/nav_batiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_batiment"
                android:layout_width="22dp"
                android:layout_height="22dp"
                android:src="@drawable/batiment_nav_icon"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_batiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="100dp"
                android:paddingStart="8dp"
                android:text="@string/batiments"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:id="@+id/container_salle"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <LinearLayout
            android:id="@+id/nav_salle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_salle"
                android:layout_width="22dp"
                android:layout_height="22dp"
                android:src="@drawable/infra_nav_icon"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_salle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="60dp"
                android:paddingStart="8dp"
                android:text="@string/infrastructures"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:id="@+id/container_maps"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal">

        <LinearLayout
            android:id="@+id/nav_maps"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/nav_item_bg"
            android:gravity="center"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/icon_maps"
                android:layout_width="22dp"
                android:layout_height="22dp"
                android:src="@drawable/map_loc"
                app:tint="@color/mainColor" />

            <TextView
                android:id="@+id/text_maps"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:gravity="center"
                android:minWidth="60dp"
                android:paddingStart="8dp"
                android:text="@string/carte"
                android:textColor="@color/mainColor"
                android:textSize="13sp"
                android:textStyle="bold"
                android:visibility="gone" />
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_all_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.batiment.AllBatimentFragment">

    <include
        android:id="@+id/shimmerAllBatiments"
        layout="@layout/shimmer_all_bat_container" />

    <!-- Liste horizontale des bâtiments -->
    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllBatiments"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_all_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.infrastructure.AllInfraFragment">

    <include
        android:id="@+id/shimmerAllInfra"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllInfra"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    tools:context=".ui.batiment.BatimentFragment">

    <!-- Barre de navigation horizontale -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="horizontal"
        android:padding="16dp">

        <LinearLayout
            android:id="@+id/nav_all"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="28dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="Tout"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_all"
                android:layout_width="38dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_nord"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="32dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="Campus Nord"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_nord"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_sud"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="Campus Sud"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_sud"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>
    </LinearLayout>

    <FrameLayout
        android:id="@+id/batiment_container"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_home.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<androidx.core.widget.NestedScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:layout_behavior="@string/appbar_scrolling_view_behavior"
    tools:context=".ui.home.HomeFragment">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:paddingVertical="16dp"
        android:paddingStart="16dp"
        android:paddingEnd="8dp">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/batiments_d_enseignement"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerBatimentsEnsContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerBatiments"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_batiment" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="25dp"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/batiment_administratifs"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerBatimentsAdminContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerBatimentsAdmin"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_batiment" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="25dp"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/salles"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerSalleContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerSalles"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_salle" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="25dp"
            android:layout_marginBottom="20dp"
            android:fontFamily="@font/gotham_medium"
            android:text="@string/autres_infrastructures"
            android:textColor="@color/mainColor"
            android:textSize="24sp"
            android:textStyle="bold" />

        <include
            android:id="@+id/shimmerInfraContainer"
            layout="@layout/shimmer_batiments_container" />

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recyclerInfra"
            android:layout_width="match_parent"
            android:layout_height="125dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:visibility="gone"
            tools:listitem="@layout/item_infra" />

    </LinearLayout>

</androidx.core.widget.NestedScrollView> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/white"
    android:orientation="vertical"
    tools:context=".ui.infrastructure.InfraFragment">

    <!-- Barre de navigation horizontale -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="horizontal"
        android:padding="16dp">

        <LinearLayout
            android:id="@+id/nav_all"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="28dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="@string/tout"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_all"
                android:layout_width="38dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_nord"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginEnd="32dp"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="@string/campus_nord"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_nord"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/nav_sud"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical">

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_medium"
                android:text="@string/campus_sud"
                android:textSize="16sp" />

            <View
                android:id="@+id/indicator_sud"
                android:layout_width="55dp"
                android:layout_height="5dp"
                android:layout_gravity="center"
                android:layout_marginTop="4dp"
                android:background="@drawable/indicator_bg"
                android:visibility="invisible" />
        </LinearLayout>
    </LinearLayout>

    <FrameLayout
        android:id="@+id/infra_container"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_loc_ul.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="48dp"
    android:layout_gravity="center"
    android:layout_marginHorizontal="8dp"
    android:background="@drawable/search_background"
    android:gravity="center"
    android:orientation="horizontal">

    <de.hdodenhof.circleimageview.CircleImageView
        android:layout_width="35dp"
        android:layout_height="35dp"
        android:layout_margin="5dp"
        android:src="@drawable/loc_ul" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="LocUL"
        android:textColor="@color/mainColor"
        android:textSize="20sp"
        android:textStyle="bold" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_logo.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="48dp"
    android:layout_gravity="center"
    android:layout_marginTop="5dp"
    android:gravity="end"
    android:orientation="horizontal"
    android:paddingEnd="0dp">

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"

        android:paddingHorizontal="10dp">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginEnd="13dp"
            android:fontFamily="@font/gotham_black"
            android:text="LocUL"
            android:textColor="@color/logo_color"
            android:textSize="25sp"
            android:textStyle="bold" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:layout_width="38dp"
            android:layout_height="38dp"
            android:layout_gravity="center"
            android:layout_margin="5dp"
            android:src="@drawable/loc_ul" />

    </LinearLayout>

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_maps.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".ui.maps.MapsFragment">

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent">

        <org.osmdroid.views.MapView
            android:id="@+id/mapView"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            tools:layout_editor_absoluteX="0dp"
            tools:layout_editor_absoluteY="0dp" />

        <ProgressBar
            android:id="@+id/locationProgressBar"
            style="?android:attr/progressBarStyleLarge"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true"
            android:visibility="gone"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />


        <LinearLayout
            android:id="@+id/destination_layout"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginVertical="63dp"
            android:layout_marginRight="150dp"
            android:background="@drawable/maps_destination_remove"
            android:gravity="center"
            android:orientation="horizontal"
            android:visibility="invisible"
            app:layout_constraintLeft_toLeftOf="parent"
            app:layout_constraintTop_toTopOf="parent">

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_weight="0.9"
                android:background="@drawable/maps_destination"
                android:gravity="center"
                android:orientation="vertical"
                android:padding="5dp"
                app:layout_constraintLeft_toLeftOf="parent"
                app:layout_constraintTop_toTopOf="parent">

                <TextView
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:fontFamily="@font/gotham_medium"
                    android:gravity="center"
                    android:text="Nouvelle destination ?"
                    android:textColor="@color/mainColor"
                    android:textStyle="bold" />

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:gravity="center"
                    android:orientation="horizontal">

                    <TextView
                        android:id="@+id/destination_text"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_margin="3dp"
                        android:layout_weight="0.9"
                        android:ellipsize="end"
                        android:fontFamily="@font/gotham_medium"
                        android:gravity="center"
                        android:lines="2"
                        android:maxLines="2"
                        android:text="Nouvelle destination ?"
                        android:textColor="@color/mainColor" />

                    <LinearLayout
                        android:id="@+id/btnRetour"
                        android:layout_width="35dp"
                        android:layout_height="35dp"
                        android:layout_gravity="start|top"
                        android:layout_weight="0.1"
                        android:gravity="center">

                        <ImageView
                            android:id="@+id/valider"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                            android:background="?attr/selectableItemBackgroundBorderless"
                            android:scaleType="centerInside"
                            android:src="@drawable/valider" />

                    </LinearLayout>
                </LinearLayout>
            </LinearLayout>

            <LinearLayout
                android:id="@+id/annuler"
                android:layout_width="14dp"
                android:layout_height="match_parent"
                android:layout_gravity="start|top"
                android:gravity="center">

                <ImageView
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:scaleType="centerInside"
                    android:src="@drawable/back_icon"
                    app:tint="@color/black" />

            </LinearLayout>

        </LinearLayout>

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/theme_icon"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:background="@drawable/background_circulaire"
            android:padding="2dp"
            android:src="@drawable/theme_icon"
            android:visibility="gone"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toTopOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_location"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/focus_location"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/focus_destination"
            android:layout_width="40dp"
            android:layout_height="40dp"
            android:layout_margin="15dp"
            android:background="@android:color/transparent"
            android:src="@drawable/destination"
            app:layout_constraintBottom_toTopOf="@id/focus_location"
            app:layout_constraintRight_toRightOf="parent" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/recharger"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire"
            android:padding="7dp"
            android:src="@drawable/recharger"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/theme_icon" />

        <de.hdodenhof.circleimageview.CircleImageView
            android:id="@+id/hide"
            android:layout_width="42dp"
            android:layout_height="42dp"
            android:layout_margin="15dp"
            android:layout_marginTop="70dp"
            android:background="@drawable/background_circulaire"
            android:padding="3dp"
            android:src="@drawable/hide"
            app:layout_constraintRight_toRightOf="parent"
            app:layout_constraintTop_toBottomOf="@id/recharger" />

    </androidx.constraintlayout.widget.ConstraintLayout>
</FrameLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_nord_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.batiment.NordBatimentFragment">

    <include
        android:id="@+id/shimmerNordBatiments"
        layout="@layout/shimmer_all_bat_container" />

    <!-- Liste horizontale des bâtiments -->
    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerNordBatiments"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_nord_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.infrastructure.NordInfraFragment">

    <include
        android:id="@+id/shimmerNordInfra"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerNordInfra"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_search_bar.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="44dp"
    android:layout_gravity="center"
    android:layout_marginHorizontal="8dp"
    android:layout_marginTop="5dp"
    android:background="@drawable/search_background"
    android:gravity="center_vertical"
    android:orientation="horizontal">

    <EditText
        android:id="@+id/search_edit_text"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_marginHorizontal="5dp"
        android:layout_weight="1"
        android:background="@null"
        android:hint="Recherche..."
        android:imeOptions="actionSearch"
        android:paddingStart="10dp"
        android:singleLine="true"
        android:textColor="@color/black"
        android:textColorHint="#A0A0A0"
        android:textSize="15sp" />

    <LinearLayout
        android:layout_width="44dp"
        android:layout_height="44dp"
        android:background="@drawable/search_icon_bg"
        android:gravity="center"
        android:orientation="horizontal">

        <ImageView
            android:id="@+id/searchIcon"
            android:layout_width="24dp"
            android:layout_height="24dp"
            android:contentDescription="Search"
            android:src="@drawable/search_icon" />

    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_sud_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.batiment.SudBatimentFragment">

    <include
        android:id="@+id/shimmerSudBatiments"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerSudBatiments"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_sud_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    tools:context=".ui.infrastructure.SudInfraFragment">

    <include
        android:id="@+id/shimmerSudInfra"
        layout="@layout/shimmer_all_bat_container" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerSudInfra"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        android:visibility="gone"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_bat_admin.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllBatAdminFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllBatimentsAdmin"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_bat_ens.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllBatEnsFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllBatimentsEns"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_batiment" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllInfraFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllInfraHome"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_infra" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\fragment_view_all_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical"
    android:paddingHorizontal="16dp"
    android:paddingTop="15dp"
    tools:context=".ui.home.ViewAllSalleFragment">

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerAllSalle"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:overScrollMode="never"
        tools:listitem="@layout/item_all_salle" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_all_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <!-- Icône du bâtiment -->
    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgBatiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomBatiment"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Bâtiment"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationBat"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:src="@drawable/route_icon" />

            <TextView
                android:id="@+id/txtDistanceBatiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="500m"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_all_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgInfra"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Infra"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:contentDescription="Icône bâtiment"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceInfra"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_all_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <!-- Icône de la salle -->
    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgSalle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <!-- Bloc nom + distance -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <!-- Nom de la salle -->
        <TextView
            android:id="@+id/txtNomSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:maxLines="1"
            android:text="Nom Salle"
            android:textSize="15sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/situationSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp"
            android:visibility="gone" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="8dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/batimentSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_horizontal"
            android:maxLines="2"
            android:text="EPL (Ecole Polytechnique de Lome---)"
            android:textSize="13sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="10dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:contentDescription="Icône bâtiment"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceSalle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgBatiment"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomBatiment"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Bâtiment"
            android:textSize="15sp"
            android:textStyle="bold" />

        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationBat"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:src="@drawable/route_icon" />

            <TextView
                android:id="@+id/txtDistanceBatiment"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="500m"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_infra.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="8dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgInfra"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <!-- Bloc nom + distance -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:gravity="center_vertical"
            android:lines="2"
            android:maxLines="2"
            android:text="Nom Infra"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="8dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/situationInfra"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="14dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceInfra"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_salle.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="8dp"
        android:background="@drawable/rounded_frame">

        <ImageView
            android:id="@+id/imgSalle"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY"
            android:src="@drawable/img" />

    </LinearLayout>

    <!-- Bloc nom + distance -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <TextView
            android:id="@+id/txtNomSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="7dp"
            android:layout_marginBottom="7dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:maxLines="1"
            android:text="Nom Salle"
            android:textSize="15sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/situationSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:fontFamily="@font/gotham_book"
            android:text="Campus Nord"
            android:textSize="14sp"
            android:visibility="gone" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="8dp"
            android:background="@android:color/darker_gray" />

        <TextView
            android:id="@+id/batimentSalle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="2dp"
            android:ellipsize="end"
            android:fontFamily="@font/gotham_book"
            android:maxLines="2"
            android:text="Batiment A"
            android:textSize="13sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <ImageView
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:contentDescription="Icône bâtiment"
                android:src="@drawable/route_icon" />

            <!-- Distance -->
            <TextView
                android:id="@+id/txtDistanceSalle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:fontFamily="@font/gotham_book"
                android:text="200m"
                android:textSize="13sp" />

        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\item_voir_tout.xml 
=============================================== 
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="125dp"
    android:layout_marginStart="-7dp"
    android:gravity="center">

    <ImageView
        android:id="@+id/imgVoirTout"
        android:layout_width="75dp"
        android:layout_height="75dp"
        android:layout_gravity="center"
        android:src="@drawable/view_all" />
</FrameLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\nav_header.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="176dp"
    android:background="@drawable/header_nav_bg"
    android:gravity="center_vertical"
    android:orientation="vertical"
    android:padding="16dp"
    android:theme="@style/ThemeOverlay.AppCompat.Dark">


    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:fontFamily="@font/gotham_bold"
        android:paddingTop="8dp"
        android:text="LocUL"
        android:textAppearance="@style/TextAppearance.AppCompat.Body1"
        android:textSize="25sp"
        android:textStyle="bold" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:fontFamily="@font/gotham_book"
        android:text="@string/app_desc" />

</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\settings.xml 
=============================================== 
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/rounded_frame"
    android:paddingLeft="16dp"
    android:paddingTop="16dp"
    android:paddingRight="16dp"
    android:paddingBottom="10dp">

    <TextView
        android:id="@+id/title"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:fontFamily="@font/gotham_book"
        android:gravity="center"
        android:paddingBottom="25dp"
        android:text="@string/reglages"
        android:textColor="@color/black"
        android:textSize="18sp"
        android:textStyle="bold" />

    <TextView
        android:id="@+id/languageLabel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/title"
        android:layout_alignParentStart="true"
        android:layout_marginEnd="20dp"
        android:layout_marginBottom="10dp"
        android:fontFamily="@font/gotham_medium"
        android:text="@string/langage"
        android:textColor="@color/black"
        android:textSize="16sp"
        android:textStyle="bold" />

    <Spinner
        android:id="@+id/languageSpinner"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/title"
        android:layout_alignBaseline="@id/languageLabel"
        android:layout_alignParentEnd="true"
        android:layout_marginTop="16dp"
        android:layout_toEndOf="@id/languageLabel"
        android:fontFamily="@font/gotham_book"
        android:textColor="@color/black" />

    <TextView
        android:id="@+id/themeLabel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/languageLabel"
        android:layout_alignParentStart="true"
        android:layout_marginTop="16dp"
        android:layout_marginEnd="20dp"
        android:layout_marginBottom="10dp"
        android:fontFamily="@font/gotham_medium"
        android:text="@string/theme"
        android:textColor="@color/black"
        android:textSize="16sp"
        android:textStyle="bold" />

    <Spinner
        android:id="@+id/themeSpinner"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/languageLabel"
        android:layout_alignBaseline="@id/themeLabel"
        android:layout_alignParentEnd="true"
        android:layout_marginTop="16dp"
        android:layout_toEndOf="@id/themeLabel"
        android:fontFamily="@font/gotham_book"
        android:textColor="@color/black" />

    <Button
        android:id="@+id/appliquer"
        android:layout_width="120dp"
        android:layout_height="wrap_content"
        android:layout_alignParentEnd="true"
        android:layout_alignParentBottom="true"
        android:layout_marginTop="10dp"
        android:fontFamily="@font/gotham_book"
        android:text="@string/appliquer"
        android:textColor="@color/white" />
</RelativeLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_all_bat_container.xml 
=============================================== 
<com.facebook.shimmer.ShimmerFrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/shimmerBatimentsEns"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:shimmer_auto_start="true"
    app:shimmer_duration="800">

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scrollbars="none">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical">

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

            <include layout="@layout/shimmer_item_all_batiment" />

        </LinearLayout>
    </ScrollView>
</com.facebook.shimmer.ShimmerFrameLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_batiments_container.xml 
=============================================== 
<com.facebook.shimmer.ShimmerFrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/shimmerBatimentsEns"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:shimmer_auto_start="true"
    app:shimmer_duration="800">

    <HorizontalScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scrollbars="none">

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="horizontal">

            <include layout="@layout/shimmer_item_batiment" />

            <include layout="@layout/shimmer_item_batiment" />

            <include layout="@layout/shimmer_item_batiment" />

            <include layout="@layout/shimmer_item_batiment" />

        </LinearLayout>
    </HorizontalScrollView>
</com.facebook.shimmer.ShimmerFrameLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_item_all_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="115dp"
    android:layout_gravity="center"
    android:layout_marginBottom="20dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <!-- Icône du bâtiment -->
    <LinearLayout
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <View
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <View
            android:layout_width="match_parent"
            android:layout_height="30dp"
            android:layout_gravity="center"
            android:layout_marginTop="2dp"
            android:layout_marginBottom="5dp"
            android:background="@color/shimmer_placeholder_color"
            android:ellipsize="end"
            android:gravity="center_vertical"
            android:textSize="15sp"
            android:textStyle="bold" />

        <!-- Ligne de séparation -->
        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="6dp"
            android:background="@android:color/darker_gray" />

        <View
            android:layout_width="120dp"
            android:layout_height="20dp"
            android:background="@color/shimmer_placeholder_color"
            android:fontFamily="@font/gotham_book"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_marginTop="12dp"
            android:orientation="horizontal">

            <View
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:background="@color/shimmer_placeholder_color" />

            <View
                android:layout_width="60dp"
                android:layout_height="16dp"
                android:background="@color/shimmer_placeholder_color"
                android:fontFamily="@font/gotham_book"
                android:textSize="13sp" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\shimmer_item_batiment.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="300dp"
    android:layout_height="match_parent"
    android:layout_marginEnd="10dp"
    android:background="@drawable/rounded_frame"
    android:orientation="horizontal"
    android:padding="3dp"
    android:paddingEnd="6dp">

    <LinearLayout
        android:layout_width="150dp"
        android:layout_height="match_parent"
        android:layout_marginEnd="10dp"
        android:background="@drawable/rounded_frame">

        <View
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="@drawable/img_backgroung"
            android:clipToOutline="true"
            android:gravity="center"
            android:scaleType="fitXY" />

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <View
            android:layout_width="120dp"
            android:layout_height="20dp"
            android:layout_gravity="center"
            android:layout_marginTop="10dp"
            android:layout_marginBottom="10dp"
            android:background="@color/shimmer_placeholder_color" />

        <View
            android:layout_width="match_parent"
            android:layout_height="2dp"
            android:layout_gravity="center"
            android:layout_marginEnd="5dp"
            android:layout_marginBottom="10dp"
            android:background="@android:color/darker_gray" />

        <View
            android:layout_width="100dp"
            android:layout_height="16dp"
            android:layout_marginBottom="15dp"
            android:background="@color/shimmer_placeholder_color" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal">

            <View
                android:layout_width="25dp"
                android:layout_height="25dp"
                android:layout_marginEnd="15dp"
                android:background="@color/shimmer_placeholder_color" />

            <View
                android:layout_width="60dp"
                android:layout_height="16dp"
                android:background="@color/shimmer_placeholder_color" />

        </LinearLayout>

    </LinearLayout>
</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\spinner_item.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/text1"
    style="?android:attr/spinnerItemStyle"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ellipsize="marquee"
    android:fontFamily="@font/gotham_book"
    android:singleLine="true"
    android:textAlignment="inherit"
    android:textColor="@color/black" /> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\layout\test.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:background="@drawable/search_icon_bg"
    android:gravity="center"
    android:orientation="horizontal">

    <ImageView
        android:id="@+id/searchIcon"
        android:layout_width="24dp"
        android:layout_height="24dp"
        android:contentDescription="Search"
        android:src="@drawable/search_icon" />


</LinearLayout> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\menu\bottom_nav_menu.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">

    <item
        android:id="@+id/nav_home"
        android:icon="@drawable/home_icon"
        android:title="Accueil" />

    <item
        android:id="@+id/nav_batiment"
        android:icon="@drawable/batiment_nav_icon"
        android:title="Batiments" />

    <item
        android:id="@+id/nav_salle"
        android:icon="@drawable/salle_nav_icon"
        android:title="Infrastructures" />

    <item
        android:id="@+id/nav_maps"
        android:icon="@drawable/salle_nav_icon"
        android:title="maps" />

</menu> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\menu\bouton_nav_menu.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item
        android:id="@+id/nav_home"
        android:icon="@drawable/home"
        android:textStyle="bold"
        android:title="Home" />
    <item
        android:id="@+id/nav_maps"
        android:icon="@drawable/maps_and_flags"
        android:textStyle="bold"
        android:title="Maps" />
</menu> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\menu\drawer_menu.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">

    <group android:id="@+id/group1">
        <item
            android:id="@+id/settings"
            android:icon="@drawable/settings_icon"
            android:title="Reglages" />
    </group>

    <group android:id="@+id/group2">
        <item
            android:id="@+id/share"
            android:icon="@drawable/share_2_icon"
            android:title="Partager" />
    </group>

    <group android:id="@+id/group3">
        <item
            android:id="@+id/contact"
            android:icon="@drawable/contact_icon"
            android:title="Contact" />
    </group>

    <group android:id="@+id/group4">
        <item
            android:id="@+id/about"
            android:icon="@drawable/about_icon"
            android:title="A propos" />
    </group>

</menu> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\ic_launcher.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
    <monochrome android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\ic_launcher_round.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@drawable/ic_launcher_background" />
    <foreground android:drawable="@drawable/ic_launcher_foreground" />
    <monochrome android:drawable="@drawable/ic_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\loc_ul_launcher.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@mipmap/loc_ul_launcher_background" />
    <foreground android:drawable="@mipmap/loc_ul_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\mipmap-anydpi-v26\loc_ul_launcher_round.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@mipmap/loc_ul_launcher_background" />
    <foreground android:drawable="@mipmap/loc_ul_launcher_foreground" />
</adaptive-icon> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\colors.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="black">#FF000000</color>
    <color name="white">#FFFFFFFF</color>
    <color name="bottom_nav_default">#F0E9F6</color>
    <color name="bottom_nav_default_item">#E6DEF6</color>
    <color name="red">#D7FF0000</color>
    <color name="gray">#808080</color>
    <color name="mainColor">#1F3563</color>
    <color name="selected_dot_color">@color/white</color>
    <color name="unselected_dot_color">#B0B0B0</color>
    <color name="shimmer_placeholder_color">#DDDDDD</color>
    <color name="shimmer_highlight_color">#EEEEEE</color>
    <color name="logo_color">#1F3563</color>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\dimens.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <dimen name="custom_dot_width">10dp</dimen>
    <dimen name="custom_dot_height">10dp</dimen>
    <dimen name="custom_dot_margin_horizontal">4dp</dimen>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\strings.xml 
=============================================== 
<resources>
    <string name="app_name">LocUL</string>
    <!-- TODO: Remove or change this placeholder text -->
    <string name="hello_blank_fragment">Hello blank fragment</string>
    <string name="navigation_drawer_open">Ouvrir le menu de navigation</string>
    <string name="navigation_drawer_close">Fermer le menu de navigation</string>
    <string name="francais">Français</string>
    <string name="anglais">Anglais</string>
    <string name="clair">Clair</string>
    <string name="sombre">Sombre</string>
    <string name="systeme">Système</string>
    <string name="infrastructures">Infrastructures</string>
    <string name="accueil">Accueil</string>
    <string name="carte">Carte</string>
    <string name="batiments_d_enseignement">Bâtiments d\'enseignement</string>
    <string name="batiment_administratifs">Bâtiments administratifs</string>
    <string name="batiments">Bâtiments</string>
    <string name="salles">Salles</string>
    <string name="autres_infrastructures">Autres infrastructures</string>
    <string name="tout">Tout</string>
    <string name="campus_nord">Campus Nord</string>
    <string name="campus_sud">Campus Sud</string>
    <string name="reglages">Réglages</string>
    <string name="langage">Langage</string>
    <string name="theme">Thème</string>
    <string name="appliquer">Appliquer</string>
    <string name="recherche">Recherche...</string>
    <string name="app_desc">Repérer vous à l\'Université de Lomé</string>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values\themes.xml 
=============================================== 
<resources>
    <!-- Base application theme. -->
    <style name="Base.Theme.LocUL" parent="Theme.Material3.DayNight.NoActionBar">
        <!-- Customize your light theme here. -->
        <!-- <item name="colorPrimary">@color/my_light_primary</item> -->
        <item name="colorPrimary">@color/mainColor</item>
    </style>

    <style name="NavigationDrawerText">
        <item name="android:fontFamily">@font/gotham_medium</item>
        <item name="android:textSize">16sp</item>
    </style>

    <style name="NavigationDrawerItemStyle">
        <item name="android:layout_marginTop">5dp</item>
        <item name="android:layout_marginBottom">5dp</item>
    </style>

    <style name="CustomTabDots" parent="Widget.Design.TabLayout">
        <item name="tabIndicatorHeight">0dp</item>
        <item name="tabPaddingStart">6dp</item>
        <item name="tabPaddingEnd">6dp</item>
        <item name="tabMinWidth">8dp</item>
    </style>

    <style name="Theme.LocUL" parent="Base.Theme.LocUL" />
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values-en\strings.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name">LocUL</string>
    <!-- TODO: Remove or change this placeholder text -->
    <string name="hello_blank_fragment">Hello blank fragment</string>
    <string name="navigation_drawer_open">Open navigation menu</string>
    <string name="navigation_drawer_close">Close navigation menu</string>
    <string name="francais">French</string>
    <string name="anglais">English</string>
    <string name="clair">Light</string>
    <string name="sombre">Dark</string>
    <string name="systeme">System</string>
    <string name="infrastructures">Facilities</string>
    <string name="accueil">Home</string>
    <string name="carte">Map</string>
    <string name="batiments_d_enseignement">Teaching buildings</string>
    <string name="batiment_administratifs">Administrative buildings</string>
    <string name="batiments">Buildings</string>
    <string name="salles">Rooms</string>
    <string name="autres_infrastructures">Other facilities</string>
    <string name="tout">All</string>
    <string name="campus_nord">North Campus</string>
    <string name="campus_sud">South Campus</string>
    <string name="reglages">Settings</string>
    <string name="langage">Language</string>
    <string name="theme">Theme</string>
    <string name="appliquer">Apply</string>
    <string name="recherche">Search...</string>
    <string name="app_desc">Find your way at the University of Lomé</string>
</resources>
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values-night\colors.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="white">#282828</color>
    <color name="mainColor">#437FF6</color>
    <color name="black">#E0E0E0</color>
    <color name="bottom_nav_default">#333333</color>
    <color name="bottom_nav_default_item">#3A3A3A</color>
    <color name="gray">#606060</color>
    <color name="selected_dot_color">#FFFFFF</color>
    <color name="unselected_dot_color">#B0B0B0</color>
    <color name="shimmer_placeholder_color">#2D2D2D</color>
    <color name="shimmer_highlight_color">#3D3D3D</color>
    <color name="logo_color">#E0E0E0</color>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\values-night\themes.xml 
=============================================== 
<resources>
    <!-- Base application theme. -->
    <style name="Base.Theme.LocUL.Dark" parent="Theme.Material3.DayNight.NoActionBar">
        <item name="colorPrimary">@color/mainColor</item>
    </style>

    <style name="Theme.LocUL" parent="Base.Theme.LocUL.Dark">
        <item name="colorPrimary">@color/mainColor</item>
    </style>
</resources> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\xml\backup_rules.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?><!--
   Sample backup rules file; uncomment and customize as necessary.
   See https://developer.android.com/guide/topics/data/autobackup
   for details.
   Note: This file is ignored for devices older than API 31
   See https://developer.android.com/about/versions/12/backup-restore
-->
<full-backup-content>
    <!--
   <include domain="sharedpref" path="."/>
   <exclude domain="sharedpref" path="device.xml"/>
-->
</full-backup-content> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\xml\data_extraction_rules.xml 
=============================================== 
<?xml version="1.0" encoding="utf-8"?><!--
   Sample data extraction rules file; uncomment and customize as necessary.
   See https://developer.android.com/about/versions/12/backup-restore#xml-changes
   for details.
-->
<data-extraction-rules>
    <cloud-backup>
        <!-- TODO: Use <include> and <exclude> to control what is backed up.
        <include .../>
        <exclude .../>
        -->
    </cloud-backup>
    <!--
    <device-transfer>
        <include .../>
        <exclude .../>
    </device-transfer>
    -->
</data-extraction-rules> 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\google-services.json 
=============================================== 
{
  "project_info": {
    "project_number": "599549183484",
    "project_id": "admin-site-4b122",
    "storage_bucket": "admin-site-4b122.firebasestorage.app"
  },
  "client": [
    {
      "client_info": {
        "mobilesdk_app_id": "1:599549183484:android:1bf3fd4bddd275a0d6de79",
        "android_client_info": {
          "package_name": "tg.univlome.epl"
        }
      },
      "oauth_client": [],
      "api_key": [
        {
          "current_key": "AIzaSyBPpQo7PtM8e0eY3HU3205XOOdg2S4kOeE"
        }
      ],
      "services": {
        "appinvite_service": {
          "other_platform_oauth_client": []
        }
      }
    }
  ],
  "configuration_version": "1"
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\main\res\raw\loading_animation.json 
=============================================== 
{
  "v": "5.5.8",
  "fr": 50,
  "ip": 0,
  "op": 147,
  "w": 800,
  "h": 600,
  "nm": "Paperplane",
  "ddd": 0,
  "assets": [
    {
      "id": "comp_0",
      "layers": [
        {
          "ddd": 0,
          "ind": 1,
          "ty": 4,
          "nm": "planete Outlines - Group 4",
          "sr": 1,
          "ks": {
            "o": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": [
                      0.833
                    ],
                    "y": [
                      0.833
                    ]
                  },
                  "o": {
                    "x": [
                      0.167
                    ],
                    "y": [
                      0.167
                    ]
                  },
                  "t": 0,
                  "s": [
                    0
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.833
                    ],
                    "y": [
                      0.833
                    ]
                  },
                  "o": {
                    "x": [
                      0.167
                    ],
                    "y": [
                      0.167
                    ]
                  },
                  "t": 38,
                  "s": [
                    50
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.833
                    ],
                    "y": [
                      0.833
                    ]
                  },
                  "o": {
                    "x": [
                      0.167
                    ],
                    "y": [
                      0.167
                    ]
                  },
                  "t": 88,
                  "s": [
                    50
                  ]
                },
                {
                  "t": 120,
                  "s": [
                    0
                  ]
                }
              ],
              "ix": 11
            },
            "r": {
              "a": 0,
              "k": 0,
              "ix": 10
            },
            "p": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": 0.833,
                    "y": 0.833
                  },
                  "o": {
                    "x": 0.167,
                    "y": 0.167
                  },
                  "t": 0,
                  "s": [
                    468.336,
                    323.378,
                    0
                  ],
                  "to": [
                    -29,
                    0,
                    0
                  ],
                  "ti": [
                    29,
                    0,
                    0
                  ]
                },
                {
                  "t": 102,
                  "s": [
                    294.336,
                    323.378,
                    0
                  ]
                }
              ],
              "ix": 2
            },
            "a": {
              "a": 0,
              "k": [
                453.672,
                304.756,
                0
              ],
              "ix": 1
            },
            "s": {
              "a": 0,
              "k": [
                50,
                50,
                100
              ],
              "ix": 6
            }
          },
          "ao": 0,
          "shapes": [
            {
              "ty": "gr",
              "it": [
                {
                  "ind": 0,
                  "ty": "sh",
                  "ix": 1,
                  "ks": {
                    "a": 0,
                    "k": {
                      "i": [
                        [
                          6.742,
                          0
                        ],
                        [
                          0.741,
                          -0.14
                        ],
                        [
                          0,
                          0.074
                        ],
                        [
                          13.484,
                          0
                        ],
                        [
                          1.669,
                          -0.361
                        ],
                        [
                          19.79,
                          0
                        ],
                        [
                          3.317,
                          -19.082
                        ],
                        [
                          2.691,
                          0
                        ],
                        [
                          0,
                          -13.484
                        ],
                        [
                          -0.048,
                          -0.629
                        ],
                        [
                          2.405,
                          0
                        ],
                        [
                          0,
                          -6.742
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          0,
                          6.743
                        ]
                      ],
                      "o": [
                        [
                          -0.781,
                          0
                        ],
                        [
                          0.001,
                          -0.074
                        ],
                        [
                          0,
                          -13.484
                        ],
                        [
                          -1.778,
                          0
                        ],
                        [
                          -3.594,
                          -18.742
                        ],
                        [
                          -20.03,
                          0
                        ],
                        [
                          -2.421,
                          -0.804
                        ],
                        [
                          -13.485,
                          0
                        ],
                        [
                          0,
                          0.642
                        ],
                        [
                          -1.89,
                          -1.199
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          6.743
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          6.742,
                          0
                        ],
                        [
                          0,
                          -6.742
                        ]
                      ],
                      "v": [
                        [
                          75.134,
                          16.175
                        ],
                        [
                          72.85,
                          16.396
                        ],
                        [
                          72.856,
                          16.175
                        ],
                        [
                          48.44,
                          -8.241
                        ],
                        [
                          43.262,
                          -7.685
                        ],
                        [
                          3.406,
                          -40.591
                        ],
                        [
                          -36.571,
                          -6.995
                        ],
                        [
                          -44.269,
                          -8.241
                        ],
                        [
                          -68.685,
                          16.175
                        ],
                        [
                          -68.604,
                          18.079
                        ],
                        [
                          -75.133,
                          16.175
                        ],
                        [
                          -87.341,
                          28.383
                        ],
                        [
                          -75.133,
                          40.592
                        ],
                        [
                          75.134,
                          40.592
                        ],
                        [
                          87.342,
                          28.383
                        ]
                      ],
                      "c": true
                    },
                    "ix": 2
                  },
                  "nm": "Path 1",
                  "mn": "ADBE Vector Shape - Group",
                  "hd": false
                },
                {
                  "ty": "fl",
                  "c": {
                    "a": 0,
                    "k": [
                      0.815686334348,
                      0.823529471603,
                      0.827451040231,
                      1
                    ],
                    "ix": 4
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 5
                  },
                  "r": 1,
                  "bm": 0,
                  "nm": "Fill 1",
                  "mn": "ADBE Vector Graphic - Fill",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      453.672,
                      304.756
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      0,
                      0
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      100,
                      100
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "Group 4",
              "np": 2,
              "cix": 2,
              "bm": 0,
              "ix": 1,
              "mn": "ADBE Vector Group",
              "hd": false
            }
          ],
          "ip": 0,
          "op": 151,
          "st": 0,
          "bm": 0
        },
        {
          "ddd": 0,
          "ind": 2,
          "ty": 4,
          "nm": "Merged Shape Layer",
          "sr": 1,
          "ks": {
            "o": {
              "a": 0,
              "k": 100,
              "ix": 11
            },
            "r": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.547
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 0,
                  "s": [
                    0
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.845
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 77,
                  "s": [
                    35
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    0
                  ]
                }
              ],
              "ix": 10
            },
            "p": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": 0.667,
                    "y": 1
                  },
                  "o": {
                    "x": 0.333,
                    "y": 0
                  },
                  "t": 0,
                  "s": [
                    390.319,
                    298.2,
                    0
                  ],
                  "to": [
                    0,
                    -2.583,
                    0
                  ],
                  "ti": [
                    0,
                    0,
                    0
                  ]
                },
                {
                  "i": {
                    "x": 0.667,
                    "y": 1
                  },
                  "o": {
                    "x": 0.333,
                    "y": 0
                  },
                  "t": 44,
                  "s": [
                    390.319,
                    282.7,
                    0
                  ],
                  "to": [
                    0,
                    0,
                    0
                  ],
                  "ti": [
                    0,
                    0,
                    0
                  ]
                },
                {
                  "i": {
                    "x": 0.667,
                    "y": 1
                  },
                  "o": {
                    "x": 0.333,
                    "y": 0
                  },
                  "t": 110,
                  "s": [
                    390.319,
                    319.25,
                    0
                  ],
                  "to": [
                    0,
                    0,
                    0
                  ],
                  "ti": [
                    0,
                    0,
                    0
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    390.319,
                    298.2,
                    0
                  ]
                }
              ],
              "ix": 2
            },
            "a": {
              "a": 0,
              "k": [
                664.319,
                256.2,
                0
              ],
              "ix": 1
            },
            "s": {
              "a": 0,
              "k": [
                100,
                100,
                100
              ],
              "ix": 6
            }
          },
          "ao": 0,
          "shapes": [
            {
              "ty": "gr",
              "it": [
                {
                  "ty": "gr",
                  "it": [
                    {
                      "ind": 0,
                      "ty": "sh",
                      "ix": 1,
                      "ks": {
                        "a": 0,
                        "k": {
                          "i": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "o": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "v": [
                            [
                              18.967,
                              -3.189
                            ],
                            [
                              -18.967,
                              19.935
                            ],
                            [
                              -0.949,
                              -19.935
                            ]
                          ],
                          "c": true
                        },
                        "ix": 2
                      },
                      "nm": "Path 1",
                      "mn": "ADBE Vector Shape - Group",
                      "hd": false
                    },
                    {
                      "ty": "fl",
                      "c": {
                        "a": 0,
                        "k": [
                          0.223528981209,
                          0.192156970501,
                          0.674510002136,
                          1
                        ],
                        "ix": 4
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 5
                      },
                      "r": 1,
                      "bm": 0,
                      "nm": "Fill 1",
                      "mn": "ADBE Vector Graphic - Fill",
                      "hd": false
                    },
                    {
                      "ty": "tr",
                      "p": {
                        "a": 0,
                        "k": [
                          236.879,
                          292.737
                        ],
                        "ix": 2
                      },
                      "a": {
                        "a": 0,
                        "k": [
                          0,
                          0
                        ],
                        "ix": 1
                      },
                      "s": {
                        "a": 0,
                        "k": [
                          100,
                          100
                        ],
                        "ix": 3
                      },
                      "r": {
                        "a": 0,
                        "k": 0,
                        "ix": 6
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 7
                      },
                      "sk": {
                        "a": 0,
                        "k": 0,
                        "ix": 4
                      },
                      "sa": {
                        "a": 0,
                        "k": 0,
                        "ix": 5
                      },
                      "nm": "Transform"
                    }
                  ],
                  "nm": "Group 1",
                  "np": 2,
                  "cix": 2,
                  "bm": 0,
                  "ix": 1,
                  "mn": "ADBE Vector Group",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      633.939,
                      275.369
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      236.879,
                      292.737
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      50,
                      50
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "planete Outlines - Group 1",
              "np": 1,
              "cix": 2,
              "bm": 0,
              "ix": 1,
              "mn": "ADBE Vector Group",
              "hd": false
            },
            {
              "ty": "gr",
              "it": [
                {
                  "ty": "gr",
                  "it": [
                    {
                      "ind": 0,
                      "ty": "sh",
                      "ix": 1,
                      "ks": {
                        "a": 0,
                        "k": {
                          "i": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "o": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "v": [
                            [
                              -98.335,
                              64.79
                            ],
                            [
                              -105.619,
                              4.984
                            ],
                            [
                              105.619,
                              -64.79
                            ],
                            [
                              -80.316,
                              24.919
                            ]
                          ],
                          "c": true
                        },
                        "ix": 2
                      },
                      "nm": "Path 1",
                      "mn": "ADBE Vector Shape - Group",
                      "hd": false
                    },
                    {
                      "ty": "fl",
                      "c": {
                        "a": 0,
                        "k": [
                          0.278430998325,
                          0.294117987156,
                          0.847059011459,
                          1
                        ],
                        "ix": 4
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 5
                      },
                      "r": 1,
                      "bm": 0,
                      "nm": "Fill 1",
                      "mn": "ADBE Vector Graphic - Fill",
                      "hd": false
                    },
                    {
                      "ty": "tr",
                      "p": {
                        "a": 0,
                        "k": [
                          316.247,
                          247.882
                        ],
                        "ix": 2
                      },
                      "a": {
                        "a": 0,
                        "k": [
                          0,
                          0
                        ],
                        "ix": 1
                      },
                      "s": {
                        "a": 0,
                        "k": [
                          100,
                          100
                        ],
                        "ix": 3
                      },
                      "r": {
                        "a": 0,
                        "k": 0,
                        "ix": 6
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 7
                      },
                      "sk": {
                        "a": 0,
                        "k": 0,
                        "ix": 4
                      },
                      "sa": {
                        "a": 0,
                        "k": 0,
                        "ix": 5
                      },
                      "nm": "Transform"
                    }
                  ],
                  "nm": "Group 2",
                  "np": 2,
                  "cix": 2,
                  "bm": 0,
                  "ix": 1,
                  "mn": "ADBE Vector Group",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      673.623,
                      252.941
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      316.247,
                      247.882
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      50,
                      50
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "planete Outlines - Group 2",
              "np": 1,
              "cix": 2,
              "bm": 0,
              "ix": 2,
              "mn": "ADBE Vector Group",
              "hd": false
            },
            {
              "ty": "gr",
              "it": [
                {
                  "ty": "gr",
                  "it": [
                    {
                      "ind": 0,
                      "ty": "sh",
                      "ix": 1,
                      "ks": {
                        "a": 0,
                        "k": {
                          "i": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "o": [
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ],
                            [
                              0,
                              0
                            ]
                          ],
                          "v": [
                            [
                              -133.812,
                              -42.171
                            ],
                            [
                              133.812,
                              -75.141
                            ],
                            [
                              5.765,
                              75.141
                            ],
                            [
                              -61.708,
                              18.402
                            ],
                            [
                              124.227,
                              -71.307
                            ],
                            [
                              -87.011,
                              -1.534
                            ]
                          ],
                          "c": true
                        },
                        "ix": 2
                      },
                      "nm": "Path 1",
                      "mn": "ADBE Vector Shape - Group",
                      "hd": false
                    },
                    {
                      "ty": "fl",
                      "c": {
                        "a": 0,
                        "k": [
                          0.365000009537,
                          0.407999992371,
                          0.976000010967,
                          1
                        ],
                        "ix": 4
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 5
                      },
                      "r": 1,
                      "bm": 0,
                      "nm": "Fill 1",
                      "mn": "ADBE Vector Graphic - Fill",
                      "hd": false
                    },
                    {
                      "ty": "tr",
                      "p": {
                        "a": 0,
                        "k": [
                          297.638,
                          254.4
                        ],
                        "ix": 2
                      },
                      "a": {
                        "a": 0,
                        "k": [
                          0,
                          0
                        ],
                        "ix": 1
                      },
                      "s": {
                        "a": 0,
                        "k": [
                          100,
                          100
                        ],
                        "ix": 3
                      },
                      "r": {
                        "a": 0,
                        "k": 0,
                        "ix": 6
                      },
                      "o": {
                        "a": 0,
                        "k": 100,
                        "ix": 7
                      },
                      "sk": {
                        "a": 0,
                        "k": 0,
                        "ix": 4
                      },
                      "sa": {
                        "a": 0,
                        "k": 0,
                        "ix": 5
                      },
                      "nm": "Transform"
                    }
                  ],
                  "nm": "Group 3",
                  "np": 2,
                  "cix": 2,
                  "bm": 0,
                  "ix": 1,
                  "mn": "ADBE Vector Group",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      664.319,
                      256.2
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      297.638,
                      254.4
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      50,
                      50
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "planete Outlines - Group 3",
              "np": 1,
              "cix": 2,
              "bm": 0,
              "ix": 3,
              "mn": "ADBE Vector Group",
              "hd": false
            }
          ],
          "ip": 0,
          "op": 151,
          "st": 0,
          "bm": 0
        },
        {
          "ddd": 0,
          "ind": 3,
          "ty": 4,
          "nm": "planete Outlines - Group 5",
          "sr": 1,
          "ks": {
            "o": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 0,
                  "s": [
                    0
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 45,
                  "s": [
                    100
                  ]
                },
                {
                  "i": {
                    "x": [
                      0.667
                    ],
                    "y": [
                      1
                    ]
                  },
                  "o": {
                    "x": [
                      0.333
                    ],
                    "y": [
                      0
                    ]
                  },
                  "t": 102,
                  "s": [
                    100
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    0
                  ]
                }
              ],
              "ix": 11
            },
            "r": {
              "a": 0,
              "k": 0,
              "ix": 10
            },
            "p": {
              "a": 1,
              "k": [
                {
                  "i": {
                    "x": 0.833,
                    "y": 0.833
                  },
                  "o": {
                    "x": 0.167,
                    "y": 0.167
                  },
                  "t": 0,
                  "s": [
                    327.38,
                    267.583,
                    0
                  ],
                  "to": [
                    25.833,
                    0,
                    0
                  ],
                  "ti": [
                    -25.833,
                    0,
                    0
                  ]
                },
                {
                  "t": 150,
                  "s": [
                    482.38,
                    267.583,
                    0
                  ]
                }
              ],
              "ix": 2
            },
            "a": {
              "a": 0,
              "k": [
                171.76,
                193.166,
                0
              ],
              "ix": 1
            },
            "s": {
              "a": 0,
              "k": [
                50,
                50,
                100
              ],
              "ix": 6
            }
          },
          "ao": 0,
          "shapes": [
            {
              "ty": "gr",
              "it": [
                {
                  "ind": 0,
                  "ty": "sh",
                  "ix": 1,
                  "ks": {
                    "a": 0,
                    "k": {
                      "i": [
                        [
                          13.485,
                          0
                        ],
                        [
                          4.38,
                          -4.171
                        ],
                        [
                          21.913,
                          0
                        ],
                        [
                          3.575,
                          -18.765
                        ],
                        [
                          1.851,
                          0
                        ],
                        [
                          0,
                          -13.484
                        ],
                        [
                          -0.011,
                          -0.291
                        ],
                        [
                          1.599,
                          0
                        ],
                        [
                          0,
                          -6.743
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          0,
                          13.485
                        ]
                      ],
                      "o": [
                        [
                          -6.526,
                          0
                        ],
                        [
                          -0.793,
                          -21.719
                        ],
                        [
                          -19.806,
                          0
                        ],
                        [
                          -1.734,
                          -0.391
                        ],
                        [
                          -13.485,
                          0
                        ],
                        [
                          0,
                          0.293
                        ],
                        [
                          -1.4,
                          -0.559
                        ],
                        [
                          -6.742,
                          0
                        ],
                        [
                          0,
                          6.742
                        ],
                        [
                          0,
                          0
                        ],
                        [
                          13.485,
                          0
                        ],
                        [
                          0,
                          -13.484
                        ]
                      ],
                      "v": [
                        [
                          59.669,
                          -8.242
                        ],
                        [
                          42.84,
                          -1.506
                        ],
                        [
                          2.287,
                          -40.592
                        ],
                        [
                          -37.576,
                          -7.638
                        ],
                        [
                          -42.962,
                          -8.242
                        ],
                        [
                          -67.378,
                          16.174
                        ],
                        [
                          -67.356,
                          17.049
                        ],
                        [
                          -71.878,
                          16.174
                        ],
                        [
                          -84.086,
                          28.383
                        ],
                        [
                          -71.878,
                          40.591
                        ],
                        [
                          59.669,
                          40.591
                        ],
                        [
                          84.086,
                          16.174
                        ]
                      ],
                      "c": true
                    },
                    "ix": 2
                  },
                  "nm": "Path 1",
                  "mn": "ADBE Vector Shape - Group",
                  "hd": false
                },
                {
                  "ty": "fl",
                  "c": {
                    "a": 0,
                    "k": [
                      0.816000007181,
                      0.823999980852,
                      0.827000038297,
                      1
                    ],
                    "ix": 4
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 5
                  },
                  "r": 1,
                  "bm": 0,
                  "nm": "Fill 1",
                  "mn": "ADBE Vector Graphic - Fill",
                  "hd": false
                },
                {
                  "ty": "tr",
                  "p": {
                    "a": 0,
                    "k": [
                      171.76,
                      193.166
                    ],
                    "ix": 2
                  },
                  "a": {
                    "a": 0,
                    "k": [
                      0,
                      0
                    ],
                    "ix": 1
                  },
                  "s": {
                    "a": 0,
                    "k": [
                      100,
                      100
                    ],
                    "ix": 3
                  },
                  "r": {
                    "a": 0,
                    "k": 0,
                    "ix": 6
                  },
                  "o": {
                    "a": 0,
                    "k": 100,
                    "ix": 7
                  },
                  "sk": {
                    "a": 0,
                    "k": 0,
                    "ix": 4
                  },
                  "sa": {
                    "a": 0,
                    "k": 0,
                    "ix": 5
                  },
                  "nm": "Transform"
                }
              ],
              "nm": "Group 5",
              "np": 2,
              "cix": 2,
              "bm": 0,
              "ix": 1,
              "mn": "ADBE Vector Group",
              "hd": false
            }
          ],
          "ip": 0,
          "op": 151,
          "st": 0,
          "bm": 0
        }
      ]
    }
  ],
  "layers": [
    {
      "ddd": 0,
      "ind": 1,
      "ty": 0,
      "nm": "Pre-comp 1",
      "refId": "comp_0",
      "sr": 1,
      "ks": {
        "o": {
          "a": 0,
          "k": 100,
          "ix": 11
        },
        "r": {
          "a": 0,
          "k": 0,
          "ix": 10
        },
        "p": {
          "a": 0,
          "k": [
            406,
            306,
            0
          ],
          "ix": 2
        },
        "a": {
          "a": 0,
          "k": [
            400,
            300,
            0
          ],
          "ix": 1
        },
        "s": {
          "a": 0,
          "k": [
            179,
            179,
            100
          ],
          "ix": 6
        }
      },
      "ao": 0,
      "w": 800,
      "h": 600,
      "ip": 0,
      "op": 147,
      "st": 0,
      "bm": 0
    }
  ],
  "markers": []
} 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\codesource.txt 
=============================================== 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\src\androidTest\java\tg\univlome\epl\ExampleInstrumentedTest.kt 
=============================================== 
package tg.univlome.epl

import androidx.test.ext.junit.runners.AndroidJUnit4
import androidx.test.platform.app.InstrumentationRegistry
import or 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\gradle.properties 
=============================================== 
# Project-wide Gradle settings.
# IDE (e.g. Android Studio) users:
# Gradle settings configured through the IDE *will override*
# any settings specified in this file.
# For more details on how to configure your build environment visit
# http://www.gradle.org/docs/current/userguide/build_environment.html
# Specifies the JVM arguments used for the daemon process.
# The setting is particularly useful for tweaking memory settings.
org.gradle.jvmargs=-Xmx2048m -Dfile.encoding=UTF-8
# When configured, Gradle will run in incubating parallel mode.
# This option should only be used with decoupled projects. For more details, visit
# https://developer.android.com/r/tools/gradle-multi-project-decoupled-projects
# org.gradle.parallel=true
# AndroidX package structure to make it clearer which packages are bundled with the
# Android operating system, and which are packaged with your app's APK
# https://developer.android.com/topic/libraries/support-library/androidx-rn
android.useAndroidX=true
# Kotlin code style for this project: "official" or "obsolete":
kotlin.code.style=official
# Enables namespacing of each library's R class so that its R class includes only the
# resources declared in the library itself and none from the library's dependencies,
# thereby reducing the size of the R class for that library
android.nonTransitiveRClass=true 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\local.properties 
=============================================== 
## This file is automatically generated by Android Studio.
# Do not modify this file -- YOUR CHANGES WILL BE ERASED!
#
# This file should *NOT* be checked into Version Control Systems,
# as it contains information specific to your local configuration.
#
# Location of the SDK. This is only used by Gradle.
# For customization when using a Version Control System, please read the
# header note.
sdk.dir=C\:\\Users\\sicyr\\AppData\\Local\\Android\\Sdk 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\proguard-rules.pro 
=============================================== 
# Add project specific ProGuard rules here.
# You can control the set of applied configuration files using the
# proguardFiles setting in build.gradle.
#
# For more details, see
#   http://developer.android.com/guide/developing/tools/proguard.html

# If your project uses WebView with JS, uncomment the following
# and specify the fully qualified class name to the JavaScript interface
# class:
#-keepclassmembers class fqcn.of.javascript.interface.for.webview {
#   public *;
#}

# Uncomment this to preserve the line number information for
# debugging stack traces.
#-keepattributes SourceFile,LineNumberTable

# If you keep the line number information, uncomment this to
# hide the original source file name.
#-renamesourcefileattribute SourceFile 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\gradle\wrapper\gradle-wrapper.properties 
=============================================== 
#Tue Mar 11 16:36:12 CET 2025
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=https\://services.gradle.org/distributions/gradle-8.11.1-bin.zip
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\gradle.properties 
=============================================== 
# Project-wide Gradle settings.
# IDE (e.g. Android Studio) users:
# Gradle settings configured through the IDE *will override*
# any settings specified in this file.
# For more details on how to configure your build environment visit
# http://www.gradle.org/docs/current/userguide/build_environment.html
# Specifies the JVM arguments used for the daemon process.
# The setting is particularly useful for tweaking memory settings.
org.gradle.jvmargs=-Xmx2048m -Dfile.encoding=UTF-8
# When configured, Gradle will run in incubating parallel mode.
# This option should only be used with decoupled projects. For more details, visit
# https://developer.android.com/r/tools/gradle-multi-project-decoupled-projects
# org.gradle.parallel=true
# AndroidX package structure to make it clearer which packages are bundled with the
# Android operating system, and which are packaged with your app's APK
# https://developer.android.com/topic/libraries/support-library/androidx-rn
android.useAndroidX=true
# Kotlin code style for this project: "official" or "obsolete":
kotlin.code.style=official
# Enables namespacing of each library's R class so that its R class includes only the
# resources declared in the library itself and none from the library's dependencies,
# thereby reducing the size of the R class for that library
android.nonTransitiveRClass=true 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\local.properties 
=============================================== 
## This file is automatically generated by Android Studio.
# Do not modify this file -- YOUR CHANGES WILL BE ERASED!
#
# This file should *NOT* be checked into Version Control Systems,
# as it contains information specific to your local configuration.
#
# Location of the SDK. This is only used by Gradle.
# For customization when using a Version Control System, please read the
# header note.
sdk.dir=C\:\\Users\\sicyr\\AppData\\Local\\Android\\Sdk 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\gradle\wrapper\gradle-wrapper.properties 
=============================================== 
#Tue Mar 11 16:36:12 CET 2025
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=https\://services.gradle.org/distributions/gradle-8.11.1-bin.zip
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\gradle\libs.versions.toml 
=============================================== 
[versions]
agp = "8.9.0"
kotlin = "2.0.21"
coreKtx = "1.10.1"
junit = "4.13.2"
junitVersion = "1.1.5"
espressoCore = "3.5.1"
appcompat = "1.6.1"
material = "1.10.0"
activity = "1.8.0"
constraintlayout = "2.1.4"
googleGmsGoogleServices = "4.4.2"
firebaseFirestore = "25.1.2"
animationGraphicsAndroid = "1.8.1"

[libraries]
androidx-core-ktx = { group = "androidx.core", name = "core-ktx", version.ref = "coreKtx" }
junit = { group = "junit", name = "junit", version.ref = "junit" }
androidx-junit = { group = "androidx.test.ext", name = "junit", version.ref = "junitVersion" }
androidx-espresso-core = { group = "androidx.test.espresso", name = "espresso-core", version.ref = "espressoCore" }
androidx-appcompat = { group = "androidx.appcompat", name = "appcompat", version.ref = "appcompat" }
material = { group = "com.google.android.material", name = "material", version.ref = "material" }
androidx-activity = { group = "androidx.activity", name = "activity", version.ref = "activity" }
androidx-constraintlayout = { group = "androidx.constraintlayout", name = "constraintlayout", version.ref = "constraintlayout" }
firebase-firestore = { group = "com.google.firebase", name = "firebase-firestore", version.ref = "firebaseFirestore" }
androidx-animation-graphics-android = { group = "androidx.compose.animation", name = "animation-graphics-android", version.ref = "animationGraphicsAndroid" }

[plugins]
android-application = { id = "com.android.application", version.ref = "agp" }
kotlin-android = { id = "org.jetbrains.kotlin.android", version.ref = "kotlin" }
google-gms-google-services = { id = "com.google.gms.google-services", version.ref = "googleGmsGoogleServices" }

 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\.gitignore 
=============================================== 
*.iml
.gradle
/local.properties
/.idea/caches
/.idea/libraries
/.idea/modules.xml
/.idea/workspace.xml
/.idea/navEditor.xml
/.idea/assetWizardSettings.xml
.DS_Store
/build
/captures
.externalNativeBuild
.cxx
local.properties
 
 
=============================================== 
Fichier : C:\Users\sicyr\AndroidStudioProjects\LocUL\LocUL\app\.gitignore 
=============================================== 
/build 
 
